

============================== 2023-02-17 13:58:19.910746 | 3f278256-fb9a-4bea-9637-3fda3eb200b4 ==============================
[0m13:58:19.910746 [info ] [MainThread]: Running with dbt=1.4.1
[0m13:58:19.914459 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:58:19.915782 [debug] [MainThread]: Tracking: tracking
[0m13:58:19.926511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16c1357700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16c1355900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16c1357730>]}
[0m13:58:19.943897 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:58:19.945423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3f278256-fb9a-4bea-9637-3fda3eb200b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16c1355780>]}
[0m13:58:20.789796 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
[0m13:58:20.802610 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
[0m13:58:20.805612 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
[0m13:58:20.863522 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffe_shop_milan.example
[0m13:58:20.870008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3f278256-fb9a-4bea-9637-3fda3eb200b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16c4b88e50>]}
[0m13:58:20.876803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3f278256-fb9a-4bea-9637-3fda3eb200b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16c177d570>]}
[0m13:58:20.877251 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 334 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m13:58:20.877630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f278256-fb9a-4bea-9637-3fda3eb200b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16c3b2dae0>]}
[0m13:58:20.879063 [info ] [MainThread]: 
[0m13:58:20.881140 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:58:20.883118 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m13:58:20.883698 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:58:22.069749 [debug] [ThreadPool]: Acquiring new bigquery connection 'create_aec-students_dbt_milan'
[0m13:58:22.071027 [debug] [ThreadPool]: Acquiring new bigquery connection 'create_aec-students_dbt_milan'
[0m13:58:22.071935 [debug] [ThreadPool]: Creating schema "ReferenceKeyMsg(database='aec-students', schema='dbt_milan', identifier=None)"
[0m13:58:22.090133 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:58:22.092330 [debug] [ThreadPool]: On create_aec-students_dbt_milan: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "connection_name": "create_aec-students_dbt_milan"} */
create schema if not exists `aec-students`.`dbt_milan`
  
[0m13:58:23.364642 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:2593ba3f-3e0b-4c61-a188-a0afbf41d598&page=queryresults
[0m13:58:23.366899 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_milan'
[0m13:58:23.367380 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:58:23.672682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f278256-fb9a-4bea-9637-3fda3eb200b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16c1507730>]}
[0m13:58:23.673521 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m13:58:23.673951 [info ] [MainThread]: 
[0m13:58:23.698432 [debug] [Thread-1 (]: Began running node model.coffee_shop.customers
[0m13:58:23.699267 [info ] [Thread-1 (]: 1 of 3 START sql view model dbt_milan.customers ................................ [RUN]
[0m13:58:23.700438 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop.customers'
[0m13:58:23.700877 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.customers
[0m13:58:23.702920 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.customers"
[0m13:58:23.703594 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (compile): 2023-02-17 13:58:23.701164 => 2023-02-17 13:58:23.703489
[0m13:58:23.703936 [debug] [Thread-1 (]: Began executing node model.coffee_shop.customers
[0m13:58:23.698767 [debug] [Thread-2 (]: Began running node model.coffee_shop.my_first_dbt_model
[0m13:58:23.726374 [info ] [Thread-2 (]: 2 of 3 START sql table model dbt_milan.my_first_dbt_model ...................... [RUN]
[0m13:58:23.737445 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.coffee_shop.my_first_dbt_model'
[0m13:58:23.741244 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop.customers"
[0m13:58:23.741585 [debug] [Thread-2 (]: Began compiling node model.coffee_shop.my_first_dbt_model
[0m13:58:23.746719 [debug] [Thread-2 (]: Writing injected SQL for node "model.coffee_shop.my_first_dbt_model"
[0m13:58:23.747641 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:58:23.748097 [debug] [Thread-2 (]: Timing info for model.coffee_shop.my_first_dbt_model (compile): 2023-02-17 13:58:23.742241 => 2023-02-17 13:58:23.747998
[0m13:58:23.748422 [debug] [Thread-1 (]: On model.coffee_shop.customers: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.customers"} */


  create or replace view `aec-students`.`dbt_milan`.`customers`
  OPTIONS()
  as select * from `analytics-engineers-club.coffee_shop.customers`
Some bad SQL
limit 9000;;


[0m13:58:23.748794 [debug] [Thread-2 (]: Began executing node model.coffee_shop.my_first_dbt_model
[0m13:58:23.781432 [debug] [Thread-2 (]: Writing runtime sql for node "model.coffee_shop.my_first_dbt_model"
[0m13:58:23.782513 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:58:23.783173 [debug] [Thread-2 (]: On model.coffee_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.my_first_dbt_model"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`my_first_dbt_model`
    
    
    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m13:58:24.206272 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected end of input but got keyword SOME at [7:1]')
[0m13:58:24.928287 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:b138ec17-7d7a-42c0-9ebc-b4e092e0ed67&page=queryresults
[0m13:58:24.929265 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (execute): 2023-02-17 13:58:23.704111 => 2023-02-17 13:58:24.929173
[0m13:58:24.944261 [debug] [Thread-1 (]: Database Error in model customers (models/customers.sql)
  Syntax error: Expected end of input but got keyword SOME at [7:1]
  compiled Code at target/run/coffee_shop/models/customers.sql
[0m13:58:24.944776 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f278256-fb9a-4bea-9637-3fda3eb200b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16c12aec50>]}
[0m13:58:24.945367 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model dbt_milan.customers ....................... [[31mERROR[0m in 1.24s]
[0m13:58:24.947691 [debug] [Thread-1 (]: Finished running node model.coffee_shop.customers
[0m13:58:26.419551 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:9ac0a970-53d9-4592-9d87-9119dbb2fedc&page=queryresults
[0m13:58:26.435314 [debug] [Thread-2 (]: Timing info for model.coffee_shop.my_first_dbt_model (execute): 2023-02-17 13:58:23.750699 => 2023-02-17 13:58:26.435249
[0m13:58:26.436215 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f278256-fb9a-4bea-9637-3fda3eb200b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16c13036d0>]}
[0m13:58:26.436842 [info ] [Thread-2 (]: 2 of 3 OK created sql table model dbt_milan.my_first_dbt_model ................. [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 2.70s]
[0m13:58:26.437643 [debug] [Thread-2 (]: Finished running node model.coffee_shop.my_first_dbt_model
[0m13:58:26.438719 [debug] [Thread-4 (]: Began running node model.coffee_shop.my_second_dbt_model
[0m13:58:26.439159 [info ] [Thread-4 (]: 3 of 3 START sql view model dbt_milan.my_second_dbt_model ...................... [RUN]
[0m13:58:26.439893 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.coffee_shop.my_second_dbt_model'
[0m13:58:26.440162 [debug] [Thread-4 (]: Began compiling node model.coffee_shop.my_second_dbt_model
[0m13:58:26.443834 [debug] [Thread-4 (]: Writing injected SQL for node "model.coffee_shop.my_second_dbt_model"
[0m13:58:26.444521 [debug] [Thread-4 (]: Timing info for model.coffee_shop.my_second_dbt_model (compile): 2023-02-17 13:58:26.440331 => 2023-02-17 13:58:26.444352
[0m13:58:26.445074 [debug] [Thread-4 (]: Began executing node model.coffee_shop.my_second_dbt_model
[0m13:58:26.448032 [debug] [Thread-4 (]: Writing runtime sql for node "model.coffee_shop.my_second_dbt_model"
[0m13:58:26.448631 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:58:26.449055 [debug] [Thread-4 (]: On model.coffee_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.my_second_dbt_model"} */


  create or replace view `aec-students`.`dbt_milan`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `aec-students`.`dbt_milan`.`my_first_dbt_model`
where id = 1;


[0m13:58:27.315335 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:9d8e149f-61cc-47ca-9de4-688ddd30b504&page=queryresults
[0m13:58:27.317169 [debug] [Thread-4 (]: Timing info for model.coffee_shop.my_second_dbt_model (execute): 2023-02-17 13:58:26.445350 => 2023-02-17 13:58:27.317108
[0m13:58:27.317956 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f278256-fb9a-4bea-9637-3fda3eb200b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16c1290910>]}
[0m13:58:27.318494 [info ] [Thread-4 (]: 3 of 3 OK created sql view model dbt_milan.my_second_dbt_model ................. [[32mCREATE VIEW (0 processed)[0m in 0.88s]
[0m13:58:27.319237 [debug] [Thread-4 (]: Finished running node model.coffee_shop.my_second_dbt_model
[0m13:58:27.321375 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:58:27.322066 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:58:27.322313 [debug] [MainThread]: Connection 'model.coffee_shop.customers' was properly closed.
[0m13:58:27.322534 [debug] [MainThread]: Connection 'model.coffee_shop.my_first_dbt_model' was properly closed.
[0m13:58:27.322738 [debug] [MainThread]: Connection 'model.coffee_shop.my_second_dbt_model' was properly closed.
[0m13:58:27.323022 [info ] [MainThread]: 
[0m13:58:27.323406 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 6.44 seconds (6.44s).
[0m13:58:27.324160 [debug] [MainThread]: Command end result
[0m13:58:27.333636 [info ] [MainThread]: 
[0m13:58:27.334290 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:58:27.334799 [info ] [MainThread]: 
[0m13:58:27.335292 [error] [MainThread]: [33mDatabase Error in model customers (models/customers.sql)[0m
[0m13:58:27.335884 [error] [MainThread]:   Syntax error: Expected end of input but got keyword SOME at [7:1]
[0m13:58:27.336389 [error] [MainThread]:   compiled Code at target/run/coffee_shop/models/customers.sql
[0m13:58:27.336906 [info ] [MainThread]: 
[0m13:58:27.337427 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m13:58:27.341051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16c12d7b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16c12d72e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16c12d7580>]}
[0m13:58:27.341598 [debug] [MainThread]: Flushing usage events


============================== 2023-02-17 14:06:16.574292 | a4d75ae1-f72f-45d4-b391-6a2fa4baf61e ==============================
[0m14:06:16.574292 [info ] [MainThread]: Running with dbt=1.4.1
[0m14:06:16.577838 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:06:16.578790 [debug] [MainThread]: Tracking: tracking
[0m14:06:16.584820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ca5636fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ca1d5e8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ca1d5f760>]}
[0m14:06:16.803565 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:06:16.803912 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:06:16.804592 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffe_shop_milan.example
[0m14:06:16.811875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a4d75ae1-f72f-45d4-b391-6a2fa4baf61e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ca1d2d360>]}
[0m14:06:16.834249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a4d75ae1-f72f-45d4-b391-6a2fa4baf61e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ca1cf1960>]}
[0m14:06:16.834959 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 334 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m14:06:16.836194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a4d75ae1-f72f-45d4-b391-6a2fa4baf61e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ca5636fe0>]}
[0m14:06:16.838545 [info ] [MainThread]: 
[0m14:06:16.842943 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:06:16.845397 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m14:06:16.846061 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:06:18.189449 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_milan'
[0m14:06:18.189951 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:06:18.471350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a4d75ae1-f72f-45d4-b391-6a2fa4baf61e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ca1d70b50>]}
[0m14:06:18.472194 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m14:06:18.472589 [info ] [MainThread]: 
[0m14:06:18.481025 [debug] [Thread-1 (]: Began running node model.coffee_shop.customers
[0m14:06:18.482978 [debug] [Thread-2 (]: Began running node model.coffee_shop.my_first_dbt_model
[0m14:06:18.481669 [info ] [Thread-1 (]: 1 of 3 START sql view model dbt_milan.customers ................................ [RUN]
[0m14:06:18.485338 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop.customers'
[0m14:06:18.485778 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.customers
[0m14:06:18.492375 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.customers"
[0m14:06:18.493053 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (compile): 2023-02-17 14:06:18.486054 => 2023-02-17 14:06:18.492945
[0m14:06:18.493481 [debug] [Thread-1 (]: Began executing node model.coffee_shop.customers
[0m14:06:18.483562 [info ] [Thread-2 (]: 2 of 3 START sql table model dbt_milan.my_first_dbt_model ...................... [RUN]
[0m14:06:18.503801 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.coffee_shop.my_first_dbt_model'
[0m14:06:18.504450 [debug] [Thread-2 (]: Began compiling node model.coffee_shop.my_first_dbt_model
[0m14:06:18.509440 [debug] [Thread-2 (]: Writing injected SQL for node "model.coffee_shop.my_first_dbt_model"
[0m14:06:18.517426 [debug] [Thread-2 (]: Timing info for model.coffee_shop.my_first_dbt_model (compile): 2023-02-17 14:06:18.504761 => 2023-02-17 14:06:18.517080
[0m14:06:18.518042 [debug] [Thread-2 (]: Began executing node model.coffee_shop.my_first_dbt_model
[0m14:06:18.575173 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:06:18.603037 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop.customers"
[0m14:06:18.603993 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:18.605014 [debug] [Thread-1 (]: On model.coffee_shop.customers: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.customers"} */


  create or replace view `aec-students`.`dbt_milan`.`customers`
  OPTIONS()
  as select * from `analytics-engineers-club.coffee_shop.customers`
Some bad SQL
limit 9000;;


[0m14:06:19.004181 [debug] [Thread-2 (]: Writing runtime sql for node "model.coffee_shop.my_first_dbt_model"
[0m14:06:19.005183 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected end of input but got keyword SOME at [7:1]')
[0m14:06:19.005902 [debug] [Thread-2 (]: On model.coffee_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.my_first_dbt_model"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`my_first_dbt_model`
    
    
    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m14:06:19.793100 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:9e1e5b9e-006d-420e-892d-f70400efaeef&page=queryresults
[0m14:06:19.793867 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (execute): 2023-02-17 14:06:18.493759 => 2023-02-17 14:06:19.793750
[0m14:06:19.850737 [debug] [Thread-1 (]: Database Error in model customers (models/customers.sql)
  Syntax error: Expected end of input but got keyword SOME at [7:1]
  compiled Code at target/run/coffee_shop/models/customers.sql
[0m14:06:19.851392 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4d75ae1-f72f-45d4-b391-6a2fa4baf61e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ca1f08f70>]}
[0m14:06:19.852084 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model dbt_milan.customers ....................... [[31mERROR[0m in 1.37s]
[0m14:06:19.854447 [debug] [Thread-1 (]: Finished running node model.coffee_shop.customers
[0m14:06:21.196306 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:bece9673-2b3a-4370-8143-c7ba8ffad906&page=queryresults
[0m14:06:21.213795 [debug] [Thread-2 (]: Timing info for model.coffee_shop.my_first_dbt_model (execute): 2023-02-17 14:06:18.518414 => 2023-02-17 14:06:21.213732
[0m14:06:21.214601 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4d75ae1-f72f-45d4-b391-6a2fa4baf61e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ca1d5cca0>]}
[0m14:06:21.215141 [info ] [Thread-2 (]: 2 of 3 OK created sql table model dbt_milan.my_first_dbt_model ................. [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 2.71s]
[0m14:06:21.215646 [debug] [Thread-2 (]: Finished running node model.coffee_shop.my_first_dbt_model
[0m14:06:21.216630 [debug] [Thread-4 (]: Began running node model.coffee_shop.my_second_dbt_model
[0m14:06:21.217033 [info ] [Thread-4 (]: 3 of 3 START sql view model dbt_milan.my_second_dbt_model ...................... [RUN]
[0m14:06:21.217901 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.coffee_shop.my_second_dbt_model'
[0m14:06:21.218190 [debug] [Thread-4 (]: Began compiling node model.coffee_shop.my_second_dbt_model
[0m14:06:21.220902 [debug] [Thread-4 (]: Writing injected SQL for node "model.coffee_shop.my_second_dbt_model"
[0m14:06:21.221463 [debug] [Thread-4 (]: Timing info for model.coffee_shop.my_second_dbt_model (compile): 2023-02-17 14:06:21.218364 => 2023-02-17 14:06:21.221378
[0m14:06:21.221864 [debug] [Thread-4 (]: Began executing node model.coffee_shop.my_second_dbt_model
[0m14:06:21.225746 [debug] [Thread-4 (]: Writing runtime sql for node "model.coffee_shop.my_second_dbt_model"
[0m14:06:21.226342 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:06:21.226774 [debug] [Thread-4 (]: On model.coffee_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.my_second_dbt_model"} */


  create or replace view `aec-students`.`dbt_milan`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `aec-students`.`dbt_milan`.`my_first_dbt_model`
where id = 1;


[0m14:06:22.017949 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:82e64039-7276-4244-a70a-02c2a61bd085&page=queryresults
[0m14:06:22.020165 [debug] [Thread-4 (]: Timing info for model.coffee_shop.my_second_dbt_model (execute): 2023-02-17 14:06:21.222103 => 2023-02-17 14:06:22.020104
[0m14:06:22.021014 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4d75ae1-f72f-45d4-b391-6a2fa4baf61e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ca1d5eb00>]}
[0m14:06:22.021595 [info ] [Thread-4 (]: 3 of 3 OK created sql view model dbt_milan.my_second_dbt_model ................. [[32mCREATE VIEW (0 processed)[0m in 0.80s]
[0m14:06:22.022265 [debug] [Thread-4 (]: Finished running node model.coffee_shop.my_second_dbt_model
[0m14:06:22.024114 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:06:22.024683 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:06:22.024907 [debug] [MainThread]: Connection 'model.coffee_shop.customers' was properly closed.
[0m14:06:22.025082 [debug] [MainThread]: Connection 'model.coffee_shop.my_first_dbt_model' was properly closed.
[0m14:06:22.025281 [debug] [MainThread]: Connection 'model.coffee_shop.my_second_dbt_model' was properly closed.
[0m14:06:22.025513 [info ] [MainThread]: 
[0m14:06:22.025850 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 5.19 seconds (5.19s).
[0m14:06:22.027189 [debug] [MainThread]: Command end result
[0m14:06:22.041934 [info ] [MainThread]: 
[0m14:06:22.043229 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:06:22.044502 [info ] [MainThread]: 
[0m14:06:22.045647 [error] [MainThread]: [33mDatabase Error in model customers (models/customers.sql)[0m
[0m14:06:22.046441 [error] [MainThread]:   Syntax error: Expected end of input but got keyword SOME at [7:1]
[0m14:06:22.047631 [error] [MainThread]:   compiled Code at target/run/coffee_shop/models/customers.sql
[0m14:06:22.048423 [info ] [MainThread]: 
[0m14:06:22.049809 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m14:06:22.051049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ca1cf1450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ca1cdf8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ca1cdfb80>]}
[0m14:06:22.051517 [debug] [MainThread]: Flushing usage events


============================== 2023-02-17 14:06:50.566125 | 171e1bbc-635c-4f0b-9872-21304fc03526 ==============================
[0m14:06:50.566125 [info ] [MainThread]: Running with dbt=1.4.1
[0m14:06:50.570110 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:06:50.570531 [debug] [MainThread]: Tracking: tracking
[0m14:06:50.572441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72df35f640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72df35ea70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72df35f670>]}
[0m14:06:50.620994 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:06:50.621565 [debug] [MainThread]: Partial parsing: updated file: coffee_shop://models/customers.sql
[0m14:06:50.650714 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
[0m14:06:50.670777 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffe_shop_milan.example
[0m14:06:50.676411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '171e1bbc-635c-4f0b-9872-21304fc03526', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72ded75f90>]}
[0m14:06:50.685821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '171e1bbc-635c-4f0b-9872-21304fc03526', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72df2e3fd0>]}
[0m14:06:50.686318 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 334 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m14:06:50.686780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '171e1bbc-635c-4f0b-9872-21304fc03526', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72df2cd360>]}
[0m14:06:50.688296 [info ] [MainThread]: 
[0m14:06:50.690484 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:06:50.691987 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m14:06:50.692435 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:06:51.869699 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_milan'
[0m14:06:51.870530 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:06:52.143614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '171e1bbc-635c-4f0b-9872-21304fc03526', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72df3706d0>]}
[0m14:06:52.144845 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m14:06:52.145955 [info ] [MainThread]: 
[0m14:06:52.153348 [debug] [Thread-1 (]: Began running node model.coffee_shop.customers
[0m14:06:52.153671 [debug] [Thread-2 (]: Began running node model.coffee_shop.my_first_dbt_model
[0m14:06:52.154118 [info ] [Thread-1 (]: 1 of 3 START sql view model dbt_milan.customers ................................ [RUN]
[0m14:06:52.154506 [info ] [Thread-2 (]: 2 of 3 START sql table model dbt_milan.my_first_dbt_model ...................... [RUN]
[0m14:06:52.155626 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop.customers'
[0m14:06:52.156279 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.coffee_shop.my_first_dbt_model'
[0m14:06:52.156983 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.customers
[0m14:06:52.157294 [debug] [Thread-2 (]: Began compiling node model.coffee_shop.my_first_dbt_model
[0m14:06:52.161214 [debug] [Thread-2 (]: Writing injected SQL for node "model.coffee_shop.my_first_dbt_model"
[0m14:06:52.215655 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.customers"
[0m14:06:52.216385 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (compile): 2023-02-17 14:06:52.157588 => 2023-02-17 14:06:52.216276
[0m14:06:52.216651 [debug] [Thread-2 (]: Timing info for model.coffee_shop.my_first_dbt_model (compile): 2023-02-17 14:06:52.158563 => 2023-02-17 14:06:52.216602
[0m14:06:52.216977 [debug] [Thread-1 (]: Began executing node model.coffee_shop.customers
[0m14:06:52.217308 [debug] [Thread-2 (]: Began executing node model.coffee_shop.my_first_dbt_model
[0m14:06:52.268020 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:06:52.270220 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop.customers"
[0m14:06:52.272884 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:52.273710 [debug] [Thread-1 (]: On model.coffee_shop.customers: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.customers"} */


  create or replace view `aec-students`.`dbt_milan`.`customers`
  OPTIONS()
  as select * from `analytics-engineers-club.coffee_shop.customers`
limit 9000;;


[0m14:06:52.644051 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected end of input but got ";" at [7:12]')
[0m14:06:52.665404 [debug] [Thread-2 (]: Writing runtime sql for node "model.coffee_shop.my_first_dbt_model"
[0m14:06:52.666107 [debug] [Thread-2 (]: On model.coffee_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.my_first_dbt_model"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`my_first_dbt_model`
    
    
    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m14:06:53.177871 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:b279d14b-745d-4f28-b016-5f1fcc6b62e0&page=queryresults
[0m14:06:53.178671 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (execute): 2023-02-17 14:06:52.217509 => 2023-02-17 14:06:53.178559
[0m14:06:53.181720 [debug] [Thread-1 (]: Database Error in model customers (models/customers.sql)
  Syntax error: Expected end of input but got ";" at [7:12]
  compiled Code at target/run/coffee_shop/models/customers.sql
[0m14:06:53.182218 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '171e1bbc-635c-4f0b-9872-21304fc03526', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72df539c90>]}
[0m14:06:53.182723 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model dbt_milan.customers ....................... [[31mERROR[0m in 1.03s]
[0m14:06:53.184606 [debug] [Thread-1 (]: Finished running node model.coffee_shop.customers
[0m14:06:54.821922 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:48c3d8d5-6a4d-476a-b08c-bfb2d541a62c&page=queryresults
[0m14:06:54.842548 [debug] [Thread-2 (]: Timing info for model.coffee_shop.my_first_dbt_model (execute): 2023-02-17 14:06:52.235754 => 2023-02-17 14:06:54.842464
[0m14:06:54.843609 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '171e1bbc-635c-4f0b-9872-21304fc03526', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72df539ab0>]}
[0m14:06:54.844357 [info ] [Thread-2 (]: 2 of 3 OK created sql table model dbt_milan.my_first_dbt_model ................. [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 2.69s]
[0m14:06:54.844921 [debug] [Thread-2 (]: Finished running node model.coffee_shop.my_first_dbt_model
[0m14:06:54.845883 [debug] [Thread-4 (]: Began running node model.coffee_shop.my_second_dbt_model
[0m14:06:54.847196 [info ] [Thread-4 (]: 3 of 3 START sql view model dbt_milan.my_second_dbt_model ...................... [RUN]
[0m14:06:54.849822 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.coffee_shop.my_second_dbt_model'
[0m14:06:54.850415 [debug] [Thread-4 (]: Began compiling node model.coffee_shop.my_second_dbt_model
[0m14:06:54.854928 [debug] [Thread-4 (]: Writing injected SQL for node "model.coffee_shop.my_second_dbt_model"
[0m14:06:54.855894 [debug] [Thread-4 (]: Timing info for model.coffee_shop.my_second_dbt_model (compile): 2023-02-17 14:06:54.850807 => 2023-02-17 14:06:54.855788
[0m14:06:54.856357 [debug] [Thread-4 (]: Began executing node model.coffee_shop.my_second_dbt_model
[0m14:06:54.860487 [debug] [Thread-4 (]: Writing runtime sql for node "model.coffee_shop.my_second_dbt_model"
[0m14:06:54.861231 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:06:54.861619 [debug] [Thread-4 (]: On model.coffee_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.my_second_dbt_model"} */


  create or replace view `aec-students`.`dbt_milan`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `aec-students`.`dbt_milan`.`my_first_dbt_model`
where id = 1;


[0m14:06:55.596819 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:e908f733-eaca-4355-a41d-d13ba12360c4&page=queryresults
[0m14:06:55.598976 [debug] [Thread-4 (]: Timing info for model.coffee_shop.my_second_dbt_model (execute): 2023-02-17 14:06:54.856640 => 2023-02-17 14:06:55.598914
[0m14:06:55.599857 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '171e1bbc-635c-4f0b-9872-21304fc03526', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72ded9f9a0>]}
[0m14:06:55.600426 [info ] [Thread-4 (]: 3 of 3 OK created sql view model dbt_milan.my_second_dbt_model ................. [[32mCREATE VIEW (0 processed)[0m in 0.75s]
[0m14:06:55.600982 [debug] [Thread-4 (]: Finished running node model.coffee_shop.my_second_dbt_model
[0m14:06:55.602900 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:06:55.603552 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:06:55.603792 [debug] [MainThread]: Connection 'model.coffee_shop.customers' was properly closed.
[0m14:06:55.604023 [debug] [MainThread]: Connection 'model.coffee_shop.my_first_dbt_model' was properly closed.
[0m14:06:55.604209 [debug] [MainThread]: Connection 'model.coffee_shop.my_second_dbt_model' was properly closed.
[0m14:06:55.604482 [info ] [MainThread]: 
[0m14:06:55.604909 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 4.92 seconds (4.92s).
[0m14:06:55.605578 [debug] [MainThread]: Command end result
[0m14:06:55.616327 [info ] [MainThread]: 
[0m14:06:55.616987 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:06:55.617495 [info ] [MainThread]: 
[0m14:06:55.617935 [error] [MainThread]: [33mDatabase Error in model customers (models/customers.sql)[0m
[0m14:06:55.618365 [error] [MainThread]:   Syntax error: Expected end of input but got ";" at [7:12]
[0m14:06:55.618849 [error] [MainThread]:   compiled Code at target/run/coffee_shop/models/customers.sql
[0m14:06:55.619356 [info ] [MainThread]: 
[0m14:06:55.619788 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m14:06:55.620295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72df788d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72df329d80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72df329d20>]}
[0m14:06:55.620671 [debug] [MainThread]: Flushing usage events


============================== 2023-02-17 14:07:17.658002 | cd46476c-e855-4feb-ad5b-4a06dda73bbf ==============================
[0m14:07:17.658002 [info ] [MainThread]: Running with dbt=1.4.1
[0m14:07:17.660861 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:07:17.661352 [debug] [MainThread]: Tracking: tracking
[0m14:07:17.664490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaab85f700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaab85c190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaab85f730>]}
[0m14:07:17.714073 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:07:17.714725 [debug] [MainThread]: Partial parsing: updated file: coffee_shop://models/customers.sql
[0m14:07:17.727516 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
[0m14:07:17.751341 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffe_shop_milan.example
[0m14:07:17.757367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cd46476c-e855-4feb-ad5b-4a06dda73bbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaab275d20>]}
[0m14:07:17.764693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cd46476c-e855-4feb-ad5b-4a06dda73bbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaab7e3f10>]}
[0m14:07:17.765186 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 334 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m14:07:17.765638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd46476c-e855-4feb-ad5b-4a06dda73bbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaab7d10f0>]}
[0m14:07:17.767477 [info ] [MainThread]: 
[0m14:07:17.769567 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:07:17.771052 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m14:07:17.771527 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:07:18.935078 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_milan'
[0m14:07:18.935695 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:07:19.222866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd46476c-e855-4feb-ad5b-4a06dda73bbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaab822f50>]}
[0m14:07:19.224162 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m14:07:19.225632 [info ] [MainThread]: 
[0m14:07:19.233129 [debug] [Thread-1 (]: Began running node model.coffee_shop.customers
[0m14:07:19.233774 [info ] [Thread-1 (]: 1 of 3 START sql view model dbt_milan.customers ................................ [RUN]
[0m14:07:19.240455 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop.customers'
[0m14:07:19.240977 [debug] [Thread-2 (]: Began running node model.coffee_shop.my_first_dbt_model
[0m14:07:19.242250 [info ] [Thread-2 (]: 2 of 3 START sql table model dbt_milan.my_first_dbt_model ...................... [RUN]
[0m14:07:19.243217 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.coffee_shop.my_first_dbt_model'
[0m14:07:19.243607 [debug] [Thread-2 (]: Began compiling node model.coffee_shop.my_first_dbt_model
[0m14:07:19.241544 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.customers
[0m14:07:19.251070 [debug] [Thread-2 (]: Writing injected SQL for node "model.coffee_shop.my_first_dbt_model"
[0m14:07:19.305338 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.customers"
[0m14:07:19.306324 [debug] [Thread-2 (]: Timing info for model.coffee_shop.my_first_dbt_model (compile): 2023-02-17 14:07:19.243848 => 2023-02-17 14:07:19.306224
[0m14:07:19.306788 [debug] [Thread-2 (]: Began executing node model.coffee_shop.my_first_dbt_model
[0m14:07:19.307052 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (compile): 2023-02-17 14:07:19.251810 => 2023-02-17 14:07:19.306994
[0m14:07:19.322867 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:07:19.323958 [debug] [Thread-1 (]: Began executing node model.coffee_shop.customers
[0m14:07:19.364651 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop.customers"
[0m14:07:19.365662 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:07:19.366791 [debug] [Thread-1 (]: On model.coffee_shop.customers: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.customers"} */


  create or replace view `aec-students`.`dbt_milan`.`customers`
  OPTIONS()
  as select * from `analytics-engineers-club.coffee_shop.customers`
limit 9000;


[0m14:07:19.744609 [debug] [Thread-2 (]: Writing runtime sql for node "model.coffee_shop.my_first_dbt_model"
[0m14:07:19.745594 [debug] [Thread-2 (]: On model.coffee_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.my_first_dbt_model"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`my_first_dbt_model`
    
    
    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m14:07:20.195496 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:51bd58ae-c9bb-4441-8f13-ade0cb01ad03&page=queryresults
[0m14:07:20.210701 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (execute): 2023-02-17 14:07:19.325826 => 2023-02-17 14:07:20.210621
[0m14:07:20.211631 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd46476c-e855-4feb-ad5b-4a06dda73bbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaab29b7c0>]}
[0m14:07:20.212225 [info ] [Thread-1 (]: 1 of 3 OK created sql view model dbt_milan.customers ........................... [[32mCREATE VIEW (0 processed)[0m in 0.98s]
[0m14:07:20.214004 [debug] [Thread-1 (]: Finished running node model.coffee_shop.customers
[0m14:07:21.939473 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:cf860ebb-73a9-48ab-afb5-ff2b39136f41&page=queryresults
[0m14:07:21.945845 [debug] [Thread-2 (]: Timing info for model.coffee_shop.my_first_dbt_model (execute): 2023-02-17 14:07:19.307237 => 2023-02-17 14:07:21.945760
[0m14:07:21.947058 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd46476c-e855-4feb-ad5b-4a06dda73bbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaab8602b0>]}
[0m14:07:21.947739 [info ] [Thread-2 (]: 2 of 3 OK created sql table model dbt_milan.my_first_dbt_model ................. [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 2.70s]
[0m14:07:21.948380 [debug] [Thread-2 (]: Finished running node model.coffee_shop.my_first_dbt_model
[0m14:07:21.949551 [debug] [Thread-4 (]: Began running node model.coffee_shop.my_second_dbt_model
[0m14:07:21.950220 [info ] [Thread-4 (]: 3 of 3 START sql view model dbt_milan.my_second_dbt_model ...................... [RUN]
[0m14:07:21.951202 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.coffee_shop.my_second_dbt_model'
[0m14:07:21.951621 [debug] [Thread-4 (]: Began compiling node model.coffee_shop.my_second_dbt_model
[0m14:07:21.955537 [debug] [Thread-4 (]: Writing injected SQL for node "model.coffee_shop.my_second_dbt_model"
[0m14:07:21.956193 [debug] [Thread-4 (]: Timing info for model.coffee_shop.my_second_dbt_model (compile): 2023-02-17 14:07:21.951869 => 2023-02-17 14:07:21.956103
[0m14:07:21.956628 [debug] [Thread-4 (]: Began executing node model.coffee_shop.my_second_dbt_model
[0m14:07:21.959720 [debug] [Thread-4 (]: Writing runtime sql for node "model.coffee_shop.my_second_dbt_model"
[0m14:07:21.960351 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:07:21.960809 [debug] [Thread-4 (]: On model.coffee_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.my_second_dbt_model"} */


  create or replace view `aec-students`.`dbt_milan`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `aec-students`.`dbt_milan`.`my_first_dbt_model`
where id = 1;


[0m14:07:22.661500 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:e37d40a7-6a20-4a5e-bc7b-c99c04fcf3e9&page=queryresults
[0m14:07:22.663546 [debug] [Thread-4 (]: Timing info for model.coffee_shop.my_second_dbt_model (execute): 2023-02-17 14:07:21.956875 => 2023-02-17 14:07:22.663484
[0m14:07:22.664401 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd46476c-e855-4feb-ad5b-4a06dda73bbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaab16f5b0>]}
[0m14:07:22.664969 [info ] [Thread-4 (]: 3 of 3 OK created sql view model dbt_milan.my_second_dbt_model ................. [[32mCREATE VIEW (0 processed)[0m in 0.71s]
[0m14:07:22.665544 [debug] [Thread-4 (]: Finished running node model.coffee_shop.my_second_dbt_model
[0m14:07:22.667366 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:07:22.667999 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:07:22.668218 [debug] [MainThread]: Connection 'model.coffee_shop.my_first_dbt_model' was properly closed.
[0m14:07:22.668422 [debug] [MainThread]: Connection 'model.coffee_shop.customers' was properly closed.
[0m14:07:22.668612 [debug] [MainThread]: Connection 'model.coffee_shop.my_second_dbt_model' was properly closed.
[0m14:07:22.668890 [info ] [MainThread]: 
[0m14:07:22.669231 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 4.90 seconds (4.90s).
[0m14:07:22.669768 [debug] [MainThread]: Command end result
[0m14:07:22.676647 [info ] [MainThread]: 
[0m14:07:22.677855 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:07:22.678342 [info ] [MainThread]: 
[0m14:07:22.679077 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m14:07:22.679675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaab340c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaab340d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaab3408b0>]}
[0m14:07:22.680349 [debug] [MainThread]: Flushing usage events


============================== 2023-02-17 14:11:50.392492 | d7b687ae-24ef-434a-8df8-4affb71472ec ==============================
[0m14:11:50.392492 [info ] [MainThread]: Running with dbt=1.4.1
[0m14:11:50.395088 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:11:50.395442 [debug] [MainThread]: Tracking: tracking
[0m14:11:50.397680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f662055f700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f662055dd20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f662055f730>]}
[0m14:11:50.455303 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:11:50.456054 [debug] [MainThread]: Partial parsing: updated file: coffee_shop://models/customers.sql
[0m14:11:50.474956 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
[0m14:11:50.493589 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffe_shop_milan.example
[0m14:11:50.499366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd7b687ae-24ef-434a-8df8-4affb71472ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f661bf2df30>]}
[0m14:11:50.507583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd7b687ae-24ef-434a-8df8-4affb71472ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66204cd2d0>]}
[0m14:11:50.508081 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 334 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m14:11:50.508696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd7b687ae-24ef-434a-8df8-4affb71472ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66204cd300>]}
[0m14:11:50.510113 [info ] [MainThread]: 
[0m14:11:50.512407 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:11:50.514251 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m14:11:50.514772 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:11:51.743684 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_milan'
[0m14:11:51.744588 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:11:52.002889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd7b687ae-24ef-434a-8df8-4affb71472ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66204e3d00>]}
[0m14:11:52.003760 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m14:11:52.004172 [info ] [MainThread]: 
[0m14:11:52.008871 [debug] [Thread-1 (]: Began running node model.coffee_shop.customers
[0m14:11:52.009201 [debug] [Thread-2 (]: Began running node model.coffee_shop.my_first_dbt_model
[0m14:11:52.009655 [info ] [Thread-1 (]: 1 of 3 START sql table model dbt_milan.customers ............................... [RUN]
[0m14:11:52.010955 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop.customers'
[0m14:11:52.013160 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.customers
[0m14:11:52.010087 [info ] [Thread-2 (]: 2 of 3 START sql table model dbt_milan.my_first_dbt_model ...................... [RUN]
[0m14:11:52.022100 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.coffee_shop.my_first_dbt_model'
[0m14:11:52.022537 [debug] [Thread-2 (]: Began compiling node model.coffee_shop.my_first_dbt_model
[0m14:11:52.026325 [debug] [Thread-2 (]: Writing injected SQL for node "model.coffee_shop.my_first_dbt_model"
[0m14:11:52.027945 [debug] [Thread-2 (]: Timing info for model.coffee_shop.my_first_dbt_model (compile): 2023-02-17 14:11:52.022880 => 2023-02-17 14:11:52.027499
[0m14:11:52.097820 [debug] [Thread-2 (]: Began executing node model.coffee_shop.my_first_dbt_model
[0m14:11:52.100586 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.customers"
[0m14:11:52.112472 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (compile): 2023-02-17 14:11:52.018688 => 2023-02-17 14:11:52.112364
[0m14:11:52.117180 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:11:52.117705 [debug] [Thread-1 (]: Began executing node model.coffee_shop.customers
[0m14:11:52.121930 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:11:52.574603 [debug] [Thread-2 (]: Writing runtime sql for node "model.coffee_shop.my_first_dbt_model"
[0m14:11:52.575737 [debug] [Thread-2 (]: On model.coffee_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.my_first_dbt_model"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`my_first_dbt_model`
    
    
    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m14:11:52.732236 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop.customers"
[0m14:11:52.733009 [debug] [Thread-1 (]: On model.coffee_shop.customers: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.customers"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`customers`
    
    
    OPTIONS()
    as (
      

select * from `analytics-engineers-club.coffee_shop.customers`
limit 9000
    );
  
[0m14:11:54.813038 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:6c949409-35a1-48be-9cc3-c7c182affd39&page=queryresults
[0m14:11:54.830145 [debug] [Thread-2 (]: Timing info for model.coffee_shop.my_first_dbt_model (execute): 2023-02-17 14:11:52.100923 => 2023-02-17 14:11:54.830082
[0m14:11:54.830955 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7b687ae-24ef-434a-8df8-4affb71472ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f662070b8b0>]}
[0m14:11:54.831513 [info ] [Thread-2 (]: 2 of 3 OK created sql table model dbt_milan.my_first_dbt_model ................. [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 2.81s]
[0m14:11:54.833307 [debug] [Thread-2 (]: Finished running node model.coffee_shop.my_first_dbt_model
[0m14:11:54.834619 [debug] [Thread-4 (]: Began running node model.coffee_shop.my_second_dbt_model
[0m14:11:54.835122 [info ] [Thread-4 (]: 3 of 3 START sql view model dbt_milan.my_second_dbt_model ...................... [RUN]
[0m14:11:54.836677 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.coffee_shop.my_second_dbt_model'
[0m14:11:54.837907 [debug] [Thread-4 (]: Began compiling node model.coffee_shop.my_second_dbt_model
[0m14:11:54.843219 [debug] [Thread-4 (]: Writing injected SQL for node "model.coffee_shop.my_second_dbt_model"
[0m14:11:54.844217 [debug] [Thread-4 (]: Timing info for model.coffee_shop.my_second_dbt_model (compile): 2023-02-17 14:11:54.838302 => 2023-02-17 14:11:54.844119
[0m14:11:54.844716 [debug] [Thread-4 (]: Began executing node model.coffee_shop.my_second_dbt_model
[0m14:11:54.867686 [debug] [Thread-4 (]: Writing runtime sql for node "model.coffee_shop.my_second_dbt_model"
[0m14:11:54.868391 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:11:54.869068 [debug] [Thread-4 (]: On model.coffee_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.my_second_dbt_model"} */


  create or replace view `aec-students`.`dbt_milan`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `aec-students`.`dbt_milan`.`my_first_dbt_model`
where id = 1;


[0m14:11:55.024812 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:03ccae19-30c5-4e5a-b8aa-4ae706fdde45&page=queryresults
[0m14:11:55.026720 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (execute): 2023-02-17 14:11:52.119555 => 2023-02-17 14:11:55.026659
[0m14:11:55.027510 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7b687ae-24ef-434a-8df8-4affb71472ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f661bf4ee90>]}
[0m14:11:55.028097 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dbt_milan.customers .......................... [[32mCREATE TABLE (9.0k rows, 12.8 MB processed)[0m in 3.02s]
[0m14:11:55.028777 [debug] [Thread-1 (]: Finished running node model.coffee_shop.customers
[0m14:11:55.616279 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:25db2192-0268-47cd-9926-dd3076a2e730&page=queryresults
[0m14:11:55.618441 [debug] [Thread-4 (]: Timing info for model.coffee_shop.my_second_dbt_model (execute): 2023-02-17 14:11:54.845086 => 2023-02-17 14:11:55.618382
[0m14:11:55.619223 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7b687ae-24ef-434a-8df8-4affb71472ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f661bf4ed70>]}
[0m14:11:55.619744 [info ] [Thread-4 (]: 3 of 3 OK created sql view model dbt_milan.my_second_dbt_model ................. [[32mCREATE VIEW (0 processed)[0m in 0.78s]
[0m14:11:55.620220 [debug] [Thread-4 (]: Finished running node model.coffee_shop.my_second_dbt_model
[0m14:11:55.622272 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:11:55.622861 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:11:55.623082 [debug] [MainThread]: Connection 'model.coffee_shop.customers' was properly closed.
[0m14:11:55.623257 [debug] [MainThread]: Connection 'model.coffee_shop.my_first_dbt_model' was properly closed.
[0m14:11:55.623458 [debug] [MainThread]: Connection 'model.coffee_shop.my_second_dbt_model' was properly closed.
[0m14:11:55.623721 [info ] [MainThread]: 
[0m14:11:55.624064 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 5.11 seconds (5.11s).
[0m14:11:55.624635 [debug] [MainThread]: Command end result
[0m14:11:55.633155 [info ] [MainThread]: 
[0m14:11:55.639494 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:11:55.641709 [info ] [MainThread]: 
[0m14:11:55.643056 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m14:11:55.643999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66204cd300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66205735e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66205705e0>]}
[0m14:11:55.644418 [debug] [MainThread]: Flushing usage events


============================== 2023-02-17 14:22:25.108088 | a77c8c04-517f-463b-836a-6d5faa265115 ==============================
[0m14:22:25.108088 [info ] [MainThread]: Running with dbt=1.4.1
[0m14:22:25.110707 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:22:25.111070 [debug] [MainThread]: Tracking: tracking
[0m14:22:25.112891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d5055f700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d5055d8a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d5055f730>]}
[0m14:22:25.164922 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m14:22:25.165662 [debug] [MainThread]: Partial parsing: added file: coffee_shop://models/customers_ref.sql
[0m14:22:25.185319 [debug] [MainThread]: 1699: static parser successfully parsed customers_ref.sql
[0m14:22:25.203335 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffe_shop_milan.example
[0m14:22:25.208932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a77c8c04-517f-463b-836a-6d5faa265115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d4bf3ddb0>]}
[0m14:22:25.216650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a77c8c04-517f-463b-836a-6d5faa265115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d504e3eb0>]}
[0m14:22:25.217143 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 334 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m14:22:25.217750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a77c8c04-517f-463b-836a-6d5faa265115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d504e3e80>]}
[0m14:22:25.219373 [info ] [MainThread]: 
[0m14:22:25.221572 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:22:25.223000 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m14:22:25.223484 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:22:26.428774 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_milan'
[0m14:22:26.429361 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:22:26.688585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a77c8c04-517f-463b-836a-6d5faa265115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d504e3c70>]}
[0m14:22:26.689384 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m14:22:26.690173 [info ] [MainThread]: 
[0m14:22:26.696002 [debug] [Thread-1 (]: Began running node model.coffee_shop.customers
[0m14:22:26.696753 [info ] [Thread-1 (]: 1 of 3 START sql table model dbt_milan.customers ............................... [RUN]
[0m14:22:26.697568 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop.customers'
[0m14:22:26.697858 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.customers
[0m14:22:26.747772 [debug] [Thread-2 (]: Began running node model.coffee_shop.my_first_dbt_model
[0m14:22:26.748427 [info ] [Thread-2 (]: 2 of 3 START sql table model dbt_milan.my_first_dbt_model ...................... [RUN]
[0m14:22:26.749398 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.coffee_shop.my_first_dbt_model'
[0m14:22:26.749801 [debug] [Thread-2 (]: Began compiling node model.coffee_shop.my_first_dbt_model
[0m14:22:26.753988 [debug] [Thread-2 (]: Writing injected SQL for node "model.coffee_shop.my_first_dbt_model"
[0m14:22:26.759650 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.customers"
[0m14:22:26.760566 [debug] [Thread-2 (]: Timing info for model.coffee_shop.my_first_dbt_model (compile): 2023-02-17 14:22:26.750068 => 2023-02-17 14:22:26.760341
[0m14:22:26.760822 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (compile): 2023-02-17 14:22:26.698031 => 2023-02-17 14:22:26.760764
[0m14:22:26.761118 [debug] [Thread-2 (]: Began executing node model.coffee_shop.my_first_dbt_model
[0m14:22:26.761416 [debug] [Thread-1 (]: Began executing node model.coffee_shop.customers
[0m14:22:26.782564 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:22:26.788707 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:22:27.223169 [debug] [Thread-2 (]: Writing runtime sql for node "model.coffee_shop.my_first_dbt_model"
[0m14:22:27.223557 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop.customers"
[0m14:22:27.224652 [debug] [Thread-2 (]: On model.coffee_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.my_first_dbt_model"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`my_first_dbt_model`
    
    
    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m14:22:27.225148 [debug] [Thread-1 (]: On model.coffee_shop.customers: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.customers"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`customers`
    
    
    OPTIONS()
    as (
      

select * from `analytics-engineers-club.coffee_shop.customers`
limit 9000
    );
  
[0m14:22:29.357582 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:0f1c114c-9665-44db-87a4-d6a5f33d747e&page=queryresults
[0m14:22:29.378582 [debug] [Thread-2 (]: Timing info for model.coffee_shop.my_first_dbt_model (execute): 2023-02-17 14:22:26.761613 => 2023-02-17 14:22:29.378514
[0m14:22:29.379395 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a77c8c04-517f-463b-836a-6d5faa265115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d5098e950>]}
[0m14:22:29.379966 [info ] [Thread-2 (]: 2 of 3 OK created sql table model dbt_milan.my_first_dbt_model ................. [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 2.63s]
[0m14:22:29.382731 [debug] [Thread-2 (]: Finished running node model.coffee_shop.my_first_dbt_model
[0m14:22:29.383901 [debug] [Thread-4 (]: Began running node model.coffee_shop.my_second_dbt_model
[0m14:22:29.384425 [info ] [Thread-4 (]: 3 of 3 START sql view model dbt_milan.my_second_dbt_model ...................... [RUN]
[0m14:22:29.385331 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.coffee_shop.my_second_dbt_model'
[0m14:22:29.385640 [debug] [Thread-4 (]: Began compiling node model.coffee_shop.my_second_dbt_model
[0m14:22:29.388933 [debug] [Thread-4 (]: Writing injected SQL for node "model.coffee_shop.my_second_dbt_model"
[0m14:22:29.389891 [debug] [Thread-4 (]: Timing info for model.coffee_shop.my_second_dbt_model (compile): 2023-02-17 14:22:29.385826 => 2023-02-17 14:22:29.389771
[0m14:22:29.390376 [debug] [Thread-4 (]: Began executing node model.coffee_shop.my_second_dbt_model
[0m14:22:29.420641 [debug] [Thread-4 (]: Writing runtime sql for node "model.coffee_shop.my_second_dbt_model"
[0m14:22:29.422985 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:22:29.423534 [debug] [Thread-4 (]: On model.coffee_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.my_second_dbt_model"} */


  create or replace view `aec-students`.`dbt_milan`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `aec-students`.`dbt_milan`.`my_first_dbt_model`
where id = 1;


[0m14:22:29.798194 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:718e437c-d621-43d2-b33a-e558ca1757dc&page=queryresults
[0m14:22:29.800130 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (execute): 2023-02-17 14:22:26.773078 => 2023-02-17 14:22:29.800066
[0m14:22:29.800896 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a77c8c04-517f-463b-836a-6d5faa265115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d4bfe4e50>]}
[0m14:22:29.801411 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dbt_milan.customers .......................... [[32mCREATE TABLE (9.0k rows, 12.8 MB processed)[0m in 3.10s]
[0m14:22:29.802150 [debug] [Thread-1 (]: Finished running node model.coffee_shop.customers
[0m14:22:30.226935 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:43ed5ab1-ab39-474a-80ce-e91319209bef&page=queryresults
[0m14:22:30.229004 [debug] [Thread-4 (]: Timing info for model.coffee_shop.my_second_dbt_model (execute): 2023-02-17 14:22:29.390647 => 2023-02-17 14:22:30.228943
[0m14:22:30.229779 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a77c8c04-517f-463b-836a-6d5faa265115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d50573b50>]}
[0m14:22:30.230292 [info ] [Thread-4 (]: 3 of 3 OK created sql view model dbt_milan.my_second_dbt_model ................. [[32mCREATE VIEW (0 processed)[0m in 0.84s]
[0m14:22:30.230771 [debug] [Thread-4 (]: Finished running node model.coffee_shop.my_second_dbt_model
[0m14:22:30.232972 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:22:30.233789 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:22:30.234267 [debug] [MainThread]: Connection 'model.coffee_shop.customers' was properly closed.
[0m14:22:30.234677 [debug] [MainThread]: Connection 'model.coffee_shop.my_first_dbt_model' was properly closed.
[0m14:22:30.235058 [debug] [MainThread]: Connection 'model.coffee_shop.my_second_dbt_model' was properly closed.
[0m14:22:30.235603 [info ] [MainThread]: 
[0m14:22:30.236585 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 5.02 seconds (5.02s).
[0m14:22:30.237949 [debug] [MainThread]: Command end result
[0m14:22:30.252287 [info ] [MainThread]: 
[0m14:22:30.253297 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:22:30.254143 [info ] [MainThread]: 
[0m14:22:30.259138 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m14:22:30.259971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d504e39a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d504e3af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d504e3970>]}
[0m14:22:30.260379 [debug] [MainThread]: Flushing usage events


============================== 2023-02-17 14:29:49.912165 | 135f21ac-d10e-4c2b-b917-0e530633c020 ==============================
[0m14:29:49.912165 [info ] [MainThread]: Running with dbt=1.4.1
[0m14:29:49.914784 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:29:49.915164 [debug] [MainThread]: Tracking: tracking
[0m14:29:49.920681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00cf25f4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00cf25c580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00cf25f5b0>]}
[0m14:29:49.973358 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m14:29:49.974308 [debug] [MainThread]: Partial parsing: updated file: coffee_shop://models/customers.sql
[0m14:29:49.974998 [debug] [MainThread]: Partial parsing: updated file: coffee_shop://models/customers_ref.sql
[0m14:29:49.993843 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
[0m14:29:50.006752 [debug] [MainThread]: 1699: static parser successfully parsed customers_ref.sql
[0m14:29:50.013596 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffe_shop_milan.example
[0m14:29:50.019373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '135f21ac-d10e-4c2b-b917-0e530633c020', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00cec880d0>]}
[0m14:29:50.027829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '135f21ac-d10e-4c2b-b917-0e530633c020', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00cf1e77c0>]}
[0m14:29:50.028445 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 334 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m14:29:50.028916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '135f21ac-d10e-4c2b-b917-0e530633c020', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00cf1d56c0>]}
[0m14:29:50.030462 [info ] [MainThread]: 
[0m14:29:50.032639 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:29:50.034498 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m14:29:50.035125 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:29:51.213456 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_milan'
[0m14:29:51.214023 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:29:51.523977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '135f21ac-d10e-4c2b-b917-0e530633c020', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00cf1e7dc0>]}
[0m14:29:51.524760 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m14:29:51.525360 [info ] [MainThread]: 
[0m14:29:51.530147 [debug] [Thread-1 (]: Began running node model.coffee_shop.customers
[0m14:29:51.530465 [debug] [Thread-2 (]: Began running node model.coffee_shop.my_first_dbt_model
[0m14:29:51.530950 [info ] [Thread-1 (]: 1 of 4 START sql view model dbt_milan.customers ................................ [RUN]
[0m14:29:51.532582 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop.customers'
[0m14:29:51.533107 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.customers
[0m14:29:51.531361 [info ] [Thread-2 (]: 2 of 4 START sql table model dbt_milan.my_first_dbt_model ...................... [RUN]
[0m14:29:51.592563 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.coffee_shop.my_first_dbt_model'
[0m14:29:51.594296 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.customers"
[0m14:29:51.594594 [debug] [Thread-2 (]: Began compiling node model.coffee_shop.my_first_dbt_model
[0m14:29:51.598866 [debug] [Thread-2 (]: Writing injected SQL for node "model.coffee_shop.my_first_dbt_model"
[0m14:29:51.599174 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (compile): 2023-02-17 14:29:51.533415 => 2023-02-17 14:29:51.599104
[0m14:29:51.600289 [debug] [Thread-1 (]: Began executing node model.coffee_shop.customers
[0m14:29:51.600533 [debug] [Thread-2 (]: Timing info for model.coffee_shop.my_first_dbt_model (compile): 2023-02-17 14:29:51.595044 => 2023-02-17 14:29:51.600479
[0m14:29:51.621717 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (execute): 2023-02-17 14:29:51.600726 => 2023-02-17 14:29:51.621629
[0m14:29:51.622214 [debug] [Thread-2 (]: Began executing node model.coffee_shop.my_first_dbt_model
[0m14:29:51.636955 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:29:51.637686 [debug] [Thread-1 (]: Compilation Error in model customers (models/customers.sql)
  Trying to create view `aec-students`.`dbt_milan`.`customers`, but it currently exists as a table. Either drop `aec-students`.`dbt_milan`.`customers` manually, or run dbt with `--full-refresh` and dbt will drop it for you.
  
  > in macro bigquery__handle_existing_table (macros/materializations/view.sql)
  > called by macro handle_existing_table (macros/materializations/models/view/helpers.sql)
  > called by macro create_or_replace_view (macros/materializations/models/view/create_or_replace_view.sql)
  > called by macro materialization_view_bigquery (macros/materializations/view.sql)
  > called by model customers (models/customers.sql)
[0m14:29:51.642358 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '135f21ac-d10e-4c2b-b917-0e530633c020', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00cf15a800>]}
[0m14:29:51.643219 [error] [Thread-1 (]: 1 of 4 ERROR creating sql view model dbt_milan.customers ....................... [[31mERROR[0m in 0.11s]
[0m14:29:51.646381 [debug] [Thread-1 (]: Finished running node model.coffee_shop.customers
[0m14:29:51.648328 [debug] [Thread-4 (]: Began running node model.coffee_shop.customers_ref
[0m14:29:51.648968 [info ] [Thread-4 (]: 3 of 4 SKIP relation dbt_milan.customers_ref ................................... [[33mSKIP[0m]
[0m14:29:51.649799 [debug] [Thread-4 (]: Finished running node model.coffee_shop.customers_ref
[0m14:29:51.967537 [debug] [Thread-2 (]: Writing runtime sql for node "model.coffee_shop.my_first_dbt_model"
[0m14:29:51.968629 [debug] [Thread-2 (]: On model.coffee_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.my_first_dbt_model"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`my_first_dbt_model`
    
    
    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m14:29:54.197894 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:8aac5d81-ca85-4645-8dd4-6bb894a135c6&page=queryresults
[0m14:29:54.215924 [debug] [Thread-2 (]: Timing info for model.coffee_shop.my_first_dbt_model (execute): 2023-02-17 14:29:51.623164 => 2023-02-17 14:29:54.215859
[0m14:29:54.216731 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '135f21ac-d10e-4c2b-b917-0e530633c020', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00cf43e1d0>]}
[0m14:29:54.217253 [info ] [Thread-2 (]: 2 of 4 OK created sql table model dbt_milan.my_first_dbt_model ................. [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 2.62s]
[0m14:29:54.217746 [debug] [Thread-2 (]: Finished running node model.coffee_shop.my_first_dbt_model
[0m14:29:54.218700 [debug] [Thread-6 (]: Began running node model.coffee_shop.my_second_dbt_model
[0m14:29:54.219118 [info ] [Thread-6 (]: 4 of 4 START sql view model dbt_milan.my_second_dbt_model ...................... [RUN]
[0m14:29:54.220216 [debug] [Thread-6 (]: Acquiring new bigquery connection 'model.coffee_shop.my_second_dbt_model'
[0m14:29:54.220514 [debug] [Thread-6 (]: Began compiling node model.coffee_shop.my_second_dbt_model
[0m14:29:54.223696 [debug] [Thread-6 (]: Writing injected SQL for node "model.coffee_shop.my_second_dbt_model"
[0m14:29:54.224365 [debug] [Thread-6 (]: Timing info for model.coffee_shop.my_second_dbt_model (compile): 2023-02-17 14:29:54.220701 => 2023-02-17 14:29:54.224272
[0m14:29:54.224719 [debug] [Thread-6 (]: Began executing node model.coffee_shop.my_second_dbt_model
[0m14:29:54.237728 [debug] [Thread-6 (]: Writing runtime sql for node "model.coffee_shop.my_second_dbt_model"
[0m14:29:54.238497 [debug] [Thread-6 (]: Opening a new connection, currently in state init
[0m14:29:54.239019 [debug] [Thread-6 (]: On model.coffee_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.my_second_dbt_model"} */


  create or replace view `aec-students`.`dbt_milan`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `aec-students`.`dbt_milan`.`my_first_dbt_model`
where id = 1;


[0m14:29:55.083007 [debug] [Thread-6 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:f7a2fad2-2e8d-452e-8c87-1f28e5576073&page=queryresults
[0m14:29:55.085097 [debug] [Thread-6 (]: Timing info for model.coffee_shop.my_second_dbt_model (execute): 2023-02-17 14:29:54.224911 => 2023-02-17 14:29:55.085034
[0m14:29:55.085887 [debug] [Thread-6 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '135f21ac-d10e-4c2b-b917-0e530633c020', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00cebb3640>]}
[0m14:29:55.086402 [info ] [Thread-6 (]: 4 of 4 OK created sql view model dbt_milan.my_second_dbt_model ................. [[32mCREATE VIEW (0 processed)[0m in 0.87s]
[0m14:29:55.086873 [debug] [Thread-6 (]: Finished running node model.coffee_shop.my_second_dbt_model
[0m14:29:55.088706 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:29:55.089270 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:29:55.089494 [debug] [MainThread]: Connection 'model.coffee_shop.my_first_dbt_model' was properly closed.
[0m14:29:55.089676 [debug] [MainThread]: Connection 'model.coffee_shop.customers' was properly closed.
[0m14:29:55.089834 [debug] [MainThread]: Connection 'model.coffee_shop.my_second_dbt_model' was properly closed.
[0m14:29:55.090058 [info ] [MainThread]: 
[0m14:29:55.090395 [info ] [MainThread]: Finished running 3 view models, 1 table model in 0 hours 0 minutes and 5.06 seconds (5.06s).
[0m14:29:55.090888 [debug] [MainThread]: Command end result
[0m14:29:55.099897 [info ] [MainThread]: 
[0m14:29:55.100446 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:29:55.100850 [info ] [MainThread]: 
[0m14:29:55.101285 [error] [MainThread]: [33mCompilation Error in model customers (models/customers.sql)[0m
[0m14:29:55.101966 [error] [MainThread]:   Trying to create view `aec-students`.`dbt_milan`.`customers`, but it currently exists as a table. Either drop `aec-students`.`dbt_milan`.`customers` manually, or run dbt with `--full-refresh` and dbt will drop it for you.
[0m14:29:55.102347 [error] [MainThread]:   
[0m14:29:55.102732 [error] [MainThread]:   > in macro bigquery__handle_existing_table (macros/materializations/view.sql)
[0m14:29:55.103151 [error] [MainThread]:   > called by macro handle_existing_table (macros/materializations/models/view/helpers.sql)
[0m14:29:55.103654 [error] [MainThread]:   > called by macro create_or_replace_view (macros/materializations/models/view/create_or_replace_view.sql)
[0m14:29:55.104008 [error] [MainThread]:   > called by macro materialization_view_bigquery (macros/materializations/view.sql)
[0m14:29:55.104374 [error] [MainThread]:   > called by model customers (models/customers.sql)
[0m14:29:55.104808 [info ] [MainThread]: 
[0m14:29:55.105236 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=1 TOTAL=4
[0m14:29:55.105810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00cf1e78b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00cf1e7f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00cf23fa30>]}
[0m14:29:55.106258 [debug] [MainThread]: Flushing usage events


============================== 2023-02-17 14:30:56.306494 | deb1f638-5ef6-40c1-ae86-21ed27cf0cee ==============================
[0m14:30:56.306494 [info ] [MainThread]: Running with dbt=1.4.1
[0m14:30:56.310232 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:30:56.311656 [debug] [MainThread]: Tracking: tracking
[0m14:30:56.313777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd27106b700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd271069960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd27106b730>]}
[0m14:30:56.372732 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:30:56.373384 [debug] [MainThread]: Partial parsing: updated file: coffee_shop://models/customers.sql
[0m14:30:56.387818 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
[0m14:30:56.404532 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffe_shop_milan.example
[0m14:30:56.410447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'deb1f638-5ef6-40c1-ae86-21ed27cf0cee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd270a8e380>]}
[0m14:30:56.417994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'deb1f638-5ef6-40c1-ae86-21ed27cf0cee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd270feffa0>]}
[0m14:30:56.418579 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 334 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m14:30:56.419073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'deb1f638-5ef6-40c1-ae86-21ed27cf0cee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd270fdd390>]}
[0m14:30:56.420580 [info ] [MainThread]: 
[0m14:30:56.423067 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:30:56.424586 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m14:30:56.425125 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:30:57.652402 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_milan'
[0m14:30:57.653037 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:30:57.925357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'deb1f638-5ef6-40c1-ae86-21ed27cf0cee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd270fefd90>]}
[0m14:30:57.926146 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m14:30:57.926750 [info ] [MainThread]: 
[0m14:30:57.932610 [debug] [Thread-1 (]: Began running node model.coffee_shop.customers
[0m14:30:57.933360 [debug] [Thread-2 (]: Began running node model.coffee_shop.my_first_dbt_model
[0m14:30:57.934084 [info ] [Thread-1 (]: 1 of 4 START sql table model dbt_milan.customers ............................... [RUN]
[0m14:30:57.935700 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop.customers'
[0m14:30:57.936116 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.customers
[0m14:30:57.934571 [info ] [Thread-2 (]: 2 of 4 START sql table model dbt_milan.my_first_dbt_model ...................... [RUN]
[0m14:30:57.993878 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.customers"
[0m14:30:57.995494 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.coffee_shop.my_first_dbt_model'
[0m14:30:57.996216 [debug] [Thread-2 (]: Began compiling node model.coffee_shop.my_first_dbt_model
[0m14:30:57.999248 [debug] [Thread-2 (]: Writing injected SQL for node "model.coffee_shop.my_first_dbt_model"
[0m14:30:57.999812 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (compile): 2023-02-17 14:30:57.936415 => 2023-02-17 14:30:57.999714
[0m14:30:58.000254 [debug] [Thread-1 (]: Began executing node model.coffee_shop.customers
[0m14:30:58.005855 [debug] [Thread-2 (]: Timing info for model.coffee_shop.my_first_dbt_model (compile): 2023-02-17 14:30:57.996439 => 2023-02-17 14:30:58.005767
[0m14:30:58.015526 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:30:58.016027 [debug] [Thread-2 (]: Began executing node model.coffee_shop.my_first_dbt_model
[0m14:30:58.019883 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:30:58.415916 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop.customers"
[0m14:30:58.417559 [debug] [Thread-2 (]: Writing runtime sql for node "model.coffee_shop.my_first_dbt_model"
[0m14:30:58.418612 [debug] [Thread-2 (]: On model.coffee_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.my_first_dbt_model"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`my_first_dbt_model`
    
    
    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m14:30:58.419046 [debug] [Thread-1 (]: On model.coffee_shop.customers: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.customers"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`customers`
    
    
    OPTIONS()
    as (
      

Select * 
from customers
limit 9000
    );
  
[0m14:30:58.635006 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Table "customers" must be qualified with a dataset (e.g. dataset.table).')
[0m14:30:58.957716 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:5fbf3b95-e31b-427d-8e0b-7ee10e544c0b&page=queryresults
[0m14:30:58.958473 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (execute): 2023-02-17 14:30:58.000492 => 2023-02-17 14:30:58.958362
[0m14:30:58.961431 [debug] [Thread-1 (]: Database Error in model customers (models/customers.sql)
  Table "customers" must be qualified with a dataset (e.g. dataset.table).
  compiled Code at target/run/coffee_shop/models/customers.sql
[0m14:30:58.961909 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'deb1f638-5ef6-40c1-ae86-21ed27cf0cee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd270a8c550>]}
[0m14:30:58.962417 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model dbt_milan.customers ...................... [[31mERROR[0m in 1.03s]
[0m14:30:58.964295 [debug] [Thread-1 (]: Finished running node model.coffee_shop.customers
[0m14:30:58.965758 [debug] [Thread-4 (]: Began running node model.coffee_shop.customers_ref
[0m14:30:58.966285 [info ] [Thread-4 (]: 3 of 4 SKIP relation dbt_milan.customers_ref ................................... [[33mSKIP[0m]
[0m14:30:58.966751 [debug] [Thread-4 (]: Finished running node model.coffee_shop.customers_ref
[0m14:31:00.627066 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:60892a4c-c920-4efd-b4a1-2060a4a5b703&page=queryresults
[0m14:31:00.653557 [debug] [Thread-2 (]: Timing info for model.coffee_shop.my_first_dbt_model (execute): 2023-02-17 14:30:58.017876 => 2023-02-17 14:31:00.653471
[0m14:31:00.654801 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'deb1f638-5ef6-40c1-ae86-21ed27cf0cee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd271246d40>]}
[0m14:31:00.655665 [info ] [Thread-2 (]: 2 of 4 OK created sql table model dbt_milan.my_first_dbt_model ................. [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 2.66s]
[0m14:31:00.656327 [debug] [Thread-2 (]: Finished running node model.coffee_shop.my_first_dbt_model
[0m14:31:00.657355 [debug] [Thread-6 (]: Began running node model.coffee_shop.my_second_dbt_model
[0m14:31:00.658155 [info ] [Thread-6 (]: 4 of 4 START sql view model dbt_milan.my_second_dbt_model ...................... [RUN]
[0m14:31:00.658954 [debug] [Thread-6 (]: Acquiring new bigquery connection 'model.coffee_shop.my_second_dbt_model'
[0m14:31:00.659229 [debug] [Thread-6 (]: Began compiling node model.coffee_shop.my_second_dbt_model
[0m14:31:00.662429 [debug] [Thread-6 (]: Writing injected SQL for node "model.coffee_shop.my_second_dbt_model"
[0m14:31:00.663053 [debug] [Thread-6 (]: Timing info for model.coffee_shop.my_second_dbt_model (compile): 2023-02-17 14:31:00.659400 => 2023-02-17 14:31:00.662967
[0m14:31:00.663467 [debug] [Thread-6 (]: Began executing node model.coffee_shop.my_second_dbt_model
[0m14:31:00.686007 [debug] [Thread-6 (]: Writing runtime sql for node "model.coffee_shop.my_second_dbt_model"
[0m14:31:00.686748 [debug] [Thread-6 (]: Opening a new connection, currently in state init
[0m14:31:00.687235 [debug] [Thread-6 (]: On model.coffee_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.my_second_dbt_model"} */


  create or replace view `aec-students`.`dbt_milan`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `aec-students`.`dbt_milan`.`my_first_dbt_model`
where id = 1;


[0m14:31:01.481744 [debug] [Thread-6 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:5714f308-47ab-4179-b434-7ea2708d8050&page=queryresults
[0m14:31:01.484043 [debug] [Thread-6 (]: Timing info for model.coffee_shop.my_second_dbt_model (execute): 2023-02-17 14:31:00.663725 => 2023-02-17 14:31:01.483982
[0m14:31:01.484896 [debug] [Thread-6 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'deb1f638-5ef6-40c1-ae86-21ed27cf0cee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd270b252d0>]}
[0m14:31:01.485452 [info ] [Thread-6 (]: 4 of 4 OK created sql view model dbt_milan.my_second_dbt_model ................. [[32mCREATE VIEW (0 processed)[0m in 0.83s]
[0m14:31:01.486161 [debug] [Thread-6 (]: Finished running node model.coffee_shop.my_second_dbt_model
[0m14:31:01.488212 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:31:01.488786 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:31:01.489008 [debug] [MainThread]: Connection 'model.coffee_shop.customers' was properly closed.
[0m14:31:01.489181 [debug] [MainThread]: Connection 'model.coffee_shop.my_first_dbt_model' was properly closed.
[0m14:31:01.489336 [debug] [MainThread]: Connection 'model.coffee_shop.my_second_dbt_model' was properly closed.
[0m14:31:01.489565 [info ] [MainThread]: 
[0m14:31:01.489901 [info ] [MainThread]: Finished running 2 table models, 2 view models in 0 hours 0 minutes and 5.07 seconds (5.07s).
[0m14:31:01.490917 [debug] [MainThread]: Command end result
[0m14:31:01.498882 [info ] [MainThread]: 
[0m14:31:01.499586 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:31:01.500095 [info ] [MainThread]: 
[0m14:31:01.500533 [error] [MainThread]: [33mDatabase Error in model customers (models/customers.sql)[0m
[0m14:31:01.501290 [error] [MainThread]:   Table "customers" must be qualified with a dataset (e.g. dataset.table).
[0m14:31:01.501715 [error] [MainThread]:   compiled Code at target/run/coffee_shop/models/customers.sql
[0m14:31:01.502118 [info ] [MainThread]: 
[0m14:31:01.502557 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=1 TOTAL=4
[0m14:31:01.503710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd270a4d0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd270a4d180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd270a4d1b0>]}
[0m14:31:01.504294 [debug] [MainThread]: Flushing usage events


============================== 2023-02-17 14:32:24.067823 | 20641465-9d80-4ad6-bfe8-75ec5ddac769 ==============================
[0m14:32:24.067823 [info ] [MainThread]: Running with dbt=1.4.1
[0m14:32:24.070427 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:32:24.070767 [debug] [MainThread]: Tracking: tracking
[0m14:32:24.073018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b38a675e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b38a671f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b38a67640>]}
[0m14:32:24.124236 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:32:24.124830 [debug] [MainThread]: Partial parsing: updated file: coffee_shop://models/customers.sql
[0m14:32:24.142858 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
[0m14:32:24.164285 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffe_shop_milan.example
[0m14:32:24.170107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '20641465-9d80-4ad6-bfe8-75ec5ddac769', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3848e590>]}
[0m14:32:24.177140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '20641465-9d80-4ad6-bfe8-75ec5ddac769', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b389eff70>]}
[0m14:32:24.177671 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 334 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m14:32:24.178044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20641465-9d80-4ad6-bfe8-75ec5ddac769', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b389dd5a0>]}
[0m14:32:24.179536 [info ] [MainThread]: 
[0m14:32:24.182195 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:32:24.184536 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m14:32:24.185014 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:32:25.419482 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_milan'
[0m14:32:25.420067 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:32:25.744854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20641465-9d80-4ad6-bfe8-75ec5ddac769', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b389effd0>]}
[0m14:32:25.746089 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m14:32:25.746984 [info ] [MainThread]: 
[0m14:32:25.755361 [debug] [Thread-1 (]: Began running node model.coffee_shop.customers
[0m14:32:25.755772 [debug] [Thread-2 (]: Began running node model.coffee_shop.my_first_dbt_model
[0m14:32:25.756571 [info ] [Thread-1 (]: 1 of 4 START sql table model dbt_milan.customers ............................... [RUN]
[0m14:32:25.757777 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop.customers'
[0m14:32:25.758104 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.customers
[0m14:32:25.756974 [info ] [Thread-2 (]: 2 of 4 START sql table model dbt_milan.my_first_dbt_model ...................... [RUN]
[0m14:32:25.810363 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.customers"
[0m14:32:25.811240 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.coffee_shop.my_first_dbt_model'
[0m14:32:25.811969 [debug] [Thread-2 (]: Began compiling node model.coffee_shop.my_first_dbt_model
[0m14:32:25.812258 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (compile): 2023-02-17 14:32:25.758561 => 2023-02-17 14:32:25.812178
[0m14:32:25.814975 [debug] [Thread-2 (]: Writing injected SQL for node "model.coffee_shop.my_first_dbt_model"
[0m14:32:25.815512 [debug] [Thread-1 (]: Began executing node model.coffee_shop.customers
[0m14:32:25.831467 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:32:25.844774 [debug] [Thread-2 (]: Timing info for model.coffee_shop.my_first_dbt_model (compile): 2023-02-17 14:32:25.812538 => 2023-02-17 14:32:25.844635
[0m14:32:25.846998 [debug] [Thread-2 (]: Began executing node model.coffee_shop.my_first_dbt_model
[0m14:32:25.850896 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:32:26.242027 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop.customers"
[0m14:32:26.243669 [debug] [Thread-1 (]: On model.coffee_shop.customers: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.customers"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`customers`
    
    
    OPTIONS()
    as (
      

select * from `analytics-engineers-club.coffee_shop.customers`
Some bad SQL
limit 9000;
    );
  
[0m14:32:26.245408 [debug] [Thread-2 (]: Writing runtime sql for node "model.coffee_shop.my_first_dbt_model"
[0m14:32:26.246595 [debug] [Thread-2 (]: On model.coffee_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.my_first_dbt_model"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`my_first_dbt_model`
    
    
    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m14:32:26.450115 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got keyword SOME at [14:1]')
[0m14:32:27.615992 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:992ad81f-6e17-493b-9782-a712813cc2f9&page=queryresults
[0m14:32:27.616967 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (execute): 2023-02-17 14:32:25.815958 => 2023-02-17 14:32:27.616857
[0m14:32:27.620004 [debug] [Thread-1 (]: Database Error in model customers (models/customers.sql)
  Syntax error: Expected ")" but got keyword SOME at [14:1]
  compiled Code at target/run/coffee_shop/models/customers.sql
[0m14:32:27.620479 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20641465-9d80-4ad6-bfe8-75ec5ddac769', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3848c5e0>]}
[0m14:32:27.621106 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model dbt_milan.customers ...................... [[31mERROR[0m in 1.86s]
[0m14:32:27.622897 [debug] [Thread-1 (]: Finished running node model.coffee_shop.customers
[0m14:32:27.623801 [debug] [Thread-4 (]: Began running node model.coffee_shop.customers_ref
[0m14:32:27.624165 [info ] [Thread-4 (]: 3 of 4 SKIP relation dbt_milan.customers_ref ................................... [[33mSKIP[0m]
[0m14:32:27.624574 [debug] [Thread-4 (]: Finished running node model.coffee_shop.customers_ref
[0m14:32:28.442319 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:518e76e1-5fd8-4a1e-8e45-8191416a02f0&page=queryresults
[0m14:32:28.464175 [debug] [Thread-2 (]: Timing info for model.coffee_shop.my_first_dbt_model (execute): 2023-02-17 14:32:25.847861 => 2023-02-17 14:32:28.464109
[0m14:32:28.465054 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20641465-9d80-4ad6-bfe8-75ec5ddac769', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b38c46fe0>]}
[0m14:32:28.465654 [info ] [Thread-2 (]: 2 of 4 OK created sql table model dbt_milan.my_first_dbt_model ................. [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 2.65s]
[0m14:32:28.466220 [debug] [Thread-2 (]: Finished running node model.coffee_shop.my_first_dbt_model
[0m14:32:28.467182 [debug] [Thread-6 (]: Began running node model.coffee_shop.my_second_dbt_model
[0m14:32:28.467626 [info ] [Thread-6 (]: 4 of 4 START sql view model dbt_milan.my_second_dbt_model ...................... [RUN]
[0m14:32:28.468766 [debug] [Thread-6 (]: Acquiring new bigquery connection 'model.coffee_shop.my_second_dbt_model'
[0m14:32:28.469045 [debug] [Thread-6 (]: Began compiling node model.coffee_shop.my_second_dbt_model
[0m14:32:28.472352 [debug] [Thread-6 (]: Writing injected SQL for node "model.coffee_shop.my_second_dbt_model"
[0m14:32:28.472975 [debug] [Thread-6 (]: Timing info for model.coffee_shop.my_second_dbt_model (compile): 2023-02-17 14:32:28.469213 => 2023-02-17 14:32:28.472891
[0m14:32:28.473376 [debug] [Thread-6 (]: Began executing node model.coffee_shop.my_second_dbt_model
[0m14:32:28.495150 [debug] [Thread-6 (]: Writing runtime sql for node "model.coffee_shop.my_second_dbt_model"
[0m14:32:28.495881 [debug] [Thread-6 (]: Opening a new connection, currently in state init
[0m14:32:28.496357 [debug] [Thread-6 (]: On model.coffee_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.my_second_dbt_model"} */


  create or replace view `aec-students`.`dbt_milan`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `aec-students`.`dbt_milan`.`my_first_dbt_model`
where id = 1;


[0m14:32:29.522558 [debug] [Thread-6 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:141730dc-c4ea-4011-941c-3d0dce8dd7c4&page=queryresults
[0m14:32:29.524978 [debug] [Thread-6 (]: Timing info for model.coffee_shop.my_second_dbt_model (execute): 2023-02-17 14:32:28.473625 => 2023-02-17 14:32:29.524914
[0m14:32:29.525845 [debug] [Thread-6 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20641465-9d80-4ad6-bfe8-75ec5ddac769', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b385255d0>]}
[0m14:32:29.526418 [info ] [Thread-6 (]: 4 of 4 OK created sql view model dbt_milan.my_second_dbt_model ................. [[32mCREATE VIEW (0 processed)[0m in 1.06s]
[0m14:32:29.526983 [debug] [Thread-6 (]: Finished running node model.coffee_shop.my_second_dbt_model
[0m14:32:29.528845 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:32:29.529430 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:32:29.529657 [debug] [MainThread]: Connection 'model.coffee_shop.my_first_dbt_model' was properly closed.
[0m14:32:29.529874 [debug] [MainThread]: Connection 'model.coffee_shop.customers' was properly closed.
[0m14:32:29.530074 [debug] [MainThread]: Connection 'model.coffee_shop.my_second_dbt_model' was properly closed.
[0m14:32:29.530357 [info ] [MainThread]: 
[0m14:32:29.530699 [info ] [MainThread]: Finished running 2 table models, 2 view models in 0 hours 0 minutes and 5.35 seconds (5.35s).
[0m14:32:29.531819 [debug] [MainThread]: Command end result
[0m14:32:29.541901 [info ] [MainThread]: 
[0m14:32:29.543112 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:32:29.544713 [info ] [MainThread]: 
[0m14:32:29.546226 [error] [MainThread]: [33mDatabase Error in model customers (models/customers.sql)[0m
[0m14:32:29.547196 [error] [MainThread]:   Syntax error: Expected ")" but got keyword SOME at [14:1]
[0m14:32:29.548962 [error] [MainThread]:   compiled Code at target/run/coffee_shop/models/customers.sql
[0m14:32:29.550492 [info ] [MainThread]: 
[0m14:32:29.553168 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=1 TOTAL=4
[0m14:32:29.555009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3848dae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3848d480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3848d420>]}
[0m14:32:29.555590 [debug] [MainThread]: Flushing usage events


============================== 2023-02-17 14:33:09.889188 | 82f07e63-de4d-4a2b-9a79-f3e7807cc72f ==============================
[0m14:33:09.889188 [info ] [MainThread]: Running with dbt=1.4.1
[0m14:33:09.891845 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:33:09.892222 [debug] [MainThread]: Tracking: tracking
[0m14:33:09.894361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f598325b2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f598325a0e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59832587f0>]}
[0m14:33:09.950103 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:33:09.951053 [debug] [MainThread]: Partial parsing: updated file: coffee_shop://models/customers.sql
[0m14:33:09.975963 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
[0m14:33:10.000771 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffe_shop_milan.example
[0m14:33:10.008698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '82f07e63-de4d-4a2b-9a79-f3e7807cc72f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5982c79cf0>]}
[0m14:33:10.016400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '82f07e63-de4d-4a2b-9a79-f3e7807cc72f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59831e3fd0>]}
[0m14:33:10.016842 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 334 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m14:33:10.017240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82f07e63-de4d-4a2b-9a79-f3e7807cc72f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5986b2efe0>]}
[0m14:33:10.018694 [info ] [MainThread]: 
[0m14:33:10.020769 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:33:10.022273 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m14:33:10.022803 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:33:11.179072 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_milan'
[0m14:33:11.179792 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:33:11.482083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82f07e63-de4d-4a2b-9a79-f3e7807cc72f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f598325ba60>]}
[0m14:33:11.482874 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m14:33:11.483514 [info ] [MainThread]: 
[0m14:33:11.489927 [debug] [Thread-1 (]: Began running node model.coffee_shop.customers
[0m14:33:11.490619 [debug] [Thread-2 (]: Began running node model.coffee_shop.my_first_dbt_model
[0m14:33:11.491068 [info ] [Thread-1 (]: 1 of 4 START sql table model dbt_milan.customers ............................... [RUN]
[0m14:33:11.491749 [info ] [Thread-2 (]: 2 of 4 START sql table model dbt_milan.my_first_dbt_model ...................... [RUN]
[0m14:33:11.492809 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop.customers'
[0m14:33:11.493563 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.coffee_shop.my_first_dbt_model'
[0m14:33:11.493904 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.customers
[0m14:33:11.494188 [debug] [Thread-2 (]: Began compiling node model.coffee_shop.my_first_dbt_model
[0m14:33:11.549197 [debug] [Thread-2 (]: Writing injected SQL for node "model.coffee_shop.my_first_dbt_model"
[0m14:33:11.556228 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.customers"
[0m14:33:11.556985 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (compile): 2023-02-17 14:33:11.494405 => 2023-02-17 14:33:11.556879
[0m14:33:11.557342 [debug] [Thread-2 (]: Timing info for model.coffee_shop.my_first_dbt_model (compile): 2023-02-17 14:33:11.546672 => 2023-02-17 14:33:11.557281
[0m14:33:11.557618 [debug] [Thread-1 (]: Began executing node model.coffee_shop.customers
[0m14:33:11.557887 [debug] [Thread-2 (]: Began executing node model.coffee_shop.my_first_dbt_model
[0m14:33:11.573211 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:33:11.575297 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:33:12.024952 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop.customers"
[0m14:33:12.026916 [debug] [Thread-2 (]: Writing runtime sql for node "model.coffee_shop.my_first_dbt_model"
[0m14:33:12.028020 [debug] [Thread-1 (]: On model.coffee_shop.customers: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.customers"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`customers`
    
    
    OPTIONS()
    as (
      

select * from `analytics-engineers-club.coffee_shop.customers`
limit 9000;
    );
  
[0m14:33:12.028468 [debug] [Thread-2 (]: On model.coffee_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.my_first_dbt_model"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`my_first_dbt_model`
    
    
    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m14:33:12.218380 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got ";" at [14:11]')
[0m14:33:13.112558 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:05e928b6-d610-48ee-b581-53d12d8176d0&page=queryresults
[0m14:33:13.113564 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (execute): 2023-02-17 14:33:11.558094 => 2023-02-17 14:33:13.113434
[0m14:33:13.117704 [debug] [Thread-1 (]: Database Error in model customers (models/customers.sql)
  Syntax error: Expected ")" but got ";" at [14:11]
  compiled Code at target/run/coffee_shop/models/customers.sql
[0m14:33:13.119070 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82f07e63-de4d-4a2b-9a79-f3e7807cc72f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f598343e950>]}
[0m14:33:13.119733 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model dbt_milan.customers ...................... [[31mERROR[0m in 1.63s]
[0m14:33:13.121550 [debug] [Thread-1 (]: Finished running node model.coffee_shop.customers
[0m14:33:13.127045 [debug] [Thread-4 (]: Began running node model.coffee_shop.customers_ref
[0m14:33:13.127754 [info ] [Thread-4 (]: 3 of 4 SKIP relation dbt_milan.customers_ref ................................... [[33mSKIP[0m]
[0m14:33:13.129023 [debug] [Thread-4 (]: Finished running node model.coffee_shop.customers_ref
[0m14:33:14.230061 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:6377df8f-d39d-4e23-a438-9ae98d4bb310&page=queryresults
[0m14:33:14.255150 [debug] [Thread-2 (]: Timing info for model.coffee_shop.my_first_dbt_model (execute): 2023-02-17 14:33:11.573535 => 2023-02-17 14:33:14.255036
[0m14:33:14.256161 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82f07e63-de4d-4a2b-9a79-f3e7807cc72f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f598343e590>]}
[0m14:33:14.256748 [info ] [Thread-2 (]: 2 of 4 OK created sql table model dbt_milan.my_first_dbt_model ................. [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 2.76s]
[0m14:33:14.257406 [debug] [Thread-2 (]: Finished running node model.coffee_shop.my_first_dbt_model
[0m14:33:14.258306 [debug] [Thread-6 (]: Began running node model.coffee_shop.my_second_dbt_model
[0m14:33:14.258959 [info ] [Thread-6 (]: 4 of 4 START sql view model dbt_milan.my_second_dbt_model ...................... [RUN]
[0m14:33:14.259850 [debug] [Thread-6 (]: Acquiring new bigquery connection 'model.coffee_shop.my_second_dbt_model'
[0m14:33:14.260139 [debug] [Thread-6 (]: Began compiling node model.coffee_shop.my_second_dbt_model
[0m14:33:14.263272 [debug] [Thread-6 (]: Writing injected SQL for node "model.coffee_shop.my_second_dbt_model"
[0m14:33:14.263845 [debug] [Thread-6 (]: Timing info for model.coffee_shop.my_second_dbt_model (compile): 2023-02-17 14:33:14.260388 => 2023-02-17 14:33:14.263759
[0m14:33:14.264188 [debug] [Thread-6 (]: Began executing node model.coffee_shop.my_second_dbt_model
[0m14:33:14.286018 [debug] [Thread-6 (]: Writing runtime sql for node "model.coffee_shop.my_second_dbt_model"
[0m14:33:14.286654 [debug] [Thread-6 (]: Opening a new connection, currently in state init
[0m14:33:14.287086 [debug] [Thread-6 (]: On model.coffee_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.my_second_dbt_model"} */


  create or replace view `aec-students`.`dbt_milan`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `aec-students`.`dbt_milan`.`my_first_dbt_model`
where id = 1;


[0m14:33:15.039021 [debug] [Thread-6 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:c84ed50e-f851-4774-9f83-9401919f2220&page=queryresults
[0m14:33:15.042210 [debug] [Thread-6 (]: Timing info for model.coffee_shop.my_second_dbt_model (execute): 2023-02-17 14:33:14.264376 => 2023-02-17 14:33:15.042127
[0m14:33:15.043324 [debug] [Thread-6 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82f07e63-de4d-4a2b-9a79-f3e7807cc72f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5982d3dff0>]}
[0m14:33:15.044011 [info ] [Thread-6 (]: 4 of 4 OK created sql view model dbt_milan.my_second_dbt_model ................. [[32mCREATE VIEW (0 processed)[0m in 0.78s]
[0m14:33:15.044833 [debug] [Thread-6 (]: Finished running node model.coffee_shop.my_second_dbt_model
[0m14:33:15.047202 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:33:15.048067 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:33:15.048402 [debug] [MainThread]: Connection 'model.coffee_shop.customers' was properly closed.
[0m14:33:15.048663 [debug] [MainThread]: Connection 'model.coffee_shop.my_first_dbt_model' was properly closed.
[0m14:33:15.048908 [debug] [MainThread]: Connection 'model.coffee_shop.my_second_dbt_model' was properly closed.
[0m14:33:15.049249 [info ] [MainThread]: 
[0m14:33:15.050361 [info ] [MainThread]: Finished running 2 table models, 2 view models in 0 hours 0 minutes and 5.03 seconds (5.03s).
[0m14:33:15.052024 [debug] [MainThread]: Command end result
[0m14:33:15.061142 [info ] [MainThread]: 
[0m14:33:15.061720 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:33:15.062312 [info ] [MainThread]: 
[0m14:33:15.062794 [error] [MainThread]: [33mDatabase Error in model customers (models/customers.sql)[0m
[0m14:33:15.063228 [error] [MainThread]:   Syntax error: Expected ")" but got ";" at [14:11]
[0m14:33:15.063755 [error] [MainThread]:   compiled Code at target/run/coffee_shop/models/customers.sql
[0m14:33:15.064199 [info ] [MainThread]: 
[0m14:33:15.064680 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=1 TOTAL=4
[0m14:33:15.066543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59831d0eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5982d3c8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5982d3d5a0>]}
[0m14:33:15.067004 [debug] [MainThread]: Flushing usage events


============================== 2023-02-17 14:35:08.005804 | acdaff74-c4e8-48e8-ab29-e4177c631e7c ==============================
[0m14:35:08.005804 [info ] [MainThread]: Running with dbt=1.4.1
[0m14:35:08.008455 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:35:08.009065 [debug] [MainThread]: Tracking: tracking
[0m14:35:08.016555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc97f0537f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc97f0528c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc97f053850>]}
[0m14:35:08.070347 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:35:08.071040 [debug] [MainThread]: Partial parsing: updated file: coffee_shop://models/customers.sql
[0m14:35:08.084674 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
[0m14:35:08.102079 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffe_shop_milan.example
[0m14:35:08.108416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'acdaff74-c4e8-48e8-ab29-e4177c631e7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc97ea822c0>]}
[0m14:35:08.116207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'acdaff74-c4e8-48e8-ab29-e4177c631e7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc97efdbf40>]}
[0m14:35:08.116912 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 334 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m14:35:08.117472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'acdaff74-c4e8-48e8-ab29-e4177c631e7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc98292afe0>]}
[0m14:35:08.119402 [info ] [MainThread]: 
[0m14:35:08.122374 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:35:08.124028 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m14:35:08.124542 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:35:09.412393 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_milan'
[0m14:35:09.413308 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:35:09.679700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'acdaff74-c4e8-48e8-ab29-e4177c631e7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc97efdbcd0>]}
[0m14:35:09.680566 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m14:35:09.681176 [info ] [MainThread]: 
[0m14:35:09.687689 [debug] [Thread-1 (]: Began running node model.coffee_shop.customers
[0m14:35:09.688437 [debug] [Thread-2 (]: Began running node model.coffee_shop.my_first_dbt_model
[0m14:35:09.689162 [info ] [Thread-1 (]: 1 of 4 START sql table model dbt_milan.customers ............................... [RUN]
[0m14:35:09.690383 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop.customers'
[0m14:35:09.690676 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.customers
[0m14:35:09.689607 [info ] [Thread-2 (]: 2 of 4 START sql table model dbt_milan.my_first_dbt_model ...................... [RUN]
[0m14:35:09.744065 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.coffee_shop.my_first_dbt_model'
[0m14:35:09.744504 [debug] [Thread-2 (]: Began compiling node model.coffee_shop.my_first_dbt_model
[0m14:35:09.748597 [debug] [Thread-2 (]: Writing injected SQL for node "model.coffee_shop.my_first_dbt_model"
[0m14:35:09.749893 [debug] [Thread-2 (]: Timing info for model.coffee_shop.my_first_dbt_model (compile): 2023-02-17 14:35:09.744760 => 2023-02-17 14:35:09.749790
[0m14:35:09.755565 [debug] [Thread-2 (]: Began executing node model.coffee_shop.my_first_dbt_model
[0m14:35:09.755129 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.customers"
[0m14:35:09.772464 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:35:09.773682 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (compile): 2023-02-17 14:35:09.690856 => 2023-02-17 14:35:09.773597
[0m14:35:09.775163 [debug] [Thread-1 (]: Began executing node model.coffee_shop.customers
[0m14:35:09.777553 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:35:10.185040 [debug] [Thread-2 (]: Writing runtime sql for node "model.coffee_shop.my_first_dbt_model"
[0m14:35:10.187772 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop.customers"
[0m14:35:10.188923 [debug] [Thread-2 (]: On model.coffee_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.my_first_dbt_model"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`my_first_dbt_model`
    
    
    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m14:35:10.189217 [debug] [Thread-1 (]: On model.coffee_shop.customers: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.customers"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`customers`
    
    
    OPTIONS()
    as (
      

select * from `analytics-engineers-club.coffee_shop.customers`
limit 9000
    );
  
[0m14:35:12.721724 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:7cad2d76-b5a6-4cfa-891c-c5a27d0400d4&page=queryresults
[0m14:35:12.750410 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (execute): 2023-02-17 14:35:09.775509 => 2023-02-17 14:35:12.750316
[0m14:35:12.756111 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'acdaff74-c4e8-48e8-ab29-e4177c631e7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc97ea80310>]}
[0m14:35:12.756775 [info ] [Thread-1 (]: 1 of 4 OK created sql table model dbt_milan.customers .......................... [[32mCREATE TABLE (9.0k rows, 12.8 MB processed)[0m in 3.07s]
[0m14:35:12.758582 [debug] [Thread-1 (]: Finished running node model.coffee_shop.customers
[0m14:35:12.759499 [debug] [Thread-4 (]: Began running node model.coffee_shop.customers_ref
[0m14:35:12.759907 [info ] [Thread-4 (]: 3 of 4 START sql view model dbt_milan.customers_ref ............................ [RUN]
[0m14:35:12.760692 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.coffee_shop.customers_ref'
[0m14:35:12.760974 [debug] [Thread-4 (]: Began compiling node model.coffee_shop.customers_ref
[0m14:35:12.764227 [debug] [Thread-4 (]: Writing injected SQL for node "model.coffee_shop.customers_ref"
[0m14:35:12.764730 [debug] [Thread-4 (]: Timing info for model.coffee_shop.customers_ref (compile): 2023-02-17 14:35:12.761141 => 2023-02-17 14:35:12.764656
[0m14:35:12.765034 [debug] [Thread-4 (]: Began executing node model.coffee_shop.customers_ref
[0m14:35:12.784449 [debug] [Thread-4 (]: Writing runtime sql for node "model.coffee_shop.customers_ref"
[0m14:35:12.785007 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:35:12.785367 [debug] [Thread-4 (]: On model.coffee_shop.customers_ref: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.customers_ref"} */


  create or replace view `aec-students`.`dbt_milan`.`customers_ref`
  OPTIONS()
  as Select *
from `aec-students`.`dbt_milan`.`customers`;


[0m14:35:12.957636 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:9c89f432-ef22-45e9-902b-66d35df88634&page=queryresults
[0m14:35:12.960545 [debug] [Thread-2 (]: Timing info for model.coffee_shop.my_first_dbt_model (execute): 2023-02-17 14:35:09.755967 => 2023-02-17 14:35:12.960454
[0m14:35:12.961446 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'acdaff74-c4e8-48e8-ab29-e4177c631e7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc97f232d70>]}
[0m14:35:12.961975 [info ] [Thread-2 (]: 2 of 4 OK created sql table model dbt_milan.my_first_dbt_model ................. [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 3.22s]
[0m14:35:12.962636 [debug] [Thread-2 (]: Finished running node model.coffee_shop.my_first_dbt_model
[0m14:35:12.963256 [debug] [Thread-6 (]: Began running node model.coffee_shop.my_second_dbt_model
[0m14:35:12.963702 [info ] [Thread-6 (]: 4 of 4 START sql view model dbt_milan.my_second_dbt_model ...................... [RUN]
[0m14:35:12.964911 [debug] [Thread-6 (]: Acquiring new bigquery connection 'model.coffee_shop.my_second_dbt_model'
[0m14:35:12.965195 [debug] [Thread-6 (]: Began compiling node model.coffee_shop.my_second_dbt_model
[0m14:35:12.969874 [debug] [Thread-6 (]: Writing injected SQL for node "model.coffee_shop.my_second_dbt_model"
[0m14:35:12.970458 [debug] [Thread-6 (]: Timing info for model.coffee_shop.my_second_dbt_model (compile): 2023-02-17 14:35:12.965396 => 2023-02-17 14:35:12.970365
[0m14:35:12.970814 [debug] [Thread-6 (]: Began executing node model.coffee_shop.my_second_dbt_model
[0m14:35:12.973677 [debug] [Thread-6 (]: Writing runtime sql for node "model.coffee_shop.my_second_dbt_model"
[0m14:35:12.974245 [debug] [Thread-6 (]: Opening a new connection, currently in state init
[0m14:35:12.974648 [debug] [Thread-6 (]: On model.coffee_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.my_second_dbt_model"} */


  create or replace view `aec-students`.`dbt_milan`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `aec-students`.`dbt_milan`.`my_first_dbt_model`
where id = 1;


[0m14:35:13.568639 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:1b24644f-b81c-405d-ab02-7db8185cf288&page=queryresults
[0m14:35:13.570584 [debug] [Thread-4 (]: Timing info for model.coffee_shop.customers_ref (execute): 2023-02-17 14:35:12.765215 => 2023-02-17 14:35:13.570523
[0m14:35:13.571457 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'acdaff74-c4e8-48e8-ab29-e4177c631e7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc97efed990>]}
[0m14:35:13.572598 [info ] [Thread-4 (]: 3 of 4 OK created sql view model dbt_milan.customers_ref ....................... [[32mCREATE VIEW (0 processed)[0m in 0.81s]
[0m14:35:13.575151 [debug] [Thread-4 (]: Finished running node model.coffee_shop.customers_ref
[0m14:35:13.757842 [debug] [Thread-6 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:2de1df5e-d7dc-4447-bec0-64633470557f&page=queryresults
[0m14:35:13.761045 [debug] [Thread-6 (]: Timing info for model.coffee_shop.my_second_dbt_model (execute): 2023-02-17 14:35:12.971009 => 2023-02-17 14:35:13.760981
[0m14:35:13.761879 [debug] [Thread-6 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'acdaff74-c4e8-48e8-ab29-e4177c631e7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc97eb26260>]}
[0m14:35:13.762440 [info ] [Thread-6 (]: 4 of 4 OK created sql view model dbt_milan.my_second_dbt_model ................. [[32mCREATE VIEW (0 processed)[0m in 0.80s]
[0m14:35:13.763003 [debug] [Thread-6 (]: Finished running node model.coffee_shop.my_second_dbt_model
[0m14:35:13.764934 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:35:13.765568 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:35:13.765798 [debug] [MainThread]: Connection 'model.coffee_shop.customers' was properly closed.
[0m14:35:13.766021 [debug] [MainThread]: Connection 'model.coffee_shop.my_first_dbt_model' was properly closed.
[0m14:35:13.766212 [debug] [MainThread]: Connection 'model.coffee_shop.customers_ref' was properly closed.
[0m14:35:13.766399 [debug] [MainThread]: Connection 'model.coffee_shop.my_second_dbt_model' was properly closed.
[0m14:35:13.766684 [info ] [MainThread]: 
[0m14:35:13.767027 [info ] [MainThread]: Finished running 2 table models, 2 view models in 0 hours 0 minutes and 5.65 seconds (5.65s).
[0m14:35:13.768241 [debug] [MainThread]: Command end result
[0m14:35:13.775537 [info ] [MainThread]: 
[0m14:35:13.776040 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:35:13.776488 [info ] [MainThread]: 
[0m14:35:13.776955 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m14:35:13.777474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc98292afe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc97eb26f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc97eb26260>]}
[0m14:35:13.777881 [debug] [MainThread]: Flushing usage events


============================== 2023-02-17 15:03:19.344365 | dc724787-2aa5-4144-b41f-4e1d7d711bbb ==============================
[0m15:03:19.344365 [info ] [MainThread]: Running with dbt=1.4.1
[0m15:03:19.346999 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:03:19.347312 [debug] [MainThread]: Tracking: tracking
[0m15:03:19.356522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88be755060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88be754550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88be754a00>]}
[0m15:03:19.415805 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m15:03:19.416580 [debug] [MainThread]: Partial parsing: added file: coffee_shop://models/schema.yml
[0m15:03:19.503094 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffe_shop_milan.example
[0m15:03:19.509292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dc724787-2aa5-4144-b41f-4e1d7d711bbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88be5980d0>]}
[0m15:03:19.516918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dc724787-2aa5-4144-b41f-4e1d7d711bbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88be6dfe50>]}
[0m15:03:19.517383 [info ] [MainThread]: Found 4 models, 9 tests, 0 snapshots, 0 analyses, 334 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m15:03:19.517754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc724787-2aa5-4144-b41f-4e1d7d711bbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88c2032fe0>]}
[0m15:03:19.519302 [info ] [MainThread]: 
[0m15:03:19.521434 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:03:19.522914 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m15:03:19.523455 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:03:20.798045 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_milan'
[0m15:03:20.803663 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:03:21.156722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc724787-2aa5-4144-b41f-4e1d7d711bbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88be90ae30>]}
[0m15:03:21.157912 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m15:03:21.158327 [info ] [MainThread]: 
[0m15:03:21.165118 [debug] [Thread-1 (]: Began running node model.coffee_shop.customers
[0m15:03:21.165556 [debug] [Thread-2 (]: Began running node model.coffee_shop.my_first_dbt_model
[0m15:03:21.166047 [info ] [Thread-1 (]: 1 of 4 START sql table model dbt_milan.customers ............................... [RUN]
[0m15:03:21.166431 [info ] [Thread-2 (]: 2 of 4 START sql table model dbt_milan.my_first_dbt_model ...................... [RUN]
[0m15:03:21.167626 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop.customers'
[0m15:03:21.168312 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.coffee_shop.my_first_dbt_model'
[0m15:03:21.168902 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.customers
[0m15:03:21.169184 [debug] [Thread-2 (]: Began compiling node model.coffee_shop.my_first_dbt_model
[0m15:03:21.171899 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.customers"
[0m15:03:21.174556 [debug] [Thread-2 (]: Writing injected SQL for node "model.coffee_shop.my_first_dbt_model"
[0m15:03:21.175296 [debug] [Thread-2 (]: Timing info for model.coffee_shop.my_first_dbt_model (compile): 2023-02-17 15:03:21.172227 => 2023-02-17 15:03:21.175201
[0m15:03:21.175597 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (compile): 2023-02-17 15:03:21.169397 => 2023-02-17 15:03:21.175540
[0m15:03:21.175972 [debug] [Thread-2 (]: Began executing node model.coffee_shop.my_first_dbt_model
[0m15:03:21.176365 [debug] [Thread-1 (]: Began executing node model.coffee_shop.customers
[0m15:03:21.191549 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:03:21.194121 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:03:21.625998 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop.customers"
[0m15:03:21.627710 [debug] [Thread-2 (]: Writing runtime sql for node "model.coffee_shop.my_first_dbt_model"
[0m15:03:21.628942 [debug] [Thread-1 (]: On model.coffee_shop.customers: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.customers"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`customers`
    
    
    OPTIONS()
    as (
      

select * from `analytics-engineers-club.coffee_shop.customers`
limit 9000
    );
  
[0m15:03:21.630493 [debug] [Thread-2 (]: On model.coffee_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.my_first_dbt_model"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`my_first_dbt_model`
    
    
    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m15:03:23.851926 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:65d6658e-9cc9-4916-ada7-67ff5accb96f&page=queryresults
[0m15:03:23.871271 [debug] [Thread-2 (]: Timing info for model.coffee_shop.my_first_dbt_model (execute): 2023-02-17 15:03:21.176641 => 2023-02-17 15:03:23.871205
[0m15:03:23.872174 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc724787-2aa5-4144-b41f-4e1d7d711bbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88be70a050>]}
[0m15:03:23.872774 [info ] [Thread-2 (]: 2 of 4 OK created sql table model dbt_milan.my_first_dbt_model ................. [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 2.70s]
[0m15:03:23.874563 [debug] [Thread-2 (]: Finished running node model.coffee_shop.my_first_dbt_model
[0m15:03:23.875569 [debug] [Thread-4 (]: Began running node model.coffee_shop.my_second_dbt_model
[0m15:03:23.876064 [info ] [Thread-4 (]: 3 of 4 START sql view model dbt_milan.my_second_dbt_model ...................... [RUN]
[0m15:03:23.876829 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.coffee_shop.my_second_dbt_model'
[0m15:03:23.877108 [debug] [Thread-4 (]: Began compiling node model.coffee_shop.my_second_dbt_model
[0m15:03:23.880250 [debug] [Thread-4 (]: Writing injected SQL for node "model.coffee_shop.my_second_dbt_model"
[0m15:03:23.881530 [debug] [Thread-4 (]: Timing info for model.coffee_shop.my_second_dbt_model (compile): 2023-02-17 15:03:23.877274 => 2023-02-17 15:03:23.881426
[0m15:03:23.881945 [debug] [Thread-4 (]: Began executing node model.coffee_shop.my_second_dbt_model
[0m15:03:23.902008 [debug] [Thread-4 (]: Writing runtime sql for node "model.coffee_shop.my_second_dbt_model"
[0m15:03:23.902742 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:03:23.903221 [debug] [Thread-4 (]: On model.coffee_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.my_second_dbt_model"} */


  create or replace view `aec-students`.`dbt_milan`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `aec-students`.`dbt_milan`.`my_first_dbt_model`
where id = 1;


[0m15:03:24.180953 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:6150f89c-fe7e-4491-9dcb-774b524112a9&page=queryresults
[0m15:03:24.182895 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (execute): 2023-02-17 15:03:21.191886 => 2023-02-17 15:03:24.182830
[0m15:03:24.183675 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc724787-2aa5-4144-b41f-4e1d7d711bbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88be61ff10>]}
[0m15:03:24.184197 [info ] [Thread-1 (]: 1 of 4 OK created sql table model dbt_milan.customers .......................... [[32mCREATE TABLE (9.0k rows, 12.8 MB processed)[0m in 3.02s]
[0m15:03:24.184688 [debug] [Thread-1 (]: Finished running node model.coffee_shop.customers
[0m15:03:24.185365 [debug] [Thread-6 (]: Began running node model.coffee_shop.customers_ref
[0m15:03:24.185769 [info ] [Thread-6 (]: 4 of 4 START sql view model dbt_milan.customers_ref ............................ [RUN]
[0m15:03:24.186718 [debug] [Thread-6 (]: Acquiring new bigquery connection 'model.coffee_shop.customers_ref'
[0m15:03:24.187095 [debug] [Thread-6 (]: Began compiling node model.coffee_shop.customers_ref
[0m15:03:24.189935 [debug] [Thread-6 (]: Writing injected SQL for node "model.coffee_shop.customers_ref"
[0m15:03:24.190534 [debug] [Thread-6 (]: Timing info for model.coffee_shop.customers_ref (compile): 2023-02-17 15:03:24.187279 => 2023-02-17 15:03:24.190445
[0m15:03:24.190888 [debug] [Thread-6 (]: Began executing node model.coffee_shop.customers_ref
[0m15:03:24.194146 [debug] [Thread-6 (]: Writing runtime sql for node "model.coffee_shop.customers_ref"
[0m15:03:24.194699 [debug] [Thread-6 (]: Opening a new connection, currently in state init
[0m15:03:24.195079 [debug] [Thread-6 (]: On model.coffee_shop.customers_ref: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.customers_ref"} */


  create or replace view `aec-students`.`dbt_milan`.`customers_ref`
  OPTIONS()
  as Select *
from `aec-students`.`dbt_milan`.`customers`;


[0m15:03:24.695371 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:b757b6c3-427a-4ff9-9084-19b1fe2bd5ba&page=queryresults
[0m15:03:24.697425 [debug] [Thread-4 (]: Timing info for model.coffee_shop.my_second_dbt_model (execute): 2023-02-17 15:03:23.882200 => 2023-02-17 15:03:24.697362
[0m15:03:24.698282 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc724787-2aa5-4144-b41f-4e1d7d711bbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88be7084c0>]}
[0m15:03:24.698830 [info ] [Thread-4 (]: 3 of 4 OK created sql view model dbt_milan.my_second_dbt_model ................. [[32mCREATE VIEW (0 processed)[0m in 0.82s]
[0m15:03:24.699307 [debug] [Thread-4 (]: Finished running node model.coffee_shop.my_second_dbt_model
[0m15:03:24.987394 [debug] [Thread-6 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:d27c0f8a-52a3-4c44-9db0-019a65f47fc4&page=queryresults
[0m15:03:24.989646 [debug] [Thread-6 (]: Timing info for model.coffee_shop.customers_ref (execute): 2023-02-17 15:03:24.191083 => 2023-02-17 15:03:24.989586
[0m15:03:24.990488 [debug] [Thread-6 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc724787-2aa5-4144-b41f-4e1d7d711bbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88be61f850>]}
[0m15:03:24.991059 [info ] [Thread-6 (]: 4 of 4 OK created sql view model dbt_milan.customers_ref ....................... [[32mCREATE VIEW (0 processed)[0m in 0.80s]
[0m15:03:24.991795 [debug] [Thread-6 (]: Finished running node model.coffee_shop.customers_ref
[0m15:03:24.994196 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:03:24.994786 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:03:24.995023 [debug] [MainThread]: Connection 'model.coffee_shop.customers' was properly closed.
[0m15:03:24.995198 [debug] [MainThread]: Connection 'model.coffee_shop.my_first_dbt_model' was properly closed.
[0m15:03:24.995369 [debug] [MainThread]: Connection 'model.coffee_shop.my_second_dbt_model' was properly closed.
[0m15:03:24.995575 [debug] [MainThread]: Connection 'model.coffee_shop.customers_ref' was properly closed.
[0m15:03:24.995814 [info ] [MainThread]: 
[0m15:03:24.996155 [info ] [MainThread]: Finished running 2 table models, 2 view models in 0 hours 0 minutes and 5.48 seconds (5.48s).
[0m15:03:24.996773 [debug] [MainThread]: Command end result
[0m15:03:25.005700 [info ] [MainThread]: 
[0m15:03:25.006344 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:03:25.006859 [info ] [MainThread]: 
[0m15:03:25.007333 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m15:03:25.008129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88be5ae200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88bea59840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88c09ef3a0>]}
[0m15:03:25.008514 [debug] [MainThread]: Flushing usage events


============================== 2023-02-17 15:03:31.553325 | 85bddb23-7e31-491f-aa3b-fe9d52eea613 ==============================
[0m15:03:31.553325 [info ] [MainThread]: Running with dbt=1.4.1
[0m15:03:31.556042 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m15:03:31.556491 [debug] [MainThread]: Tracking: tracking
[0m15:03:31.558553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefee047730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefede61180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefede61990>]}
[0m15:03:31.608711 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:03:31.609058 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:03:31.609773 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffe_shop_milan.example
[0m15:03:31.616490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '85bddb23-7e31-491f-aa3b-fe9d52eea613', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefede3d8d0>]}
[0m15:03:31.625013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '85bddb23-7e31-491f-aa3b-fe9d52eea613', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefede09e70>]}
[0m15:03:31.625529 [info ] [MainThread]: Found 4 models, 9 tests, 0 snapshots, 0 analyses, 334 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m15:03:31.626225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '85bddb23-7e31-491f-aa3b-fe9d52eea613', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefee047730>]}
[0m15:03:31.628353 [info ] [MainThread]: 
[0m15:03:31.630959 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:03:31.632538 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_milan'
[0m15:03:31.633194 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:03:32.757886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '85bddb23-7e31-491f-aa3b-fe9d52eea613', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefede09720>]}
[0m15:03:32.759265 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m15:03:32.760194 [info ] [MainThread]: 
[0m15:03:32.766725 [debug] [Thread-1 (]: Began running node test.coffee_shop.not_null_customers_id.422908bfae
[0m15:03:32.767232 [info ] [Thread-1 (]: 1 of 9 START test not_null_customers_id ........................................ [RUN]
[0m15:03:32.768454 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.coffee_shop.not_null_customers_id.422908bfae'
[0m15:03:32.768874 [debug] [Thread-1 (]: Began compiling node test.coffee_shop.not_null_customers_id.422908bfae
[0m15:03:32.775920 [debug] [Thread-2 (]: Began running node test.coffee_shop.not_null_customers_ref_email.337290571c
[0m15:03:32.776436 [info ] [Thread-2 (]: 2 of 9 START test not_null_customers_ref_email ................................. [RUN]
[0m15:03:32.777438 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.coffee_shop.not_null_customers_ref_email.337290571c'
[0m15:03:32.777831 [debug] [Thread-2 (]: Began compiling node test.coffee_shop.not_null_customers_ref_email.337290571c
[0m15:03:32.799067 [debug] [Thread-3 (]: Began running node test.coffee_shop.not_null_customers_ref_id.1480a96cf3
[0m15:03:32.802713 [debug] [Thread-1 (]: Writing injected SQL for node "test.coffee_shop.not_null_customers_id.422908bfae"
[0m15:03:32.803212 [debug] [Thread-2 (]: Writing injected SQL for node "test.coffee_shop.not_null_customers_ref_email.337290571c"
[0m15:03:32.803578 [debug] [Thread-4 (]: Began running node test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:03:32.803938 [debug] [Thread-5 (]: Began running node test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778
[0m15:03:32.804432 [debug] [Thread-6 (]: Began running node test.coffee_shop.unique_customers_id.70f3d3fd20
[0m15:03:32.804653 [debug] [Thread-7 (]: Began running node test.coffee_shop.unique_customers_ref_id.48ce3bbab4
[0m15:03:32.804202 [info ] [Thread-3 (]: 3 of 9 START test not_null_customers_ref_id .................................... [RUN]
[0m15:03:32.808606 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.coffee_shop.not_null_customers_ref_id.1480a96cf3'
[0m15:03:32.808963 [debug] [Thread-3 (]: Began compiling node test.coffee_shop.not_null_customers_ref_id.1480a96cf3
[0m15:03:32.807164 [debug] [Thread-1 (]: Timing info for test.coffee_shop.not_null_customers_id.422908bfae (compile): 2023-02-17 15:03:32.769149 => 2023-02-17 15:03:32.807035
[0m15:03:32.806176 [info ] [Thread-4 (]: 4 of 9 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m15:03:32.806479 [info ] [Thread-5 (]: 5 of 9 START test not_null_my_second_dbt_model_id .............................. [RUN]
[0m15:03:32.805142 [debug] [Thread-8 (]: Began running node test.coffee_shop.unique_my_first_dbt_model_id.16e066b321
[0m15:03:32.816571 [info ] [Thread-8 (]: 8 of 9 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m15:03:32.807789 [info ] [Thread-7 (]: 7 of 9 START test unique_customers_ref_id ...................................... [RUN]
[0m15:03:32.817858 [debug] [Thread-7 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_customers_ref_id.48ce3bbab4'
[0m15:03:32.814491 [debug] [Thread-3 (]: Writing injected SQL for node "test.coffee_shop.not_null_customers_ref_id.1480a96cf3"
[0m15:03:32.814935 [debug] [Thread-1 (]: Began executing node test.coffee_shop.not_null_customers_id.422908bfae
[0m15:03:32.815626 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710'
[0m15:03:32.816215 [debug] [Thread-5 (]: Acquiring new bigquery connection 'test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778'
[0m15:03:32.817313 [debug] [Thread-8 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_my_first_dbt_model_id.16e066b321'
[0m15:03:32.805921 [debug] [Thread-2 (]: Timing info for test.coffee_shop.not_null_customers_ref_email.337290571c (compile): 2023-02-17 15:03:32.778080 => 2023-02-17 15:03:32.805833
[0m15:03:32.806792 [info ] [Thread-6 (]: 6 of 9 START test unique_customers_id .......................................... [RUN]
[0m15:03:32.818136 [debug] [Thread-7 (]: Began compiling node test.coffee_shop.unique_customers_ref_id.48ce3bbab4
[0m15:03:32.819013 [debug] [Thread-3 (]: Timing info for test.coffee_shop.not_null_customers_ref_id.1480a96cf3 (compile): 2023-02-17 15:03:32.809553 => 2023-02-17 15:03:32.818926
[0m15:03:32.821690 [debug] [Thread-4 (]: Began compiling node test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:03:32.822128 [debug] [Thread-5 (]: Began compiling node test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778
[0m15:03:32.915627 [debug] [Thread-5 (]: Writing injected SQL for node "test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778"
[0m15:03:32.833237 [debug] [Thread-2 (]: Began executing node test.coffee_shop.not_null_customers_ref_email.337290571c
[0m15:03:32.898781 [debug] [Thread-1 (]: Writing runtime sql for node "test.coffee_shop.not_null_customers_id.422908bfae"
[0m15:03:32.899636 [debug] [Thread-6 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_customers_id.70f3d3fd20'
[0m15:03:32.906732 [debug] [Thread-7 (]: Writing injected SQL for node "test.coffee_shop.unique_customers_ref_id.48ce3bbab4"
[0m15:03:32.907163 [debug] [Thread-3 (]: Began executing node test.coffee_shop.not_null_customers_ref_id.1480a96cf3
[0m15:03:32.911340 [debug] [Thread-4 (]: Writing injected SQL for node "test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710"
[0m15:03:32.822430 [debug] [Thread-8 (]: Began compiling node test.coffee_shop.unique_my_first_dbt_model_id.16e066b321
[0m15:03:32.918286 [debug] [Thread-2 (]: Writing runtime sql for node "test.coffee_shop.not_null_customers_ref_email.337290571c"
[0m15:03:32.919032 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:03:32.919370 [debug] [Thread-6 (]: Began compiling node test.coffee_shop.unique_customers_id.70f3d3fd20
[0m15:03:32.921708 [debug] [Thread-3 (]: Writing runtime sql for node "test.coffee_shop.not_null_customers_ref_id.1480a96cf3"
[0m15:03:32.933401 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:03:32.933840 [debug] [Thread-3 (]: On test.coffee_shop.not_null_customers_ref_id.1480a96cf3: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "test.coffee_shop.not_null_customers_ref_id.1480a96cf3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from `aec-students`.`dbt_milan`.`customers_ref`
where id is null



      
    ) dbt_internal_test
[0m15:03:32.926375 [debug] [Thread-8 (]: Writing injected SQL for node "test.coffee_shop.unique_my_first_dbt_model_id.16e066b321"
[0m15:03:32.936969 [debug] [Thread-8 (]: Timing info for test.coffee_shop.unique_my_first_dbt_model_id.16e066b321 (compile): 2023-02-17 15:03:32.922493 => 2023-02-17 15:03:32.936850
[0m15:03:32.937519 [debug] [Thread-8 (]: Began executing node test.coffee_shop.unique_my_first_dbt_model_id.16e066b321
[0m15:03:32.942589 [debug] [Thread-8 (]: Writing runtime sql for node "test.coffee_shop.unique_my_first_dbt_model_id.16e066b321"
[0m15:03:32.927461 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:03:32.943636 [debug] [Thread-2 (]: On test.coffee_shop.not_null_customers_ref_email.337290571c: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "test.coffee_shop.not_null_customers_ref_email.337290571c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select email
from `aec-students`.`dbt_milan`.`customers_ref`
where email is null



      
    ) dbt_internal_test
[0m15:03:32.927953 [debug] [Thread-4 (]: Timing info for test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710 (compile): 2023-02-17 15:03:32.907454 => 2023-02-17 15:03:32.927892
[0m15:03:32.922195 [debug] [Thread-7 (]: Timing info for test.coffee_shop.unique_customers_ref_id.48ce3bbab4 (compile): 2023-02-17 15:03:32.899951 => 2023-02-17 15:03:32.922101
[0m15:03:32.951498 [debug] [Thread-7 (]: Began executing node test.coffee_shop.unique_customers_ref_id.48ce3bbab4
[0m15:03:32.926921 [debug] [Thread-5 (]: Timing info for test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778 (compile): 2023-02-17 15:03:32.911675 => 2023-02-17 15:03:32.926830
[0m15:03:32.955703 [debug] [Thread-5 (]: Began executing node test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778
[0m15:03:32.932668 [debug] [Thread-6 (]: Writing injected SQL for node "test.coffee_shop.unique_customers_id.70f3d3fd20"
[0m15:03:32.960319 [debug] [Thread-6 (]: Timing info for test.coffee_shop.unique_customers_id.70f3d3fd20 (compile): 2023-02-17 15:03:32.928798 => 2023-02-17 15:03:32.960217
[0m15:03:32.960718 [debug] [Thread-6 (]: Began executing node test.coffee_shop.unique_customers_id.70f3d3fd20
[0m15:03:32.946783 [debug] [Thread-8 (]: Opening a new connection, currently in state init
[0m15:03:32.965409 [debug] [Thread-8 (]: On test.coffee_shop.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "test.coffee_shop.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `aec-students`.`dbt_milan`.`my_first_dbt_model`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m15:03:32.954994 [debug] [Thread-7 (]: Writing runtime sql for node "test.coffee_shop.unique_customers_ref_id.48ce3bbab4"
[0m15:03:32.928547 [debug] [Thread-1 (]: On test.coffee_shop.not_null_customers_id.422908bfae: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "test.coffee_shop.not_null_customers_id.422908bfae"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from `aec-students`.`dbt_milan`.`customers`
where id is null



      
    ) dbt_internal_test
[0m15:03:32.959083 [debug] [Thread-5 (]: Writing runtime sql for node "test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778"
[0m15:03:32.950994 [debug] [Thread-4 (]: Began executing node test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:03:32.964902 [debug] [Thread-6 (]: Writing runtime sql for node "test.coffee_shop.unique_customers_id.70f3d3fd20"
[0m15:03:32.974722 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m15:03:32.990187 [debug] [Thread-5 (]: On test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from `aec-students`.`dbt_milan`.`my_second_dbt_model`
where id is null



      
    ) dbt_internal_test
[0m15:03:32.981260 [debug] [Thread-4 (]: Writing runtime sql for node "test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710"
[0m15:03:32.977494 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m15:03:32.995081 [debug] [Thread-7 (]: On test.coffee_shop.unique_customers_ref_id.48ce3bbab4: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "test.coffee_shop.unique_customers_ref_id.48ce3bbab4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `aec-students`.`dbt_milan`.`customers_ref`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m15:03:32.991150 [debug] [Thread-6 (]: Opening a new connection, currently in state init
[0m15:03:32.999016 [debug] [Thread-6 (]: On test.coffee_shop.unique_customers_id.70f3d3fd20: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "test.coffee_shop.unique_customers_id.70f3d3fd20"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `aec-students`.`dbt_milan`.`customers`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m15:03:33.002989 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:03:33.003564 [debug] [Thread-4 (]: On test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from `aec-students`.`dbt_milan`.`my_first_dbt_model`
where id is null



      
    ) dbt_internal_test
[0m15:03:34.716670 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:f67fb66b-95ff-49f0-a8cd-75ff654f8ebd&page=queryresults
[0m15:03:34.718154 [debug] [Thread-1 (]: Timing info for test.coffee_shop.not_null_customers_id.422908bfae (execute): 2023-02-17 15:03:32.819190 => 2023-02-17 15:03:34.718074
[0m15:03:34.719005 [info ] [Thread-1 (]: 1 of 9 PASS not_null_customers_id .............................................. [[32mPASS[0m in 1.95s]
[0m15:03:34.721633 [debug] [Thread-1 (]: Finished running node test.coffee_shop.not_null_customers_id.422908bfae
[0m15:03:34.722175 [debug] [Thread-1 (]: Began running node test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493
[0m15:03:34.722646 [info ] [Thread-1 (]: 9 of 9 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m15:03:34.723449 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493'
[0m15:03:34.723789 [debug] [Thread-1 (]: Began compiling node test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493
[0m15:03:34.728584 [debug] [Thread-1 (]: Writing injected SQL for node "test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493"
[0m15:03:34.729175 [debug] [Thread-1 (]: Timing info for test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493 (compile): 2023-02-17 15:03:34.724044 => 2023-02-17 15:03:34.729097
[0m15:03:34.729524 [debug] [Thread-1 (]: Began executing node test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493
[0m15:03:34.732809 [debug] [Thread-1 (]: Writing runtime sql for node "test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493"
[0m15:03:34.735301 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:03:34.735907 [debug] [Thread-1 (]: On test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `aec-students`.`dbt_milan`.`my_second_dbt_model`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m15:03:34.790281 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:a5f7af8f-1383-488f-b8a2-8b83d4b5c518&page=queryresults
[0m15:03:34.791483 [debug] [Thread-4 (]: Timing info for test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710 (execute): 2023-02-17 15:03:32.978003 => 2023-02-17 15:03:34.791346
[0m15:03:34.792884 [error] [Thread-4 (]: 4 of 9 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 1.98s]
[0m15:03:34.795576 [debug] [Thread-4 (]: Finished running node test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:03:34.825709 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:35c9b1e8-347c-4dad-a378-d65c28a03c8c&page=queryresults
[0m15:03:34.826645 [debug] [Thread-2 (]: Timing info for test.coffee_shop.not_null_customers_ref_email.337290571c (execute): 2023-02-17 15:03:32.916257 => 2023-02-17 15:03:34.826545
[0m15:03:34.827905 [info ] [Thread-2 (]: 2 of 9 PASS not_null_customers_ref_email ....................................... [[32mPASS[0m in 2.05s]
[0m15:03:34.829001 [debug] [Thread-2 (]: Finished running node test.coffee_shop.not_null_customers_ref_email.337290571c
[0m15:03:34.868428 [debug] [Thread-5 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:85eb3077-124a-411d-9fb5-71a49e3cfd54&page=queryresults
[0m15:03:34.869155 [debug] [Thread-5 (]: Timing info for test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778 (execute): 2023-02-17 15:03:32.956007 => 2023-02-17 15:03:34.869082
[0m15:03:34.869934 [info ] [Thread-5 (]: 5 of 9 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 2.05s]
[0m15:03:34.870405 [debug] [Thread-5 (]: Finished running node test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778
[0m15:03:34.876271 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:c34f72c4-d032-406f-ae56-772ced91946c&page=queryresults
[0m15:03:34.876981 [debug] [Thread-3 (]: Timing info for test.coffee_shop.not_null_customers_ref_id.1480a96cf3 (execute): 2023-02-17 15:03:32.919793 => 2023-02-17 15:03:34.876914
[0m15:03:34.877836 [info ] [Thread-3 (]: 3 of 9 PASS not_null_customers_ref_id .......................................... [[32mPASS[0m in 2.07s]
[0m15:03:34.882273 [debug] [Thread-3 (]: Finished running node test.coffee_shop.not_null_customers_ref_id.1480a96cf3
[0m15:03:35.051012 [debug] [Thread-8 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:28473867-3501-4132-8576-88c721932986&page=queryresults
[0m15:03:35.052020 [debug] [Thread-8 (]: Timing info for test.coffee_shop.unique_my_first_dbt_model_id.16e066b321 (execute): 2023-02-17 15:03:32.937882 => 2023-02-17 15:03:35.051899
[0m15:03:35.056531 [debug] [Thread-7 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:a7881b46-475d-4f9a-a79a-289bbc5f0986&page=queryresults
[0m15:03:35.057395 [debug] [Thread-7 (]: Timing info for test.coffee_shop.unique_customers_ref_id.48ce3bbab4 (execute): 2023-02-17 15:03:32.951790 => 2023-02-17 15:03:35.057301
[0m15:03:35.053112 [info ] [Thread-8 (]: 8 of 9 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 2.24s]
[0m15:03:35.058384 [info ] [Thread-7 (]: 7 of 9 PASS unique_customers_ref_id ............................................ [[32mPASS[0m in 2.24s]
[0m15:03:35.059155 [debug] [Thread-8 (]: Finished running node test.coffee_shop.unique_my_first_dbt_model_id.16e066b321
[0m15:03:35.060363 [debug] [Thread-6 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:cfe38d76-c242-49a6-82f8-c0e0b27186d2&page=queryresults
[0m15:03:35.060808 [debug] [Thread-7 (]: Finished running node test.coffee_shop.unique_customers_ref_id.48ce3bbab4
[0m15:03:35.061780 [debug] [Thread-6 (]: Timing info for test.coffee_shop.unique_customers_id.70f3d3fd20 (execute): 2023-02-17 15:03:32.960964 => 2023-02-17 15:03:35.061718
[0m15:03:35.062746 [info ] [Thread-6 (]: 6 of 9 PASS unique_customers_id ................................................ [[32mPASS[0m in 2.16s]
[0m15:03:35.063276 [debug] [Thread-6 (]: Finished running node test.coffee_shop.unique_customers_id.70f3d3fd20
[0m15:03:36.094035 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:1e598575-4a4d-41e3-9709-8fd88fe70644&page=queryresults
[0m15:03:36.094802 [debug] [Thread-1 (]: Timing info for test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493 (execute): 2023-02-17 15:03:34.729766 => 2023-02-17 15:03:36.094722
[0m15:03:36.095599 [info ] [Thread-1 (]: 9 of 9 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 1.37s]
[0m15:03:36.096106 [debug] [Thread-1 (]: Finished running node test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493
[0m15:03:36.098042 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:03:36.098630 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:03:36.098851 [debug] [MainThread]: Connection 'test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m15:03:36.099026 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_customers_ref_email.337290571c' was properly closed.
[0m15:03:36.099192 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_customers_ref_id.1480a96cf3' was properly closed.
[0m15:03:36.099346 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m15:03:36.099535 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
[0m15:03:36.099687 [debug] [MainThread]: Connection 'test.coffee_shop.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m15:03:36.099842 [debug] [MainThread]: Connection 'test.coffee_shop.unique_customers_ref_id.48ce3bbab4' was properly closed.
[0m15:03:36.100836 [debug] [MainThread]: Connection 'test.coffee_shop.unique_customers_id.70f3d3fd20' was properly closed.
[0m15:03:36.101223 [info ] [MainThread]: 
[0m15:03:36.101813 [info ] [MainThread]: Finished running 9 tests in 0 hours 0 minutes and 4.47 seconds (4.47s).
[0m15:03:36.102653 [debug] [MainThread]: Command end result
[0m15:03:36.110863 [info ] [MainThread]: 
[0m15:03:36.111811 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:03:36.112312 [info ] [MainThread]: 
[0m15:03:36.113069 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
[0m15:03:36.113491 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m15:03:36.114195 [info ] [MainThread]: 
[0m15:03:36.114961 [info ] [MainThread]:   compiled Code at target/compiled/coffee_shop/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
[0m15:03:36.115542 [info ] [MainThread]: 
[0m15:03:36.116024 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=0 TOTAL=9
[0m15:03:36.117020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefec34be80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefec4279a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefede090f0>]}
[0m15:03:36.117430 [debug] [MainThread]: Flushing usage events


============================== 2023-02-17 15:07:01.789518 | 9d5fd12c-11ef-43a9-8a25-9e999ffa03fa ==============================
[0m15:07:01.789518 [info ] [MainThread]: Running with dbt=1.4.1
[0m15:07:01.793224 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
[0m15:07:01.794506 [debug] [MainThread]: Tracking: tracking
[0m15:07:01.796476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14d6c591b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14d6c58310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14d6c58b50>]}
[0m15:07:01.854956 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:07:01.855613 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:07:01.856357 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffe_shop_milan.example
[0m15:07:01.862854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9d5fd12c-11ef-43a9-8a25-9e999ffa03fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14d6c35f90>]}
[0m15:07:01.871352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9d5fd12c-11ef-43a9-8a25-9e999ffa03fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14d6b66560>]}
[0m15:07:01.872082 [info ] [MainThread]: Found 4 models, 9 tests, 0 snapshots, 0 analyses, 334 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m15:07:01.872596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d5fd12c-11ef-43a9-8a25-9e999ffa03fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14d6b665c0>]}
[0m15:07:01.874431 [info ] [MainThread]: 
[0m15:07:01.876547 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:07:01.878662 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_milan'
[0m15:07:01.879227 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:07:03.059463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d5fd12c-11ef-43a9-8a25-9e999ffa03fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14d6b66230>]}
[0m15:07:03.060798 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m15:07:03.061459 [info ] [MainThread]: 
[0m15:07:03.071569 [debug] [Thread-1 (]: Began running node model.coffee_shop.customers
[0m15:07:03.072118 [debug] [Thread-2 (]: Began running node model.coffee_shop.my_first_dbt_model
[0m15:07:03.073871 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.coffee_shop.my_first_dbt_model'
[0m15:07:03.074412 [debug] [Thread-2 (]: Began compiling node model.coffee_shop.my_first_dbt_model
[0m15:07:03.072869 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop.customers'
[0m15:07:03.080742 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.customers
[0m15:07:03.085771 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.customers"
[0m15:07:03.086643 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (compile): 2023-02-17 15:07:03.081167 => 2023-02-17 15:07:03.086533
[0m15:07:03.080169 [debug] [Thread-2 (]: Writing injected SQL for node "model.coffee_shop.my_first_dbt_model"
[0m15:07:03.088761 [debug] [Thread-2 (]: Timing info for model.coffee_shop.my_first_dbt_model (compile): 2023-02-17 15:07:03.074818 => 2023-02-17 15:07:03.088663
[0m15:07:03.089311 [debug] [Thread-2 (]: Began executing node model.coffee_shop.my_first_dbt_model
[0m15:07:03.089817 [debug] [Thread-2 (]: Timing info for model.coffee_shop.my_first_dbt_model (execute): 2023-02-17 15:07:03.089717 => 2023-02-17 15:07:03.089742
[0m15:07:03.092664 [debug] [Thread-2 (]: Finished running node model.coffee_shop.my_first_dbt_model
[0m15:07:03.087210 [debug] [Thread-1 (]: Began executing node model.coffee_shop.customers
[0m15:07:03.093675 [debug] [Thread-4 (]: Began running node model.coffee_shop.my_second_dbt_model
[0m15:07:03.095668 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.coffee_shop.my_second_dbt_model'
[0m15:07:03.094263 [debug] [Thread-6 (]: Began running node test.coffee_shop.unique_my_first_dbt_model_id.16e066b321
[0m15:07:03.096759 [debug] [Thread-6 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_my_first_dbt_model_id.16e066b321'
[0m15:07:03.097243 [debug] [Thread-6 (]: Began compiling node test.coffee_shop.unique_my_first_dbt_model_id.16e066b321
[0m15:07:03.093960 [debug] [Thread-5 (]: Began running node test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:07:03.109509 [debug] [Thread-5 (]: Acquiring new bigquery connection 'test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710'
[0m15:07:03.109820 [debug] [Thread-5 (]: Began compiling node test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:07:03.108802 [debug] [Thread-6 (]: Writing injected SQL for node "test.coffee_shop.unique_my_first_dbt_model_id.16e066b321"
[0m15:07:03.095982 [debug] [Thread-4 (]: Began compiling node model.coffee_shop.my_second_dbt_model
[0m15:07:03.094869 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (execute): 2023-02-17 15:07:03.094773 => 2023-02-17 15:07:03.094790
[0m15:07:03.119554 [debug] [Thread-5 (]: Writing injected SQL for node "test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710"
[0m15:07:03.123262 [debug] [Thread-1 (]: Finished running node model.coffee_shop.customers
[0m15:07:03.126905 [debug] [Thread-4 (]: Writing injected SQL for node "model.coffee_shop.my_second_dbt_model"
[0m15:07:03.127697 [debug] [Thread-5 (]: Timing info for test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710 (compile): 2023-02-17 15:07:03.109998 => 2023-02-17 15:07:03.127599
[0m15:07:03.128024 [debug] [Thread-6 (]: Timing info for test.coffee_shop.unique_my_first_dbt_model_id.16e066b321 (compile): 2023-02-17 15:07:03.097706 => 2023-02-17 15:07:03.127977
[0m15:07:03.130837 [debug] [Thread-6 (]: Began executing node test.coffee_shop.unique_my_first_dbt_model_id.16e066b321
[0m15:07:03.129725 [debug] [Thread-8 (]: Began running node model.coffee_shop.customers_ref
[0m15:07:03.129973 [debug] [Thread-3 (]: Began running node test.coffee_shop.not_null_customers_id.422908bfae
[0m15:07:03.132369 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.coffee_shop.not_null_customers_id.422908bfae'
[0m15:07:03.130496 [debug] [Thread-5 (]: Began executing node test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:07:03.129358 [debug] [Thread-4 (]: Timing info for model.coffee_shop.my_second_dbt_model (compile): 2023-02-17 15:07:03.120130 => 2023-02-17 15:07:03.129249
[0m15:07:03.133291 [debug] [Thread-4 (]: Began executing node model.coffee_shop.my_second_dbt_model
[0m15:07:03.133670 [debug] [Thread-4 (]: Timing info for model.coffee_shop.my_second_dbt_model (execute): 2023-02-17 15:07:03.133605 => 2023-02-17 15:07:03.133615
[0m15:07:03.132634 [debug] [Thread-3 (]: Began compiling node test.coffee_shop.not_null_customers_id.422908bfae
[0m15:07:03.130212 [debug] [Thread-2 (]: Began running node test.coffee_shop.unique_customers_id.70f3d3fd20
[0m15:07:03.201563 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_customers_id.70f3d3fd20'
[0m15:07:03.131128 [debug] [Thread-6 (]: Timing info for test.coffee_shop.unique_my_first_dbt_model_id.16e066b321 (execute): 2023-02-17 15:07:03.131071 => 2023-02-17 15:07:03.131084
[0m15:07:03.131767 [debug] [Thread-8 (]: Acquiring new bigquery connection 'model.coffee_shop.customers_ref'
[0m15:07:03.203373 [debug] [Thread-8 (]: Began compiling node model.coffee_shop.customers_ref
[0m15:07:03.134612 [debug] [Thread-4 (]: Finished running node model.coffee_shop.my_second_dbt_model
[0m15:07:03.218519 [debug] [Thread-3 (]: Writing injected SQL for node "test.coffee_shop.not_null_customers_id.422908bfae"
[0m15:07:03.203000 [debug] [Thread-6 (]: Finished running node test.coffee_shop.unique_my_first_dbt_model_id.16e066b321
[0m15:07:03.219368 [debug] [Thread-3 (]: Timing info for test.coffee_shop.not_null_customers_id.422908bfae (compile): 2023-02-17 15:07:03.134896 => 2023-02-17 15:07:03.219276
[0m15:07:03.219793 [debug] [Thread-3 (]: Began executing node test.coffee_shop.not_null_customers_id.422908bfae
[0m15:07:03.220141 [debug] [Thread-3 (]: Timing info for test.coffee_shop.not_null_customers_id.422908bfae (execute): 2023-02-17 15:07:03.220059 => 2023-02-17 15:07:03.220077
[0m15:07:03.202100 [debug] [Thread-2 (]: Began compiling node test.coffee_shop.unique_customers_id.70f3d3fd20
[0m15:07:03.132934 [debug] [Thread-5 (]: Timing info for test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710 (execute): 2023-02-17 15:07:03.132847 => 2023-02-17 15:07:03.132861
[0m15:07:03.228166 [debug] [Thread-5 (]: Finished running node test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:07:03.221111 [debug] [Thread-3 (]: Finished running node test.coffee_shop.not_null_customers_id.422908bfae
[0m15:07:03.230409 [debug] [Thread-1 (]: Began running node test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778
[0m15:07:03.207400 [debug] [Thread-8 (]: Writing injected SQL for node "model.coffee_shop.customers_ref"
[0m15:07:03.231333 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778'
[0m15:07:03.247688 [debug] [Thread-1 (]: Began compiling node test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778
[0m15:07:03.226891 [debug] [Thread-2 (]: Writing injected SQL for node "test.coffee_shop.unique_customers_id.70f3d3fd20"
[0m15:07:03.244163 [debug] [Thread-8 (]: Timing info for model.coffee_shop.customers_ref (compile): 2023-02-17 15:07:03.203675 => 2023-02-17 15:07:03.244034
[0m15:07:03.255523 [debug] [Thread-8 (]: Began executing node model.coffee_shop.customers_ref
[0m15:07:03.255952 [debug] [Thread-8 (]: Timing info for model.coffee_shop.customers_ref (execute): 2023-02-17 15:07:03.255856 => 2023-02-17 15:07:03.255874
[0m15:07:03.256938 [debug] [Thread-8 (]: Finished running node model.coffee_shop.customers_ref
[0m15:07:03.240325 [debug] [Thread-7 (]: Began running node test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493
[0m15:07:03.257876 [debug] [Thread-7 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493'
[0m15:07:03.258277 [debug] [Thread-7 (]: Began compiling node test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493
[0m15:07:03.254828 [debug] [Thread-1 (]: Writing injected SQL for node "test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778"
[0m15:07:03.269498 [debug] [Thread-1 (]: Timing info for test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778 (compile): 2023-02-17 15:07:03.248071 => 2023-02-17 15:07:03.269414
[0m15:07:03.270106 [debug] [Thread-1 (]: Began executing node test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778
[0m15:07:03.270439 [debug] [Thread-1 (]: Timing info for test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778 (execute): 2023-02-17 15:07:03.270371 => 2023-02-17 15:07:03.270386
[0m15:07:03.267699 [debug] [Thread-6 (]: Began running node test.coffee_shop.not_null_customers_ref_email.337290571c
[0m15:07:03.272335 [debug] [Thread-6 (]: Acquiring new bigquery connection 'test.coffee_shop.not_null_customers_ref_email.337290571c'
[0m15:07:03.269799 [debug] [Thread-2 (]: Timing info for test.coffee_shop.unique_customers_id.70f3d3fd20 (compile): 2023-02-17 15:07:03.221449 => 2023-02-17 15:07:03.269754
[0m15:07:03.268861 [debug] [Thread-3 (]: Began running node test.coffee_shop.unique_customers_ref_id.48ce3bbab4
[0m15:07:03.274143 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_customers_ref_id.48ce3bbab4'
[0m15:07:03.274592 [debug] [Thread-3 (]: Began compiling node test.coffee_shop.unique_customers_ref_id.48ce3bbab4
[0m15:07:03.271485 [debug] [Thread-1 (]: Finished running node test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778
[0m15:07:03.267151 [debug] [Thread-7 (]: Writing injected SQL for node "test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493"
[0m15:07:03.273105 [debug] [Thread-2 (]: Began executing node test.coffee_shop.unique_customers_id.70f3d3fd20
[0m15:07:03.282592 [debug] [Thread-3 (]: Writing injected SQL for node "test.coffee_shop.unique_customers_ref_id.48ce3bbab4"
[0m15:07:03.272734 [debug] [Thread-6 (]: Began compiling node test.coffee_shop.not_null_customers_ref_email.337290571c
[0m15:07:03.283411 [debug] [Thread-2 (]: Timing info for test.coffee_shop.unique_customers_id.70f3d3fd20 (execute): 2023-02-17 15:07:03.283327 => 2023-02-17 15:07:03.283343
[0m15:07:03.268475 [debug] [Thread-5 (]: Began running node test.coffee_shop.not_null_customers_ref_id.1480a96cf3
[0m15:07:03.292883 [debug] [Thread-5 (]: Acquiring new bigquery connection 'test.coffee_shop.not_null_customers_ref_id.1480a96cf3'
[0m15:07:03.293195 [debug] [Thread-5 (]: Began compiling node test.coffee_shop.not_null_customers_ref_id.1480a96cf3
[0m15:07:03.290766 [debug] [Thread-2 (]: Finished running node test.coffee_shop.unique_customers_id.70f3d3fd20
[0m15:07:03.292308 [debug] [Thread-3 (]: Timing info for test.coffee_shop.unique_customers_ref_id.48ce3bbab4 (compile): 2023-02-17 15:07:03.274883 => 2023-02-17 15:07:03.292253
[0m15:07:03.284004 [debug] [Thread-7 (]: Timing info for test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493 (compile): 2023-02-17 15:07:03.258545 => 2023-02-17 15:07:03.283925
[0m15:07:03.292030 [debug] [Thread-6 (]: Writing injected SQL for node "test.coffee_shop.not_null_customers_ref_email.337290571c"
[0m15:07:03.297625 [debug] [Thread-5 (]: Writing injected SQL for node "test.coffee_shop.not_null_customers_ref_id.1480a96cf3"
[0m15:07:03.298280 [debug] [Thread-3 (]: Began executing node test.coffee_shop.unique_customers_ref_id.48ce3bbab4
[0m15:07:03.298612 [debug] [Thread-7 (]: Began executing node test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493
[0m15:07:03.301694 [debug] [Thread-7 (]: Timing info for test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493 (execute): 2023-02-17 15:07:03.301623 => 2023-02-17 15:07:03.301635
[0m15:07:03.302384 [debug] [Thread-7 (]: Finished running node test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493
[0m15:07:03.301324 [debug] [Thread-3 (]: Timing info for test.coffee_shop.unique_customers_ref_id.48ce3bbab4 (execute): 2023-02-17 15:07:03.301243 => 2023-02-17 15:07:03.301261
[0m15:07:03.300525 [debug] [Thread-6 (]: Timing info for test.coffee_shop.not_null_customers_ref_email.337290571c (compile): 2023-02-17 15:07:03.284415 => 2023-02-17 15:07:03.300337
[0m15:07:03.303597 [debug] [Thread-6 (]: Began executing node test.coffee_shop.not_null_customers_ref_email.337290571c
[0m15:07:03.303262 [debug] [Thread-3 (]: Finished running node test.coffee_shop.unique_customers_ref_id.48ce3bbab4
[0m15:07:03.300953 [debug] [Thread-5 (]: Timing info for test.coffee_shop.not_null_customers_ref_id.1480a96cf3 (compile): 2023-02-17 15:07:03.293376 => 2023-02-17 15:07:03.300869
[0m15:07:03.304358 [debug] [Thread-5 (]: Began executing node test.coffee_shop.not_null_customers_ref_id.1480a96cf3
[0m15:07:03.303843 [debug] [Thread-6 (]: Timing info for test.coffee_shop.not_null_customers_ref_email.337290571c (execute): 2023-02-17 15:07:03.303776 => 2023-02-17 15:07:03.303786
[0m15:07:03.304597 [debug] [Thread-5 (]: Timing info for test.coffee_shop.not_null_customers_ref_id.1480a96cf3 (execute): 2023-02-17 15:07:03.304533 => 2023-02-17 15:07:03.304543
[0m15:07:03.305294 [debug] [Thread-6 (]: Finished running node test.coffee_shop.not_null_customers_ref_email.337290571c
[0m15:07:03.305961 [debug] [Thread-5 (]: Finished running node test.coffee_shop.not_null_customers_ref_id.1480a96cf3
[0m15:07:03.307541 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:07:03.307798 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
[0m15:07:03.308011 [debug] [MainThread]: Connection 'test.coffee_shop.unique_customers_id.70f3d3fd20' was properly closed.
[0m15:07:03.308198 [debug] [MainThread]: Connection 'model.coffee_shop.my_second_dbt_model' was properly closed.
[0m15:07:03.308400 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_customers_ref_email.337290571c' was properly closed.
[0m15:07:03.308584 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_customers_ref_id.1480a96cf3' was properly closed.
[0m15:07:03.308763 [debug] [MainThread]: Connection 'model.coffee_shop.customers_ref' was properly closed.
[0m15:07:03.308943 [debug] [MainThread]: Connection 'test.coffee_shop.unique_customers_ref_id.48ce3bbab4' was properly closed.
[0m15:07:03.309120 [debug] [MainThread]: Connection 'test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m15:07:03.309790 [debug] [MainThread]: Command end result
[0m15:07:03.318437 [info ] [MainThread]: Done.
[0m15:07:03.353997 [debug] [MainThread]: Acquiring new bigquery connection 'generate_catalog'
[0m15:07:03.354590 [info ] [MainThread]: Building catalog
[0m15:07:03.356039 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:07:03.708957 [debug] [ThreadPool]: Acquiring new bigquery connection 'aec-students.information_schema'
[0m15:07:03.727595 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:07:03.728447 [debug] [ThreadPool]: On aec-students.information_schema: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "connection_name": "aec-students.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `aec-students`.`dbt_milan`.__TABLES__
        where (upper(dataset_id) = upper('dbt_milan'))
    ),

    table_options as (
        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            JSON_VALUE(option_value) as table_comment

        from `aec-students`.`dbt_milan`.INFORMATION_SCHEMA.TABLE_OPTIONS
        where option_name = 'description'
    ),
    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `aec-students`.`dbt_milan`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `aec-students`.`dbt_milan`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,
        table_options.table_comment,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join table_options using (relation_id)
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
[0m15:07:06.208385 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:75ec95cb-4a69-4443-b006-a22ed8fe5dd5&page=queryresults
[0m15:07:06.232567 [info ] [MainThread]: Catalog written to /workspaces/ae-club-milan/coffe_shop_milan/target/catalog.json
[0m15:07:06.233372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14d6c70400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14d6c73b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14d6c70490>]}
[0m15:07:06.233919 [debug] [MainThread]: Flushing usage events
[0m15:07:06.622828 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m15:07:06.623553 [debug] [MainThread]: Connection 'aec-students.information_schema' was properly closed.


============================== 2023-02-17 15:07:31.496810 | f0668524-9774-4ded-96e3-a2b30cac3dd4 ==============================
[0m15:07:31.496810 [info ] [MainThread]: Running with dbt=1.4.1
[0m15:07:31.499484 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
[0m15:07:31.499931 [debug] [MainThread]: Tracking: tracking
[0m15:07:31.506769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec2ec4d1b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec2ec4c3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec2ec4f2e0>]}
[0m15:07:31.511786 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
[0m15:07:31.513020 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
[0m15:07:31.514247 [info ] [MainThread]: 
[0m15:07:31.515312 [info ] [MainThread]: 
[0m15:07:31.516369 [info ] [MainThread]: Press Ctrl+C to exit.
[0m15:29:24.682309 [debug] [MainThread]: Flushing usage events
[0m15:29:25.085667 [info ] [MainThread]: ctrl-c


============================== 2023-02-17 15:30:01.234811 | 4b8a382a-a8ae-4996-a5ee-b8d8d3522aa3 ==============================
[0m15:30:01.234811 [info ] [MainThread]: Running with dbt=1.4.1
[0m15:30:01.237302 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
[0m15:30:01.237623 [debug] [MainThread]: Tracking: tracking
[0m15:30:01.242770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3231437f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3231401f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff323143850>]}
[0m15:30:01.245236 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
[0m15:30:01.245738 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
[0m15:30:01.246125 [info ] [MainThread]: 
[0m15:30:01.246474 [info ] [MainThread]: 
[0m15:30:01.246808 [info ] [MainThread]: Press Ctrl+C to exit.
[0m15:30:56.481657 [debug] [MainThread]: Flushing usage events
[0m15:30:56.884760 [info ] [MainThread]: ctrl-c


============================== 2023-02-17 15:31:20.171003 | 2abb7a7c-8ecb-4f6f-b3d7-0b808dc681f2 ==============================
[0m15:31:20.171003 [info ] [MainThread]: Running with dbt=1.4.1
[0m15:31:20.173676 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
[0m15:31:20.174100 [debug] [MainThread]: Tracking: tracking
[0m15:31:20.177431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f490e061390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f490e060610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f490e061150>]}
[0m15:31:20.227573 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:31:20.228396 [debug] [MainThread]: Partial parsing: updated file: coffee_shop://models/schema.yml
[0m15:31:20.246488 [debug] [MainThread]: 1699: static parser successfully parsed customers_ref.sql
[0m15:31:20.291023 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffe_shop_milan.example
[0m15:31:20.298269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2abb7a7c-8ecb-4f6f-b3d7-0b808dc681f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f490e02f550>]}
[0m15:31:20.359290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2abb7a7c-8ecb-4f6f-b3d7-0b808dc681f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f490e391ea0>]}
[0m15:31:20.359870 [info ] [MainThread]: Found 4 models, 9 tests, 0 snapshots, 0 analyses, 334 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m15:31:20.360566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2abb7a7c-8ecb-4f6f-b3d7-0b808dc681f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4910835ae0>]}
[0m15:31:20.362703 [info ] [MainThread]: 
[0m15:31:20.365104 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:31:20.366548 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_milan'
[0m15:31:20.366972 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:31:21.635938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2abb7a7c-8ecb-4f6f-b3d7-0b808dc681f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f490e47c790>]}
[0m15:31:21.636983 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m15:31:21.637830 [info ] [MainThread]: 
[0m15:31:21.642841 [debug] [Thread-1 (]: Began running node model.coffee_shop.customers
[0m15:31:21.643777 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop.customers'
[0m15:31:21.644181 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.customers
[0m15:31:21.648279 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.customers"
[0m15:31:21.648769 [debug] [Thread-2 (]: Began running node model.coffee_shop.my_first_dbt_model
[0m15:31:21.649894 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.coffee_shop.my_first_dbt_model'
[0m15:31:21.650429 [debug] [Thread-2 (]: Began compiling node model.coffee_shop.my_first_dbt_model
[0m15:31:21.654404 [debug] [Thread-2 (]: Writing injected SQL for node "model.coffee_shop.my_first_dbt_model"
[0m15:31:21.655492 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (compile): 2023-02-17 15:31:21.644442 => 2023-02-17 15:31:21.655366
[0m15:31:21.655811 [debug] [Thread-2 (]: Timing info for model.coffee_shop.my_first_dbt_model (compile): 2023-02-17 15:31:21.650672 => 2023-02-17 15:31:21.655747
[0m15:31:21.656074 [debug] [Thread-1 (]: Began executing node model.coffee_shop.customers
[0m15:31:21.656379 [debug] [Thread-2 (]: Began executing node model.coffee_shop.my_first_dbt_model
[0m15:31:21.656701 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (execute): 2023-02-17 15:31:21.656639 => 2023-02-17 15:31:21.656655
[0m15:31:21.656954 [debug] [Thread-2 (]: Timing info for model.coffee_shop.my_first_dbt_model (execute): 2023-02-17 15:31:21.656894 => 2023-02-17 15:31:21.656903
[0m15:31:21.658814 [debug] [Thread-1 (]: Finished running node model.coffee_shop.customers
[0m15:31:21.659620 [debug] [Thread-2 (]: Finished running node model.coffee_shop.my_first_dbt_model
[0m15:31:21.660394 [debug] [Thread-4 (]: Began running node model.coffee_shop.customers_ref
[0m15:31:21.660704 [debug] [Thread-5 (]: Began running node test.coffee_shop.not_null_customers_id.422908bfae
[0m15:31:21.660958 [debug] [Thread-6 (]: Began running node test.coffee_shop.unique_customers_id.70f3d3fd20
[0m15:31:21.661773 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.coffee_shop.customers_ref'
[0m15:31:21.662557 [debug] [Thread-5 (]: Acquiring new bigquery connection 'test.coffee_shop.not_null_customers_id.422908bfae'
[0m15:31:21.663001 [debug] [Thread-8 (]: Began running node model.coffee_shop.my_second_dbt_model
[0m15:31:21.663498 [debug] [Thread-3 (]: Began running node test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:31:21.663786 [debug] [Thread-1 (]: Began running node test.coffee_shop.unique_my_first_dbt_model_id.16e066b321
[0m15:31:21.664422 [debug] [Thread-6 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_customers_id.70f3d3fd20'
[0m15:31:21.664722 [debug] [Thread-4 (]: Began compiling node model.coffee_shop.customers_ref
[0m15:31:21.665024 [debug] [Thread-5 (]: Began compiling node test.coffee_shop.not_null_customers_id.422908bfae
[0m15:31:21.665592 [debug] [Thread-8 (]: Acquiring new bigquery connection 'model.coffee_shop.my_second_dbt_model'
[0m15:31:21.666190 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710'
[0m15:31:21.666748 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_my_first_dbt_model_id.16e066b321'
[0m15:31:21.667053 [debug] [Thread-6 (]: Began compiling node test.coffee_shop.unique_customers_id.70f3d3fd20
[0m15:31:21.670284 [debug] [Thread-4 (]: Writing injected SQL for node "model.coffee_shop.customers_ref"
[0m15:31:21.678409 [debug] [Thread-8 (]: Began compiling node model.coffee_shop.my_second_dbt_model
[0m15:31:21.688753 [debug] [Thread-3 (]: Began compiling node test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:31:21.691802 [debug] [Thread-5 (]: Writing injected SQL for node "test.coffee_shop.not_null_customers_id.422908bfae"
[0m15:31:21.692303 [debug] [Thread-1 (]: Began compiling node test.coffee_shop.unique_my_first_dbt_model_id.16e066b321
[0m15:31:21.699050 [debug] [Thread-6 (]: Writing injected SQL for node "test.coffee_shop.unique_customers_id.70f3d3fd20"
[0m15:31:21.702208 [debug] [Thread-8 (]: Writing injected SQL for node "model.coffee_shop.my_second_dbt_model"
[0m15:31:21.706624 [debug] [Thread-3 (]: Writing injected SQL for node "test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710"
[0m15:31:21.706911 [debug] [Thread-4 (]: Timing info for model.coffee_shop.customers_ref (compile): 2023-02-17 15:31:21.667341 => 2023-02-17 15:31:21.706842
[0m15:31:21.713275 [debug] [Thread-4 (]: Began executing node model.coffee_shop.customers_ref
[0m15:31:21.713621 [debug] [Thread-4 (]: Timing info for model.coffee_shop.customers_ref (execute): 2023-02-17 15:31:21.713547 => 2023-02-17 15:31:21.713565
[0m15:31:21.712224 [debug] [Thread-6 (]: Timing info for test.coffee_shop.unique_customers_id.70f3d3fd20 (compile): 2023-02-17 15:31:21.692543 => 2023-02-17 15:31:21.712059
[0m15:31:21.715014 [debug] [Thread-6 (]: Began executing node test.coffee_shop.unique_customers_id.70f3d3fd20
[0m15:31:21.714658 [debug] [Thread-4 (]: Finished running node model.coffee_shop.customers_ref
[0m15:31:21.711127 [debug] [Thread-1 (]: Writing injected SQL for node "test.coffee_shop.unique_my_first_dbt_model_id.16e066b321"
[0m15:31:21.711459 [debug] [Thread-5 (]: Timing info for test.coffee_shop.not_null_customers_id.422908bfae (compile): 2023-02-17 15:31:21.670611 => 2023-02-17 15:31:21.711351
[0m15:31:21.717324 [debug] [Thread-5 (]: Began executing node test.coffee_shop.not_null_customers_id.422908bfae
[0m15:31:21.717653 [debug] [Thread-5 (]: Timing info for test.coffee_shop.not_null_customers_id.422908bfae (execute): 2023-02-17 15:31:21.717576 => 2023-02-17 15:31:21.717590
[0m15:31:21.718597 [debug] [Thread-5 (]: Finished running node test.coffee_shop.not_null_customers_id.422908bfae
[0m15:31:21.716163 [debug] [Thread-2 (]: Began running node test.coffee_shop.not_null_customers_ref_email.337290571c
[0m15:31:21.719320 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.coffee_shop.not_null_customers_ref_email.337290571c'
[0m15:31:21.719630 [debug] [Thread-2 (]: Began compiling node test.coffee_shop.not_null_customers_ref_email.337290571c
[0m15:31:21.716450 [debug] [Thread-7 (]: Began running node test.coffee_shop.not_null_customers_ref_id.1480a96cf3
[0m15:31:21.724594 [debug] [Thread-7 (]: Acquiring new bigquery connection 'test.coffee_shop.not_null_customers_ref_id.1480a96cf3'
[0m15:31:21.724919 [debug] [Thread-7 (]: Began compiling node test.coffee_shop.not_null_customers_ref_id.1480a96cf3
[0m15:31:21.715281 [debug] [Thread-3 (]: Timing info for test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710 (compile): 2023-02-17 15:31:21.702661 => 2023-02-17 15:31:21.715231
[0m15:31:21.716738 [debug] [Thread-4 (]: Began running node test.coffee_shop.unique_customers_ref_id.48ce3bbab4
[0m15:31:21.712691 [debug] [Thread-8 (]: Timing info for model.coffee_shop.my_second_dbt_model (compile): 2023-02-17 15:31:21.699690 => 2023-02-17 15:31:21.712621
[0m15:31:21.730436 [debug] [Thread-8 (]: Began executing node model.coffee_shop.my_second_dbt_model
[0m15:31:21.730673 [debug] [Thread-8 (]: Timing info for model.coffee_shop.my_second_dbt_model (execute): 2023-02-17 15:31:21.730610 => 2023-02-17 15:31:21.730623
[0m15:31:21.729051 [debug] [Thread-7 (]: Writing injected SQL for node "test.coffee_shop.not_null_customers_ref_id.1480a96cf3"
[0m15:31:21.731786 [debug] [Thread-7 (]: Timing info for test.coffee_shop.not_null_customers_ref_id.1480a96cf3 (compile): 2023-02-17 15:31:21.725110 => 2023-02-17 15:31:21.731718
[0m15:31:21.729538 [debug] [Thread-3 (]: Began executing node test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:31:21.730134 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_customers_ref_id.48ce3bbab4'
[0m15:31:21.731274 [debug] [Thread-8 (]: Finished running node model.coffee_shop.my_second_dbt_model
[0m15:31:21.723867 [debug] [Thread-2 (]: Writing injected SQL for node "test.coffee_shop.not_null_customers_ref_email.337290571c"
[0m15:31:21.733703 [debug] [Thread-2 (]: Timing info for test.coffee_shop.not_null_customers_ref_email.337290571c (compile): 2023-02-17 15:31:21.719800 => 2023-02-17 15:31:21.733633
[0m15:31:21.734138 [debug] [Thread-2 (]: Began executing node test.coffee_shop.not_null_customers_ref_email.337290571c
[0m15:31:21.734510 [debug] [Thread-2 (]: Timing info for test.coffee_shop.not_null_customers_ref_email.337290571c (execute): 2023-02-17 15:31:21.734451 => 2023-02-17 15:31:21.734462
[0m15:31:21.732411 [debug] [Thread-3 (]: Timing info for test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710 (execute): 2023-02-17 15:31:21.732358 => 2023-02-17 15:31:21.732367
[0m15:31:21.737352 [debug] [Thread-3 (]: Finished running node test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:31:21.717932 [debug] [Thread-1 (]: Timing info for test.coffee_shop.unique_my_first_dbt_model_id.16e066b321 (compile): 2023-02-17 15:31:21.707444 => 2023-02-17 15:31:21.717884
[0m15:31:21.738059 [debug] [Thread-1 (]: Began executing node test.coffee_shop.unique_my_first_dbt_model_id.16e066b321
[0m15:31:21.738471 [debug] [Thread-1 (]: Timing info for test.coffee_shop.unique_my_first_dbt_model_id.16e066b321 (execute): 2023-02-17 15:31:21.738398 => 2023-02-17 15:31:21.738410
[0m15:31:21.739484 [debug] [Thread-1 (]: Finished running node test.coffee_shop.unique_my_first_dbt_model_id.16e066b321
[0m15:31:21.736238 [debug] [Thread-5 (]: Began running node test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778
[0m15:31:21.736521 [debug] [Thread-8 (]: Began running node test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493
[0m15:31:21.745950 [debug] [Thread-8 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493'
[0m15:31:21.715545 [debug] [Thread-6 (]: Timing info for test.coffee_shop.unique_customers_id.70f3d3fd20 (execute): 2023-02-17 15:31:21.715481 => 2023-02-17 15:31:21.715492
[0m15:31:21.732688 [debug] [Thread-4 (]: Began compiling node test.coffee_shop.unique_customers_ref_id.48ce3bbab4
[0m15:31:21.755270 [debug] [Thread-4 (]: Writing injected SQL for node "test.coffee_shop.unique_customers_ref_id.48ce3bbab4"
[0m15:31:21.746589 [debug] [Thread-8 (]: Began compiling node test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493
[0m15:31:21.747575 [debug] [Thread-6 (]: Finished running node test.coffee_shop.unique_customers_id.70f3d3fd20
[0m15:31:21.732093 [debug] [Thread-7 (]: Began executing node test.coffee_shop.not_null_customers_ref_id.1480a96cf3
[0m15:31:21.762204 [debug] [Thread-7 (]: Timing info for test.coffee_shop.not_null_customers_ref_id.1480a96cf3 (execute): 2023-02-17 15:31:21.761974 => 2023-02-17 15:31:21.762123
[0m15:31:21.763101 [debug] [Thread-7 (]: Finished running node test.coffee_shop.not_null_customers_ref_id.1480a96cf3
[0m15:31:21.735760 [debug] [Thread-2 (]: Finished running node test.coffee_shop.not_null_customers_ref_email.337290571c
[0m15:31:21.744259 [debug] [Thread-5 (]: Acquiring new bigquery connection 'test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778'
[0m15:31:21.762436 [debug] [Thread-4 (]: Timing info for test.coffee_shop.unique_customers_ref_id.48ce3bbab4 (compile): 2023-02-17 15:31:21.749064 => 2023-02-17 15:31:21.762388
[0m15:31:21.763778 [debug] [Thread-5 (]: Began compiling node test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778
[0m15:31:21.761331 [debug] [Thread-8 (]: Writing injected SQL for node "test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493"
[0m15:31:21.769867 [debug] [Thread-8 (]: Timing info for test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493 (compile): 2023-02-17 15:31:21.755878 => 2023-02-17 15:31:21.769781
[0m15:31:21.769296 [debug] [Thread-5 (]: Writing injected SQL for node "test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778"
[0m15:31:21.770211 [debug] [Thread-8 (]: Began executing node test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493
[0m15:31:21.764084 [debug] [Thread-4 (]: Began executing node test.coffee_shop.unique_customers_ref_id.48ce3bbab4
[0m15:31:21.771075 [debug] [Thread-4 (]: Timing info for test.coffee_shop.unique_customers_ref_id.48ce3bbab4 (execute): 2023-02-17 15:31:21.771010 => 2023-02-17 15:31:21.771020
[0m15:31:21.772028 [debug] [Thread-4 (]: Finished running node test.coffee_shop.unique_customers_ref_id.48ce3bbab4
[0m15:31:21.770771 [debug] [Thread-8 (]: Timing info for test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493 (execute): 2023-02-17 15:31:21.770702 => 2023-02-17 15:31:21.770718
[0m15:31:21.772885 [debug] [Thread-8 (]: Finished running node test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493
[0m15:31:21.771338 [debug] [Thread-5 (]: Timing info for test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778 (compile): 2023-02-17 15:31:21.764336 => 2023-02-17 15:31:21.771293
[0m15:31:21.773364 [debug] [Thread-5 (]: Began executing node test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778
[0m15:31:21.773604 [debug] [Thread-5 (]: Timing info for test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778 (execute): 2023-02-17 15:31:21.773539 => 2023-02-17 15:31:21.773549
[0m15:31:21.774235 [debug] [Thread-5 (]: Finished running node test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778
[0m15:31:21.775600 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:31:21.775852 [debug] [MainThread]: Connection 'test.coffee_shop.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m15:31:21.776030 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_customers_ref_email.337290571c' was properly closed.
[0m15:31:21.776188 [debug] [MainThread]: Connection 'test.coffee_shop.unique_customers_ref_id.48ce3bbab4' was properly closed.
[0m15:31:21.776339 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
[0m15:31:21.776488 [debug] [MainThread]: Connection 'test.coffee_shop.unique_customers_id.70f3d3fd20' was properly closed.
[0m15:31:21.776636 [debug] [MainThread]: Connection 'test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m15:31:21.776799 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m15:31:21.776950 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_customers_ref_id.1480a96cf3' was properly closed.
[0m15:31:21.777590 [debug] [MainThread]: Command end result
[0m15:31:21.785106 [info ] [MainThread]: Done.
[0m15:31:21.793632 [debug] [MainThread]: Acquiring new bigquery connection 'generate_catalog'
[0m15:31:21.794000 [info ] [MainThread]: Building catalog
[0m15:31:21.795238 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:31:22.094305 [debug] [ThreadPool]: Acquiring new bigquery connection 'aec-students.information_schema'
[0m15:31:22.109791 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:31:22.110673 [debug] [ThreadPool]: On aec-students.information_schema: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "connection_name": "aec-students.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `aec-students`.`dbt_milan`.__TABLES__
        where (upper(dataset_id) = upper('dbt_milan'))
    ),

    table_options as (
        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            JSON_VALUE(option_value) as table_comment

        from `aec-students`.`dbt_milan`.INFORMATION_SCHEMA.TABLE_OPTIONS
        where option_name = 'description'
    ),
    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `aec-students`.`dbt_milan`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `aec-students`.`dbt_milan`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,
        table_options.table_comment,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join table_options using (relation_id)
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
[0m15:31:24.819495 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:baf83c73-3180-4ae8-8ffd-54ac4fb4aa30&page=queryresults
[0m15:31:24.837191 [info ] [MainThread]: Catalog written to /workspaces/ae-club-milan/coffe_shop_milan/target/catalog.json
[0m15:31:24.838127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f490d97b3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f490d97ad10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f490d9663b0>]}
[0m15:31:24.838638 [debug] [MainThread]: Flushing usage events
[0m15:31:25.238414 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m15:31:25.239173 [debug] [MainThread]: Connection 'aec-students.information_schema' was properly closed.


============================== 2023-02-17 15:31:32.581557 | 38e1f2c1-9110-4b66-8f4c-6f64a5966b21 ==============================
[0m15:31:32.581557 [info ] [MainThread]: Running with dbt=1.4.1
[0m15:31:32.584675 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
[0m15:31:32.585192 [debug] [MainThread]: Tracking: tracking
[0m15:31:32.590389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f175eee8dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f175b55aa70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f175b55b730>]}
[0m15:31:32.595860 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
[0m15:31:32.596396 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
[0m15:31:32.596919 [info ] [MainThread]: 
[0m15:31:32.597488 [info ] [MainThread]: 
[0m15:31:32.597981 [info ] [MainThread]: Press Ctrl+C to exit.
[0m15:41:21.787631 [debug] [MainThread]: Flushing usage events
[0m15:41:22.238098 [info ] [MainThread]: ctrl-c


============================== 2023-02-17 15:41:31.103456 | ef1230f4-8436-4380-b618-32f53c6413cc ==============================
[0m15:41:31.103456 [info ] [MainThread]: Running with dbt=1.4.1
[0m15:41:31.107847 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
[0m15:41:31.108336 [debug] [MainThread]: Tracking: tracking
[0m15:41:31.110236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ce1c6b700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ce1c69a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ce1c6b730>]}
[0m15:41:31.169982 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m15:41:31.170676 [debug] [MainThread]: Partial parsing: updated file: coffee_shop://models/schema.yml
[0m15:41:31.171147 [debug] [MainThread]: Partial parsing: updated file: coffee_shop://models/customers_ref.sql
[0m15:41:31.184824 [debug] [MainThread]: 1699: static parser successfully parsed customers_ref.sql
[0m15:41:31.304221 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffe_shop_milan.example
[0m15:41:31.310316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ef1230f4-8436-4380-b618-32f53c6413cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ce1c1ec80>]}
[0m15:41:31.319171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ef1230f4-8436-4380-b618-32f53c6413cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ce1c0be50>]}
[0m15:41:31.319713 [info ] [MainThread]: Found 4 models, 12 tests, 0 snapshots, 0 analyses, 334 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m15:41:31.320180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef1230f4-8436-4380-b618-32f53c6413cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ce1bfbf40>]}
[0m15:41:31.322247 [info ] [MainThread]: 
[0m15:41:31.324509 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:41:31.325886 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_milan'
[0m15:41:31.326340 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:41:32.492441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef1230f4-8436-4380-b618-32f53c6413cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ce1c0b880>]}
[0m15:41:32.493297 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m15:41:32.493929 [info ] [MainThread]: 
[0m15:41:32.499485 [debug] [Thread-1 (]: Began running node model.coffee_shop.customers
[0m15:41:32.499854 [debug] [Thread-2 (]: Began running node model.coffee_shop.customers_ref
[0m15:41:32.501972 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.coffee_shop.customers_ref'
[0m15:41:32.502244 [debug] [Thread-2 (]: Began compiling node model.coffee_shop.customers_ref
[0m15:41:32.500507 [debug] [Thread-5 (]: Began running node test.coffee_shop.source_unique_coffee_shop_customers_.40a2aff259
[0m15:41:32.500716 [debug] [Thread-6 (]: Began running node test.coffee_shop.source_unique_coffee_shop_customers_id.33a28346d5
[0m15:41:32.501362 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop.customers'
[0m15:41:32.509736 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.customers
[0m15:41:32.500305 [debug] [Thread-4 (]: Began running node test.coffee_shop.source_not_null_coffee_shop_customers_id.d265e0f7a0
[0m15:41:32.513455 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.coffee_shop.source_not_null_coffee_shop_customers_id.d265e0f7a0'
[0m15:41:32.508502 [debug] [Thread-5 (]: Acquiring new bigquery connection 'test.coffee_shop.source_unique_coffee_shop_customers_.40a2aff259'
[0m15:41:32.507326 [debug] [Thread-2 (]: Writing injected SQL for node "model.coffee_shop.customers_ref"
[0m15:41:32.514585 [debug] [Thread-2 (]: Timing info for model.coffee_shop.customers_ref (compile): 2023-02-17 15:41:32.502529 => 2023-02-17 15:41:32.514500
[0m15:41:32.512668 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.customers"
[0m15:41:32.513764 [debug] [Thread-4 (]: Began compiling node test.coffee_shop.source_not_null_coffee_shop_customers_id.d265e0f7a0
[0m15:41:32.514074 [debug] [Thread-5 (]: Began compiling node test.coffee_shop.source_unique_coffee_shop_customers_.40a2aff259
[0m15:41:32.509327 [debug] [Thread-6 (]: Acquiring new bigquery connection 'test.coffee_shop.source_unique_coffee_shop_customers_id.33a28346d5'
[0m15:41:32.535304 [debug] [Thread-6 (]: Began compiling node test.coffee_shop.source_unique_coffee_shop_customers_id.33a28346d5
[0m15:41:32.500093 [debug] [Thread-3 (]: Began running node model.coffee_shop.my_first_dbt_model
[0m15:41:32.551274 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.coffee_shop.my_first_dbt_model'
[0m15:41:32.551849 [debug] [Thread-3 (]: Began compiling node model.coffee_shop.my_first_dbt_model
[0m15:41:32.536118 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (compile): 2023-02-17 15:41:32.509923 => 2023-02-17 15:41:32.536018
[0m15:41:32.557486 [debug] [Thread-1 (]: Began executing node model.coffee_shop.customers
[0m15:41:32.557978 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (execute): 2023-02-17 15:41:32.557873 => 2023-02-17 15:41:32.557897
[0m15:41:32.514892 [debug] [Thread-2 (]: Began executing node model.coffee_shop.customers_ref
[0m15:41:32.560621 [debug] [Thread-1 (]: Finished running node model.coffee_shop.customers
[0m15:41:32.556223 [debug] [Thread-3 (]: Writing injected SQL for node "model.coffee_shop.my_first_dbt_model"
[0m15:41:32.556995 [debug] [Thread-6 (]: Writing injected SQL for node "test.coffee_shop.source_unique_coffee_shop_customers_id.33a28346d5"
[0m15:41:32.550230 [debug] [Thread-5 (]: Writing injected SQL for node "test.coffee_shop.source_unique_coffee_shop_customers_.40a2aff259"
[0m15:41:32.561093 [debug] [Thread-2 (]: Timing info for model.coffee_shop.customers_ref (execute): 2023-02-17 15:41:32.561002 => 2023-02-17 15:41:32.561016
[0m15:41:32.567236 [debug] [Thread-2 (]: Finished running node model.coffee_shop.customers_ref
[0m15:41:32.565515 [debug] [Thread-8 (]: Began running node test.coffee_shop.not_null_customers_id.422908bfae
[0m15:41:32.565940 [debug] [Thread-7 (]: Began running node test.coffee_shop.unique_customers_id.70f3d3fd20
[0m15:41:32.570361 [debug] [Thread-7 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_customers_id.70f3d3fd20'
[0m15:41:32.571099 [debug] [Thread-7 (]: Began compiling node test.coffee_shop.unique_customers_id.70f3d3fd20
[0m15:41:32.569413 [debug] [Thread-1 (]: Began running node test.coffee_shop.not_null_customers_ref_email.337290571c
[0m15:41:32.580142 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.coffee_shop.not_null_customers_ref_email.337290571c'
[0m15:41:32.581456 [debug] [Thread-1 (]: Began compiling node test.coffee_shop.not_null_customers_ref_email.337290571c
[0m15:41:32.564485 [debug] [Thread-4 (]: Writing injected SQL for node "test.coffee_shop.source_not_null_coffee_shop_customers_id.d265e0f7a0"
[0m15:41:32.570815 [debug] [Thread-2 (]: Began running node test.coffee_shop.not_null_customers_ref_id.1480a96cf3
[0m15:41:32.589365 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.coffee_shop.not_null_customers_ref_id.1480a96cf3'
[0m15:41:32.590354 [debug] [Thread-2 (]: Began compiling node test.coffee_shop.not_null_customers_ref_id.1480a96cf3
[0m15:41:32.568942 [debug] [Thread-8 (]: Acquiring new bigquery connection 'test.coffee_shop.not_null_customers_id.422908bfae'
[0m15:41:32.597169 [debug] [Thread-8 (]: Began compiling node test.coffee_shop.not_null_customers_id.422908bfae
[0m15:41:32.581776 [debug] [Thread-3 (]: Timing info for model.coffee_shop.my_first_dbt_model (compile): 2023-02-17 15:41:32.552208 => 2023-02-17 15:41:32.581717
[0m15:41:32.580757 [debug] [Thread-6 (]: Timing info for test.coffee_shop.source_unique_coffee_shop_customers_id.33a28346d5 (compile): 2023-02-17 15:41:32.536396 => 2023-02-17 15:41:32.580667
[0m15:41:32.605363 [debug] [Thread-6 (]: Began executing node test.coffee_shop.source_unique_coffee_shop_customers_id.33a28346d5
[0m15:41:32.589993 [debug] [Thread-4 (]: Timing info for test.coffee_shop.source_not_null_coffee_shop_customers_id.d265e0f7a0 (compile): 2023-02-17 15:41:32.515209 => 2023-02-17 15:41:32.589851
[0m15:41:32.579162 [debug] [Thread-7 (]: Writing injected SQL for node "test.coffee_shop.unique_customers_id.70f3d3fd20"
[0m15:41:32.606349 [debug] [Thread-7 (]: Timing info for test.coffee_shop.unique_customers_id.70f3d3fd20 (compile): 2023-02-17 15:41:32.571372 => 2023-02-17 15:41:32.606276
[0m15:41:32.606697 [debug] [Thread-7 (]: Began executing node test.coffee_shop.unique_customers_id.70f3d3fd20
[0m15:41:32.606960 [debug] [Thread-7 (]: Timing info for test.coffee_shop.unique_customers_id.70f3d3fd20 (execute): 2023-02-17 15:41:32.606876 => 2023-02-17 15:41:32.606904
[0m15:41:32.605037 [debug] [Thread-3 (]: Began executing node model.coffee_shop.my_first_dbt_model
[0m15:41:32.607911 [debug] [Thread-3 (]: Timing info for model.coffee_shop.my_first_dbt_model (execute): 2023-02-17 15:41:32.607860 => 2023-02-17 15:41:32.607869
[0m15:41:32.605620 [debug] [Thread-6 (]: Timing info for test.coffee_shop.source_unique_coffee_shop_customers_id.33a28346d5 (execute): 2023-02-17 15:41:32.605539 => 2023-02-17 15:41:32.605555
[0m15:41:32.605887 [debug] [Thread-4 (]: Began executing node test.coffee_shop.source_not_null_coffee_shop_customers_id.d265e0f7a0
[0m15:41:32.609409 [debug] [Thread-4 (]: Timing info for test.coffee_shop.source_not_null_coffee_shop_customers_id.d265e0f7a0 (execute): 2023-02-17 15:41:32.609360 => 2023-02-17 15:41:32.609369
[0m15:41:32.609957 [debug] [Thread-4 (]: Finished running node test.coffee_shop.source_not_null_coffee_shop_customers_id.d265e0f7a0
[0m15:41:32.607640 [debug] [Thread-7 (]: Finished running node test.coffee_shop.unique_customers_id.70f3d3fd20
[0m15:41:32.604676 [debug] [Thread-8 (]: Writing injected SQL for node "test.coffee_shop.not_null_customers_id.422908bfae"
[0m15:41:32.608494 [debug] [Thread-3 (]: Finished running node model.coffee_shop.my_first_dbt_model
[0m15:41:32.581128 [debug] [Thread-5 (]: Timing info for test.coffee_shop.source_unique_coffee_shop_customers_.40a2aff259 (compile): 2023-02-17 15:41:32.524114 => 2023-02-17 15:41:32.581060
[0m15:41:32.611212 [debug] [Thread-5 (]: Began executing node test.coffee_shop.source_unique_coffee_shop_customers_.40a2aff259
[0m15:41:32.610274 [debug] [Thread-4 (]: Began running node test.coffee_shop.unique_customers_ref_id.48ce3bbab4
[0m15:41:32.613397 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_customers_ref_id.48ce3bbab4'
[0m15:41:32.603746 [debug] [Thread-2 (]: Writing injected SQL for node "test.coffee_shop.not_null_customers_ref_id.1480a96cf3"
[0m15:41:32.609156 [debug] [Thread-6 (]: Finished running node test.coffee_shop.source_unique_coffee_shop_customers_id.33a28346d5
[0m15:41:32.614604 [debug] [Thread-6 (]: Began running node test.coffee_shop.unique_my_first_dbt_model_id.16e066b321
[0m15:41:32.611825 [debug] [Thread-3 (]: Began running node test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:41:32.612401 [debug] [Thread-8 (]: Timing info for test.coffee_shop.not_null_customers_id.422908bfae (compile): 2023-02-17 15:41:32.597497 => 2023-02-17 15:41:32.612317
[0m15:41:32.612706 [debug] [Thread-5 (]: Timing info for test.coffee_shop.source_unique_coffee_shop_customers_.40a2aff259 (execute): 2023-02-17 15:41:32.612654 => 2023-02-17 15:41:32.612664
[0m15:41:32.613685 [debug] [Thread-4 (]: Began compiling node test.coffee_shop.unique_customers_ref_id.48ce3bbab4
[0m15:41:32.621508 [debug] [Thread-4 (]: Writing injected SQL for node "test.coffee_shop.unique_customers_ref_id.48ce3bbab4"
[0m15:41:32.611565 [debug] [Thread-7 (]: Began running node model.coffee_shop.my_second_dbt_model
[0m15:41:32.615289 [debug] [Thread-6 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_my_first_dbt_model_id.16e066b321'
[0m15:41:32.622673 [debug] [Thread-6 (]: Began compiling node test.coffee_shop.unique_my_first_dbt_model_id.16e066b321
[0m15:41:32.615847 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710'
[0m15:41:32.616973 [debug] [Thread-5 (]: Finished running node test.coffee_shop.source_unique_coffee_shop_customers_.40a2aff259
[0m15:41:32.617184 [debug] [Thread-2 (]: Timing info for test.coffee_shop.not_null_customers_ref_id.1480a96cf3 (compile): 2023-02-17 15:41:32.590712 => 2023-02-17 15:41:32.617144
[0m15:41:32.596598 [debug] [Thread-1 (]: Writing injected SQL for node "test.coffee_shop.not_null_customers_ref_email.337290571c"
[0m15:41:32.628602 [debug] [Thread-1 (]: Timing info for test.coffee_shop.not_null_customers_ref_email.337290571c (compile): 2023-02-17 15:41:32.581935 => 2023-02-17 15:41:32.628532
[0m15:41:32.628899 [debug] [Thread-1 (]: Began executing node test.coffee_shop.not_null_customers_ref_email.337290571c
[0m15:41:32.629133 [debug] [Thread-1 (]: Timing info for test.coffee_shop.not_null_customers_ref_email.337290571c (execute): 2023-02-17 15:41:32.629067 => 2023-02-17 15:41:32.629081
[0m15:41:32.629766 [debug] [Thread-1 (]: Finished running node test.coffee_shop.not_null_customers_ref_email.337290571c
[0m15:41:32.627202 [debug] [Thread-3 (]: Began compiling node test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:41:32.628158 [debug] [Thread-2 (]: Began executing node test.coffee_shop.not_null_customers_ref_id.1480a96cf3
[0m15:41:32.636577 [debug] [Thread-2 (]: Timing info for test.coffee_shop.not_null_customers_ref_id.1480a96cf3 (execute): 2023-02-17 15:41:32.636486 => 2023-02-17 15:41:32.636503
[0m15:41:32.637567 [debug] [Thread-2 (]: Finished running node test.coffee_shop.not_null_customers_ref_id.1480a96cf3
[0m15:41:32.636005 [debug] [Thread-3 (]: Writing injected SQL for node "test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710"
[0m15:41:32.616183 [debug] [Thread-8 (]: Began executing node test.coffee_shop.not_null_customers_id.422908bfae
[0m15:41:32.639791 [debug] [Thread-8 (]: Timing info for test.coffee_shop.not_null_customers_id.422908bfae (execute): 2023-02-17 15:41:32.639687 => 2023-02-17 15:41:32.639703
[0m15:41:32.627620 [debug] [Thread-4 (]: Timing info for test.coffee_shop.unique_customers_ref_id.48ce3bbab4 (compile): 2023-02-17 15:41:32.617369 => 2023-02-17 15:41:32.627558
[0m15:41:32.641710 [debug] [Thread-4 (]: Began executing node test.coffee_shop.unique_customers_ref_id.48ce3bbab4
[0m15:41:32.642138 [debug] [Thread-4 (]: Timing info for test.coffee_shop.unique_customers_ref_id.48ce3bbab4 (execute): 2023-02-17 15:41:32.642066 => 2023-02-17 15:41:32.642078
[0m15:41:32.643026 [debug] [Thread-4 (]: Finished running node test.coffee_shop.unique_customers_ref_id.48ce3bbab4
[0m15:41:32.643576 [debug] [Thread-3 (]: Timing info for test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710 (compile): 2023-02-17 15:41:32.630160 => 2023-02-17 15:41:32.643509
[0m15:41:32.644211 [debug] [Thread-3 (]: Began executing node test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:41:32.644650 [debug] [Thread-3 (]: Timing info for test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710 (execute): 2023-02-17 15:41:32.644571 => 2023-02-17 15:41:32.644584
[0m15:41:32.645719 [debug] [Thread-3 (]: Finished running node test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:41:32.641164 [debug] [Thread-8 (]: Finished running node test.coffee_shop.not_null_customers_id.422908bfae
[0m15:41:32.626744 [debug] [Thread-6 (]: Writing injected SQL for node "test.coffee_shop.unique_my_first_dbt_model_id.16e066b321"
[0m15:41:32.622302 [debug] [Thread-7 (]: Acquiring new bigquery connection 'model.coffee_shop.my_second_dbt_model'
[0m15:41:32.647990 [debug] [Thread-7 (]: Began compiling node model.coffee_shop.my_second_dbt_model
[0m15:41:32.648291 [debug] [Thread-6 (]: Timing info for test.coffee_shop.unique_my_first_dbt_model_id.16e066b321 (compile): 2023-02-17 15:41:32.622937 => 2023-02-17 15:41:32.648218
[0m15:41:32.655551 [debug] [Thread-7 (]: Writing injected SQL for node "model.coffee_shop.my_second_dbt_model"
[0m15:41:32.656000 [debug] [Thread-6 (]: Began executing node test.coffee_shop.unique_my_first_dbt_model_id.16e066b321
[0m15:41:32.656504 [debug] [Thread-6 (]: Timing info for test.coffee_shop.unique_my_first_dbt_model_id.16e066b321 (execute): 2023-02-17 15:41:32.656394 => 2023-02-17 15:41:32.656410
[0m15:41:32.657253 [debug] [Thread-6 (]: Finished running node test.coffee_shop.unique_my_first_dbt_model_id.16e066b321
[0m15:41:32.657742 [debug] [Thread-7 (]: Timing info for model.coffee_shop.my_second_dbt_model (compile): 2023-02-17 15:41:32.651680 => 2023-02-17 15:41:32.657685
[0m15:41:32.658066 [debug] [Thread-7 (]: Began executing node model.coffee_shop.my_second_dbt_model
[0m15:41:32.658345 [debug] [Thread-7 (]: Timing info for model.coffee_shop.my_second_dbt_model (execute): 2023-02-17 15:41:32.658295 => 2023-02-17 15:41:32.658304
[0m15:41:32.659021 [debug] [Thread-7 (]: Finished running node model.coffee_shop.my_second_dbt_model
[0m15:41:32.659784 [debug] [Thread-5 (]: Began running node test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778
[0m15:41:32.660776 [debug] [Thread-5 (]: Acquiring new bigquery connection 'test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778'
[0m15:41:32.661096 [debug] [Thread-5 (]: Began compiling node test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778
[0m15:41:32.667492 [debug] [Thread-5 (]: Writing injected SQL for node "test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778"
[0m15:41:32.668566 [debug] [Thread-5 (]: Timing info for test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778 (compile): 2023-02-17 15:41:32.661289 => 2023-02-17 15:41:32.668489
[0m15:41:32.668883 [debug] [Thread-5 (]: Began executing node test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778
[0m15:41:32.669119 [debug] [Thread-5 (]: Timing info for test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778 (execute): 2023-02-17 15:41:32.669053 => 2023-02-17 15:41:32.669068
[0m15:41:32.669766 [debug] [Thread-5 (]: Finished running node test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778
[0m15:41:32.667872 [debug] [Thread-1 (]: Began running node test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493
[0m15:41:32.670527 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493'
[0m15:41:32.670862 [debug] [Thread-1 (]: Began compiling node test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493
[0m15:41:32.674903 [debug] [Thread-1 (]: Writing injected SQL for node "test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493"
[0m15:41:32.675571 [debug] [Thread-1 (]: Timing info for test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493 (compile): 2023-02-17 15:41:32.671113 => 2023-02-17 15:41:32.675484
[0m15:41:32.675949 [debug] [Thread-1 (]: Began executing node test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493
[0m15:41:32.676245 [debug] [Thread-1 (]: Timing info for test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493 (execute): 2023-02-17 15:41:32.676190 => 2023-02-17 15:41:32.676201
[0m15:41:32.676904 [debug] [Thread-1 (]: Finished running node test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493
[0m15:41:32.678324 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:41:32.678583 [debug] [MainThread]: Connection 'test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m15:41:32.678793 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_customers_ref_id.1480a96cf3' was properly closed.
[0m15:41:32.678980 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
[0m15:41:32.679158 [debug] [MainThread]: Connection 'test.coffee_shop.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m15:41:32.679333 [debug] [MainThread]: Connection 'test.coffee_shop.unique_customers_ref_id.48ce3bbab4' was properly closed.
[0m15:41:32.679542 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m15:41:32.679722 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_customers_id.422908bfae' was properly closed.
[0m15:41:32.679896 [debug] [MainThread]: Connection 'model.coffee_shop.my_second_dbt_model' was properly closed.
[0m15:41:32.680638 [debug] [MainThread]: Command end result
[0m15:41:32.687787 [info ] [MainThread]: Done.
[0m15:41:32.694962 [debug] [MainThread]: Acquiring new bigquery connection 'generate_catalog'
[0m15:41:32.695352 [info ] [MainThread]: Building catalog
[0m15:41:32.697436 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:41:33.273892 [debug] [ThreadPool]: Acquiring new bigquery connection 'aec-students.information_schema'
[0m15:41:33.274630 [debug] [ThreadPool]: Acquiring new bigquery connection 'analytics-engineers-club.information_schema'
[0m15:41:33.290413 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:41:33.292804 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:41:33.293608 [debug] [ThreadPool]: On aec-students.information_schema: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "connection_name": "aec-students.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `aec-students`.`dbt_milan`.__TABLES__
        where (upper(dataset_id) = upper('dbt_milan'))
    ),

    table_options as (
        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            JSON_VALUE(option_value) as table_comment

        from `aec-students`.`dbt_milan`.INFORMATION_SCHEMA.TABLE_OPTIONS
        where option_name = 'description'
    ),
    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `aec-students`.`dbt_milan`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `aec-students`.`dbt_milan`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,
        table_options.table_comment,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join table_options using (relation_id)
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
[0m15:41:33.294019 [debug] [ThreadPool]: On analytics-engineers-club.information_schema: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "connection_name": "analytics-engineers-club.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `analytics-engineers-club`.`coffee_shop`.__TABLES__
        where (upper(dataset_id) = upper('coffee_shop'))
    ),

    table_options as (
        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            JSON_VALUE(option_value) as table_comment

        from `analytics-engineers-club`.`coffee_shop`.INFORMATION_SCHEMA.TABLE_OPTIONS
        where option_name = 'description'
    ),
    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `analytics-engineers-club`.`coffee_shop`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `analytics-engineers-club`.`coffee_shop`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,
        table_options.table_comment,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join table_options using (relation_id)
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
[0m15:41:35.852950 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:6ace5d8c-b3ff-4520-9e8e-3d07029dd2f7&page=queryresults
[0m15:41:35.860456 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:8a8934a4-2170-4cfb-80e1-523a043af78d&page=queryresults
[0m15:41:35.881707 [info ] [MainThread]: Catalog written to /workspaces/ae-club-milan/coffe_shop_milan/target/catalog.json
[0m15:41:35.882543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ce642a260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ce1c6acb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ce1c69810>]}
[0m15:41:35.883276 [debug] [MainThread]: Flushing usage events
[0m15:41:36.260755 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m15:41:36.261321 [debug] [MainThread]: Connection 'aec-students.information_schema' was properly closed.
[0m15:41:36.261531 [debug] [MainThread]: Connection 'analytics-engineers-club.information_schema' was properly closed.


============================== 2023-02-17 15:42:03.881210 | 539c0562-13a1-4391-8cb8-e4dbc83b3045 ==============================
[0m15:42:03.881210 [info ] [MainThread]: Running with dbt=1.4.1
[0m15:42:03.884085 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:42:03.884626 [debug] [MainThread]: Tracking: tracking
[0m15:42:03.888503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc69f9510f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc69f950430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc69f950a90>]}
[0m15:42:03.940290 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:42:03.940920 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:42:03.941946 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffe_shop_milan.example
[0m15:42:03.951283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '539c0562-13a1-4391-8cb8-e4dbc83b3045', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc69f943ee0>]}
[0m15:42:03.961997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '539c0562-13a1-4391-8cb8-e4dbc83b3045', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc69f906fe0>]}
[0m15:42:03.962690 [info ] [MainThread]: Found 4 models, 12 tests, 0 snapshots, 0 analyses, 334 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m15:42:03.963254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '539c0562-13a1-4391-8cb8-e4dbc83b3045', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc69f907040>]}
[0m15:42:03.965062 [info ] [MainThread]: 
[0m15:42:03.967151 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:42:03.968705 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m15:42:03.969214 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:42:05.127612 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_milan'
[0m15:42:05.128105 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:42:05.509226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '539c0562-13a1-4391-8cb8-e4dbc83b3045', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc69f906c20>]}
[0m15:42:05.510008 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m15:42:05.510407 [info ] [MainThread]: 
[0m15:42:05.515588 [debug] [Thread-1 (]: Began running node model.coffee_shop.customers
[0m15:42:05.516042 [debug] [Thread-2 (]: Began running node model.coffee_shop.customers_ref
[0m15:42:05.516367 [debug] [Thread-3 (]: Began running node model.coffee_shop.my_first_dbt_model
[0m15:42:05.516690 [info ] [Thread-1 (]: 1 of 4 START sql table model dbt_milan.customers ............................... [RUN]
[0m15:42:05.517456 [info ] [Thread-2 (]: 2 of 4 START sql view model dbt_milan.customers_ref ............................ [RUN]
[0m15:42:05.518493 [info ] [Thread-3 (]: 3 of 4 START sql table model dbt_milan.my_first_dbt_model ...................... [RUN]
[0m15:42:05.520918 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.coffee_shop.my_first_dbt_model'
[0m15:42:05.520217 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.coffee_shop.customers_ref'
[0m15:42:05.521187 [debug] [Thread-3 (]: Began compiling node model.coffee_shop.my_first_dbt_model
[0m15:42:05.519379 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop.customers'
[0m15:42:05.525088 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.customers
[0m15:42:05.524599 [debug] [Thread-3 (]: Writing injected SQL for node "model.coffee_shop.my_first_dbt_model"
[0m15:42:05.521508 [debug] [Thread-2 (]: Began compiling node model.coffee_shop.customers_ref
[0m15:42:05.527693 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.customers"
[0m15:42:05.531558 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (compile): 2023-02-17 15:42:05.525368 => 2023-02-17 15:42:05.531474
[0m15:42:05.530962 [debug] [Thread-2 (]: Writing injected SQL for node "model.coffee_shop.customers_ref"
[0m15:42:05.531933 [debug] [Thread-1 (]: Began executing node model.coffee_shop.customers
[0m15:42:05.528326 [debug] [Thread-3 (]: Timing info for model.coffee_shop.my_first_dbt_model (compile): 2023-02-17 15:42:05.521721 => 2023-02-17 15:42:05.528234
[0m15:42:05.540944 [debug] [Thread-3 (]: Began executing node model.coffee_shop.my_first_dbt_model
[0m15:42:05.549853 [debug] [Thread-2 (]: Timing info for model.coffee_shop.customers_ref (compile): 2023-02-17 15:42:05.528637 => 2023-02-17 15:42:05.549738
[0m15:42:05.557105 [debug] [Thread-2 (]: Began executing node model.coffee_shop.customers_ref
[0m15:42:05.579303 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:42:05.597774 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:42:05.660199 [debug] [Thread-2 (]: Writing runtime sql for node "model.coffee_shop.customers_ref"
[0m15:42:05.663276 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:42:05.664081 [debug] [Thread-2 (]: On model.coffee_shop.customers_ref: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.customers_ref"} */


  create or replace view `aec-students`.`dbt_milan`.`customers_ref`
  OPTIONS()
  as Select *
from `analytics-engineers-club`.`coffee_shop`.`customers`;


[0m15:42:06.088167 [debug] [Thread-3 (]: Writing runtime sql for node "model.coffee_shop.my_first_dbt_model"
[0m15:42:06.088862 [debug] [Thread-3 (]: On model.coffee_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.my_first_dbt_model"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`my_first_dbt_model`
    
    
    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m15:42:06.110826 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop.customers"
[0m15:42:06.111511 [debug] [Thread-1 (]: On model.coffee_shop.customers: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.customers"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`customers`
    
    
    OPTIONS()
    as (
      

select * from `analytics-engineers-club.coffee_shop.customers`
limit 9000
    );
  
[0m15:42:06.657956 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:c2606840-fc31-41e4-803e-681a78a92ab7&page=queryresults
[0m15:42:06.676049 [debug] [Thread-2 (]: Timing info for model.coffee_shop.customers_ref (execute): 2023-02-17 15:42:05.557447 => 2023-02-17 15:42:06.675983
[0m15:42:06.676896 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '539c0562-13a1-4391-8cb8-e4dbc83b3045', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc69f847dc0>]}
[0m15:42:06.677437 [info ] [Thread-2 (]: 2 of 4 OK created sql view model dbt_milan.customers_ref ....................... [[32mCREATE VIEW (0 processed)[0m in 1.16s]
[0m15:42:06.679429 [debug] [Thread-2 (]: Finished running node model.coffee_shop.customers_ref
[0m15:42:08.308548 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:9697043c-3d5d-48a8-9e93-cd1717b4fac7&page=queryresults
[0m15:42:08.310370 [debug] [Thread-3 (]: Timing info for model.coffee_shop.my_first_dbt_model (execute): 2023-02-17 15:42:05.541298 => 2023-02-17 15:42:08.310280
[0m15:42:08.311066 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '539c0562-13a1-4391-8cb8-e4dbc83b3045', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc69f802aa0>]}
[0m15:42:08.311639 [info ] [Thread-3 (]: 3 of 4 OK created sql table model dbt_milan.my_first_dbt_model ................. [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 2.79s]
[0m15:42:08.312154 [debug] [Thread-3 (]: Finished running node model.coffee_shop.my_first_dbt_model
[0m15:42:08.313027 [debug] [Thread-5 (]: Began running node model.coffee_shop.my_second_dbt_model
[0m15:42:08.313439 [info ] [Thread-5 (]: 4 of 4 START sql view model dbt_milan.my_second_dbt_model ...................... [RUN]
[0m15:42:08.314623 [debug] [Thread-5 (]: Acquiring new bigquery connection 'model.coffee_shop.my_second_dbt_model'
[0m15:42:08.314920 [debug] [Thread-5 (]: Began compiling node model.coffee_shop.my_second_dbt_model
[0m15:42:08.318258 [debug] [Thread-5 (]: Writing injected SQL for node "model.coffee_shop.my_second_dbt_model"
[0m15:42:08.319013 [debug] [Thread-5 (]: Timing info for model.coffee_shop.my_second_dbt_model (compile): 2023-02-17 15:42:08.315099 => 2023-02-17 15:42:08.318907
[0m15:42:08.319485 [debug] [Thread-5 (]: Began executing node model.coffee_shop.my_second_dbt_model
[0m15:42:08.322629 [debug] [Thread-5 (]: Writing runtime sql for node "model.coffee_shop.my_second_dbt_model"
[0m15:42:08.323287 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m15:42:08.323770 [debug] [Thread-5 (]: On model.coffee_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.my_second_dbt_model"} */


  create or replace view `aec-students`.`dbt_milan`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `aec-students`.`dbt_milan`.`my_first_dbt_model`
where id = 1;


[0m15:42:08.686610 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:4ce89272-3cc4-47fa-a106-7dd5fdfcfd7b&page=queryresults
[0m15:42:08.688610 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (execute): 2023-02-17 15:42:05.532356 => 2023-02-17 15:42:08.688546
[0m15:42:08.689387 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '539c0562-13a1-4391-8cb8-e4dbc83b3045', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc69c66d630>]}
[0m15:42:08.689922 [info ] [Thread-1 (]: 1 of 4 OK created sql table model dbt_milan.customers .......................... [[32mCREATE TABLE (9.0k rows, 12.8 MB processed)[0m in 3.17s]
[0m15:42:08.690603 [debug] [Thread-1 (]: Finished running node model.coffee_shop.customers
[0m15:42:09.118497 [debug] [Thread-5 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:ac9707e9-a3a2-4445-9d0b-7db8a785d04c&page=queryresults
[0m15:42:09.121016 [debug] [Thread-5 (]: Timing info for model.coffee_shop.my_second_dbt_model (execute): 2023-02-17 15:42:08.319758 => 2023-02-17 15:42:09.120952
[0m15:42:09.121862 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '539c0562-13a1-4391-8cb8-e4dbc83b3045', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc69f803400>]}
[0m15:42:09.122439 [info ] [Thread-5 (]: 4 of 4 OK created sql view model dbt_milan.my_second_dbt_model ................. [[32mCREATE VIEW (0 processed)[0m in 0.81s]
[0m15:42:09.123006 [debug] [Thread-5 (]: Finished running node model.coffee_shop.my_second_dbt_model
[0m15:42:09.124844 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:42:09.125458 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:42:09.125684 [debug] [MainThread]: Connection 'model.coffee_shop.customers' was properly closed.
[0m15:42:09.125899 [debug] [MainThread]: Connection 'model.coffee_shop.customers_ref' was properly closed.
[0m15:42:09.126091 [debug] [MainThread]: Connection 'model.coffee_shop.my_first_dbt_model' was properly closed.
[0m15:42:09.126283 [debug] [MainThread]: Connection 'model.coffee_shop.my_second_dbt_model' was properly closed.
[0m15:42:09.126569 [info ] [MainThread]: 
[0m15:42:09.126917 [info ] [MainThread]: Finished running 2 view models, 2 table models in 0 hours 0 minutes and 5.16 seconds (5.16s).
[0m15:42:09.129120 [debug] [MainThread]: Command end result
[0m15:42:09.141205 [info ] [MainThread]: 
[0m15:42:09.141800 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:42:09.142256 [info ] [MainThread]: 
[0m15:42:09.142669 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m15:42:09.143633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc69c65d210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc69fd6c790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc69fb37340>]}
[0m15:42:09.144411 [debug] [MainThread]: Flushing usage events


============================== 2023-02-17 15:42:16.952459 | 919fef0d-f852-4d01-8548-c7a0650ae840 ==============================
[0m15:42:16.952459 [info ] [MainThread]: Running with dbt=1.4.1
[0m15:42:16.955114 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m15:42:16.955511 [debug] [MainThread]: Tracking: tracking
[0m15:42:16.957828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3507bf4dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f350426b6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f350426b700>]}
[0m15:42:17.009919 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:42:17.010424 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:42:17.011576 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffe_shop_milan.example
[0m15:42:17.021974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '919fef0d-f852-4d01-8548-c7a0650ae840', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35040580d0>]}
[0m15:42:17.034698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '919fef0d-f852-4d01-8548-c7a0650ae840', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f350421b370>]}
[0m15:42:17.035371 [info ] [MainThread]: Found 4 models, 12 tests, 0 snapshots, 0 analyses, 334 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m15:42:17.035994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '919fef0d-f852-4d01-8548-c7a0650ae840', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3507bf4dc0>]}
[0m15:42:17.038583 [info ] [MainThread]: 
[0m15:42:17.041373 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:42:17.043293 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_milan'
[0m15:42:17.043909 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:42:18.259337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '919fef0d-f852-4d01-8548-c7a0650ae840', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3504218340>]}
[0m15:42:18.260212 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m15:42:18.260930 [info ] [MainThread]: 
[0m15:42:18.265822 [debug] [Thread-1 (]: Began running node test.coffee_shop.not_null_customers_id.422908bfae
[0m15:42:18.266160 [debug] [Thread-2 (]: Began running node test.coffee_shop.not_null_customers_ref_email.337290571c
[0m15:42:18.266503 [debug] [Thread-3 (]: Began running node test.coffee_shop.not_null_customers_ref_id.1480a96cf3
[0m15:42:18.266969 [debug] [Thread-4 (]: Began running node test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:42:18.267337 [debug] [Thread-5 (]: Began running node test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778
[0m15:42:18.267680 [debug] [Thread-6 (]: Began running node test.coffee_shop.source_not_null_coffee_shop_customers_id.d265e0f7a0
[0m15:42:18.267905 [debug] [Thread-7 (]: Began running node test.coffee_shop.source_unique_coffee_shop_customers_.40a2aff259
[0m15:42:18.268102 [debug] [Thread-8 (]: Began running node test.coffee_shop.source_unique_coffee_shop_customers_id.33a28346d5
[0m15:42:18.268521 [info ] [Thread-1 (]: 1 of 12 START test not_null_customers_id ....................................... [RUN]
[0m15:42:18.271996 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.coffee_shop.not_null_customers_id.422908bfae'
[0m15:42:18.268823 [info ] [Thread-2 (]: 2 of 12 START test not_null_customers_ref_email ................................ [RUN]
[0m15:42:18.274473 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.coffee_shop.not_null_customers_ref_email.337290571c'
[0m15:42:18.269773 [info ] [Thread-5 (]: 5 of 12 START test not_null_my_second_dbt_model_id ............................. [RUN]
[0m15:42:18.270754 [info ] [Thread-7 (]: 7 of 12 START test source_unique_coffee_shop_customers_ ........................ [RUN]
[0m15:42:18.271070 [info ] [Thread-8 (]: 8 of 12 START test source_unique_coffee_shop_customers_id ...................... [RUN]
[0m15:42:18.277275 [debug] [Thread-8 (]: Acquiring new bigquery connection 'test.coffee_shop.source_unique_coffee_shop_customers_id.33a28346d5'
[0m15:42:18.277554 [debug] [Thread-8 (]: Began compiling node test.coffee_shop.source_unique_coffee_shop_customers_id.33a28346d5
[0m15:42:18.270286 [info ] [Thread-6 (]: 6 of 12 START test source_not_null_coffee_shop_customers_id .................... [RUN]
[0m15:42:18.289315 [debug] [Thread-6 (]: Acquiring new bigquery connection 'test.coffee_shop.source_not_null_coffee_shop_customers_id.d265e0f7a0'
[0m15:42:18.289654 [debug] [Thread-6 (]: Began compiling node test.coffee_shop.source_not_null_coffee_shop_customers_id.d265e0f7a0
[0m15:42:18.276101 [debug] [Thread-5 (]: Acquiring new bigquery connection 'test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778'
[0m15:42:18.276691 [debug] [Thread-7 (]: Acquiring new bigquery connection 'test.coffee_shop.source_unique_coffee_shop_customers_.40a2aff259'
[0m15:42:18.269156 [info ] [Thread-3 (]: 3 of 12 START test not_null_customers_ref_id ................................... [RUN]
[0m15:42:18.301002 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.coffee_shop.not_null_customers_ref_id.1480a96cf3'
[0m15:42:18.273410 [debug] [Thread-1 (]: Began compiling node test.coffee_shop.not_null_customers_id.422908bfae
[0m15:42:18.269466 [info ] [Thread-4 (]: 4 of 12 START test not_null_my_first_dbt_model_id .............................. [RUN]
[0m15:42:18.274842 [debug] [Thread-2 (]: Began compiling node test.coffee_shop.not_null_customers_ref_email.337290571c
[0m15:42:18.299542 [debug] [Thread-6 (]: Writing injected SQL for node "test.coffee_shop.source_not_null_coffee_shop_customers_id.d265e0f7a0"
[0m15:42:18.300017 [debug] [Thread-5 (]: Began compiling node test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778
[0m15:42:18.300360 [debug] [Thread-7 (]: Began compiling node test.coffee_shop.source_unique_coffee_shop_customers_.40a2aff259
[0m15:42:18.288525 [debug] [Thread-8 (]: Writing injected SQL for node "test.coffee_shop.source_unique_coffee_shop_customers_id.33a28346d5"
[0m15:42:18.301296 [debug] [Thread-3 (]: Began compiling node test.coffee_shop.not_null_customers_ref_id.1480a96cf3
[0m15:42:18.305927 [debug] [Thread-1 (]: Writing injected SQL for node "test.coffee_shop.not_null_customers_id.422908bfae"
[0m15:42:18.306665 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710'
[0m15:42:18.312948 [debug] [Thread-5 (]: Writing injected SQL for node "test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778"
[0m15:42:18.318423 [debug] [Thread-7 (]: Writing injected SQL for node "test.coffee_shop.source_unique_coffee_shop_customers_.40a2aff259"
[0m15:42:18.322897 [debug] [Thread-2 (]: Writing injected SQL for node "test.coffee_shop.not_null_customers_ref_email.337290571c"
[0m15:42:18.393012 [debug] [Thread-5 (]: Timing info for test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778 (compile): 2023-02-17 15:42:18.308897 => 2023-02-17 15:42:18.392957
[0m15:42:18.391013 [debug] [Thread-3 (]: Writing injected SQL for node "test.coffee_shop.not_null_customers_ref_id.1480a96cf3"
[0m15:42:18.391605 [debug] [Thread-4 (]: Began compiling node test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:42:18.398538 [debug] [Thread-4 (]: Writing injected SQL for node "test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710"
[0m15:42:18.392444 [debug] [Thread-1 (]: Timing info for test.coffee_shop.not_null_customers_id.422908bfae (compile): 2023-02-17 15:42:18.301529 => 2023-02-17 15:42:18.392373
[0m15:42:18.386258 [debug] [Thread-8 (]: Timing info for test.coffee_shop.source_unique_coffee_shop_customers_id.33a28346d5 (compile): 2023-02-17 15:42:18.277737 => 2023-02-17 15:42:18.386031
[0m15:42:18.393430 [debug] [Thread-7 (]: Timing info for test.coffee_shop.source_unique_coffee_shop_customers_.40a2aff259 (compile): 2023-02-17 15:42:18.314267 => 2023-02-17 15:42:18.393368
[0m15:42:18.400476 [debug] [Thread-7 (]: Began executing node test.coffee_shop.source_unique_coffee_shop_customers_.40a2aff259
[0m15:42:18.393984 [debug] [Thread-2 (]: Timing info for test.coffee_shop.not_null_customers_ref_email.337290571c (compile): 2023-02-17 15:42:18.306975 => 2023-02-17 15:42:18.393942
[0m15:42:18.392017 [debug] [Thread-6 (]: Timing info for test.coffee_shop.source_not_null_coffee_shop_customers_id.d265e0f7a0 (compile): 2023-02-17 15:42:18.289835 => 2023-02-17 15:42:18.391922
[0m15:42:18.399229 [debug] [Thread-1 (]: Began executing node test.coffee_shop.not_null_customers_id.422908bfae
[0m15:42:18.399585 [debug] [Thread-3 (]: Timing info for test.coffee_shop.not_null_customers_ref_id.1480a96cf3 (compile): 2023-02-17 15:42:18.323621 => 2023-02-17 15:42:18.399515
[0m15:42:18.399947 [debug] [Thread-8 (]: Began executing node test.coffee_shop.source_unique_coffee_shop_customers_id.33a28346d5
[0m15:42:18.425241 [debug] [Thread-8 (]: Writing runtime sql for node "test.coffee_shop.source_unique_coffee_shop_customers_id.33a28346d5"
[0m15:42:18.393787 [debug] [Thread-5 (]: Began executing node test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778
[0m15:42:18.419198 [debug] [Thread-7 (]: Writing runtime sql for node "test.coffee_shop.source_unique_coffee_shop_customers_.40a2aff259"
[0m15:42:18.419658 [debug] [Thread-2 (]: Began executing node test.coffee_shop.not_null_customers_ref_email.337290571c
[0m15:42:18.420038 [debug] [Thread-6 (]: Began executing node test.coffee_shop.source_not_null_coffee_shop_customers_id.d265e0f7a0
[0m15:42:18.422457 [debug] [Thread-1 (]: Writing runtime sql for node "test.coffee_shop.not_null_customers_id.422908bfae"
[0m15:42:18.433972 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:42:18.435043 [debug] [Thread-1 (]: On test.coffee_shop.not_null_customers_id.422908bfae: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "test.coffee_shop.not_null_customers_id.422908bfae"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from `aec-students`.`dbt_milan`.`customers`
where id is null



      
    ) dbt_internal_test
[0m15:42:18.427889 [debug] [Thread-5 (]: Writing runtime sql for node "test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778"
[0m15:42:18.437355 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m15:42:18.437871 [debug] [Thread-5 (]: On test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from `aec-students`.`dbt_milan`.`my_second_dbt_model`
where id is null



      
    ) dbt_internal_test
[0m15:42:18.422887 [debug] [Thread-3 (]: Began executing node test.coffee_shop.not_null_customers_ref_id.1480a96cf3
[0m15:42:18.446547 [debug] [Thread-3 (]: Writing runtime sql for node "test.coffee_shop.not_null_customers_ref_id.1480a96cf3"
[0m15:42:18.400241 [debug] [Thread-4 (]: Timing info for test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710 (compile): 2023-02-17 15:42:18.394476 => 2023-02-17 15:42:18.400194
[0m15:42:18.447544 [debug] [Thread-4 (]: Began executing node test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:42:18.430984 [debug] [Thread-2 (]: Writing runtime sql for node "test.coffee_shop.not_null_customers_ref_email.337290571c"
[0m15:42:18.433153 [debug] [Thread-6 (]: Writing runtime sql for node "test.coffee_shop.source_not_null_coffee_shop_customers_id.d265e0f7a0"
[0m15:42:18.428805 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m15:42:18.452670 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:42:18.461026 [debug] [Thread-3 (]: On test.coffee_shop.not_null_customers_ref_id.1480a96cf3: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "test.coffee_shop.not_null_customers_ref_id.1480a96cf3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from `aec-students`.`dbt_milan`.`customers_ref`
where id is null



      
    ) dbt_internal_test
[0m15:42:18.453518 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:42:18.462654 [debug] [Thread-2 (]: On test.coffee_shop.not_null_customers_ref_email.337290571c: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "test.coffee_shop.not_null_customers_ref_email.337290571c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select email
from `aec-students`.`dbt_milan`.`customers_ref`
where email is null



      
    ) dbt_internal_test
[0m15:42:18.452228 [debug] [Thread-4 (]: Writing runtime sql for node "test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710"
[0m15:42:18.428218 [debug] [Thread-8 (]: Opening a new connection, currently in state init
[0m15:42:18.469380 [debug] [Thread-8 (]: On test.coffee_shop.source_unique_coffee_shop_customers_id.33a28346d5: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "test.coffee_shop.source_unique_coffee_shop_customers_id.33a28346d5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `analytics-engineers-club`.`coffee_shop`.`customers`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m15:42:18.459725 [debug] [Thread-6 (]: Opening a new connection, currently in state init
[0m15:42:18.468249 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:42:18.472482 [debug] [Thread-4 (]: On test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from `aec-students`.`dbt_milan`.`my_first_dbt_model`
where id is null



      
    ) dbt_internal_test
[0m15:42:18.471804 [debug] [Thread-6 (]: On test.coffee_shop.source_not_null_coffee_shop_customers_id.d265e0f7a0: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "test.coffee_shop.source_not_null_coffee_shop_customers_id.d265e0f7a0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from `analytics-engineers-club`.`coffee_shop`.`customers`
where id is null



      
    ) dbt_internal_test
[0m15:42:18.460512 [debug] [Thread-7 (]: On test.coffee_shop.source_unique_coffee_shop_customers_.40a2aff259: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "test.coffee_shop.source_unique_coffee_shop_customers_.40a2aff259"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select  as unique_field
  from `analytics-engineers-club`.`coffee_shop`.`customers`
  where  is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m15:42:19.315454 [debug] [Thread-7 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: SELECT list must not be empty at [14:3]')
[0m15:42:20.073027 [error] [Thread-7 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:19dd2067-3ca9-4339-be4a-cfb1651a60de&page=queryresults
[0m15:42:20.074018 [debug] [Thread-7 (]: Timing info for test.coffee_shop.source_unique_coffee_shop_customers_.40a2aff259 (execute): 2023-02-17 15:42:18.400641 => 2023-02-17 15:42:20.073896
[0m15:42:20.077691 [debug] [Thread-7 (]: Database Error in test source_unique_coffee_shop_customers_ (models/schema.yml)
  Syntax error: SELECT list must not be empty at [14:3]
  compiled Code at target/run/coffee_shop/models/schema.yml/source_unique_coffee_shop_customers_.sql
[0m15:42:20.078204 [error] [Thread-7 (]: 7 of 12 ERROR source_unique_coffee_shop_customers_ ............................. [[31mERROR[0m in 1.80s]
[0m15:42:20.080785 [debug] [Thread-7 (]: Finished running node test.coffee_shop.source_unique_coffee_shop_customers_.40a2aff259
[0m15:42:20.081315 [debug] [Thread-7 (]: Began running node test.coffee_shop.unique_customers_id.70f3d3fd20
[0m15:42:20.081806 [info ] [Thread-7 (]: 9 of 12 START test unique_customers_id ......................................... [RUN]
[0m15:42:20.082639 [debug] [Thread-7 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_customers_id.70f3d3fd20'
[0m15:42:20.082941 [debug] [Thread-7 (]: Began compiling node test.coffee_shop.unique_customers_id.70f3d3fd20
[0m15:42:20.087875 [debug] [Thread-7 (]: Writing injected SQL for node "test.coffee_shop.unique_customers_id.70f3d3fd20"
[0m15:42:20.088472 [debug] [Thread-7 (]: Timing info for test.coffee_shop.unique_customers_id.70f3d3fd20 (compile): 2023-02-17 15:42:20.083134 => 2023-02-17 15:42:20.088373
[0m15:42:20.088824 [debug] [Thread-7 (]: Began executing node test.coffee_shop.unique_customers_id.70f3d3fd20
[0m15:42:20.091099 [debug] [Thread-7 (]: Writing runtime sql for node "test.coffee_shop.unique_customers_id.70f3d3fd20"
[0m15:42:20.091683 [debug] [Thread-7 (]: Opening a new connection, currently in state closed
[0m15:42:20.092138 [debug] [Thread-7 (]: On test.coffee_shop.unique_customers_id.70f3d3fd20: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "test.coffee_shop.unique_customers_id.70f3d3fd20"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `aec-students`.`dbt_milan`.`customers`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m15:42:20.297198 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:502f9011-c093-49b7-b4ce-6f5f5a676bab&page=queryresults
[0m15:42:20.299079 [debug] [Thread-1 (]: Timing info for test.coffee_shop.not_null_customers_id.422908bfae (execute): 2023-02-17 15:42:18.420335 => 2023-02-17 15:42:20.298985
[0m15:42:20.299908 [info ] [Thread-1 (]: 1 of 12 PASS not_null_customers_id ............................................. [[32mPASS[0m in 2.03s]
[0m15:42:20.300664 [debug] [Thread-1 (]: Finished running node test.coffee_shop.not_null_customers_id.422908bfae
[0m15:42:20.301039 [debug] [Thread-1 (]: Began running node test.coffee_shop.unique_customers_ref_id.48ce3bbab4
[0m15:42:20.301417 [info ] [Thread-1 (]: 10 of 12 START test unique_customers_ref_id .................................... [RUN]
[0m15:42:20.302377 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_customers_ref_id.48ce3bbab4'
[0m15:42:20.302665 [debug] [Thread-1 (]: Began compiling node test.coffee_shop.unique_customers_ref_id.48ce3bbab4
[0m15:42:20.307773 [debug] [Thread-1 (]: Writing injected SQL for node "test.coffee_shop.unique_customers_ref_id.48ce3bbab4"
[0m15:42:20.308747 [debug] [Thread-5 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:fc67ea2c-b7eb-470a-ac9d-c1cfbd5a6e6b&page=queryresults
[0m15:42:20.309472 [debug] [Thread-5 (]: Timing info for test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778 (execute): 2023-02-17 15:42:18.425928 => 2023-02-17 15:42:20.309392
[0m15:42:20.310203 [info ] [Thread-5 (]: 5 of 12 PASS not_null_my_second_dbt_model_id ................................... [[32mPASS[0m in 2.03s]
[0m15:42:20.310681 [debug] [Thread-5 (]: Finished running node test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778
[0m15:42:20.311101 [debug] [Thread-5 (]: Began running node test.coffee_shop.unique_my_first_dbt_model_id.16e066b321
[0m15:42:20.311654 [info ] [Thread-5 (]: 11 of 12 START test unique_my_first_dbt_model_id ............................... [RUN]
[0m15:42:20.312558 [debug] [Thread-5 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_my_first_dbt_model_id.16e066b321'
[0m15:42:20.313289 [debug] [Thread-5 (]: Began compiling node test.coffee_shop.unique_my_first_dbt_model_id.16e066b321
[0m15:42:20.313531 [debug] [Thread-1 (]: Timing info for test.coffee_shop.unique_customers_ref_id.48ce3bbab4 (compile): 2023-02-17 15:42:20.302848 => 2023-02-17 15:42:20.313469
[0m15:42:20.319595 [debug] [Thread-5 (]: Writing injected SQL for node "test.coffee_shop.unique_my_first_dbt_model_id.16e066b321"
[0m15:42:20.320826 [debug] [Thread-6 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:88b21c98-5ea9-4bb7-9268-7c60c0e3b838&page=queryresults
[0m15:42:20.322051 [debug] [Thread-6 (]: Timing info for test.coffee_shop.source_not_null_coffee_shop_customers_id.d265e0f7a0 (execute): 2023-02-17 15:42:18.431288 => 2023-02-17 15:42:20.321984
[0m15:42:20.321140 [debug] [Thread-1 (]: Began executing node test.coffee_shop.unique_customers_ref_id.48ce3bbab4
[0m15:42:20.326229 [debug] [Thread-1 (]: Writing runtime sql for node "test.coffee_shop.unique_customers_ref_id.48ce3bbab4"
[0m15:42:20.322780 [info ] [Thread-6 (]: 6 of 12 PASS source_not_null_coffee_shop_customers_id .......................... [[32mPASS[0m in 2.03s]
[0m15:42:20.327031 [debug] [Thread-6 (]: Finished running node test.coffee_shop.source_not_null_coffee_shop_customers_id.d265e0f7a0
[0m15:42:20.327799 [debug] [Thread-6 (]: Began running node test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493
[0m15:42:20.327307 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:42:20.323491 [debug] [Thread-5 (]: Timing info for test.coffee_shop.unique_my_first_dbt_model_id.16e066b321 (compile): 2023-02-17 15:42:20.313744 => 2023-02-17 15:42:20.323382
[0m15:42:20.329320 [debug] [Thread-5 (]: Began executing node test.coffee_shop.unique_my_first_dbt_model_id.16e066b321
[0m15:42:20.328956 [debug] [Thread-1 (]: On test.coffee_shop.unique_customers_ref_id.48ce3bbab4: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "test.coffee_shop.unique_customers_ref_id.48ce3bbab4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `aec-students`.`dbt_milan`.`customers_ref`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m15:42:20.332076 [debug] [Thread-5 (]: Writing runtime sql for node "test.coffee_shop.unique_my_first_dbt_model_id.16e066b321"
[0m15:42:20.328243 [info ] [Thread-6 (]: 12 of 12 START test unique_my_second_dbt_model_id .............................. [RUN]
[0m15:42:20.352118 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:a6253720-70ea-4377-8711-2d9559b50149&page=queryresults
[0m15:42:20.354392 [debug] [Thread-2 (]: Timing info for test.coffee_shop.not_null_customers_ref_email.337290571c (execute): 2023-02-17 15:42:18.429001 => 2023-02-17 15:42:20.354289
[0m15:42:20.364476 [info ] [Thread-2 (]: 2 of 12 PASS not_null_customers_ref_email ...................................... [[32mPASS[0m in 2.09s]
[0m15:42:20.365896 [debug] [Thread-2 (]: Finished running node test.coffee_shop.not_null_customers_ref_email.337290571c
[0m15:42:20.353517 [debug] [Thread-6 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493'
[0m15:42:20.367219 [debug] [Thread-6 (]: Began compiling node test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493
[0m15:42:20.374239 [debug] [Thread-6 (]: Writing injected SQL for node "test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493"
[0m15:42:20.374930 [debug] [Thread-5 (]: Opening a new connection, currently in state closed
[0m15:42:20.375747 [debug] [Thread-5 (]: On test.coffee_shop.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "test.coffee_shop.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `aec-students`.`dbt_milan`.`my_first_dbt_model`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m15:42:20.379537 [debug] [Thread-6 (]: Timing info for test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493 (compile): 2023-02-17 15:42:20.367751 => 2023-02-17 15:42:20.379370
[0m15:42:20.380230 [debug] [Thread-6 (]: Began executing node test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493
[0m15:42:20.384505 [debug] [Thread-6 (]: Writing runtime sql for node "test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493"
[0m15:42:20.385874 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:2b9956c0-7cbb-4cd5-a525-b7604711069c&page=queryresults
[0m15:42:20.387136 [debug] [Thread-3 (]: Timing info for test.coffee_shop.not_null_customers_ref_id.1480a96cf3 (execute): 2023-02-17 15:42:18.444445 => 2023-02-17 15:42:20.386918
[0m15:42:20.388147 [info ] [Thread-3 (]: 3 of 12 PASS not_null_customers_ref_id ......................................... [[32mPASS[0m in 2.09s]
[0m15:42:20.389201 [debug] [Thread-3 (]: Finished running node test.coffee_shop.not_null_customers_ref_id.1480a96cf3
[0m15:42:20.391006 [debug] [Thread-6 (]: Opening a new connection, currently in state closed
[0m15:42:20.391706 [debug] [Thread-6 (]: On test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `aec-students`.`dbt_milan`.`my_second_dbt_model`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m15:42:20.731717 [debug] [Thread-8 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:f2e625ed-4305-4904-94e0-e80ec4601487&page=queryresults
[0m15:42:20.732528 [debug] [Thread-8 (]: Timing info for test.coffee_shop.source_unique_coffee_shop_customers_id.33a28346d5 (execute): 2023-02-17 15:42:18.423202 => 2023-02-17 15:42:20.732449
[0m15:42:20.733466 [info ] [Thread-8 (]: 8 of 12 PASS source_unique_coffee_shop_customers_id ............................ [[32mPASS[0m in 2.46s]
[0m15:42:20.734385 [debug] [Thread-8 (]: Finished running node test.coffee_shop.source_unique_coffee_shop_customers_id.33a28346d5
[0m15:42:20.743994 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:83ee0737-b348-4333-b84a-8ad4a42243c4&page=queryresults
[0m15:42:20.744946 [debug] [Thread-4 (]: Timing info for test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710 (execute): 2023-02-17 15:42:18.447866 => 2023-02-17 15:42:20.744843
[0m15:42:20.746005 [error] [Thread-4 (]: 4 of 12 FAIL 1 not_null_my_first_dbt_model_id .................................. [[31mFAIL 1[0m in 2.44s]
[0m15:42:20.747064 [debug] [Thread-4 (]: Finished running node test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:42:21.472311 [debug] [Thread-7 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:a093b9f1-cc85-4946-8b86-6d5343c39947&page=queryresults
[0m15:42:21.473094 [debug] [Thread-7 (]: Timing info for test.coffee_shop.unique_customers_id.70f3d3fd20 (execute): 2023-02-17 15:42:20.089003 => 2023-02-17 15:42:21.473013
[0m15:42:21.473905 [info ] [Thread-7 (]: 9 of 12 PASS unique_customers_id ............................................... [[32mPASS[0m in 1.39s]
[0m15:42:21.474596 [debug] [Thread-7 (]: Finished running node test.coffee_shop.unique_customers_id.70f3d3fd20
[0m15:42:21.872812 [debug] [Thread-5 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:c6f2ae85-9400-4674-80a9-1a19c5567a49&page=queryresults
[0m15:42:21.873658 [debug] [Thread-5 (]: Timing info for test.coffee_shop.unique_my_first_dbt_model_id.16e066b321 (execute): 2023-02-17 15:42:20.329566 => 2023-02-17 15:42:21.873582
[0m15:42:21.874459 [info ] [Thread-5 (]: 11 of 12 PASS unique_my_first_dbt_model_id ..................................... [[32mPASS[0m in 1.56s]
[0m15:42:21.875203 [debug] [Thread-5 (]: Finished running node test.coffee_shop.unique_my_first_dbt_model_id.16e066b321
[0m15:42:21.978474 [debug] [Thread-6 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:96ed5b2c-aa06-4bb3-bb9a-807c05a3794f&page=queryresults
[0m15:42:21.979287 [debug] [Thread-6 (]: Timing info for test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493 (execute): 2023-02-17 15:42:20.380586 => 2023-02-17 15:42:21.979211
[0m15:42:21.980160 [info ] [Thread-6 (]: 12 of 12 PASS unique_my_second_dbt_model_id .................................... [[32mPASS[0m in 1.63s]
[0m15:42:21.980948 [debug] [Thread-6 (]: Finished running node test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493
[0m15:42:22.268475 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:e4ff9d4b-8ff4-4e44-a6cc-386317a5bb76&page=queryresults
[0m15:42:22.269274 [debug] [Thread-1 (]: Timing info for test.coffee_shop.unique_customers_ref_id.48ce3bbab4 (execute): 2023-02-17 15:42:20.323888 => 2023-02-17 15:42:22.269200
[0m15:42:22.270108 [info ] [Thread-1 (]: 10 of 12 PASS unique_customers_ref_id .......................................... [[32mPASS[0m in 1.97s]
[0m15:42:22.270691 [debug] [Thread-1 (]: Finished running node test.coffee_shop.unique_customers_ref_id.48ce3bbab4
[0m15:42:22.273204 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:42:22.273793 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:42:22.274026 [debug] [MainThread]: Connection 'test.coffee_shop.unique_customers_ref_id.48ce3bbab4' was properly closed.
[0m15:42:22.274208 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_customers_ref_email.337290571c' was properly closed.
[0m15:42:22.274374 [debug] [MainThread]: Connection 'test.coffee_shop.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m15:42:22.274526 [debug] [MainThread]: Connection 'test.coffee_shop.unique_customers_id.70f3d3fd20' was properly closed.
[0m15:42:22.274678 [debug] [MainThread]: Connection 'test.coffee_shop.source_unique_coffee_shop_customers_id.33a28346d5' was properly closed.
[0m15:42:22.274828 [debug] [MainThread]: Connection 'test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m15:42:22.274980 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_customers_ref_id.1480a96cf3' was properly closed.
[0m15:42:22.275128 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m15:42:22.275344 [info ] [MainThread]: 
[0m15:42:22.275730 [info ] [MainThread]: Finished running 12 tests in 0 hours 0 minutes and 5.24 seconds (5.24s).
[0m15:42:22.276525 [debug] [MainThread]: Command end result
[0m15:42:22.286700 [info ] [MainThread]: 
[0m15:42:22.287718 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m15:42:22.288184 [info ] [MainThread]: 
[0m15:42:22.288640 [error] [MainThread]: [33mDatabase Error in test source_unique_coffee_shop_customers_ (models/schema.yml)[0m
[0m15:42:22.289116 [error] [MainThread]:   Syntax error: SELECT list must not be empty at [14:3]
[0m15:42:22.289602 [error] [MainThread]:   compiled Code at target/run/coffee_shop/models/schema.yml/source_unique_coffee_shop_customers_.sql
[0m15:42:22.290084 [info ] [MainThread]: 
[0m15:42:22.293440 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
[0m15:42:22.294113 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m15:42:22.294588 [info ] [MainThread]: 
[0m15:42:22.295130 [info ] [MainThread]:   compiled Code at target/compiled/coffee_shop/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
[0m15:42:22.295665 [info ] [MainThread]: 
[0m15:42:22.296092 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=2 SKIP=0 TOTAL=12
[0m15:42:22.296672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34e27263e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f350421b1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3504218340>]}
[0m15:42:22.297227 [debug] [MainThread]: Flushing usage events


============================== 2023-02-17 15:42:36.866770 | 0a32ef4a-9add-46cb-9876-914e1b219446 ==============================
[0m15:42:36.866770 [info ] [MainThread]: Running with dbt=1.4.1
[0m15:42:36.870410 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
[0m15:42:36.871808 [debug] [MainThread]: Tracking: tracking
[0m15:42:36.874173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c29245840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c29062c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c29063b20>]}
[0m15:42:36.923522 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:42:36.923966 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:42:36.924703 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffe_shop_milan.example
[0m15:42:36.931451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0a32ef4a-9add-46cb-9876-914e1b219446', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c28e4e680>]}
[0m15:42:36.941591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0a32ef4a-9add-46cb-9876-914e1b219446', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c29016c50>]}
[0m15:42:36.942192 [info ] [MainThread]: Found 4 models, 12 tests, 0 snapshots, 0 analyses, 334 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m15:42:36.943283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a32ef4a-9add-46cb-9876-914e1b219446', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c29016cb0>]}
[0m15:42:36.945849 [info ] [MainThread]: 
[0m15:42:36.950132 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:42:36.952255 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_milan'
[0m15:42:36.952704 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:42:38.051347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a32ef4a-9add-46cb-9876-914e1b219446', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c29016890>]}
[0m15:42:38.052437 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m15:42:38.053424 [info ] [MainThread]: 
[0m15:42:38.062005 [debug] [Thread-1 (]: Began running node model.coffee_shop.customers
[0m15:42:38.062589 [debug] [Thread-2 (]: Began running node model.coffee_shop.customers_ref
[0m15:42:38.066299 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.coffee_shop.customers_ref'
[0m15:42:38.066718 [debug] [Thread-2 (]: Began compiling node model.coffee_shop.customers_ref
[0m15:42:38.062930 [debug] [Thread-3 (]: Began running node model.coffee_shop.my_first_dbt_model
[0m15:42:38.064231 [debug] [Thread-6 (]: Began running node test.coffee_shop.source_unique_coffee_shop_customers_id.33a28346d5
[0m15:42:38.074663 [debug] [Thread-6 (]: Acquiring new bigquery connection 'test.coffee_shop.source_unique_coffee_shop_customers_id.33a28346d5'
[0m15:42:38.075117 [debug] [Thread-6 (]: Began compiling node test.coffee_shop.source_unique_coffee_shop_customers_id.33a28346d5
[0m15:42:38.063290 [debug] [Thread-4 (]: Began running node test.coffee_shop.source_not_null_coffee_shop_customers_id.d265e0f7a0
[0m15:42:38.081298 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.coffee_shop.source_not_null_coffee_shop_customers_id.d265e0f7a0'
[0m15:42:38.081787 [debug] [Thread-4 (]: Began compiling node test.coffee_shop.source_not_null_coffee_shop_customers_id.d265e0f7a0
[0m15:42:38.065389 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop.customers'
[0m15:42:38.093105 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.customers
[0m15:42:38.063821 [debug] [Thread-5 (]: Began running node test.coffee_shop.source_unique_coffee_shop_customers_.40a2aff259
[0m15:42:38.098452 [debug] [Thread-5 (]: Acquiring new bigquery connection 'test.coffee_shop.source_unique_coffee_shop_customers_.40a2aff259'
[0m15:42:38.098910 [debug] [Thread-5 (]: Began compiling node test.coffee_shop.source_unique_coffee_shop_customers_.40a2aff259
[0m15:42:38.073468 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.coffee_shop.my_first_dbt_model'
[0m15:42:38.108697 [debug] [Thread-3 (]: Began compiling node model.coffee_shop.my_first_dbt_model
[0m15:42:38.072260 [debug] [Thread-2 (]: Writing injected SQL for node "model.coffee_shop.customers_ref"
[0m15:42:38.123338 [debug] [Thread-2 (]: Timing info for model.coffee_shop.customers_ref (compile): 2023-02-17 15:42:38.067007 => 2023-02-17 15:42:38.123194
[0m15:42:38.123923 [debug] [Thread-2 (]: Began executing node model.coffee_shop.customers_ref
[0m15:42:38.124272 [debug] [Thread-2 (]: Timing info for model.coffee_shop.customers_ref (execute): 2023-02-17 15:42:38.124181 => 2023-02-17 15:42:38.124203
[0m15:42:38.126768 [debug] [Thread-2 (]: Finished running node model.coffee_shop.customers_ref
[0m15:42:38.097344 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.customers"
[0m15:42:38.113139 [debug] [Thread-3 (]: Writing injected SQL for node "model.coffee_shop.my_first_dbt_model"
[0m15:42:38.134305 [debug] [Thread-6 (]: Writing injected SQL for node "test.coffee_shop.source_unique_coffee_shop_customers_id.33a28346d5"
[0m15:42:38.247615 [debug] [Thread-4 (]: Writing injected SQL for node "test.coffee_shop.source_not_null_coffee_shop_customers_id.d265e0f7a0"
[0m15:42:38.260400 [debug] [Thread-6 (]: Timing info for test.coffee_shop.source_unique_coffee_shop_customers_id.33a28346d5 (compile): 2023-02-17 15:42:38.075375 => 2023-02-17 15:42:38.260318
[0m15:42:38.260800 [debug] [Thread-6 (]: Began executing node test.coffee_shop.source_unique_coffee_shop_customers_id.33a28346d5
[0m15:42:38.253403 [debug] [Thread-5 (]: Writing injected SQL for node "test.coffee_shop.source_unique_coffee_shop_customers_.40a2aff259"
[0m15:42:38.255586 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (compile): 2023-02-17 15:42:38.093479 => 2023-02-17 15:42:38.255526
[0m15:42:38.259398 [debug] [Thread-7 (]: Began running node test.coffee_shop.not_null_customers_ref_id.1480a96cf3
[0m15:42:38.259734 [debug] [Thread-2 (]: Began running node test.coffee_shop.unique_customers_ref_id.48ce3bbab4
[0m15:42:38.263775 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_customers_ref_id.48ce3bbab4'
[0m15:42:38.264071 [debug] [Thread-2 (]: Began compiling node test.coffee_shop.unique_customers_ref_id.48ce3bbab4
[0m15:42:38.261159 [debug] [Thread-6 (]: Timing info for test.coffee_shop.source_unique_coffee_shop_customers_id.33a28346d5 (execute): 2023-02-17 15:42:38.261066 => 2023-02-17 15:42:38.261083
[0m15:42:38.270597 [debug] [Thread-6 (]: Finished running node test.coffee_shop.source_unique_coffee_shop_customers_id.33a28346d5
[0m15:42:38.261753 [debug] [Thread-4 (]: Timing info for test.coffee_shop.source_not_null_coffee_shop_customers_id.d265e0f7a0 (compile): 2023-02-17 15:42:38.082229 => 2023-02-17 15:42:38.261683
[0m15:42:38.271056 [debug] [Thread-4 (]: Began executing node test.coffee_shop.source_not_null_coffee_shop_customers_id.d265e0f7a0
[0m15:42:38.262004 [debug] [Thread-1 (]: Began executing node model.coffee_shop.customers
[0m15:42:38.271716 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (execute): 2023-02-17 15:42:38.271645 => 2023-02-17 15:42:38.271656
[0m15:42:38.272363 [debug] [Thread-1 (]: Finished running node model.coffee_shop.customers
[0m15:42:38.255311 [debug] [Thread-8 (]: Began running node test.coffee_shop.not_null_customers_ref_email.337290571c
[0m15:42:38.269536 [debug] [Thread-2 (]: Writing injected SQL for node "test.coffee_shop.unique_customers_ref_id.48ce3bbab4"
[0m15:42:38.271329 [debug] [Thread-4 (]: Timing info for test.coffee_shop.source_not_null_coffee_shop_customers_id.d265e0f7a0 (execute): 2023-02-17 15:42:38.271251 => 2023-02-17 15:42:38.271264
[0m15:42:38.274623 [debug] [Thread-4 (]: Finished running node test.coffee_shop.source_not_null_coffee_shop_customers_id.d265e0f7a0
[0m15:42:38.273055 [debug] [Thread-8 (]: Acquiring new bigquery connection 'test.coffee_shop.not_null_customers_ref_email.337290571c'
[0m15:42:38.275165 [debug] [Thread-8 (]: Began compiling node test.coffee_shop.not_null_customers_ref_email.337290571c
[0m15:42:38.262711 [debug] [Thread-7 (]: Acquiring new bigquery connection 'test.coffee_shop.not_null_customers_ref_id.1480a96cf3'
[0m15:42:38.280511 [debug] [Thread-7 (]: Began compiling node test.coffee_shop.not_null_customers_ref_id.1480a96cf3
[0m15:42:38.273586 [debug] [Thread-6 (]: Began running node test.coffee_shop.not_null_customers_id.422908bfae
[0m15:42:38.263085 [debug] [Thread-5 (]: Timing info for test.coffee_shop.source_unique_coffee_shop_customers_.40a2aff259 (compile): 2023-02-17 15:42:38.106329 => 2023-02-17 15:42:38.263020
[0m15:42:38.254793 [debug] [Thread-3 (]: Timing info for model.coffee_shop.my_first_dbt_model (compile): 2023-02-17 15:42:38.109115 => 2023-02-17 15:42:38.254685
[0m15:42:38.279847 [debug] [Thread-8 (]: Writing injected SQL for node "test.coffee_shop.not_null_customers_ref_email.337290571c"
[0m15:42:38.280139 [debug] [Thread-2 (]: Timing info for test.coffee_shop.unique_customers_ref_id.48ce3bbab4 (compile): 2023-02-17 15:42:38.264244 => 2023-02-17 15:42:38.280074
[0m15:42:38.273890 [debug] [Thread-1 (]: Began running node test.coffee_shop.unique_customers_id.70f3d3fd20
[0m15:42:38.284942 [debug] [Thread-7 (]: Writing injected SQL for node "test.coffee_shop.not_null_customers_ref_id.1480a96cf3"
[0m15:42:38.285637 [debug] [Thread-6 (]: Acquiring new bigquery connection 'test.coffee_shop.not_null_customers_id.422908bfae'
[0m15:42:38.289646 [debug] [Thread-6 (]: Began compiling node test.coffee_shop.not_null_customers_id.422908bfae
[0m15:42:38.286340 [debug] [Thread-3 (]: Began executing node model.coffee_shop.my_first_dbt_model
[0m15:42:38.294743 [debug] [Thread-3 (]: Timing info for model.coffee_shop.my_first_dbt_model (execute): 2023-02-17 15:42:38.294661 => 2023-02-17 15:42:38.294678
[0m15:42:38.288239 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_customers_id.70f3d3fd20'
[0m15:42:38.295778 [debug] [Thread-1 (]: Began compiling node test.coffee_shop.unique_customers_id.70f3d3fd20
[0m15:42:38.286049 [debug] [Thread-5 (]: Began executing node test.coffee_shop.source_unique_coffee_shop_customers_.40a2aff259
[0m15:42:38.303109 [debug] [Thread-5 (]: Timing info for test.coffee_shop.source_unique_coffee_shop_customers_.40a2aff259 (execute): 2023-02-17 15:42:38.303006 => 2023-02-17 15:42:38.303027
[0m15:42:38.294331 [debug] [Thread-6 (]: Writing injected SQL for node "test.coffee_shop.not_null_customers_id.422908bfae"
[0m15:42:38.286813 [debug] [Thread-2 (]: Began executing node test.coffee_shop.unique_customers_ref_id.48ce3bbab4
[0m15:42:38.295396 [debug] [Thread-3 (]: Finished running node model.coffee_shop.my_first_dbt_model
[0m15:42:38.288931 [debug] [Thread-7 (]: Timing info for test.coffee_shop.not_null_customers_ref_id.1480a96cf3 (compile): 2023-02-17 15:42:38.280717 => 2023-02-17 15:42:38.288837
[0m15:42:38.307154 [debug] [Thread-7 (]: Began executing node test.coffee_shop.not_null_customers_ref_id.1480a96cf3
[0m15:42:38.289234 [debug] [Thread-8 (]: Timing info for test.coffee_shop.not_null_customers_ref_email.337290571c (compile): 2023-02-17 15:42:38.275391 => 2023-02-17 15:42:38.289169
[0m15:42:38.307758 [debug] [Thread-8 (]: Began executing node test.coffee_shop.not_null_customers_ref_email.337290571c
[0m15:42:38.305258 [debug] [Thread-2 (]: Timing info for test.coffee_shop.unique_customers_ref_id.48ce3bbab4 (execute): 2023-02-17 15:42:38.305178 => 2023-02-17 15:42:38.305191
[0m15:42:38.308746 [debug] [Thread-2 (]: Finished running node test.coffee_shop.unique_customers_ref_id.48ce3bbab4
[0m15:42:38.306351 [debug] [Thread-4 (]: Began running node model.coffee_shop.my_second_dbt_model
[0m15:42:38.309756 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.coffee_shop.my_second_dbt_model'
[0m15:42:38.307406 [debug] [Thread-7 (]: Timing info for test.coffee_shop.not_null_customers_ref_id.1480a96cf3 (execute): 2023-02-17 15:42:38.307339 => 2023-02-17 15:42:38.307350
[0m15:42:38.310667 [debug] [Thread-7 (]: Finished running node test.coffee_shop.not_null_customers_ref_id.1480a96cf3
[0m15:42:38.308065 [debug] [Thread-8 (]: Timing info for test.coffee_shop.not_null_customers_ref_email.337290571c (execute): 2023-02-17 15:42:38.308012 => 2023-02-17 15:42:38.308022
[0m15:42:38.304008 [debug] [Thread-5 (]: Finished running node test.coffee_shop.source_unique_coffee_shop_customers_.40a2aff259
[0m15:42:38.306024 [debug] [Thread-6 (]: Timing info for test.coffee_shop.not_null_customers_id.422908bfae (compile): 2023-02-17 15:42:38.289848 => 2023-02-17 15:42:38.305962
[0m15:42:38.312014 [debug] [Thread-6 (]: Began executing node test.coffee_shop.not_null_customers_id.422908bfae
[0m15:42:38.310018 [debug] [Thread-4 (]: Began compiling node model.coffee_shop.my_second_dbt_model
[0m15:42:38.315004 [debug] [Thread-4 (]: Writing injected SQL for node "model.coffee_shop.my_second_dbt_model"
[0m15:42:38.306590 [debug] [Thread-3 (]: Began running node test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:42:38.316280 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710'
[0m15:42:38.316563 [debug] [Thread-3 (]: Began compiling node test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:42:38.312283 [debug] [Thread-6 (]: Timing info for test.coffee_shop.not_null_customers_id.422908bfae (execute): 2023-02-17 15:42:38.312207 => 2023-02-17 15:42:38.312218
[0m15:42:38.299979 [debug] [Thread-1 (]: Writing injected SQL for node "test.coffee_shop.unique_customers_id.70f3d3fd20"
[0m15:42:38.315686 [debug] [Thread-4 (]: Timing info for model.coffee_shop.my_second_dbt_model (compile): 2023-02-17 15:42:38.312487 => 2023-02-17 15:42:38.315473
[0m15:42:38.322241 [debug] [Thread-4 (]: Began executing node model.coffee_shop.my_second_dbt_model
[0m15:42:38.322638 [debug] [Thread-4 (]: Timing info for model.coffee_shop.my_second_dbt_model (execute): 2023-02-17 15:42:38.322552 => 2023-02-17 15:42:38.322567
[0m15:42:38.320846 [debug] [Thread-3 (]: Writing injected SQL for node "test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710"
[0m15:42:38.321670 [debug] [Thread-6 (]: Finished running node test.coffee_shop.not_null_customers_id.422908bfae
[0m15:42:38.311489 [debug] [Thread-8 (]: Finished running node test.coffee_shop.not_null_customers_ref_email.337290571c
[0m15:42:38.309121 [debug] [Thread-2 (]: Began running node test.coffee_shop.unique_my_first_dbt_model_id.16e066b321
[0m15:42:38.324937 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_my_first_dbt_model_id.16e066b321'
[0m15:42:38.325476 [debug] [Thread-2 (]: Began compiling node test.coffee_shop.unique_my_first_dbt_model_id.16e066b321
[0m15:42:38.323665 [debug] [Thread-4 (]: Finished running node model.coffee_shop.my_second_dbt_model
[0m15:42:38.325183 [debug] [Thread-3 (]: Timing info for test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710 (compile): 2023-02-17 15:42:38.316733 => 2023-02-17 15:42:38.325130
[0m15:42:38.322996 [debug] [Thread-1 (]: Timing info for test.coffee_shop.unique_customers_id.70f3d3fd20 (compile): 2023-02-17 15:42:38.295957 => 2023-02-17 15:42:38.322948
[0m15:42:38.329758 [debug] [Thread-2 (]: Writing injected SQL for node "test.coffee_shop.unique_my_first_dbt_model_id.16e066b321"
[0m15:42:38.330622 [debug] [Thread-7 (]: Began running node test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778
[0m15:42:38.332262 [debug] [Thread-7 (]: Acquiring new bigquery connection 'test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778'
[0m15:42:38.331154 [debug] [Thread-5 (]: Began running node test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493
[0m15:42:38.335613 [debug] [Thread-5 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493'
[0m15:42:38.336054 [debug] [Thread-5 (]: Began compiling node test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493
[0m15:42:38.331487 [debug] [Thread-1 (]: Began executing node test.coffee_shop.unique_customers_id.70f3d3fd20
[0m15:42:38.343538 [debug] [Thread-1 (]: Timing info for test.coffee_shop.unique_customers_id.70f3d3fd20 (execute): 2023-02-17 15:42:38.343432 => 2023-02-17 15:42:38.343452
[0m15:42:38.332726 [debug] [Thread-7 (]: Began compiling node test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778
[0m15:42:38.330911 [debug] [Thread-3 (]: Began executing node test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:42:38.351397 [debug] [Thread-3 (]: Timing info for test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710 (execute): 2023-02-17 15:42:38.351301 => 2023-02-17 15:42:38.351317
[0m15:42:38.344297 [debug] [Thread-1 (]: Finished running node test.coffee_shop.unique_customers_id.70f3d3fd20
[0m15:42:38.332968 [debug] [Thread-2 (]: Timing info for test.coffee_shop.unique_my_first_dbt_model_id.16e066b321 (compile): 2023-02-17 15:42:38.325659 => 2023-02-17 15:42:38.332914
[0m15:42:38.352483 [debug] [Thread-3 (]: Finished running node test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:42:38.343013 [debug] [Thread-5 (]: Writing injected SQL for node "test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493"
[0m15:42:38.354095 [debug] [Thread-5 (]: Timing info for test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493 (compile): 2023-02-17 15:42:38.336291 => 2023-02-17 15:42:38.354023
[0m15:42:38.354564 [debug] [Thread-5 (]: Began executing node test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493
[0m15:42:38.354967 [debug] [Thread-5 (]: Timing info for test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493 (execute): 2023-02-17 15:42:38.354901 => 2023-02-17 15:42:38.354912
[0m15:42:38.355816 [debug] [Thread-5 (]: Finished running node test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493
[0m15:42:38.350894 [debug] [Thread-7 (]: Writing injected SQL for node "test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778"
[0m15:42:38.356576 [debug] [Thread-7 (]: Timing info for test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778 (compile): 2023-02-17 15:42:38.344571 => 2023-02-17 15:42:38.356506
[0m15:42:38.353243 [debug] [Thread-2 (]: Began executing node test.coffee_shop.unique_my_first_dbt_model_id.16e066b321
[0m15:42:38.357220 [debug] [Thread-2 (]: Timing info for test.coffee_shop.unique_my_first_dbt_model_id.16e066b321 (execute): 2023-02-17 15:42:38.357149 => 2023-02-17 15:42:38.357162
[0m15:42:38.357855 [debug] [Thread-2 (]: Finished running node test.coffee_shop.unique_my_first_dbt_model_id.16e066b321
[0m15:42:38.356941 [debug] [Thread-7 (]: Began executing node test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778
[0m15:42:38.358269 [debug] [Thread-7 (]: Timing info for test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778 (execute): 2023-02-17 15:42:38.358202 => 2023-02-17 15:42:38.358212
[0m15:42:38.359086 [debug] [Thread-7 (]: Finished running node test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778
[0m15:42:38.362371 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:42:38.362797 [debug] [MainThread]: Connection 'test.coffee_shop.unique_customers_id.70f3d3fd20' was properly closed.
[0m15:42:38.363126 [debug] [MainThread]: Connection 'test.coffee_shop.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m15:42:38.363407 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m15:42:38.363703 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_customers_id.422908bfae' was properly closed.
[0m15:42:38.363971 [debug] [MainThread]: Connection 'model.coffee_shop.my_second_dbt_model' was properly closed.
[0m15:42:38.364238 [debug] [MainThread]: Connection 'test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m15:42:38.364589 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
[0m15:42:38.364807 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_customers_ref_email.337290571c' was properly closed.
[0m15:42:38.365853 [debug] [MainThread]: Command end result
[0m15:42:38.374565 [info ] [MainThread]: Done.
[0m15:42:38.378078 [debug] [MainThread]: Acquiring new bigquery connection 'generate_catalog'
[0m15:42:38.378492 [info ] [MainThread]: Building catalog
[0m15:42:38.379723 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:42:38.909110 [debug] [ThreadPool]: Acquiring new bigquery connection 'aec-students.information_schema'
[0m15:42:38.909869 [debug] [ThreadPool]: Acquiring new bigquery connection 'analytics-engineers-club.information_schema'
[0m15:42:38.925503 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:42:38.927928 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:42:38.928708 [debug] [ThreadPool]: On aec-students.information_schema: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "connection_name": "aec-students.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `aec-students`.`dbt_milan`.__TABLES__
        where (upper(dataset_id) = upper('dbt_milan'))
    ),

    table_options as (
        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            JSON_VALUE(option_value) as table_comment

        from `aec-students`.`dbt_milan`.INFORMATION_SCHEMA.TABLE_OPTIONS
        where option_name = 'description'
    ),
    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `aec-students`.`dbt_milan`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `aec-students`.`dbt_milan`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,
        table_options.table_comment,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join table_options using (relation_id)
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
[0m15:42:38.929172 [debug] [ThreadPool]: On analytics-engineers-club.information_schema: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "connection_name": "analytics-engineers-club.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `analytics-engineers-club`.`coffee_shop`.__TABLES__
        where (upper(dataset_id) = upper('coffee_shop'))
    ),

    table_options as (
        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            JSON_VALUE(option_value) as table_comment

        from `analytics-engineers-club`.`coffee_shop`.INFORMATION_SCHEMA.TABLE_OPTIONS
        where option_name = 'description'
    ),
    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `analytics-engineers-club`.`coffee_shop`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `analytics-engineers-club`.`coffee_shop`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,
        table_options.table_comment,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join table_options using (relation_id)
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
[0m15:42:41.677047 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:28d2c5bc-6a69-40b9-b93e-d444103b98ee&page=queryresults
[0m15:42:41.735202 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:98252f8f-8b69-45f4-902f-4aed3d22fda8&page=queryresults
[0m15:42:41.823183 [info ] [MainThread]: Catalog written to /workspaces/ae-club-milan/coffe_shop_milan/target/catalog.json
[0m15:42:41.833762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c29245840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c29470bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c29471720>]}
[0m15:42:41.834263 [debug] [MainThread]: Flushing usage events
[0m15:42:42.245313 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m15:42:42.246115 [debug] [MainThread]: Connection 'aec-students.information_schema' was properly closed.
[0m15:42:42.246440 [debug] [MainThread]: Connection 'analytics-engineers-club.information_schema' was properly closed.


============================== 2023-02-17 15:42:52.880060 | 1ffd6aa8-f023-4feb-8883-694f1406db64 ==============================
[0m15:42:52.880060 [info ] [MainThread]: Running with dbt=1.4.1
[0m15:42:52.883856 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
[0m15:42:52.885270 [debug] [MainThread]: Tracking: tracking
[0m15:42:52.887389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a85253730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a85251a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a85253880>]}
[0m15:42:52.893283 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
[0m15:42:52.895326 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
[0m15:42:52.896532 [info ] [MainThread]: 
[0m15:42:52.898195 [info ] [MainThread]: 
[0m15:42:52.901145 [info ] [MainThread]: Press Ctrl+C to exit.
[0m15:49:51.466631 [debug] [MainThread]: Flushing usage events
[0m15:49:51.880408 [info ] [MainThread]: ctrl-c


============================== 2023-02-17 15:50:04.280940 | 32badbcd-7066-448e-90e5-e8b67d492045 ==============================
[0m15:50:04.280940 [info ] [MainThread]: Running with dbt=1.4.1
[0m15:50:04.288880 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'source-freshness', 'rpc_method': 'source-freshness', 'indirect_selection': 'eager'}
[0m15:50:04.290204 [debug] [MainThread]: Tracking: tracking
[0m15:50:04.303289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f335ee3d7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f335ec5a560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f335ec5b9a0>]}
[0m15:50:04.365201 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:50:04.365833 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:50:04.366741 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffe_shop_milan.example
[0m15:50:04.373480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '32badbcd-7066-448e-90e5-e8b67d492045', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f335ec425c0>]}
[0m15:50:04.382580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '32badbcd-7066-448e-90e5-e8b67d492045', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f335ec0eb60>]}
[0m15:50:04.383078 [info ] [MainThread]: Found 4 models, 12 tests, 0 snapshots, 0 analyses, 334 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m15:50:04.383558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '32badbcd-7066-448e-90e5-e8b67d492045', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f335ee3d7b0>]}
[0m15:50:04.385032 [info ] [MainThread]: 
[0m15:50:04.385845 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m15:50:04.392115 [info ] [MainThread]: Done.
[0m15:50:04.392811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f335ec0e770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f335ec0c250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f335ec0e7a0>]}
[0m15:50:04.393289 [debug] [MainThread]: Flushing usage events


============================== 2023-02-17 15:51:41.495674 | 4adec956-37df-447b-9bde-74f39d80694e ==============================
[0m15:51:41.495674 [info ] [MainThread]: Running with dbt=1.4.1
[0m15:51:41.498266 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'source-freshness', 'rpc_method': 'source-freshness', 'indirect_selection': 'eager'}
[0m15:51:41.498611 [debug] [MainThread]: Tracking: tracking
[0m15:51:41.501178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a2945f850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a2945d900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a2945fd60>]}
[0m15:51:41.560472 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:51:41.561272 [debug] [MainThread]: Partial parsing: updated file: coffee_shop://models/schema.yml
[0m15:51:41.576094 [debug] [MainThread]: 1699: static parser successfully parsed customers_ref.sql
[0m15:51:41.690587 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffe_shop_milan.example
[0m15:51:41.696706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4adec956-37df-447b-9bde-74f39d80694e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a2941f4f0>]}
[0m15:51:41.705753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4adec956-37df-447b-9bde-74f39d80694e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a2941f7f0>]}
[0m15:51:41.706370 [info ] [MainThread]: Found 4 models, 12 tests, 0 snapshots, 0 analyses, 334 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m15:51:41.706831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4adec956-37df-447b-9bde-74f39d80694e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a2cd2ef50>]}
[0m15:51:41.708639 [info ] [MainThread]: 
[0m15:51:41.710764 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:51:41.712218 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_milan'
[0m15:51:41.712642 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:51:42.981669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4adec956-37df-447b-9bde-74f39d80694e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a2941f9d0>]}
[0m15:51:42.982472 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m15:51:42.983093 [info ] [MainThread]: 
[0m15:51:42.987679 [debug] [Thread-1 (]: Began running node source.coffee_shop.coffee_shop.customers
[0m15:51:42.988046 [info ] [Thread-1 (]: 1 of 1 START freshness of coffee_shop.customers ................................ [RUN]
[0m15:51:42.988809 [debug] [Thread-1 (]: Acquiring new bigquery connection 'source.coffee_shop.coffee_shop.customers'
[0m15:51:42.989091 [debug] [Thread-1 (]: Began compiling node source.coffee_shop.coffee_shop.customers
[0m15:51:42.989314 [debug] [Thread-1 (]: Timing info for source.coffee_shop.coffee_shop.customers (compile): 2023-02-17 15:51:42.989254 => 2023-02-17 15:51:42.989261
[0m15:51:42.989531 [debug] [Thread-1 (]: Began executing node source.coffee_shop.coffee_shop.customers
[0m15:51:42.990394 [debug] [Thread-1 (]: Acquiring new bigquery connection 'source.coffee_shop.coffee_shop.customers'
[0m15:51:43.003856 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:51:43.004672 [debug] [Thread-1 (]: On source.coffee_shop.coffee_shop.customers: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "source.coffee_shop.coffee_shop.customers"} */
select
      max(created_at) as max_loaded_at,
      current_timestamp() as snapshotted_at
    from `analytics-engineers-club`.`coffee_shop`.`customers`
    
  
[0m15:51:43.501225 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: created_at at [3:11]')
[0m15:51:44.082234 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:c1335af8-912f-4d38-ad02-b8d8f1b27c7b&page=queryresults
[0m15:51:44.082925 [debug] [Thread-1 (]: BigQuery adapter: Unhandled error while running:
macro collect_freshness
[0m15:51:44.083810 [debug] [Thread-1 (]: BigQuery adapter: Database Error
  Unrecognized name: created_at at [3:11]
[0m15:51:44.084895 [debug] [Thread-1 (]: Timing info for source.coffee_shop.coffee_shop.customers (execute): 2023-02-17 15:51:42.989735 => 2023-02-17 15:51:44.084816
[0m15:51:44.091280 [debug] [Thread-1 (]: Database Error in source customers (models/schema.yml)
  Unrecognized name: created_at at [3:11]
[0m15:51:44.091818 [error] [Thread-1 (]: 1 of 1 ERROR freshness of coffee_shop.customers ................................ [[31mERROR[0m in 1.10s]
[0m15:51:44.093588 [debug] [Thread-1 (]: Finished running node source.coffee_shop.coffee_shop.customers
[0m15:51:44.095257 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:51:44.095574 [debug] [MainThread]: Connection 'source.coffee_shop.coffee_shop.customers' was properly closed.
[0m15:51:44.102890 [info ] [MainThread]: 
[0m15:51:44.103443 [error] [MainThread]: [33mDatabase Error in source customers (models/schema.yml)[0m
[0m15:51:44.103915 [error] [MainThread]:   Unrecognized name: created_at at [3:11]
[0m15:51:44.104337 [info ] [MainThread]: Done.
[0m15:51:44.105195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a2941f970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a2940d540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a2940d510>]}
[0m15:51:44.105581 [debug] [MainThread]: Flushing usage events
