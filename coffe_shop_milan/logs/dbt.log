

============================== 2023-02-17 13:58:19.910746 | 3f278256-fb9a-4bea-9637-3fda3eb200b4 ==============================
[0m13:58:19.910746 [info ] [MainThread]: Running with dbt=1.4.1
[0m13:58:19.914459 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:58:19.915782 [debug] [MainThread]: Tracking: tracking
[0m13:58:19.926511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16c1357700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16c1355900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16c1357730>]}
[0m13:58:19.943897 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m13:58:19.945423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3f278256-fb9a-4bea-9637-3fda3eb200b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16c1355780>]}
[0m13:58:20.789796 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
[0m13:58:20.802610 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
[0m13:58:20.805612 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
[0m13:58:20.863522 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffe_shop_milan.example
[0m13:58:20.870008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3f278256-fb9a-4bea-9637-3fda3eb200b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16c4b88e50>]}
[0m13:58:20.876803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3f278256-fb9a-4bea-9637-3fda3eb200b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16c177d570>]}
[0m13:58:20.877251 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 334 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m13:58:20.877630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f278256-fb9a-4bea-9637-3fda3eb200b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16c3b2dae0>]}
[0m13:58:20.879063 [info ] [MainThread]: 
[0m13:58:20.881140 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:58:20.883118 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m13:58:20.883698 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:58:22.069749 [debug] [ThreadPool]: Acquiring new bigquery connection 'create_aec-students_dbt_milan'
[0m13:58:22.071027 [debug] [ThreadPool]: Acquiring new bigquery connection 'create_aec-students_dbt_milan'
[0m13:58:22.071935 [debug] [ThreadPool]: Creating schema "ReferenceKeyMsg(database='aec-students', schema='dbt_milan', identifier=None)"
[0m13:58:22.090133 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:58:22.092330 [debug] [ThreadPool]: On create_aec-students_dbt_milan: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "connection_name": "create_aec-students_dbt_milan"} */
create schema if not exists `aec-students`.`dbt_milan`
  
[0m13:58:23.364642 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:2593ba3f-3e0b-4c61-a188-a0afbf41d598&page=queryresults
[0m13:58:23.366899 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_milan'
[0m13:58:23.367380 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:58:23.672682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f278256-fb9a-4bea-9637-3fda3eb200b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16c1507730>]}
[0m13:58:23.673521 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m13:58:23.673951 [info ] [MainThread]: 
[0m13:58:23.698432 [debug] [Thread-1 (]: Began running node model.coffee_shop.customers
[0m13:58:23.699267 [info ] [Thread-1 (]: 1 of 3 START sql view model dbt_milan.customers ................................ [RUN]
[0m13:58:23.700438 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop.customers'
[0m13:58:23.700877 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.customers
[0m13:58:23.702920 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.customers"
[0m13:58:23.703594 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (compile): 2023-02-17 13:58:23.701164 => 2023-02-17 13:58:23.703489
[0m13:58:23.703936 [debug] [Thread-1 (]: Began executing node model.coffee_shop.customers
[0m13:58:23.698767 [debug] [Thread-2 (]: Began running node model.coffee_shop.my_first_dbt_model
[0m13:58:23.726374 [info ] [Thread-2 (]: 2 of 3 START sql table model dbt_milan.my_first_dbt_model ...................... [RUN]
[0m13:58:23.737445 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.coffee_shop.my_first_dbt_model'
[0m13:58:23.741244 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop.customers"
[0m13:58:23.741585 [debug] [Thread-2 (]: Began compiling node model.coffee_shop.my_first_dbt_model
[0m13:58:23.746719 [debug] [Thread-2 (]: Writing injected SQL for node "model.coffee_shop.my_first_dbt_model"
[0m13:58:23.747641 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:58:23.748097 [debug] [Thread-2 (]: Timing info for model.coffee_shop.my_first_dbt_model (compile): 2023-02-17 13:58:23.742241 => 2023-02-17 13:58:23.747998
[0m13:58:23.748422 [debug] [Thread-1 (]: On model.coffee_shop.customers: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.customers"} */


  create or replace view `aec-students`.`dbt_milan`.`customers`
  OPTIONS()
  as select * from `analytics-engineers-club.coffee_shop.customers`
Some bad SQL
limit 9000;;


[0m13:58:23.748794 [debug] [Thread-2 (]: Began executing node model.coffee_shop.my_first_dbt_model
[0m13:58:23.781432 [debug] [Thread-2 (]: Writing runtime sql for node "model.coffee_shop.my_first_dbt_model"
[0m13:58:23.782513 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:58:23.783173 [debug] [Thread-2 (]: On model.coffee_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.my_first_dbt_model"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`my_first_dbt_model`
    
    
    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m13:58:24.206272 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected end of input but got keyword SOME at [7:1]')
[0m13:58:24.928287 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:b138ec17-7d7a-42c0-9ebc-b4e092e0ed67&page=queryresults
[0m13:58:24.929265 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (execute): 2023-02-17 13:58:23.704111 => 2023-02-17 13:58:24.929173
[0m13:58:24.944261 [debug] [Thread-1 (]: Database Error in model customers (models/customers.sql)
  Syntax error: Expected end of input but got keyword SOME at [7:1]
  compiled Code at target/run/coffee_shop/models/customers.sql
[0m13:58:24.944776 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f278256-fb9a-4bea-9637-3fda3eb200b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16c12aec50>]}
[0m13:58:24.945367 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model dbt_milan.customers ....................... [[31mERROR[0m in 1.24s]
[0m13:58:24.947691 [debug] [Thread-1 (]: Finished running node model.coffee_shop.customers
[0m13:58:26.419551 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:9ac0a970-53d9-4592-9d87-9119dbb2fedc&page=queryresults
[0m13:58:26.435314 [debug] [Thread-2 (]: Timing info for model.coffee_shop.my_first_dbt_model (execute): 2023-02-17 13:58:23.750699 => 2023-02-17 13:58:26.435249
[0m13:58:26.436215 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f278256-fb9a-4bea-9637-3fda3eb200b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16c13036d0>]}
[0m13:58:26.436842 [info ] [Thread-2 (]: 2 of 3 OK created sql table model dbt_milan.my_first_dbt_model ................. [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 2.70s]
[0m13:58:26.437643 [debug] [Thread-2 (]: Finished running node model.coffee_shop.my_first_dbt_model
[0m13:58:26.438719 [debug] [Thread-4 (]: Began running node model.coffee_shop.my_second_dbt_model
[0m13:58:26.439159 [info ] [Thread-4 (]: 3 of 3 START sql view model dbt_milan.my_second_dbt_model ...................... [RUN]
[0m13:58:26.439893 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.coffee_shop.my_second_dbt_model'
[0m13:58:26.440162 [debug] [Thread-4 (]: Began compiling node model.coffee_shop.my_second_dbt_model
[0m13:58:26.443834 [debug] [Thread-4 (]: Writing injected SQL for node "model.coffee_shop.my_second_dbt_model"
[0m13:58:26.444521 [debug] [Thread-4 (]: Timing info for model.coffee_shop.my_second_dbt_model (compile): 2023-02-17 13:58:26.440331 => 2023-02-17 13:58:26.444352
[0m13:58:26.445074 [debug] [Thread-4 (]: Began executing node model.coffee_shop.my_second_dbt_model
[0m13:58:26.448032 [debug] [Thread-4 (]: Writing runtime sql for node "model.coffee_shop.my_second_dbt_model"
[0m13:58:26.448631 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:58:26.449055 [debug] [Thread-4 (]: On model.coffee_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.my_second_dbt_model"} */


  create or replace view `aec-students`.`dbt_milan`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `aec-students`.`dbt_milan`.`my_first_dbt_model`
where id = 1;


[0m13:58:27.315335 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:9d8e149f-61cc-47ca-9de4-688ddd30b504&page=queryresults
[0m13:58:27.317169 [debug] [Thread-4 (]: Timing info for model.coffee_shop.my_second_dbt_model (execute): 2023-02-17 13:58:26.445350 => 2023-02-17 13:58:27.317108
[0m13:58:27.317956 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f278256-fb9a-4bea-9637-3fda3eb200b4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16c1290910>]}
[0m13:58:27.318494 [info ] [Thread-4 (]: 3 of 3 OK created sql view model dbt_milan.my_second_dbt_model ................. [[32mCREATE VIEW (0 processed)[0m in 0.88s]
[0m13:58:27.319237 [debug] [Thread-4 (]: Finished running node model.coffee_shop.my_second_dbt_model
[0m13:58:27.321375 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:58:27.322066 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:58:27.322313 [debug] [MainThread]: Connection 'model.coffee_shop.customers' was properly closed.
[0m13:58:27.322534 [debug] [MainThread]: Connection 'model.coffee_shop.my_first_dbt_model' was properly closed.
[0m13:58:27.322738 [debug] [MainThread]: Connection 'model.coffee_shop.my_second_dbt_model' was properly closed.
[0m13:58:27.323022 [info ] [MainThread]: 
[0m13:58:27.323406 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 6.44 seconds (6.44s).
[0m13:58:27.324160 [debug] [MainThread]: Command end result
[0m13:58:27.333636 [info ] [MainThread]: 
[0m13:58:27.334290 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:58:27.334799 [info ] [MainThread]: 
[0m13:58:27.335292 [error] [MainThread]: [33mDatabase Error in model customers (models/customers.sql)[0m
[0m13:58:27.335884 [error] [MainThread]:   Syntax error: Expected end of input but got keyword SOME at [7:1]
[0m13:58:27.336389 [error] [MainThread]:   compiled Code at target/run/coffee_shop/models/customers.sql
[0m13:58:27.336906 [info ] [MainThread]: 
[0m13:58:27.337427 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m13:58:27.341051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16c12d7b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16c12d72e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f16c12d7580>]}
[0m13:58:27.341598 [debug] [MainThread]: Flushing usage events


============================== 2023-02-17 14:06:16.574292 | a4d75ae1-f72f-45d4-b391-6a2fa4baf61e ==============================
[0m14:06:16.574292 [info ] [MainThread]: Running with dbt=1.4.1
[0m14:06:16.577838 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:06:16.578790 [debug] [MainThread]: Tracking: tracking
[0m14:06:16.584820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ca5636fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ca1d5e8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ca1d5f760>]}
[0m14:06:16.803565 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:06:16.803912 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:06:16.804592 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffe_shop_milan.example
[0m14:06:16.811875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a4d75ae1-f72f-45d4-b391-6a2fa4baf61e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ca1d2d360>]}
[0m14:06:16.834249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a4d75ae1-f72f-45d4-b391-6a2fa4baf61e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ca1cf1960>]}
[0m14:06:16.834959 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 334 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m14:06:16.836194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a4d75ae1-f72f-45d4-b391-6a2fa4baf61e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ca5636fe0>]}
[0m14:06:16.838545 [info ] [MainThread]: 
[0m14:06:16.842943 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:06:16.845397 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m14:06:16.846061 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:06:18.189449 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_milan'
[0m14:06:18.189951 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:06:18.471350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a4d75ae1-f72f-45d4-b391-6a2fa4baf61e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ca1d70b50>]}
[0m14:06:18.472194 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m14:06:18.472589 [info ] [MainThread]: 
[0m14:06:18.481025 [debug] [Thread-1 (]: Began running node model.coffee_shop.customers
[0m14:06:18.482978 [debug] [Thread-2 (]: Began running node model.coffee_shop.my_first_dbt_model
[0m14:06:18.481669 [info ] [Thread-1 (]: 1 of 3 START sql view model dbt_milan.customers ................................ [RUN]
[0m14:06:18.485338 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop.customers'
[0m14:06:18.485778 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.customers
[0m14:06:18.492375 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.customers"
[0m14:06:18.493053 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (compile): 2023-02-17 14:06:18.486054 => 2023-02-17 14:06:18.492945
[0m14:06:18.493481 [debug] [Thread-1 (]: Began executing node model.coffee_shop.customers
[0m14:06:18.483562 [info ] [Thread-2 (]: 2 of 3 START sql table model dbt_milan.my_first_dbt_model ...................... [RUN]
[0m14:06:18.503801 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.coffee_shop.my_first_dbt_model'
[0m14:06:18.504450 [debug] [Thread-2 (]: Began compiling node model.coffee_shop.my_first_dbt_model
[0m14:06:18.509440 [debug] [Thread-2 (]: Writing injected SQL for node "model.coffee_shop.my_first_dbt_model"
[0m14:06:18.517426 [debug] [Thread-2 (]: Timing info for model.coffee_shop.my_first_dbt_model (compile): 2023-02-17 14:06:18.504761 => 2023-02-17 14:06:18.517080
[0m14:06:18.518042 [debug] [Thread-2 (]: Began executing node model.coffee_shop.my_first_dbt_model
[0m14:06:18.575173 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:06:18.603037 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop.customers"
[0m14:06:18.603993 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:18.605014 [debug] [Thread-1 (]: On model.coffee_shop.customers: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.customers"} */


  create or replace view `aec-students`.`dbt_milan`.`customers`
  OPTIONS()
  as select * from `analytics-engineers-club.coffee_shop.customers`
Some bad SQL
limit 9000;;


[0m14:06:19.004181 [debug] [Thread-2 (]: Writing runtime sql for node "model.coffee_shop.my_first_dbt_model"
[0m14:06:19.005183 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected end of input but got keyword SOME at [7:1]')
[0m14:06:19.005902 [debug] [Thread-2 (]: On model.coffee_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.my_first_dbt_model"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`my_first_dbt_model`
    
    
    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m14:06:19.793100 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:9e1e5b9e-006d-420e-892d-f70400efaeef&page=queryresults
[0m14:06:19.793867 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (execute): 2023-02-17 14:06:18.493759 => 2023-02-17 14:06:19.793750
[0m14:06:19.850737 [debug] [Thread-1 (]: Database Error in model customers (models/customers.sql)
  Syntax error: Expected end of input but got keyword SOME at [7:1]
  compiled Code at target/run/coffee_shop/models/customers.sql
[0m14:06:19.851392 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4d75ae1-f72f-45d4-b391-6a2fa4baf61e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ca1f08f70>]}
[0m14:06:19.852084 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model dbt_milan.customers ....................... [[31mERROR[0m in 1.37s]
[0m14:06:19.854447 [debug] [Thread-1 (]: Finished running node model.coffee_shop.customers
[0m14:06:21.196306 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:bece9673-2b3a-4370-8143-c7ba8ffad906&page=queryresults
[0m14:06:21.213795 [debug] [Thread-2 (]: Timing info for model.coffee_shop.my_first_dbt_model (execute): 2023-02-17 14:06:18.518414 => 2023-02-17 14:06:21.213732
[0m14:06:21.214601 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4d75ae1-f72f-45d4-b391-6a2fa4baf61e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ca1d5cca0>]}
[0m14:06:21.215141 [info ] [Thread-2 (]: 2 of 3 OK created sql table model dbt_milan.my_first_dbt_model ................. [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 2.71s]
[0m14:06:21.215646 [debug] [Thread-2 (]: Finished running node model.coffee_shop.my_first_dbt_model
[0m14:06:21.216630 [debug] [Thread-4 (]: Began running node model.coffee_shop.my_second_dbt_model
[0m14:06:21.217033 [info ] [Thread-4 (]: 3 of 3 START sql view model dbt_milan.my_second_dbt_model ...................... [RUN]
[0m14:06:21.217901 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.coffee_shop.my_second_dbt_model'
[0m14:06:21.218190 [debug] [Thread-4 (]: Began compiling node model.coffee_shop.my_second_dbt_model
[0m14:06:21.220902 [debug] [Thread-4 (]: Writing injected SQL for node "model.coffee_shop.my_second_dbt_model"
[0m14:06:21.221463 [debug] [Thread-4 (]: Timing info for model.coffee_shop.my_second_dbt_model (compile): 2023-02-17 14:06:21.218364 => 2023-02-17 14:06:21.221378
[0m14:06:21.221864 [debug] [Thread-4 (]: Began executing node model.coffee_shop.my_second_dbt_model
[0m14:06:21.225746 [debug] [Thread-4 (]: Writing runtime sql for node "model.coffee_shop.my_second_dbt_model"
[0m14:06:21.226342 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:06:21.226774 [debug] [Thread-4 (]: On model.coffee_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.my_second_dbt_model"} */


  create or replace view `aec-students`.`dbt_milan`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `aec-students`.`dbt_milan`.`my_first_dbt_model`
where id = 1;


[0m14:06:22.017949 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:82e64039-7276-4244-a70a-02c2a61bd085&page=queryresults
[0m14:06:22.020165 [debug] [Thread-4 (]: Timing info for model.coffee_shop.my_second_dbt_model (execute): 2023-02-17 14:06:21.222103 => 2023-02-17 14:06:22.020104
[0m14:06:22.021014 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4d75ae1-f72f-45d4-b391-6a2fa4baf61e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ca1d5eb00>]}
[0m14:06:22.021595 [info ] [Thread-4 (]: 3 of 3 OK created sql view model dbt_milan.my_second_dbt_model ................. [[32mCREATE VIEW (0 processed)[0m in 0.80s]
[0m14:06:22.022265 [debug] [Thread-4 (]: Finished running node model.coffee_shop.my_second_dbt_model
[0m14:06:22.024114 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:06:22.024683 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:06:22.024907 [debug] [MainThread]: Connection 'model.coffee_shop.customers' was properly closed.
[0m14:06:22.025082 [debug] [MainThread]: Connection 'model.coffee_shop.my_first_dbt_model' was properly closed.
[0m14:06:22.025281 [debug] [MainThread]: Connection 'model.coffee_shop.my_second_dbt_model' was properly closed.
[0m14:06:22.025513 [info ] [MainThread]: 
[0m14:06:22.025850 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 5.19 seconds (5.19s).
[0m14:06:22.027189 [debug] [MainThread]: Command end result
[0m14:06:22.041934 [info ] [MainThread]: 
[0m14:06:22.043229 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:06:22.044502 [info ] [MainThread]: 
[0m14:06:22.045647 [error] [MainThread]: [33mDatabase Error in model customers (models/customers.sql)[0m
[0m14:06:22.046441 [error] [MainThread]:   Syntax error: Expected end of input but got keyword SOME at [7:1]
[0m14:06:22.047631 [error] [MainThread]:   compiled Code at target/run/coffee_shop/models/customers.sql
[0m14:06:22.048423 [info ] [MainThread]: 
[0m14:06:22.049809 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m14:06:22.051049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ca1cf1450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ca1cdf8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ca1cdfb80>]}
[0m14:06:22.051517 [debug] [MainThread]: Flushing usage events


============================== 2023-02-17 14:06:50.566125 | 171e1bbc-635c-4f0b-9872-21304fc03526 ==============================
[0m14:06:50.566125 [info ] [MainThread]: Running with dbt=1.4.1
[0m14:06:50.570110 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:06:50.570531 [debug] [MainThread]: Tracking: tracking
[0m14:06:50.572441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72df35f640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72df35ea70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72df35f670>]}
[0m14:06:50.620994 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:06:50.621565 [debug] [MainThread]: Partial parsing: updated file: coffee_shop://models/customers.sql
[0m14:06:50.650714 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
[0m14:06:50.670777 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffe_shop_milan.example
[0m14:06:50.676411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '171e1bbc-635c-4f0b-9872-21304fc03526', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72ded75f90>]}
[0m14:06:50.685821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '171e1bbc-635c-4f0b-9872-21304fc03526', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72df2e3fd0>]}
[0m14:06:50.686318 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 334 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m14:06:50.686780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '171e1bbc-635c-4f0b-9872-21304fc03526', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72df2cd360>]}
[0m14:06:50.688296 [info ] [MainThread]: 
[0m14:06:50.690484 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:06:50.691987 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m14:06:50.692435 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:06:51.869699 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_milan'
[0m14:06:51.870530 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:06:52.143614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '171e1bbc-635c-4f0b-9872-21304fc03526', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72df3706d0>]}
[0m14:06:52.144845 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m14:06:52.145955 [info ] [MainThread]: 
[0m14:06:52.153348 [debug] [Thread-1 (]: Began running node model.coffee_shop.customers
[0m14:06:52.153671 [debug] [Thread-2 (]: Began running node model.coffee_shop.my_first_dbt_model
[0m14:06:52.154118 [info ] [Thread-1 (]: 1 of 3 START sql view model dbt_milan.customers ................................ [RUN]
[0m14:06:52.154506 [info ] [Thread-2 (]: 2 of 3 START sql table model dbt_milan.my_first_dbt_model ...................... [RUN]
[0m14:06:52.155626 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop.customers'
[0m14:06:52.156279 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.coffee_shop.my_first_dbt_model'
[0m14:06:52.156983 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.customers
[0m14:06:52.157294 [debug] [Thread-2 (]: Began compiling node model.coffee_shop.my_first_dbt_model
[0m14:06:52.161214 [debug] [Thread-2 (]: Writing injected SQL for node "model.coffee_shop.my_first_dbt_model"
[0m14:06:52.215655 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.customers"
[0m14:06:52.216385 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (compile): 2023-02-17 14:06:52.157588 => 2023-02-17 14:06:52.216276
[0m14:06:52.216651 [debug] [Thread-2 (]: Timing info for model.coffee_shop.my_first_dbt_model (compile): 2023-02-17 14:06:52.158563 => 2023-02-17 14:06:52.216602
[0m14:06:52.216977 [debug] [Thread-1 (]: Began executing node model.coffee_shop.customers
[0m14:06:52.217308 [debug] [Thread-2 (]: Began executing node model.coffee_shop.my_first_dbt_model
[0m14:06:52.268020 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:06:52.270220 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop.customers"
[0m14:06:52.272884 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:06:52.273710 [debug] [Thread-1 (]: On model.coffee_shop.customers: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.customers"} */


  create or replace view `aec-students`.`dbt_milan`.`customers`
  OPTIONS()
  as select * from `analytics-engineers-club.coffee_shop.customers`
limit 9000;;


[0m14:06:52.644051 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected end of input but got ";" at [7:12]')
[0m14:06:52.665404 [debug] [Thread-2 (]: Writing runtime sql for node "model.coffee_shop.my_first_dbt_model"
[0m14:06:52.666107 [debug] [Thread-2 (]: On model.coffee_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.my_first_dbt_model"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`my_first_dbt_model`
    
    
    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m14:06:53.177871 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:b279d14b-745d-4f28-b016-5f1fcc6b62e0&page=queryresults
[0m14:06:53.178671 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (execute): 2023-02-17 14:06:52.217509 => 2023-02-17 14:06:53.178559
[0m14:06:53.181720 [debug] [Thread-1 (]: Database Error in model customers (models/customers.sql)
  Syntax error: Expected end of input but got ";" at [7:12]
  compiled Code at target/run/coffee_shop/models/customers.sql
[0m14:06:53.182218 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '171e1bbc-635c-4f0b-9872-21304fc03526', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72df539c90>]}
[0m14:06:53.182723 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model dbt_milan.customers ....................... [[31mERROR[0m in 1.03s]
[0m14:06:53.184606 [debug] [Thread-1 (]: Finished running node model.coffee_shop.customers
[0m14:06:54.821922 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:48c3d8d5-6a4d-476a-b08c-bfb2d541a62c&page=queryresults
[0m14:06:54.842548 [debug] [Thread-2 (]: Timing info for model.coffee_shop.my_first_dbt_model (execute): 2023-02-17 14:06:52.235754 => 2023-02-17 14:06:54.842464
[0m14:06:54.843609 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '171e1bbc-635c-4f0b-9872-21304fc03526', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72df539ab0>]}
[0m14:06:54.844357 [info ] [Thread-2 (]: 2 of 3 OK created sql table model dbt_milan.my_first_dbt_model ................. [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 2.69s]
[0m14:06:54.844921 [debug] [Thread-2 (]: Finished running node model.coffee_shop.my_first_dbt_model
[0m14:06:54.845883 [debug] [Thread-4 (]: Began running node model.coffee_shop.my_second_dbt_model
[0m14:06:54.847196 [info ] [Thread-4 (]: 3 of 3 START sql view model dbt_milan.my_second_dbt_model ...................... [RUN]
[0m14:06:54.849822 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.coffee_shop.my_second_dbt_model'
[0m14:06:54.850415 [debug] [Thread-4 (]: Began compiling node model.coffee_shop.my_second_dbt_model
[0m14:06:54.854928 [debug] [Thread-4 (]: Writing injected SQL for node "model.coffee_shop.my_second_dbt_model"
[0m14:06:54.855894 [debug] [Thread-4 (]: Timing info for model.coffee_shop.my_second_dbt_model (compile): 2023-02-17 14:06:54.850807 => 2023-02-17 14:06:54.855788
[0m14:06:54.856357 [debug] [Thread-4 (]: Began executing node model.coffee_shop.my_second_dbt_model
[0m14:06:54.860487 [debug] [Thread-4 (]: Writing runtime sql for node "model.coffee_shop.my_second_dbt_model"
[0m14:06:54.861231 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:06:54.861619 [debug] [Thread-4 (]: On model.coffee_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.my_second_dbt_model"} */


  create or replace view `aec-students`.`dbt_milan`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `aec-students`.`dbt_milan`.`my_first_dbt_model`
where id = 1;


[0m14:06:55.596819 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:e908f733-eaca-4355-a41d-d13ba12360c4&page=queryresults
[0m14:06:55.598976 [debug] [Thread-4 (]: Timing info for model.coffee_shop.my_second_dbt_model (execute): 2023-02-17 14:06:54.856640 => 2023-02-17 14:06:55.598914
[0m14:06:55.599857 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '171e1bbc-635c-4f0b-9872-21304fc03526', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72ded9f9a0>]}
[0m14:06:55.600426 [info ] [Thread-4 (]: 3 of 3 OK created sql view model dbt_milan.my_second_dbt_model ................. [[32mCREATE VIEW (0 processed)[0m in 0.75s]
[0m14:06:55.600982 [debug] [Thread-4 (]: Finished running node model.coffee_shop.my_second_dbt_model
[0m14:06:55.602900 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:06:55.603552 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:06:55.603792 [debug] [MainThread]: Connection 'model.coffee_shop.customers' was properly closed.
[0m14:06:55.604023 [debug] [MainThread]: Connection 'model.coffee_shop.my_first_dbt_model' was properly closed.
[0m14:06:55.604209 [debug] [MainThread]: Connection 'model.coffee_shop.my_second_dbt_model' was properly closed.
[0m14:06:55.604482 [info ] [MainThread]: 
[0m14:06:55.604909 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 4.92 seconds (4.92s).
[0m14:06:55.605578 [debug] [MainThread]: Command end result
[0m14:06:55.616327 [info ] [MainThread]: 
[0m14:06:55.616987 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:06:55.617495 [info ] [MainThread]: 
[0m14:06:55.617935 [error] [MainThread]: [33mDatabase Error in model customers (models/customers.sql)[0m
[0m14:06:55.618365 [error] [MainThread]:   Syntax error: Expected end of input but got ";" at [7:12]
[0m14:06:55.618849 [error] [MainThread]:   compiled Code at target/run/coffee_shop/models/customers.sql
[0m14:06:55.619356 [info ] [MainThread]: 
[0m14:06:55.619788 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m14:06:55.620295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72df788d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72df329d80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72df329d20>]}
[0m14:06:55.620671 [debug] [MainThread]: Flushing usage events


============================== 2023-02-17 14:07:17.658002 | cd46476c-e855-4feb-ad5b-4a06dda73bbf ==============================
[0m14:07:17.658002 [info ] [MainThread]: Running with dbt=1.4.1
[0m14:07:17.660861 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:07:17.661352 [debug] [MainThread]: Tracking: tracking
[0m14:07:17.664490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaab85f700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaab85c190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaab85f730>]}
[0m14:07:17.714073 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:07:17.714725 [debug] [MainThread]: Partial parsing: updated file: coffee_shop://models/customers.sql
[0m14:07:17.727516 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
[0m14:07:17.751341 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffe_shop_milan.example
[0m14:07:17.757367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cd46476c-e855-4feb-ad5b-4a06dda73bbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaab275d20>]}
[0m14:07:17.764693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cd46476c-e855-4feb-ad5b-4a06dda73bbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaab7e3f10>]}
[0m14:07:17.765186 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 334 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m14:07:17.765638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd46476c-e855-4feb-ad5b-4a06dda73bbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaab7d10f0>]}
[0m14:07:17.767477 [info ] [MainThread]: 
[0m14:07:17.769567 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:07:17.771052 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m14:07:17.771527 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:07:18.935078 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_milan'
[0m14:07:18.935695 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:07:19.222866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd46476c-e855-4feb-ad5b-4a06dda73bbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaab822f50>]}
[0m14:07:19.224162 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m14:07:19.225632 [info ] [MainThread]: 
[0m14:07:19.233129 [debug] [Thread-1 (]: Began running node model.coffee_shop.customers
[0m14:07:19.233774 [info ] [Thread-1 (]: 1 of 3 START sql view model dbt_milan.customers ................................ [RUN]
[0m14:07:19.240455 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop.customers'
[0m14:07:19.240977 [debug] [Thread-2 (]: Began running node model.coffee_shop.my_first_dbt_model
[0m14:07:19.242250 [info ] [Thread-2 (]: 2 of 3 START sql table model dbt_milan.my_first_dbt_model ...................... [RUN]
[0m14:07:19.243217 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.coffee_shop.my_first_dbt_model'
[0m14:07:19.243607 [debug] [Thread-2 (]: Began compiling node model.coffee_shop.my_first_dbt_model
[0m14:07:19.241544 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.customers
[0m14:07:19.251070 [debug] [Thread-2 (]: Writing injected SQL for node "model.coffee_shop.my_first_dbt_model"
[0m14:07:19.305338 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.customers"
[0m14:07:19.306324 [debug] [Thread-2 (]: Timing info for model.coffee_shop.my_first_dbt_model (compile): 2023-02-17 14:07:19.243848 => 2023-02-17 14:07:19.306224
[0m14:07:19.306788 [debug] [Thread-2 (]: Began executing node model.coffee_shop.my_first_dbt_model
[0m14:07:19.307052 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (compile): 2023-02-17 14:07:19.251810 => 2023-02-17 14:07:19.306994
[0m14:07:19.322867 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:07:19.323958 [debug] [Thread-1 (]: Began executing node model.coffee_shop.customers
[0m14:07:19.364651 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop.customers"
[0m14:07:19.365662 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:07:19.366791 [debug] [Thread-1 (]: On model.coffee_shop.customers: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.customers"} */


  create or replace view `aec-students`.`dbt_milan`.`customers`
  OPTIONS()
  as select * from `analytics-engineers-club.coffee_shop.customers`
limit 9000;


[0m14:07:19.744609 [debug] [Thread-2 (]: Writing runtime sql for node "model.coffee_shop.my_first_dbt_model"
[0m14:07:19.745594 [debug] [Thread-2 (]: On model.coffee_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.my_first_dbt_model"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`my_first_dbt_model`
    
    
    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m14:07:20.195496 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:51bd58ae-c9bb-4441-8f13-ade0cb01ad03&page=queryresults
[0m14:07:20.210701 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (execute): 2023-02-17 14:07:19.325826 => 2023-02-17 14:07:20.210621
[0m14:07:20.211631 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd46476c-e855-4feb-ad5b-4a06dda73bbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaab29b7c0>]}
[0m14:07:20.212225 [info ] [Thread-1 (]: 1 of 3 OK created sql view model dbt_milan.customers ........................... [[32mCREATE VIEW (0 processed)[0m in 0.98s]
[0m14:07:20.214004 [debug] [Thread-1 (]: Finished running node model.coffee_shop.customers
[0m14:07:21.939473 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:cf860ebb-73a9-48ab-afb5-ff2b39136f41&page=queryresults
[0m14:07:21.945845 [debug] [Thread-2 (]: Timing info for model.coffee_shop.my_first_dbt_model (execute): 2023-02-17 14:07:19.307237 => 2023-02-17 14:07:21.945760
[0m14:07:21.947058 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd46476c-e855-4feb-ad5b-4a06dda73bbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaab8602b0>]}
[0m14:07:21.947739 [info ] [Thread-2 (]: 2 of 3 OK created sql table model dbt_milan.my_first_dbt_model ................. [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 2.70s]
[0m14:07:21.948380 [debug] [Thread-2 (]: Finished running node model.coffee_shop.my_first_dbt_model
[0m14:07:21.949551 [debug] [Thread-4 (]: Began running node model.coffee_shop.my_second_dbt_model
[0m14:07:21.950220 [info ] [Thread-4 (]: 3 of 3 START sql view model dbt_milan.my_second_dbt_model ...................... [RUN]
[0m14:07:21.951202 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.coffee_shop.my_second_dbt_model'
[0m14:07:21.951621 [debug] [Thread-4 (]: Began compiling node model.coffee_shop.my_second_dbt_model
[0m14:07:21.955537 [debug] [Thread-4 (]: Writing injected SQL for node "model.coffee_shop.my_second_dbt_model"
[0m14:07:21.956193 [debug] [Thread-4 (]: Timing info for model.coffee_shop.my_second_dbt_model (compile): 2023-02-17 14:07:21.951869 => 2023-02-17 14:07:21.956103
[0m14:07:21.956628 [debug] [Thread-4 (]: Began executing node model.coffee_shop.my_second_dbt_model
[0m14:07:21.959720 [debug] [Thread-4 (]: Writing runtime sql for node "model.coffee_shop.my_second_dbt_model"
[0m14:07:21.960351 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:07:21.960809 [debug] [Thread-4 (]: On model.coffee_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.my_second_dbt_model"} */


  create or replace view `aec-students`.`dbt_milan`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `aec-students`.`dbt_milan`.`my_first_dbt_model`
where id = 1;


[0m14:07:22.661500 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:e37d40a7-6a20-4a5e-bc7b-c99c04fcf3e9&page=queryresults
[0m14:07:22.663546 [debug] [Thread-4 (]: Timing info for model.coffee_shop.my_second_dbt_model (execute): 2023-02-17 14:07:21.956875 => 2023-02-17 14:07:22.663484
[0m14:07:22.664401 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd46476c-e855-4feb-ad5b-4a06dda73bbf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaab16f5b0>]}
[0m14:07:22.664969 [info ] [Thread-4 (]: 3 of 3 OK created sql view model dbt_milan.my_second_dbt_model ................. [[32mCREATE VIEW (0 processed)[0m in 0.71s]
[0m14:07:22.665544 [debug] [Thread-4 (]: Finished running node model.coffee_shop.my_second_dbt_model
[0m14:07:22.667366 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:07:22.667999 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:07:22.668218 [debug] [MainThread]: Connection 'model.coffee_shop.my_first_dbt_model' was properly closed.
[0m14:07:22.668422 [debug] [MainThread]: Connection 'model.coffee_shop.customers' was properly closed.
[0m14:07:22.668612 [debug] [MainThread]: Connection 'model.coffee_shop.my_second_dbt_model' was properly closed.
[0m14:07:22.668890 [info ] [MainThread]: 
[0m14:07:22.669231 [info ] [MainThread]: Finished running 2 view models, 1 table model in 0 hours 0 minutes and 4.90 seconds (4.90s).
[0m14:07:22.669768 [debug] [MainThread]: Command end result
[0m14:07:22.676647 [info ] [MainThread]: 
[0m14:07:22.677855 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:07:22.678342 [info ] [MainThread]: 
[0m14:07:22.679077 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m14:07:22.679675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaab340c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaab340d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7feaab3408b0>]}
[0m14:07:22.680349 [debug] [MainThread]: Flushing usage events


============================== 2023-02-17 14:11:50.392492 | d7b687ae-24ef-434a-8df8-4affb71472ec ==============================
[0m14:11:50.392492 [info ] [MainThread]: Running with dbt=1.4.1
[0m14:11:50.395088 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:11:50.395442 [debug] [MainThread]: Tracking: tracking
[0m14:11:50.397680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f662055f700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f662055dd20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f662055f730>]}
[0m14:11:50.455303 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:11:50.456054 [debug] [MainThread]: Partial parsing: updated file: coffee_shop://models/customers.sql
[0m14:11:50.474956 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
[0m14:11:50.493589 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffe_shop_milan.example
[0m14:11:50.499366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd7b687ae-24ef-434a-8df8-4affb71472ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f661bf2df30>]}
[0m14:11:50.507583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd7b687ae-24ef-434a-8df8-4affb71472ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66204cd2d0>]}
[0m14:11:50.508081 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 334 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m14:11:50.508696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd7b687ae-24ef-434a-8df8-4affb71472ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66204cd300>]}
[0m14:11:50.510113 [info ] [MainThread]: 
[0m14:11:50.512407 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:11:50.514251 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m14:11:50.514772 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:11:51.743684 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_milan'
[0m14:11:51.744588 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:11:52.002889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd7b687ae-24ef-434a-8df8-4affb71472ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66204e3d00>]}
[0m14:11:52.003760 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m14:11:52.004172 [info ] [MainThread]: 
[0m14:11:52.008871 [debug] [Thread-1 (]: Began running node model.coffee_shop.customers
[0m14:11:52.009201 [debug] [Thread-2 (]: Began running node model.coffee_shop.my_first_dbt_model
[0m14:11:52.009655 [info ] [Thread-1 (]: 1 of 3 START sql table model dbt_milan.customers ............................... [RUN]
[0m14:11:52.010955 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop.customers'
[0m14:11:52.013160 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.customers
[0m14:11:52.010087 [info ] [Thread-2 (]: 2 of 3 START sql table model dbt_milan.my_first_dbt_model ...................... [RUN]
[0m14:11:52.022100 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.coffee_shop.my_first_dbt_model'
[0m14:11:52.022537 [debug] [Thread-2 (]: Began compiling node model.coffee_shop.my_first_dbt_model
[0m14:11:52.026325 [debug] [Thread-2 (]: Writing injected SQL for node "model.coffee_shop.my_first_dbt_model"
[0m14:11:52.027945 [debug] [Thread-2 (]: Timing info for model.coffee_shop.my_first_dbt_model (compile): 2023-02-17 14:11:52.022880 => 2023-02-17 14:11:52.027499
[0m14:11:52.097820 [debug] [Thread-2 (]: Began executing node model.coffee_shop.my_first_dbt_model
[0m14:11:52.100586 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.customers"
[0m14:11:52.112472 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (compile): 2023-02-17 14:11:52.018688 => 2023-02-17 14:11:52.112364
[0m14:11:52.117180 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:11:52.117705 [debug] [Thread-1 (]: Began executing node model.coffee_shop.customers
[0m14:11:52.121930 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:11:52.574603 [debug] [Thread-2 (]: Writing runtime sql for node "model.coffee_shop.my_first_dbt_model"
[0m14:11:52.575737 [debug] [Thread-2 (]: On model.coffee_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.my_first_dbt_model"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`my_first_dbt_model`
    
    
    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m14:11:52.732236 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop.customers"
[0m14:11:52.733009 [debug] [Thread-1 (]: On model.coffee_shop.customers: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.customers"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`customers`
    
    
    OPTIONS()
    as (
      

select * from `analytics-engineers-club.coffee_shop.customers`
limit 9000
    );
  
[0m14:11:54.813038 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:6c949409-35a1-48be-9cc3-c7c182affd39&page=queryresults
[0m14:11:54.830145 [debug] [Thread-2 (]: Timing info for model.coffee_shop.my_first_dbt_model (execute): 2023-02-17 14:11:52.100923 => 2023-02-17 14:11:54.830082
[0m14:11:54.830955 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7b687ae-24ef-434a-8df8-4affb71472ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f662070b8b0>]}
[0m14:11:54.831513 [info ] [Thread-2 (]: 2 of 3 OK created sql table model dbt_milan.my_first_dbt_model ................. [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 2.81s]
[0m14:11:54.833307 [debug] [Thread-2 (]: Finished running node model.coffee_shop.my_first_dbt_model
[0m14:11:54.834619 [debug] [Thread-4 (]: Began running node model.coffee_shop.my_second_dbt_model
[0m14:11:54.835122 [info ] [Thread-4 (]: 3 of 3 START sql view model dbt_milan.my_second_dbt_model ...................... [RUN]
[0m14:11:54.836677 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.coffee_shop.my_second_dbt_model'
[0m14:11:54.837907 [debug] [Thread-4 (]: Began compiling node model.coffee_shop.my_second_dbt_model
[0m14:11:54.843219 [debug] [Thread-4 (]: Writing injected SQL for node "model.coffee_shop.my_second_dbt_model"
[0m14:11:54.844217 [debug] [Thread-4 (]: Timing info for model.coffee_shop.my_second_dbt_model (compile): 2023-02-17 14:11:54.838302 => 2023-02-17 14:11:54.844119
[0m14:11:54.844716 [debug] [Thread-4 (]: Began executing node model.coffee_shop.my_second_dbt_model
[0m14:11:54.867686 [debug] [Thread-4 (]: Writing runtime sql for node "model.coffee_shop.my_second_dbt_model"
[0m14:11:54.868391 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:11:54.869068 [debug] [Thread-4 (]: On model.coffee_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.my_second_dbt_model"} */


  create or replace view `aec-students`.`dbt_milan`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `aec-students`.`dbt_milan`.`my_first_dbt_model`
where id = 1;


[0m14:11:55.024812 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:03ccae19-30c5-4e5a-b8aa-4ae706fdde45&page=queryresults
[0m14:11:55.026720 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (execute): 2023-02-17 14:11:52.119555 => 2023-02-17 14:11:55.026659
[0m14:11:55.027510 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7b687ae-24ef-434a-8df8-4affb71472ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f661bf4ee90>]}
[0m14:11:55.028097 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dbt_milan.customers .......................... [[32mCREATE TABLE (9.0k rows, 12.8 MB processed)[0m in 3.02s]
[0m14:11:55.028777 [debug] [Thread-1 (]: Finished running node model.coffee_shop.customers
[0m14:11:55.616279 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:25db2192-0268-47cd-9926-dd3076a2e730&page=queryresults
[0m14:11:55.618441 [debug] [Thread-4 (]: Timing info for model.coffee_shop.my_second_dbt_model (execute): 2023-02-17 14:11:54.845086 => 2023-02-17 14:11:55.618382
[0m14:11:55.619223 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7b687ae-24ef-434a-8df8-4affb71472ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f661bf4ed70>]}
[0m14:11:55.619744 [info ] [Thread-4 (]: 3 of 3 OK created sql view model dbt_milan.my_second_dbt_model ................. [[32mCREATE VIEW (0 processed)[0m in 0.78s]
[0m14:11:55.620220 [debug] [Thread-4 (]: Finished running node model.coffee_shop.my_second_dbt_model
[0m14:11:55.622272 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:11:55.622861 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:11:55.623082 [debug] [MainThread]: Connection 'model.coffee_shop.customers' was properly closed.
[0m14:11:55.623257 [debug] [MainThread]: Connection 'model.coffee_shop.my_first_dbt_model' was properly closed.
[0m14:11:55.623458 [debug] [MainThread]: Connection 'model.coffee_shop.my_second_dbt_model' was properly closed.
[0m14:11:55.623721 [info ] [MainThread]: 
[0m14:11:55.624064 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 5.11 seconds (5.11s).
[0m14:11:55.624635 [debug] [MainThread]: Command end result
[0m14:11:55.633155 [info ] [MainThread]: 
[0m14:11:55.639494 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:11:55.641709 [info ] [MainThread]: 
[0m14:11:55.643056 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m14:11:55.643999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66204cd300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66205735e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f66205705e0>]}
[0m14:11:55.644418 [debug] [MainThread]: Flushing usage events


============================== 2023-02-17 14:22:25.108088 | a77c8c04-517f-463b-836a-6d5faa265115 ==============================
[0m14:22:25.108088 [info ] [MainThread]: Running with dbt=1.4.1
[0m14:22:25.110707 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:22:25.111070 [debug] [MainThread]: Tracking: tracking
[0m14:22:25.112891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d5055f700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d5055d8a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d5055f730>]}
[0m14:22:25.164922 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m14:22:25.165662 [debug] [MainThread]: Partial parsing: added file: coffee_shop://models/customers_ref.sql
[0m14:22:25.185319 [debug] [MainThread]: 1699: static parser successfully parsed customers_ref.sql
[0m14:22:25.203335 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffe_shop_milan.example
[0m14:22:25.208932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a77c8c04-517f-463b-836a-6d5faa265115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d4bf3ddb0>]}
[0m14:22:25.216650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a77c8c04-517f-463b-836a-6d5faa265115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d504e3eb0>]}
[0m14:22:25.217143 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 334 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m14:22:25.217750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a77c8c04-517f-463b-836a-6d5faa265115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d504e3e80>]}
[0m14:22:25.219373 [info ] [MainThread]: 
[0m14:22:25.221572 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:22:25.223000 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m14:22:25.223484 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:22:26.428774 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_milan'
[0m14:22:26.429361 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:22:26.688585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a77c8c04-517f-463b-836a-6d5faa265115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d504e3c70>]}
[0m14:22:26.689384 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m14:22:26.690173 [info ] [MainThread]: 
[0m14:22:26.696002 [debug] [Thread-1 (]: Began running node model.coffee_shop.customers
[0m14:22:26.696753 [info ] [Thread-1 (]: 1 of 3 START sql table model dbt_milan.customers ............................... [RUN]
[0m14:22:26.697568 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop.customers'
[0m14:22:26.697858 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.customers
[0m14:22:26.747772 [debug] [Thread-2 (]: Began running node model.coffee_shop.my_first_dbt_model
[0m14:22:26.748427 [info ] [Thread-2 (]: 2 of 3 START sql table model dbt_milan.my_first_dbt_model ...................... [RUN]
[0m14:22:26.749398 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.coffee_shop.my_first_dbt_model'
[0m14:22:26.749801 [debug] [Thread-2 (]: Began compiling node model.coffee_shop.my_first_dbt_model
[0m14:22:26.753988 [debug] [Thread-2 (]: Writing injected SQL for node "model.coffee_shop.my_first_dbt_model"
[0m14:22:26.759650 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.customers"
[0m14:22:26.760566 [debug] [Thread-2 (]: Timing info for model.coffee_shop.my_first_dbt_model (compile): 2023-02-17 14:22:26.750068 => 2023-02-17 14:22:26.760341
[0m14:22:26.760822 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (compile): 2023-02-17 14:22:26.698031 => 2023-02-17 14:22:26.760764
[0m14:22:26.761118 [debug] [Thread-2 (]: Began executing node model.coffee_shop.my_first_dbt_model
[0m14:22:26.761416 [debug] [Thread-1 (]: Began executing node model.coffee_shop.customers
[0m14:22:26.782564 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:22:26.788707 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:22:27.223169 [debug] [Thread-2 (]: Writing runtime sql for node "model.coffee_shop.my_first_dbt_model"
[0m14:22:27.223557 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop.customers"
[0m14:22:27.224652 [debug] [Thread-2 (]: On model.coffee_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.my_first_dbt_model"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`my_first_dbt_model`
    
    
    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m14:22:27.225148 [debug] [Thread-1 (]: On model.coffee_shop.customers: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.customers"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`customers`
    
    
    OPTIONS()
    as (
      

select * from `analytics-engineers-club.coffee_shop.customers`
limit 9000
    );
  
[0m14:22:29.357582 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:0f1c114c-9665-44db-87a4-d6a5f33d747e&page=queryresults
[0m14:22:29.378582 [debug] [Thread-2 (]: Timing info for model.coffee_shop.my_first_dbt_model (execute): 2023-02-17 14:22:26.761613 => 2023-02-17 14:22:29.378514
[0m14:22:29.379395 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a77c8c04-517f-463b-836a-6d5faa265115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d5098e950>]}
[0m14:22:29.379966 [info ] [Thread-2 (]: 2 of 3 OK created sql table model dbt_milan.my_first_dbt_model ................. [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 2.63s]
[0m14:22:29.382731 [debug] [Thread-2 (]: Finished running node model.coffee_shop.my_first_dbt_model
[0m14:22:29.383901 [debug] [Thread-4 (]: Began running node model.coffee_shop.my_second_dbt_model
[0m14:22:29.384425 [info ] [Thread-4 (]: 3 of 3 START sql view model dbt_milan.my_second_dbt_model ...................... [RUN]
[0m14:22:29.385331 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.coffee_shop.my_second_dbt_model'
[0m14:22:29.385640 [debug] [Thread-4 (]: Began compiling node model.coffee_shop.my_second_dbt_model
[0m14:22:29.388933 [debug] [Thread-4 (]: Writing injected SQL for node "model.coffee_shop.my_second_dbt_model"
[0m14:22:29.389891 [debug] [Thread-4 (]: Timing info for model.coffee_shop.my_second_dbt_model (compile): 2023-02-17 14:22:29.385826 => 2023-02-17 14:22:29.389771
[0m14:22:29.390376 [debug] [Thread-4 (]: Began executing node model.coffee_shop.my_second_dbt_model
[0m14:22:29.420641 [debug] [Thread-4 (]: Writing runtime sql for node "model.coffee_shop.my_second_dbt_model"
[0m14:22:29.422985 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:22:29.423534 [debug] [Thread-4 (]: On model.coffee_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.my_second_dbt_model"} */


  create or replace view `aec-students`.`dbt_milan`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `aec-students`.`dbt_milan`.`my_first_dbt_model`
where id = 1;


[0m14:22:29.798194 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:718e437c-d621-43d2-b33a-e558ca1757dc&page=queryresults
[0m14:22:29.800130 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (execute): 2023-02-17 14:22:26.773078 => 2023-02-17 14:22:29.800066
[0m14:22:29.800896 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a77c8c04-517f-463b-836a-6d5faa265115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d4bfe4e50>]}
[0m14:22:29.801411 [info ] [Thread-1 (]: 1 of 3 OK created sql table model dbt_milan.customers .......................... [[32mCREATE TABLE (9.0k rows, 12.8 MB processed)[0m in 3.10s]
[0m14:22:29.802150 [debug] [Thread-1 (]: Finished running node model.coffee_shop.customers
[0m14:22:30.226935 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:43ed5ab1-ab39-474a-80ce-e91319209bef&page=queryresults
[0m14:22:30.229004 [debug] [Thread-4 (]: Timing info for model.coffee_shop.my_second_dbt_model (execute): 2023-02-17 14:22:29.390647 => 2023-02-17 14:22:30.228943
[0m14:22:30.229779 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a77c8c04-517f-463b-836a-6d5faa265115', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d50573b50>]}
[0m14:22:30.230292 [info ] [Thread-4 (]: 3 of 3 OK created sql view model dbt_milan.my_second_dbt_model ................. [[32mCREATE VIEW (0 processed)[0m in 0.84s]
[0m14:22:30.230771 [debug] [Thread-4 (]: Finished running node model.coffee_shop.my_second_dbt_model
[0m14:22:30.232972 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:22:30.233789 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:22:30.234267 [debug] [MainThread]: Connection 'model.coffee_shop.customers' was properly closed.
[0m14:22:30.234677 [debug] [MainThread]: Connection 'model.coffee_shop.my_first_dbt_model' was properly closed.
[0m14:22:30.235058 [debug] [MainThread]: Connection 'model.coffee_shop.my_second_dbt_model' was properly closed.
[0m14:22:30.235603 [info ] [MainThread]: 
[0m14:22:30.236585 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 5.02 seconds (5.02s).
[0m14:22:30.237949 [debug] [MainThread]: Command end result
[0m14:22:30.252287 [info ] [MainThread]: 
[0m14:22:30.253297 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:22:30.254143 [info ] [MainThread]: 
[0m14:22:30.259138 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m14:22:30.259971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d504e39a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d504e3af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d504e3970>]}
[0m14:22:30.260379 [debug] [MainThread]: Flushing usage events


============================== 2023-02-17 14:29:49.912165 | 135f21ac-d10e-4c2b-b917-0e530633c020 ==============================
[0m14:29:49.912165 [info ] [MainThread]: Running with dbt=1.4.1
[0m14:29:49.914784 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:29:49.915164 [debug] [MainThread]: Tracking: tracking
[0m14:29:49.920681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00cf25f4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00cf25c580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00cf25f5b0>]}
[0m14:29:49.973358 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m14:29:49.974308 [debug] [MainThread]: Partial parsing: updated file: coffee_shop://models/customers.sql
[0m14:29:49.974998 [debug] [MainThread]: Partial parsing: updated file: coffee_shop://models/customers_ref.sql
[0m14:29:49.993843 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
[0m14:29:50.006752 [debug] [MainThread]: 1699: static parser successfully parsed customers_ref.sql
[0m14:29:50.013596 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffe_shop_milan.example
[0m14:29:50.019373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '135f21ac-d10e-4c2b-b917-0e530633c020', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00cec880d0>]}
[0m14:29:50.027829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '135f21ac-d10e-4c2b-b917-0e530633c020', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00cf1e77c0>]}
[0m14:29:50.028445 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 334 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m14:29:50.028916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '135f21ac-d10e-4c2b-b917-0e530633c020', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00cf1d56c0>]}
[0m14:29:50.030462 [info ] [MainThread]: 
[0m14:29:50.032639 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:29:50.034498 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m14:29:50.035125 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:29:51.213456 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_milan'
[0m14:29:51.214023 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:29:51.523977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '135f21ac-d10e-4c2b-b917-0e530633c020', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00cf1e7dc0>]}
[0m14:29:51.524760 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m14:29:51.525360 [info ] [MainThread]: 
[0m14:29:51.530147 [debug] [Thread-1 (]: Began running node model.coffee_shop.customers
[0m14:29:51.530465 [debug] [Thread-2 (]: Began running node model.coffee_shop.my_first_dbt_model
[0m14:29:51.530950 [info ] [Thread-1 (]: 1 of 4 START sql view model dbt_milan.customers ................................ [RUN]
[0m14:29:51.532582 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop.customers'
[0m14:29:51.533107 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.customers
[0m14:29:51.531361 [info ] [Thread-2 (]: 2 of 4 START sql table model dbt_milan.my_first_dbt_model ...................... [RUN]
[0m14:29:51.592563 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.coffee_shop.my_first_dbt_model'
[0m14:29:51.594296 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.customers"
[0m14:29:51.594594 [debug] [Thread-2 (]: Began compiling node model.coffee_shop.my_first_dbt_model
[0m14:29:51.598866 [debug] [Thread-2 (]: Writing injected SQL for node "model.coffee_shop.my_first_dbt_model"
[0m14:29:51.599174 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (compile): 2023-02-17 14:29:51.533415 => 2023-02-17 14:29:51.599104
[0m14:29:51.600289 [debug] [Thread-1 (]: Began executing node model.coffee_shop.customers
[0m14:29:51.600533 [debug] [Thread-2 (]: Timing info for model.coffee_shop.my_first_dbt_model (compile): 2023-02-17 14:29:51.595044 => 2023-02-17 14:29:51.600479
[0m14:29:51.621717 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (execute): 2023-02-17 14:29:51.600726 => 2023-02-17 14:29:51.621629
[0m14:29:51.622214 [debug] [Thread-2 (]: Began executing node model.coffee_shop.my_first_dbt_model
[0m14:29:51.636955 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:29:51.637686 [debug] [Thread-1 (]: Compilation Error in model customers (models/customers.sql)
  Trying to create view `aec-students`.`dbt_milan`.`customers`, but it currently exists as a table. Either drop `aec-students`.`dbt_milan`.`customers` manually, or run dbt with `--full-refresh` and dbt will drop it for you.
  
  > in macro bigquery__handle_existing_table (macros/materializations/view.sql)
  > called by macro handle_existing_table (macros/materializations/models/view/helpers.sql)
  > called by macro create_or_replace_view (macros/materializations/models/view/create_or_replace_view.sql)
  > called by macro materialization_view_bigquery (macros/materializations/view.sql)
  > called by model customers (models/customers.sql)
[0m14:29:51.642358 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '135f21ac-d10e-4c2b-b917-0e530633c020', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00cf15a800>]}
[0m14:29:51.643219 [error] [Thread-1 (]: 1 of 4 ERROR creating sql view model dbt_milan.customers ....................... [[31mERROR[0m in 0.11s]
[0m14:29:51.646381 [debug] [Thread-1 (]: Finished running node model.coffee_shop.customers
[0m14:29:51.648328 [debug] [Thread-4 (]: Began running node model.coffee_shop.customers_ref
[0m14:29:51.648968 [info ] [Thread-4 (]: 3 of 4 SKIP relation dbt_milan.customers_ref ................................... [[33mSKIP[0m]
[0m14:29:51.649799 [debug] [Thread-4 (]: Finished running node model.coffee_shop.customers_ref
[0m14:29:51.967537 [debug] [Thread-2 (]: Writing runtime sql for node "model.coffee_shop.my_first_dbt_model"
[0m14:29:51.968629 [debug] [Thread-2 (]: On model.coffee_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.my_first_dbt_model"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`my_first_dbt_model`
    
    
    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m14:29:54.197894 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:8aac5d81-ca85-4645-8dd4-6bb894a135c6&page=queryresults
[0m14:29:54.215924 [debug] [Thread-2 (]: Timing info for model.coffee_shop.my_first_dbt_model (execute): 2023-02-17 14:29:51.623164 => 2023-02-17 14:29:54.215859
[0m14:29:54.216731 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '135f21ac-d10e-4c2b-b917-0e530633c020', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00cf43e1d0>]}
[0m14:29:54.217253 [info ] [Thread-2 (]: 2 of 4 OK created sql table model dbt_milan.my_first_dbt_model ................. [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 2.62s]
[0m14:29:54.217746 [debug] [Thread-2 (]: Finished running node model.coffee_shop.my_first_dbt_model
[0m14:29:54.218700 [debug] [Thread-6 (]: Began running node model.coffee_shop.my_second_dbt_model
[0m14:29:54.219118 [info ] [Thread-6 (]: 4 of 4 START sql view model dbt_milan.my_second_dbt_model ...................... [RUN]
[0m14:29:54.220216 [debug] [Thread-6 (]: Acquiring new bigquery connection 'model.coffee_shop.my_second_dbt_model'
[0m14:29:54.220514 [debug] [Thread-6 (]: Began compiling node model.coffee_shop.my_second_dbt_model
[0m14:29:54.223696 [debug] [Thread-6 (]: Writing injected SQL for node "model.coffee_shop.my_second_dbt_model"
[0m14:29:54.224365 [debug] [Thread-6 (]: Timing info for model.coffee_shop.my_second_dbt_model (compile): 2023-02-17 14:29:54.220701 => 2023-02-17 14:29:54.224272
[0m14:29:54.224719 [debug] [Thread-6 (]: Began executing node model.coffee_shop.my_second_dbt_model
[0m14:29:54.237728 [debug] [Thread-6 (]: Writing runtime sql for node "model.coffee_shop.my_second_dbt_model"
[0m14:29:54.238497 [debug] [Thread-6 (]: Opening a new connection, currently in state init
[0m14:29:54.239019 [debug] [Thread-6 (]: On model.coffee_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.my_second_dbt_model"} */


  create or replace view `aec-students`.`dbt_milan`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `aec-students`.`dbt_milan`.`my_first_dbt_model`
where id = 1;


[0m14:29:55.083007 [debug] [Thread-6 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:f7a2fad2-2e8d-452e-8c87-1f28e5576073&page=queryresults
[0m14:29:55.085097 [debug] [Thread-6 (]: Timing info for model.coffee_shop.my_second_dbt_model (execute): 2023-02-17 14:29:54.224911 => 2023-02-17 14:29:55.085034
[0m14:29:55.085887 [debug] [Thread-6 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '135f21ac-d10e-4c2b-b917-0e530633c020', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00cebb3640>]}
[0m14:29:55.086402 [info ] [Thread-6 (]: 4 of 4 OK created sql view model dbt_milan.my_second_dbt_model ................. [[32mCREATE VIEW (0 processed)[0m in 0.87s]
[0m14:29:55.086873 [debug] [Thread-6 (]: Finished running node model.coffee_shop.my_second_dbt_model
[0m14:29:55.088706 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:29:55.089270 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:29:55.089494 [debug] [MainThread]: Connection 'model.coffee_shop.my_first_dbt_model' was properly closed.
[0m14:29:55.089676 [debug] [MainThread]: Connection 'model.coffee_shop.customers' was properly closed.
[0m14:29:55.089834 [debug] [MainThread]: Connection 'model.coffee_shop.my_second_dbt_model' was properly closed.
[0m14:29:55.090058 [info ] [MainThread]: 
[0m14:29:55.090395 [info ] [MainThread]: Finished running 3 view models, 1 table model in 0 hours 0 minutes and 5.06 seconds (5.06s).
[0m14:29:55.090888 [debug] [MainThread]: Command end result
[0m14:29:55.099897 [info ] [MainThread]: 
[0m14:29:55.100446 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:29:55.100850 [info ] [MainThread]: 
[0m14:29:55.101285 [error] [MainThread]: [33mCompilation Error in model customers (models/customers.sql)[0m
[0m14:29:55.101966 [error] [MainThread]:   Trying to create view `aec-students`.`dbt_milan`.`customers`, but it currently exists as a table. Either drop `aec-students`.`dbt_milan`.`customers` manually, or run dbt with `--full-refresh` and dbt will drop it for you.
[0m14:29:55.102347 [error] [MainThread]:   
[0m14:29:55.102732 [error] [MainThread]:   > in macro bigquery__handle_existing_table (macros/materializations/view.sql)
[0m14:29:55.103151 [error] [MainThread]:   > called by macro handle_existing_table (macros/materializations/models/view/helpers.sql)
[0m14:29:55.103654 [error] [MainThread]:   > called by macro create_or_replace_view (macros/materializations/models/view/create_or_replace_view.sql)
[0m14:29:55.104008 [error] [MainThread]:   > called by macro materialization_view_bigquery (macros/materializations/view.sql)
[0m14:29:55.104374 [error] [MainThread]:   > called by model customers (models/customers.sql)
[0m14:29:55.104808 [info ] [MainThread]: 
[0m14:29:55.105236 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=1 TOTAL=4
[0m14:29:55.105810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00cf1e78b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00cf1e7f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f00cf23fa30>]}
[0m14:29:55.106258 [debug] [MainThread]: Flushing usage events


============================== 2023-02-17 14:30:56.306494 | deb1f638-5ef6-40c1-ae86-21ed27cf0cee ==============================
[0m14:30:56.306494 [info ] [MainThread]: Running with dbt=1.4.1
[0m14:30:56.310232 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:30:56.311656 [debug] [MainThread]: Tracking: tracking
[0m14:30:56.313777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd27106b700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd271069960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd27106b730>]}
[0m14:30:56.372732 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:30:56.373384 [debug] [MainThread]: Partial parsing: updated file: coffee_shop://models/customers.sql
[0m14:30:56.387818 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
[0m14:30:56.404532 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffe_shop_milan.example
[0m14:30:56.410447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'deb1f638-5ef6-40c1-ae86-21ed27cf0cee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd270a8e380>]}
[0m14:30:56.417994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'deb1f638-5ef6-40c1-ae86-21ed27cf0cee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd270feffa0>]}
[0m14:30:56.418579 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 334 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m14:30:56.419073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'deb1f638-5ef6-40c1-ae86-21ed27cf0cee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd270fdd390>]}
[0m14:30:56.420580 [info ] [MainThread]: 
[0m14:30:56.423067 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:30:56.424586 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m14:30:56.425125 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:30:57.652402 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_milan'
[0m14:30:57.653037 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:30:57.925357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'deb1f638-5ef6-40c1-ae86-21ed27cf0cee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd270fefd90>]}
[0m14:30:57.926146 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m14:30:57.926750 [info ] [MainThread]: 
[0m14:30:57.932610 [debug] [Thread-1 (]: Began running node model.coffee_shop.customers
[0m14:30:57.933360 [debug] [Thread-2 (]: Began running node model.coffee_shop.my_first_dbt_model
[0m14:30:57.934084 [info ] [Thread-1 (]: 1 of 4 START sql table model dbt_milan.customers ............................... [RUN]
[0m14:30:57.935700 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop.customers'
[0m14:30:57.936116 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.customers
[0m14:30:57.934571 [info ] [Thread-2 (]: 2 of 4 START sql table model dbt_milan.my_first_dbt_model ...................... [RUN]
[0m14:30:57.993878 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.customers"
[0m14:30:57.995494 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.coffee_shop.my_first_dbt_model'
[0m14:30:57.996216 [debug] [Thread-2 (]: Began compiling node model.coffee_shop.my_first_dbt_model
[0m14:30:57.999248 [debug] [Thread-2 (]: Writing injected SQL for node "model.coffee_shop.my_first_dbt_model"
[0m14:30:57.999812 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (compile): 2023-02-17 14:30:57.936415 => 2023-02-17 14:30:57.999714
[0m14:30:58.000254 [debug] [Thread-1 (]: Began executing node model.coffee_shop.customers
[0m14:30:58.005855 [debug] [Thread-2 (]: Timing info for model.coffee_shop.my_first_dbt_model (compile): 2023-02-17 14:30:57.996439 => 2023-02-17 14:30:58.005767
[0m14:30:58.015526 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:30:58.016027 [debug] [Thread-2 (]: Began executing node model.coffee_shop.my_first_dbt_model
[0m14:30:58.019883 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:30:58.415916 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop.customers"
[0m14:30:58.417559 [debug] [Thread-2 (]: Writing runtime sql for node "model.coffee_shop.my_first_dbt_model"
[0m14:30:58.418612 [debug] [Thread-2 (]: On model.coffee_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.my_first_dbt_model"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`my_first_dbt_model`
    
    
    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m14:30:58.419046 [debug] [Thread-1 (]: On model.coffee_shop.customers: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.customers"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`customers`
    
    
    OPTIONS()
    as (
      

Select * 
from customers
limit 9000
    );
  
[0m14:30:58.635006 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Table "customers" must be qualified with a dataset (e.g. dataset.table).')
[0m14:30:58.957716 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:5fbf3b95-e31b-427d-8e0b-7ee10e544c0b&page=queryresults
[0m14:30:58.958473 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (execute): 2023-02-17 14:30:58.000492 => 2023-02-17 14:30:58.958362
[0m14:30:58.961431 [debug] [Thread-1 (]: Database Error in model customers (models/customers.sql)
  Table "customers" must be qualified with a dataset (e.g. dataset.table).
  compiled Code at target/run/coffee_shop/models/customers.sql
[0m14:30:58.961909 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'deb1f638-5ef6-40c1-ae86-21ed27cf0cee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd270a8c550>]}
[0m14:30:58.962417 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model dbt_milan.customers ...................... [[31mERROR[0m in 1.03s]
[0m14:30:58.964295 [debug] [Thread-1 (]: Finished running node model.coffee_shop.customers
[0m14:30:58.965758 [debug] [Thread-4 (]: Began running node model.coffee_shop.customers_ref
[0m14:30:58.966285 [info ] [Thread-4 (]: 3 of 4 SKIP relation dbt_milan.customers_ref ................................... [[33mSKIP[0m]
[0m14:30:58.966751 [debug] [Thread-4 (]: Finished running node model.coffee_shop.customers_ref
[0m14:31:00.627066 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:60892a4c-c920-4efd-b4a1-2060a4a5b703&page=queryresults
[0m14:31:00.653557 [debug] [Thread-2 (]: Timing info for model.coffee_shop.my_first_dbt_model (execute): 2023-02-17 14:30:58.017876 => 2023-02-17 14:31:00.653471
[0m14:31:00.654801 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'deb1f638-5ef6-40c1-ae86-21ed27cf0cee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd271246d40>]}
[0m14:31:00.655665 [info ] [Thread-2 (]: 2 of 4 OK created sql table model dbt_milan.my_first_dbt_model ................. [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 2.66s]
[0m14:31:00.656327 [debug] [Thread-2 (]: Finished running node model.coffee_shop.my_first_dbt_model
[0m14:31:00.657355 [debug] [Thread-6 (]: Began running node model.coffee_shop.my_second_dbt_model
[0m14:31:00.658155 [info ] [Thread-6 (]: 4 of 4 START sql view model dbt_milan.my_second_dbt_model ...................... [RUN]
[0m14:31:00.658954 [debug] [Thread-6 (]: Acquiring new bigquery connection 'model.coffee_shop.my_second_dbt_model'
[0m14:31:00.659229 [debug] [Thread-6 (]: Began compiling node model.coffee_shop.my_second_dbt_model
[0m14:31:00.662429 [debug] [Thread-6 (]: Writing injected SQL for node "model.coffee_shop.my_second_dbt_model"
[0m14:31:00.663053 [debug] [Thread-6 (]: Timing info for model.coffee_shop.my_second_dbt_model (compile): 2023-02-17 14:31:00.659400 => 2023-02-17 14:31:00.662967
[0m14:31:00.663467 [debug] [Thread-6 (]: Began executing node model.coffee_shop.my_second_dbt_model
[0m14:31:00.686007 [debug] [Thread-6 (]: Writing runtime sql for node "model.coffee_shop.my_second_dbt_model"
[0m14:31:00.686748 [debug] [Thread-6 (]: Opening a new connection, currently in state init
[0m14:31:00.687235 [debug] [Thread-6 (]: On model.coffee_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.my_second_dbt_model"} */


  create or replace view `aec-students`.`dbt_milan`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `aec-students`.`dbt_milan`.`my_first_dbt_model`
where id = 1;


[0m14:31:01.481744 [debug] [Thread-6 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:5714f308-47ab-4179-b434-7ea2708d8050&page=queryresults
[0m14:31:01.484043 [debug] [Thread-6 (]: Timing info for model.coffee_shop.my_second_dbt_model (execute): 2023-02-17 14:31:00.663725 => 2023-02-17 14:31:01.483982
[0m14:31:01.484896 [debug] [Thread-6 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'deb1f638-5ef6-40c1-ae86-21ed27cf0cee', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd270b252d0>]}
[0m14:31:01.485452 [info ] [Thread-6 (]: 4 of 4 OK created sql view model dbt_milan.my_second_dbt_model ................. [[32mCREATE VIEW (0 processed)[0m in 0.83s]
[0m14:31:01.486161 [debug] [Thread-6 (]: Finished running node model.coffee_shop.my_second_dbt_model
[0m14:31:01.488212 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:31:01.488786 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:31:01.489008 [debug] [MainThread]: Connection 'model.coffee_shop.customers' was properly closed.
[0m14:31:01.489181 [debug] [MainThread]: Connection 'model.coffee_shop.my_first_dbt_model' was properly closed.
[0m14:31:01.489336 [debug] [MainThread]: Connection 'model.coffee_shop.my_second_dbt_model' was properly closed.
[0m14:31:01.489565 [info ] [MainThread]: 
[0m14:31:01.489901 [info ] [MainThread]: Finished running 2 table models, 2 view models in 0 hours 0 minutes and 5.07 seconds (5.07s).
[0m14:31:01.490917 [debug] [MainThread]: Command end result
[0m14:31:01.498882 [info ] [MainThread]: 
[0m14:31:01.499586 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:31:01.500095 [info ] [MainThread]: 
[0m14:31:01.500533 [error] [MainThread]: [33mDatabase Error in model customers (models/customers.sql)[0m
[0m14:31:01.501290 [error] [MainThread]:   Table "customers" must be qualified with a dataset (e.g. dataset.table).
[0m14:31:01.501715 [error] [MainThread]:   compiled Code at target/run/coffee_shop/models/customers.sql
[0m14:31:01.502118 [info ] [MainThread]: 
[0m14:31:01.502557 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=1 TOTAL=4
[0m14:31:01.503710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd270a4d0f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd270a4d180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd270a4d1b0>]}
[0m14:31:01.504294 [debug] [MainThread]: Flushing usage events


============================== 2023-02-17 14:32:24.067823 | 20641465-9d80-4ad6-bfe8-75ec5ddac769 ==============================
[0m14:32:24.067823 [info ] [MainThread]: Running with dbt=1.4.1
[0m14:32:24.070427 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:32:24.070767 [debug] [MainThread]: Tracking: tracking
[0m14:32:24.073018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b38a675e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b38a671f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b38a67640>]}
[0m14:32:24.124236 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:32:24.124830 [debug] [MainThread]: Partial parsing: updated file: coffee_shop://models/customers.sql
[0m14:32:24.142858 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
[0m14:32:24.164285 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffe_shop_milan.example
[0m14:32:24.170107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '20641465-9d80-4ad6-bfe8-75ec5ddac769', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3848e590>]}
[0m14:32:24.177140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '20641465-9d80-4ad6-bfe8-75ec5ddac769', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b389eff70>]}
[0m14:32:24.177671 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 334 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m14:32:24.178044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20641465-9d80-4ad6-bfe8-75ec5ddac769', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b389dd5a0>]}
[0m14:32:24.179536 [info ] [MainThread]: 
[0m14:32:24.182195 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:32:24.184536 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m14:32:24.185014 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:32:25.419482 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_milan'
[0m14:32:25.420067 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:32:25.744854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20641465-9d80-4ad6-bfe8-75ec5ddac769', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b389effd0>]}
[0m14:32:25.746089 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m14:32:25.746984 [info ] [MainThread]: 
[0m14:32:25.755361 [debug] [Thread-1 (]: Began running node model.coffee_shop.customers
[0m14:32:25.755772 [debug] [Thread-2 (]: Began running node model.coffee_shop.my_first_dbt_model
[0m14:32:25.756571 [info ] [Thread-1 (]: 1 of 4 START sql table model dbt_milan.customers ............................... [RUN]
[0m14:32:25.757777 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop.customers'
[0m14:32:25.758104 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.customers
[0m14:32:25.756974 [info ] [Thread-2 (]: 2 of 4 START sql table model dbt_milan.my_first_dbt_model ...................... [RUN]
[0m14:32:25.810363 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.customers"
[0m14:32:25.811240 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.coffee_shop.my_first_dbt_model'
[0m14:32:25.811969 [debug] [Thread-2 (]: Began compiling node model.coffee_shop.my_first_dbt_model
[0m14:32:25.812258 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (compile): 2023-02-17 14:32:25.758561 => 2023-02-17 14:32:25.812178
[0m14:32:25.814975 [debug] [Thread-2 (]: Writing injected SQL for node "model.coffee_shop.my_first_dbt_model"
[0m14:32:25.815512 [debug] [Thread-1 (]: Began executing node model.coffee_shop.customers
[0m14:32:25.831467 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:32:25.844774 [debug] [Thread-2 (]: Timing info for model.coffee_shop.my_first_dbt_model (compile): 2023-02-17 14:32:25.812538 => 2023-02-17 14:32:25.844635
[0m14:32:25.846998 [debug] [Thread-2 (]: Began executing node model.coffee_shop.my_first_dbt_model
[0m14:32:25.850896 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:32:26.242027 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop.customers"
[0m14:32:26.243669 [debug] [Thread-1 (]: On model.coffee_shop.customers: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.customers"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`customers`
    
    
    OPTIONS()
    as (
      

select * from `analytics-engineers-club.coffee_shop.customers`
Some bad SQL
limit 9000;
    );
  
[0m14:32:26.245408 [debug] [Thread-2 (]: Writing runtime sql for node "model.coffee_shop.my_first_dbt_model"
[0m14:32:26.246595 [debug] [Thread-2 (]: On model.coffee_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.my_first_dbt_model"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`my_first_dbt_model`
    
    
    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m14:32:26.450115 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got keyword SOME at [14:1]')
[0m14:32:27.615992 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:992ad81f-6e17-493b-9782-a712813cc2f9&page=queryresults
[0m14:32:27.616967 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (execute): 2023-02-17 14:32:25.815958 => 2023-02-17 14:32:27.616857
[0m14:32:27.620004 [debug] [Thread-1 (]: Database Error in model customers (models/customers.sql)
  Syntax error: Expected ")" but got keyword SOME at [14:1]
  compiled Code at target/run/coffee_shop/models/customers.sql
[0m14:32:27.620479 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20641465-9d80-4ad6-bfe8-75ec5ddac769', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3848c5e0>]}
[0m14:32:27.621106 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model dbt_milan.customers ...................... [[31mERROR[0m in 1.86s]
[0m14:32:27.622897 [debug] [Thread-1 (]: Finished running node model.coffee_shop.customers
[0m14:32:27.623801 [debug] [Thread-4 (]: Began running node model.coffee_shop.customers_ref
[0m14:32:27.624165 [info ] [Thread-4 (]: 3 of 4 SKIP relation dbt_milan.customers_ref ................................... [[33mSKIP[0m]
[0m14:32:27.624574 [debug] [Thread-4 (]: Finished running node model.coffee_shop.customers_ref
[0m14:32:28.442319 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:518e76e1-5fd8-4a1e-8e45-8191416a02f0&page=queryresults
[0m14:32:28.464175 [debug] [Thread-2 (]: Timing info for model.coffee_shop.my_first_dbt_model (execute): 2023-02-17 14:32:25.847861 => 2023-02-17 14:32:28.464109
[0m14:32:28.465054 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20641465-9d80-4ad6-bfe8-75ec5ddac769', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b38c46fe0>]}
[0m14:32:28.465654 [info ] [Thread-2 (]: 2 of 4 OK created sql table model dbt_milan.my_first_dbt_model ................. [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 2.65s]
[0m14:32:28.466220 [debug] [Thread-2 (]: Finished running node model.coffee_shop.my_first_dbt_model
[0m14:32:28.467182 [debug] [Thread-6 (]: Began running node model.coffee_shop.my_second_dbt_model
[0m14:32:28.467626 [info ] [Thread-6 (]: 4 of 4 START sql view model dbt_milan.my_second_dbt_model ...................... [RUN]
[0m14:32:28.468766 [debug] [Thread-6 (]: Acquiring new bigquery connection 'model.coffee_shop.my_second_dbt_model'
[0m14:32:28.469045 [debug] [Thread-6 (]: Began compiling node model.coffee_shop.my_second_dbt_model
[0m14:32:28.472352 [debug] [Thread-6 (]: Writing injected SQL for node "model.coffee_shop.my_second_dbt_model"
[0m14:32:28.472975 [debug] [Thread-6 (]: Timing info for model.coffee_shop.my_second_dbt_model (compile): 2023-02-17 14:32:28.469213 => 2023-02-17 14:32:28.472891
[0m14:32:28.473376 [debug] [Thread-6 (]: Began executing node model.coffee_shop.my_second_dbt_model
[0m14:32:28.495150 [debug] [Thread-6 (]: Writing runtime sql for node "model.coffee_shop.my_second_dbt_model"
[0m14:32:28.495881 [debug] [Thread-6 (]: Opening a new connection, currently in state init
[0m14:32:28.496357 [debug] [Thread-6 (]: On model.coffee_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.my_second_dbt_model"} */


  create or replace view `aec-students`.`dbt_milan`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `aec-students`.`dbt_milan`.`my_first_dbt_model`
where id = 1;


[0m14:32:29.522558 [debug] [Thread-6 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:141730dc-c4ea-4011-941c-3d0dce8dd7c4&page=queryresults
[0m14:32:29.524978 [debug] [Thread-6 (]: Timing info for model.coffee_shop.my_second_dbt_model (execute): 2023-02-17 14:32:28.473625 => 2023-02-17 14:32:29.524914
[0m14:32:29.525845 [debug] [Thread-6 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20641465-9d80-4ad6-bfe8-75ec5ddac769', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b385255d0>]}
[0m14:32:29.526418 [info ] [Thread-6 (]: 4 of 4 OK created sql view model dbt_milan.my_second_dbt_model ................. [[32mCREATE VIEW (0 processed)[0m in 1.06s]
[0m14:32:29.526983 [debug] [Thread-6 (]: Finished running node model.coffee_shop.my_second_dbt_model
[0m14:32:29.528845 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:32:29.529430 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:32:29.529657 [debug] [MainThread]: Connection 'model.coffee_shop.my_first_dbt_model' was properly closed.
[0m14:32:29.529874 [debug] [MainThread]: Connection 'model.coffee_shop.customers' was properly closed.
[0m14:32:29.530074 [debug] [MainThread]: Connection 'model.coffee_shop.my_second_dbt_model' was properly closed.
[0m14:32:29.530357 [info ] [MainThread]: 
[0m14:32:29.530699 [info ] [MainThread]: Finished running 2 table models, 2 view models in 0 hours 0 minutes and 5.35 seconds (5.35s).
[0m14:32:29.531819 [debug] [MainThread]: Command end result
[0m14:32:29.541901 [info ] [MainThread]: 
[0m14:32:29.543112 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:32:29.544713 [info ] [MainThread]: 
[0m14:32:29.546226 [error] [MainThread]: [33mDatabase Error in model customers (models/customers.sql)[0m
[0m14:32:29.547196 [error] [MainThread]:   Syntax error: Expected ")" but got keyword SOME at [14:1]
[0m14:32:29.548962 [error] [MainThread]:   compiled Code at target/run/coffee_shop/models/customers.sql
[0m14:32:29.550492 [info ] [MainThread]: 
[0m14:32:29.553168 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=1 TOTAL=4
[0m14:32:29.555009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3848dae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3848d480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3848d420>]}
[0m14:32:29.555590 [debug] [MainThread]: Flushing usage events


============================== 2023-02-17 14:33:09.889188 | 82f07e63-de4d-4a2b-9a79-f3e7807cc72f ==============================
[0m14:33:09.889188 [info ] [MainThread]: Running with dbt=1.4.1
[0m14:33:09.891845 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:33:09.892222 [debug] [MainThread]: Tracking: tracking
[0m14:33:09.894361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f598325b2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f598325a0e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59832587f0>]}
[0m14:33:09.950103 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:33:09.951053 [debug] [MainThread]: Partial parsing: updated file: coffee_shop://models/customers.sql
[0m14:33:09.975963 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
[0m14:33:10.000771 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffe_shop_milan.example
[0m14:33:10.008698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '82f07e63-de4d-4a2b-9a79-f3e7807cc72f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5982c79cf0>]}
[0m14:33:10.016400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '82f07e63-de4d-4a2b-9a79-f3e7807cc72f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59831e3fd0>]}
[0m14:33:10.016842 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 334 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m14:33:10.017240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82f07e63-de4d-4a2b-9a79-f3e7807cc72f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5986b2efe0>]}
[0m14:33:10.018694 [info ] [MainThread]: 
[0m14:33:10.020769 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:33:10.022273 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m14:33:10.022803 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:33:11.179072 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_milan'
[0m14:33:11.179792 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:33:11.482083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82f07e63-de4d-4a2b-9a79-f3e7807cc72f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f598325ba60>]}
[0m14:33:11.482874 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m14:33:11.483514 [info ] [MainThread]: 
[0m14:33:11.489927 [debug] [Thread-1 (]: Began running node model.coffee_shop.customers
[0m14:33:11.490619 [debug] [Thread-2 (]: Began running node model.coffee_shop.my_first_dbt_model
[0m14:33:11.491068 [info ] [Thread-1 (]: 1 of 4 START sql table model dbt_milan.customers ............................... [RUN]
[0m14:33:11.491749 [info ] [Thread-2 (]: 2 of 4 START sql table model dbt_milan.my_first_dbt_model ...................... [RUN]
[0m14:33:11.492809 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop.customers'
[0m14:33:11.493563 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.coffee_shop.my_first_dbt_model'
[0m14:33:11.493904 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.customers
[0m14:33:11.494188 [debug] [Thread-2 (]: Began compiling node model.coffee_shop.my_first_dbt_model
[0m14:33:11.549197 [debug] [Thread-2 (]: Writing injected SQL for node "model.coffee_shop.my_first_dbt_model"
[0m14:33:11.556228 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.customers"
[0m14:33:11.556985 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (compile): 2023-02-17 14:33:11.494405 => 2023-02-17 14:33:11.556879
[0m14:33:11.557342 [debug] [Thread-2 (]: Timing info for model.coffee_shop.my_first_dbt_model (compile): 2023-02-17 14:33:11.546672 => 2023-02-17 14:33:11.557281
[0m14:33:11.557618 [debug] [Thread-1 (]: Began executing node model.coffee_shop.customers
[0m14:33:11.557887 [debug] [Thread-2 (]: Began executing node model.coffee_shop.my_first_dbt_model
[0m14:33:11.573211 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:33:11.575297 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:33:12.024952 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop.customers"
[0m14:33:12.026916 [debug] [Thread-2 (]: Writing runtime sql for node "model.coffee_shop.my_first_dbt_model"
[0m14:33:12.028020 [debug] [Thread-1 (]: On model.coffee_shop.customers: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.customers"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`customers`
    
    
    OPTIONS()
    as (
      

select * from `analytics-engineers-club.coffee_shop.customers`
limit 9000;
    );
  
[0m14:33:12.028468 [debug] [Thread-2 (]: On model.coffee_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.my_first_dbt_model"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`my_first_dbt_model`
    
    
    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m14:33:12.218380 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: Expected ")" but got ";" at [14:11]')
[0m14:33:13.112558 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:05e928b6-d610-48ee-b581-53d12d8176d0&page=queryresults
[0m14:33:13.113564 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (execute): 2023-02-17 14:33:11.558094 => 2023-02-17 14:33:13.113434
[0m14:33:13.117704 [debug] [Thread-1 (]: Database Error in model customers (models/customers.sql)
  Syntax error: Expected ")" but got ";" at [14:11]
  compiled Code at target/run/coffee_shop/models/customers.sql
[0m14:33:13.119070 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82f07e63-de4d-4a2b-9a79-f3e7807cc72f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f598343e950>]}
[0m14:33:13.119733 [error] [Thread-1 (]: 1 of 4 ERROR creating sql table model dbt_milan.customers ...................... [[31mERROR[0m in 1.63s]
[0m14:33:13.121550 [debug] [Thread-1 (]: Finished running node model.coffee_shop.customers
[0m14:33:13.127045 [debug] [Thread-4 (]: Began running node model.coffee_shop.customers_ref
[0m14:33:13.127754 [info ] [Thread-4 (]: 3 of 4 SKIP relation dbt_milan.customers_ref ................................... [[33mSKIP[0m]
[0m14:33:13.129023 [debug] [Thread-4 (]: Finished running node model.coffee_shop.customers_ref
[0m14:33:14.230061 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:6377df8f-d39d-4e23-a438-9ae98d4bb310&page=queryresults
[0m14:33:14.255150 [debug] [Thread-2 (]: Timing info for model.coffee_shop.my_first_dbt_model (execute): 2023-02-17 14:33:11.573535 => 2023-02-17 14:33:14.255036
[0m14:33:14.256161 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82f07e63-de4d-4a2b-9a79-f3e7807cc72f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f598343e590>]}
[0m14:33:14.256748 [info ] [Thread-2 (]: 2 of 4 OK created sql table model dbt_milan.my_first_dbt_model ................. [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 2.76s]
[0m14:33:14.257406 [debug] [Thread-2 (]: Finished running node model.coffee_shop.my_first_dbt_model
[0m14:33:14.258306 [debug] [Thread-6 (]: Began running node model.coffee_shop.my_second_dbt_model
[0m14:33:14.258959 [info ] [Thread-6 (]: 4 of 4 START sql view model dbt_milan.my_second_dbt_model ...................... [RUN]
[0m14:33:14.259850 [debug] [Thread-6 (]: Acquiring new bigquery connection 'model.coffee_shop.my_second_dbt_model'
[0m14:33:14.260139 [debug] [Thread-6 (]: Began compiling node model.coffee_shop.my_second_dbt_model
[0m14:33:14.263272 [debug] [Thread-6 (]: Writing injected SQL for node "model.coffee_shop.my_second_dbt_model"
[0m14:33:14.263845 [debug] [Thread-6 (]: Timing info for model.coffee_shop.my_second_dbt_model (compile): 2023-02-17 14:33:14.260388 => 2023-02-17 14:33:14.263759
[0m14:33:14.264188 [debug] [Thread-6 (]: Began executing node model.coffee_shop.my_second_dbt_model
[0m14:33:14.286018 [debug] [Thread-6 (]: Writing runtime sql for node "model.coffee_shop.my_second_dbt_model"
[0m14:33:14.286654 [debug] [Thread-6 (]: Opening a new connection, currently in state init
[0m14:33:14.287086 [debug] [Thread-6 (]: On model.coffee_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.my_second_dbt_model"} */


  create or replace view `aec-students`.`dbt_milan`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `aec-students`.`dbt_milan`.`my_first_dbt_model`
where id = 1;


[0m14:33:15.039021 [debug] [Thread-6 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:c84ed50e-f851-4774-9f83-9401919f2220&page=queryresults
[0m14:33:15.042210 [debug] [Thread-6 (]: Timing info for model.coffee_shop.my_second_dbt_model (execute): 2023-02-17 14:33:14.264376 => 2023-02-17 14:33:15.042127
[0m14:33:15.043324 [debug] [Thread-6 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82f07e63-de4d-4a2b-9a79-f3e7807cc72f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5982d3dff0>]}
[0m14:33:15.044011 [info ] [Thread-6 (]: 4 of 4 OK created sql view model dbt_milan.my_second_dbt_model ................. [[32mCREATE VIEW (0 processed)[0m in 0.78s]
[0m14:33:15.044833 [debug] [Thread-6 (]: Finished running node model.coffee_shop.my_second_dbt_model
[0m14:33:15.047202 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:33:15.048067 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:33:15.048402 [debug] [MainThread]: Connection 'model.coffee_shop.customers' was properly closed.
[0m14:33:15.048663 [debug] [MainThread]: Connection 'model.coffee_shop.my_first_dbt_model' was properly closed.
[0m14:33:15.048908 [debug] [MainThread]: Connection 'model.coffee_shop.my_second_dbt_model' was properly closed.
[0m14:33:15.049249 [info ] [MainThread]: 
[0m14:33:15.050361 [info ] [MainThread]: Finished running 2 table models, 2 view models in 0 hours 0 minutes and 5.03 seconds (5.03s).
[0m14:33:15.052024 [debug] [MainThread]: Command end result
[0m14:33:15.061142 [info ] [MainThread]: 
[0m14:33:15.061720 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:33:15.062312 [info ] [MainThread]: 
[0m14:33:15.062794 [error] [MainThread]: [33mDatabase Error in model customers (models/customers.sql)[0m
[0m14:33:15.063228 [error] [MainThread]:   Syntax error: Expected ")" but got ";" at [14:11]
[0m14:33:15.063755 [error] [MainThread]:   compiled Code at target/run/coffee_shop/models/customers.sql
[0m14:33:15.064199 [info ] [MainThread]: 
[0m14:33:15.064680 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=1 TOTAL=4
[0m14:33:15.066543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59831d0eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5982d3c8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5982d3d5a0>]}
[0m14:33:15.067004 [debug] [MainThread]: Flushing usage events


============================== 2023-02-17 14:35:08.005804 | acdaff74-c4e8-48e8-ab29-e4177c631e7c ==============================
[0m14:35:08.005804 [info ] [MainThread]: Running with dbt=1.4.1
[0m14:35:08.008455 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:35:08.009065 [debug] [MainThread]: Tracking: tracking
[0m14:35:08.016555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc97f0537f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc97f0528c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc97f053850>]}
[0m14:35:08.070347 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:35:08.071040 [debug] [MainThread]: Partial parsing: updated file: coffee_shop://models/customers.sql
[0m14:35:08.084674 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
[0m14:35:08.102079 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffe_shop_milan.example
[0m14:35:08.108416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'acdaff74-c4e8-48e8-ab29-e4177c631e7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc97ea822c0>]}
[0m14:35:08.116207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'acdaff74-c4e8-48e8-ab29-e4177c631e7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc97efdbf40>]}
[0m14:35:08.116912 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 334 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m14:35:08.117472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'acdaff74-c4e8-48e8-ab29-e4177c631e7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc98292afe0>]}
[0m14:35:08.119402 [info ] [MainThread]: 
[0m14:35:08.122374 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:35:08.124028 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m14:35:08.124542 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:35:09.412393 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_milan'
[0m14:35:09.413308 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:35:09.679700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'acdaff74-c4e8-48e8-ab29-e4177c631e7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc97efdbcd0>]}
[0m14:35:09.680566 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m14:35:09.681176 [info ] [MainThread]: 
[0m14:35:09.687689 [debug] [Thread-1 (]: Began running node model.coffee_shop.customers
[0m14:35:09.688437 [debug] [Thread-2 (]: Began running node model.coffee_shop.my_first_dbt_model
[0m14:35:09.689162 [info ] [Thread-1 (]: 1 of 4 START sql table model dbt_milan.customers ............................... [RUN]
[0m14:35:09.690383 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop.customers'
[0m14:35:09.690676 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.customers
[0m14:35:09.689607 [info ] [Thread-2 (]: 2 of 4 START sql table model dbt_milan.my_first_dbt_model ...................... [RUN]
[0m14:35:09.744065 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.coffee_shop.my_first_dbt_model'
[0m14:35:09.744504 [debug] [Thread-2 (]: Began compiling node model.coffee_shop.my_first_dbt_model
[0m14:35:09.748597 [debug] [Thread-2 (]: Writing injected SQL for node "model.coffee_shop.my_first_dbt_model"
[0m14:35:09.749893 [debug] [Thread-2 (]: Timing info for model.coffee_shop.my_first_dbt_model (compile): 2023-02-17 14:35:09.744760 => 2023-02-17 14:35:09.749790
[0m14:35:09.755565 [debug] [Thread-2 (]: Began executing node model.coffee_shop.my_first_dbt_model
[0m14:35:09.755129 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.customers"
[0m14:35:09.772464 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:35:09.773682 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (compile): 2023-02-17 14:35:09.690856 => 2023-02-17 14:35:09.773597
[0m14:35:09.775163 [debug] [Thread-1 (]: Began executing node model.coffee_shop.customers
[0m14:35:09.777553 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:35:10.185040 [debug] [Thread-2 (]: Writing runtime sql for node "model.coffee_shop.my_first_dbt_model"
[0m14:35:10.187772 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop.customers"
[0m14:35:10.188923 [debug] [Thread-2 (]: On model.coffee_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.my_first_dbt_model"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`my_first_dbt_model`
    
    
    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m14:35:10.189217 [debug] [Thread-1 (]: On model.coffee_shop.customers: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.customers"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`customers`
    
    
    OPTIONS()
    as (
      

select * from `analytics-engineers-club.coffee_shop.customers`
limit 9000
    );
  
[0m14:35:12.721724 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:7cad2d76-b5a6-4cfa-891c-c5a27d0400d4&page=queryresults
[0m14:35:12.750410 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (execute): 2023-02-17 14:35:09.775509 => 2023-02-17 14:35:12.750316
[0m14:35:12.756111 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'acdaff74-c4e8-48e8-ab29-e4177c631e7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc97ea80310>]}
[0m14:35:12.756775 [info ] [Thread-1 (]: 1 of 4 OK created sql table model dbt_milan.customers .......................... [[32mCREATE TABLE (9.0k rows, 12.8 MB processed)[0m in 3.07s]
[0m14:35:12.758582 [debug] [Thread-1 (]: Finished running node model.coffee_shop.customers
[0m14:35:12.759499 [debug] [Thread-4 (]: Began running node model.coffee_shop.customers_ref
[0m14:35:12.759907 [info ] [Thread-4 (]: 3 of 4 START sql view model dbt_milan.customers_ref ............................ [RUN]
[0m14:35:12.760692 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.coffee_shop.customers_ref'
[0m14:35:12.760974 [debug] [Thread-4 (]: Began compiling node model.coffee_shop.customers_ref
[0m14:35:12.764227 [debug] [Thread-4 (]: Writing injected SQL for node "model.coffee_shop.customers_ref"
[0m14:35:12.764730 [debug] [Thread-4 (]: Timing info for model.coffee_shop.customers_ref (compile): 2023-02-17 14:35:12.761141 => 2023-02-17 14:35:12.764656
[0m14:35:12.765034 [debug] [Thread-4 (]: Began executing node model.coffee_shop.customers_ref
[0m14:35:12.784449 [debug] [Thread-4 (]: Writing runtime sql for node "model.coffee_shop.customers_ref"
[0m14:35:12.785007 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:35:12.785367 [debug] [Thread-4 (]: On model.coffee_shop.customers_ref: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.customers_ref"} */


  create or replace view `aec-students`.`dbt_milan`.`customers_ref`
  OPTIONS()
  as Select *
from `aec-students`.`dbt_milan`.`customers`;


[0m14:35:12.957636 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:9c89f432-ef22-45e9-902b-66d35df88634&page=queryresults
[0m14:35:12.960545 [debug] [Thread-2 (]: Timing info for model.coffee_shop.my_first_dbt_model (execute): 2023-02-17 14:35:09.755967 => 2023-02-17 14:35:12.960454
[0m14:35:12.961446 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'acdaff74-c4e8-48e8-ab29-e4177c631e7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc97f232d70>]}
[0m14:35:12.961975 [info ] [Thread-2 (]: 2 of 4 OK created sql table model dbt_milan.my_first_dbt_model ................. [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 3.22s]
[0m14:35:12.962636 [debug] [Thread-2 (]: Finished running node model.coffee_shop.my_first_dbt_model
[0m14:35:12.963256 [debug] [Thread-6 (]: Began running node model.coffee_shop.my_second_dbt_model
[0m14:35:12.963702 [info ] [Thread-6 (]: 4 of 4 START sql view model dbt_milan.my_second_dbt_model ...................... [RUN]
[0m14:35:12.964911 [debug] [Thread-6 (]: Acquiring new bigquery connection 'model.coffee_shop.my_second_dbt_model'
[0m14:35:12.965195 [debug] [Thread-6 (]: Began compiling node model.coffee_shop.my_second_dbt_model
[0m14:35:12.969874 [debug] [Thread-6 (]: Writing injected SQL for node "model.coffee_shop.my_second_dbt_model"
[0m14:35:12.970458 [debug] [Thread-6 (]: Timing info for model.coffee_shop.my_second_dbt_model (compile): 2023-02-17 14:35:12.965396 => 2023-02-17 14:35:12.970365
[0m14:35:12.970814 [debug] [Thread-6 (]: Began executing node model.coffee_shop.my_second_dbt_model
[0m14:35:12.973677 [debug] [Thread-6 (]: Writing runtime sql for node "model.coffee_shop.my_second_dbt_model"
[0m14:35:12.974245 [debug] [Thread-6 (]: Opening a new connection, currently in state init
[0m14:35:12.974648 [debug] [Thread-6 (]: On model.coffee_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.my_second_dbt_model"} */


  create or replace view `aec-students`.`dbt_milan`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `aec-students`.`dbt_milan`.`my_first_dbt_model`
where id = 1;


[0m14:35:13.568639 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:1b24644f-b81c-405d-ab02-7db8185cf288&page=queryresults
[0m14:35:13.570584 [debug] [Thread-4 (]: Timing info for model.coffee_shop.customers_ref (execute): 2023-02-17 14:35:12.765215 => 2023-02-17 14:35:13.570523
[0m14:35:13.571457 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'acdaff74-c4e8-48e8-ab29-e4177c631e7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc97efed990>]}
[0m14:35:13.572598 [info ] [Thread-4 (]: 3 of 4 OK created sql view model dbt_milan.customers_ref ....................... [[32mCREATE VIEW (0 processed)[0m in 0.81s]
[0m14:35:13.575151 [debug] [Thread-4 (]: Finished running node model.coffee_shop.customers_ref
[0m14:35:13.757842 [debug] [Thread-6 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:2de1df5e-d7dc-4447-bec0-64633470557f&page=queryresults
[0m14:35:13.761045 [debug] [Thread-6 (]: Timing info for model.coffee_shop.my_second_dbt_model (execute): 2023-02-17 14:35:12.971009 => 2023-02-17 14:35:13.760981
[0m14:35:13.761879 [debug] [Thread-6 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'acdaff74-c4e8-48e8-ab29-e4177c631e7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc97eb26260>]}
[0m14:35:13.762440 [info ] [Thread-6 (]: 4 of 4 OK created sql view model dbt_milan.my_second_dbt_model ................. [[32mCREATE VIEW (0 processed)[0m in 0.80s]
[0m14:35:13.763003 [debug] [Thread-6 (]: Finished running node model.coffee_shop.my_second_dbt_model
[0m14:35:13.764934 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:35:13.765568 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:35:13.765798 [debug] [MainThread]: Connection 'model.coffee_shop.customers' was properly closed.
[0m14:35:13.766021 [debug] [MainThread]: Connection 'model.coffee_shop.my_first_dbt_model' was properly closed.
[0m14:35:13.766212 [debug] [MainThread]: Connection 'model.coffee_shop.customers_ref' was properly closed.
[0m14:35:13.766399 [debug] [MainThread]: Connection 'model.coffee_shop.my_second_dbt_model' was properly closed.
[0m14:35:13.766684 [info ] [MainThread]: 
[0m14:35:13.767027 [info ] [MainThread]: Finished running 2 table models, 2 view models in 0 hours 0 minutes and 5.65 seconds (5.65s).
[0m14:35:13.768241 [debug] [MainThread]: Command end result
[0m14:35:13.775537 [info ] [MainThread]: 
[0m14:35:13.776040 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:35:13.776488 [info ] [MainThread]: 
[0m14:35:13.776955 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m14:35:13.777474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc98292afe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc97eb26f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc97eb26260>]}
[0m14:35:13.777881 [debug] [MainThread]: Flushing usage events


============================== 2023-02-17 15:03:19.344365 | dc724787-2aa5-4144-b41f-4e1d7d711bbb ==============================
[0m15:03:19.344365 [info ] [MainThread]: Running with dbt=1.4.1
[0m15:03:19.346999 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:03:19.347312 [debug] [MainThread]: Tracking: tracking
[0m15:03:19.356522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88be755060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88be754550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88be754a00>]}
[0m15:03:19.415805 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m15:03:19.416580 [debug] [MainThread]: Partial parsing: added file: coffee_shop://models/schema.yml
[0m15:03:19.503094 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffe_shop_milan.example
[0m15:03:19.509292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dc724787-2aa5-4144-b41f-4e1d7d711bbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88be5980d0>]}
[0m15:03:19.516918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dc724787-2aa5-4144-b41f-4e1d7d711bbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88be6dfe50>]}
[0m15:03:19.517383 [info ] [MainThread]: Found 4 models, 9 tests, 0 snapshots, 0 analyses, 334 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m15:03:19.517754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc724787-2aa5-4144-b41f-4e1d7d711bbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88c2032fe0>]}
[0m15:03:19.519302 [info ] [MainThread]: 
[0m15:03:19.521434 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:03:19.522914 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m15:03:19.523455 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:03:20.798045 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_milan'
[0m15:03:20.803663 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:03:21.156722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc724787-2aa5-4144-b41f-4e1d7d711bbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88be90ae30>]}
[0m15:03:21.157912 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m15:03:21.158327 [info ] [MainThread]: 
[0m15:03:21.165118 [debug] [Thread-1 (]: Began running node model.coffee_shop.customers
[0m15:03:21.165556 [debug] [Thread-2 (]: Began running node model.coffee_shop.my_first_dbt_model
[0m15:03:21.166047 [info ] [Thread-1 (]: 1 of 4 START sql table model dbt_milan.customers ............................... [RUN]
[0m15:03:21.166431 [info ] [Thread-2 (]: 2 of 4 START sql table model dbt_milan.my_first_dbt_model ...................... [RUN]
[0m15:03:21.167626 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop.customers'
[0m15:03:21.168312 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.coffee_shop.my_first_dbt_model'
[0m15:03:21.168902 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.customers
[0m15:03:21.169184 [debug] [Thread-2 (]: Began compiling node model.coffee_shop.my_first_dbt_model
[0m15:03:21.171899 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.customers"
[0m15:03:21.174556 [debug] [Thread-2 (]: Writing injected SQL for node "model.coffee_shop.my_first_dbt_model"
[0m15:03:21.175296 [debug] [Thread-2 (]: Timing info for model.coffee_shop.my_first_dbt_model (compile): 2023-02-17 15:03:21.172227 => 2023-02-17 15:03:21.175201
[0m15:03:21.175597 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (compile): 2023-02-17 15:03:21.169397 => 2023-02-17 15:03:21.175540
[0m15:03:21.175972 [debug] [Thread-2 (]: Began executing node model.coffee_shop.my_first_dbt_model
[0m15:03:21.176365 [debug] [Thread-1 (]: Began executing node model.coffee_shop.customers
[0m15:03:21.191549 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:03:21.194121 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:03:21.625998 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop.customers"
[0m15:03:21.627710 [debug] [Thread-2 (]: Writing runtime sql for node "model.coffee_shop.my_first_dbt_model"
[0m15:03:21.628942 [debug] [Thread-1 (]: On model.coffee_shop.customers: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.customers"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`customers`
    
    
    OPTIONS()
    as (
      

select * from `analytics-engineers-club.coffee_shop.customers`
limit 9000
    );
  
[0m15:03:21.630493 [debug] [Thread-2 (]: On model.coffee_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.my_first_dbt_model"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`my_first_dbt_model`
    
    
    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m15:03:23.851926 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:65d6658e-9cc9-4916-ada7-67ff5accb96f&page=queryresults
[0m15:03:23.871271 [debug] [Thread-2 (]: Timing info for model.coffee_shop.my_first_dbt_model (execute): 2023-02-17 15:03:21.176641 => 2023-02-17 15:03:23.871205
[0m15:03:23.872174 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc724787-2aa5-4144-b41f-4e1d7d711bbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88be70a050>]}
[0m15:03:23.872774 [info ] [Thread-2 (]: 2 of 4 OK created sql table model dbt_milan.my_first_dbt_model ................. [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 2.70s]
[0m15:03:23.874563 [debug] [Thread-2 (]: Finished running node model.coffee_shop.my_first_dbt_model
[0m15:03:23.875569 [debug] [Thread-4 (]: Began running node model.coffee_shop.my_second_dbt_model
[0m15:03:23.876064 [info ] [Thread-4 (]: 3 of 4 START sql view model dbt_milan.my_second_dbt_model ...................... [RUN]
[0m15:03:23.876829 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.coffee_shop.my_second_dbt_model'
[0m15:03:23.877108 [debug] [Thread-4 (]: Began compiling node model.coffee_shop.my_second_dbt_model
[0m15:03:23.880250 [debug] [Thread-4 (]: Writing injected SQL for node "model.coffee_shop.my_second_dbt_model"
[0m15:03:23.881530 [debug] [Thread-4 (]: Timing info for model.coffee_shop.my_second_dbt_model (compile): 2023-02-17 15:03:23.877274 => 2023-02-17 15:03:23.881426
[0m15:03:23.881945 [debug] [Thread-4 (]: Began executing node model.coffee_shop.my_second_dbt_model
[0m15:03:23.902008 [debug] [Thread-4 (]: Writing runtime sql for node "model.coffee_shop.my_second_dbt_model"
[0m15:03:23.902742 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:03:23.903221 [debug] [Thread-4 (]: On model.coffee_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.my_second_dbt_model"} */


  create or replace view `aec-students`.`dbt_milan`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `aec-students`.`dbt_milan`.`my_first_dbt_model`
where id = 1;


[0m15:03:24.180953 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:6150f89c-fe7e-4491-9dcb-774b524112a9&page=queryresults
[0m15:03:24.182895 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (execute): 2023-02-17 15:03:21.191886 => 2023-02-17 15:03:24.182830
[0m15:03:24.183675 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc724787-2aa5-4144-b41f-4e1d7d711bbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88be61ff10>]}
[0m15:03:24.184197 [info ] [Thread-1 (]: 1 of 4 OK created sql table model dbt_milan.customers .......................... [[32mCREATE TABLE (9.0k rows, 12.8 MB processed)[0m in 3.02s]
[0m15:03:24.184688 [debug] [Thread-1 (]: Finished running node model.coffee_shop.customers
[0m15:03:24.185365 [debug] [Thread-6 (]: Began running node model.coffee_shop.customers_ref
[0m15:03:24.185769 [info ] [Thread-6 (]: 4 of 4 START sql view model dbt_milan.customers_ref ............................ [RUN]
[0m15:03:24.186718 [debug] [Thread-6 (]: Acquiring new bigquery connection 'model.coffee_shop.customers_ref'
[0m15:03:24.187095 [debug] [Thread-6 (]: Began compiling node model.coffee_shop.customers_ref
[0m15:03:24.189935 [debug] [Thread-6 (]: Writing injected SQL for node "model.coffee_shop.customers_ref"
[0m15:03:24.190534 [debug] [Thread-6 (]: Timing info for model.coffee_shop.customers_ref (compile): 2023-02-17 15:03:24.187279 => 2023-02-17 15:03:24.190445
[0m15:03:24.190888 [debug] [Thread-6 (]: Began executing node model.coffee_shop.customers_ref
[0m15:03:24.194146 [debug] [Thread-6 (]: Writing runtime sql for node "model.coffee_shop.customers_ref"
[0m15:03:24.194699 [debug] [Thread-6 (]: Opening a new connection, currently in state init
[0m15:03:24.195079 [debug] [Thread-6 (]: On model.coffee_shop.customers_ref: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.customers_ref"} */


  create or replace view `aec-students`.`dbt_milan`.`customers_ref`
  OPTIONS()
  as Select *
from `aec-students`.`dbt_milan`.`customers`;


[0m15:03:24.695371 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:b757b6c3-427a-4ff9-9084-19b1fe2bd5ba&page=queryresults
[0m15:03:24.697425 [debug] [Thread-4 (]: Timing info for model.coffee_shop.my_second_dbt_model (execute): 2023-02-17 15:03:23.882200 => 2023-02-17 15:03:24.697362
[0m15:03:24.698282 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc724787-2aa5-4144-b41f-4e1d7d711bbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88be7084c0>]}
[0m15:03:24.698830 [info ] [Thread-4 (]: 3 of 4 OK created sql view model dbt_milan.my_second_dbt_model ................. [[32mCREATE VIEW (0 processed)[0m in 0.82s]
[0m15:03:24.699307 [debug] [Thread-4 (]: Finished running node model.coffee_shop.my_second_dbt_model
[0m15:03:24.987394 [debug] [Thread-6 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:d27c0f8a-52a3-4c44-9db0-019a65f47fc4&page=queryresults
[0m15:03:24.989646 [debug] [Thread-6 (]: Timing info for model.coffee_shop.customers_ref (execute): 2023-02-17 15:03:24.191083 => 2023-02-17 15:03:24.989586
[0m15:03:24.990488 [debug] [Thread-6 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dc724787-2aa5-4144-b41f-4e1d7d711bbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88be61f850>]}
[0m15:03:24.991059 [info ] [Thread-6 (]: 4 of 4 OK created sql view model dbt_milan.customers_ref ....................... [[32mCREATE VIEW (0 processed)[0m in 0.80s]
[0m15:03:24.991795 [debug] [Thread-6 (]: Finished running node model.coffee_shop.customers_ref
[0m15:03:24.994196 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:03:24.994786 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:03:24.995023 [debug] [MainThread]: Connection 'model.coffee_shop.customers' was properly closed.
[0m15:03:24.995198 [debug] [MainThread]: Connection 'model.coffee_shop.my_first_dbt_model' was properly closed.
[0m15:03:24.995369 [debug] [MainThread]: Connection 'model.coffee_shop.my_second_dbt_model' was properly closed.
[0m15:03:24.995575 [debug] [MainThread]: Connection 'model.coffee_shop.customers_ref' was properly closed.
[0m15:03:24.995814 [info ] [MainThread]: 
[0m15:03:24.996155 [info ] [MainThread]: Finished running 2 table models, 2 view models in 0 hours 0 minutes and 5.48 seconds (5.48s).
[0m15:03:24.996773 [debug] [MainThread]: Command end result
[0m15:03:25.005700 [info ] [MainThread]: 
[0m15:03:25.006344 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:03:25.006859 [info ] [MainThread]: 
[0m15:03:25.007333 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m15:03:25.008129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88be5ae200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88bea59840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88c09ef3a0>]}
[0m15:03:25.008514 [debug] [MainThread]: Flushing usage events


============================== 2023-02-17 15:03:31.553325 | 85bddb23-7e31-491f-aa3b-fe9d52eea613 ==============================
[0m15:03:31.553325 [info ] [MainThread]: Running with dbt=1.4.1
[0m15:03:31.556042 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m15:03:31.556491 [debug] [MainThread]: Tracking: tracking
[0m15:03:31.558553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefee047730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefede61180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefede61990>]}
[0m15:03:31.608711 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:03:31.609058 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:03:31.609773 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffe_shop_milan.example
[0m15:03:31.616490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '85bddb23-7e31-491f-aa3b-fe9d52eea613', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefede3d8d0>]}
[0m15:03:31.625013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '85bddb23-7e31-491f-aa3b-fe9d52eea613', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefede09e70>]}
[0m15:03:31.625529 [info ] [MainThread]: Found 4 models, 9 tests, 0 snapshots, 0 analyses, 334 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m15:03:31.626225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '85bddb23-7e31-491f-aa3b-fe9d52eea613', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefee047730>]}
[0m15:03:31.628353 [info ] [MainThread]: 
[0m15:03:31.630959 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:03:31.632538 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_milan'
[0m15:03:31.633194 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:03:32.757886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '85bddb23-7e31-491f-aa3b-fe9d52eea613', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefede09720>]}
[0m15:03:32.759265 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m15:03:32.760194 [info ] [MainThread]: 
[0m15:03:32.766725 [debug] [Thread-1 (]: Began running node test.coffee_shop.not_null_customers_id.422908bfae
[0m15:03:32.767232 [info ] [Thread-1 (]: 1 of 9 START test not_null_customers_id ........................................ [RUN]
[0m15:03:32.768454 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.coffee_shop.not_null_customers_id.422908bfae'
[0m15:03:32.768874 [debug] [Thread-1 (]: Began compiling node test.coffee_shop.not_null_customers_id.422908bfae
[0m15:03:32.775920 [debug] [Thread-2 (]: Began running node test.coffee_shop.not_null_customers_ref_email.337290571c
[0m15:03:32.776436 [info ] [Thread-2 (]: 2 of 9 START test not_null_customers_ref_email ................................. [RUN]
[0m15:03:32.777438 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.coffee_shop.not_null_customers_ref_email.337290571c'
[0m15:03:32.777831 [debug] [Thread-2 (]: Began compiling node test.coffee_shop.not_null_customers_ref_email.337290571c
[0m15:03:32.799067 [debug] [Thread-3 (]: Began running node test.coffee_shop.not_null_customers_ref_id.1480a96cf3
[0m15:03:32.802713 [debug] [Thread-1 (]: Writing injected SQL for node "test.coffee_shop.not_null_customers_id.422908bfae"
[0m15:03:32.803212 [debug] [Thread-2 (]: Writing injected SQL for node "test.coffee_shop.not_null_customers_ref_email.337290571c"
[0m15:03:32.803578 [debug] [Thread-4 (]: Began running node test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:03:32.803938 [debug] [Thread-5 (]: Began running node test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778
[0m15:03:32.804432 [debug] [Thread-6 (]: Began running node test.coffee_shop.unique_customers_id.70f3d3fd20
[0m15:03:32.804653 [debug] [Thread-7 (]: Began running node test.coffee_shop.unique_customers_ref_id.48ce3bbab4
[0m15:03:32.804202 [info ] [Thread-3 (]: 3 of 9 START test not_null_customers_ref_id .................................... [RUN]
[0m15:03:32.808606 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.coffee_shop.not_null_customers_ref_id.1480a96cf3'
[0m15:03:32.808963 [debug] [Thread-3 (]: Began compiling node test.coffee_shop.not_null_customers_ref_id.1480a96cf3
[0m15:03:32.807164 [debug] [Thread-1 (]: Timing info for test.coffee_shop.not_null_customers_id.422908bfae (compile): 2023-02-17 15:03:32.769149 => 2023-02-17 15:03:32.807035
[0m15:03:32.806176 [info ] [Thread-4 (]: 4 of 9 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m15:03:32.806479 [info ] [Thread-5 (]: 5 of 9 START test not_null_my_second_dbt_model_id .............................. [RUN]
[0m15:03:32.805142 [debug] [Thread-8 (]: Began running node test.coffee_shop.unique_my_first_dbt_model_id.16e066b321
[0m15:03:32.816571 [info ] [Thread-8 (]: 8 of 9 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m15:03:32.807789 [info ] [Thread-7 (]: 7 of 9 START test unique_customers_ref_id ...................................... [RUN]
[0m15:03:32.817858 [debug] [Thread-7 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_customers_ref_id.48ce3bbab4'
[0m15:03:32.814491 [debug] [Thread-3 (]: Writing injected SQL for node "test.coffee_shop.not_null_customers_ref_id.1480a96cf3"
[0m15:03:32.814935 [debug] [Thread-1 (]: Began executing node test.coffee_shop.not_null_customers_id.422908bfae
[0m15:03:32.815626 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710'
[0m15:03:32.816215 [debug] [Thread-5 (]: Acquiring new bigquery connection 'test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778'
[0m15:03:32.817313 [debug] [Thread-8 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_my_first_dbt_model_id.16e066b321'
[0m15:03:32.805921 [debug] [Thread-2 (]: Timing info for test.coffee_shop.not_null_customers_ref_email.337290571c (compile): 2023-02-17 15:03:32.778080 => 2023-02-17 15:03:32.805833
[0m15:03:32.806792 [info ] [Thread-6 (]: 6 of 9 START test unique_customers_id .......................................... [RUN]
[0m15:03:32.818136 [debug] [Thread-7 (]: Began compiling node test.coffee_shop.unique_customers_ref_id.48ce3bbab4
[0m15:03:32.819013 [debug] [Thread-3 (]: Timing info for test.coffee_shop.not_null_customers_ref_id.1480a96cf3 (compile): 2023-02-17 15:03:32.809553 => 2023-02-17 15:03:32.818926
[0m15:03:32.821690 [debug] [Thread-4 (]: Began compiling node test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:03:32.822128 [debug] [Thread-5 (]: Began compiling node test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778
[0m15:03:32.915627 [debug] [Thread-5 (]: Writing injected SQL for node "test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778"
[0m15:03:32.833237 [debug] [Thread-2 (]: Began executing node test.coffee_shop.not_null_customers_ref_email.337290571c
[0m15:03:32.898781 [debug] [Thread-1 (]: Writing runtime sql for node "test.coffee_shop.not_null_customers_id.422908bfae"
[0m15:03:32.899636 [debug] [Thread-6 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_customers_id.70f3d3fd20'
[0m15:03:32.906732 [debug] [Thread-7 (]: Writing injected SQL for node "test.coffee_shop.unique_customers_ref_id.48ce3bbab4"
[0m15:03:32.907163 [debug] [Thread-3 (]: Began executing node test.coffee_shop.not_null_customers_ref_id.1480a96cf3
[0m15:03:32.911340 [debug] [Thread-4 (]: Writing injected SQL for node "test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710"
[0m15:03:32.822430 [debug] [Thread-8 (]: Began compiling node test.coffee_shop.unique_my_first_dbt_model_id.16e066b321
[0m15:03:32.918286 [debug] [Thread-2 (]: Writing runtime sql for node "test.coffee_shop.not_null_customers_ref_email.337290571c"
[0m15:03:32.919032 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:03:32.919370 [debug] [Thread-6 (]: Began compiling node test.coffee_shop.unique_customers_id.70f3d3fd20
[0m15:03:32.921708 [debug] [Thread-3 (]: Writing runtime sql for node "test.coffee_shop.not_null_customers_ref_id.1480a96cf3"
[0m15:03:32.933401 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:03:32.933840 [debug] [Thread-3 (]: On test.coffee_shop.not_null_customers_ref_id.1480a96cf3: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "test.coffee_shop.not_null_customers_ref_id.1480a96cf3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from `aec-students`.`dbt_milan`.`customers_ref`
where id is null



      
    ) dbt_internal_test
[0m15:03:32.926375 [debug] [Thread-8 (]: Writing injected SQL for node "test.coffee_shop.unique_my_first_dbt_model_id.16e066b321"
[0m15:03:32.936969 [debug] [Thread-8 (]: Timing info for test.coffee_shop.unique_my_first_dbt_model_id.16e066b321 (compile): 2023-02-17 15:03:32.922493 => 2023-02-17 15:03:32.936850
[0m15:03:32.937519 [debug] [Thread-8 (]: Began executing node test.coffee_shop.unique_my_first_dbt_model_id.16e066b321
[0m15:03:32.942589 [debug] [Thread-8 (]: Writing runtime sql for node "test.coffee_shop.unique_my_first_dbt_model_id.16e066b321"
[0m15:03:32.927461 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:03:32.943636 [debug] [Thread-2 (]: On test.coffee_shop.not_null_customers_ref_email.337290571c: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "test.coffee_shop.not_null_customers_ref_email.337290571c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select email
from `aec-students`.`dbt_milan`.`customers_ref`
where email is null



      
    ) dbt_internal_test
[0m15:03:32.927953 [debug] [Thread-4 (]: Timing info for test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710 (compile): 2023-02-17 15:03:32.907454 => 2023-02-17 15:03:32.927892
[0m15:03:32.922195 [debug] [Thread-7 (]: Timing info for test.coffee_shop.unique_customers_ref_id.48ce3bbab4 (compile): 2023-02-17 15:03:32.899951 => 2023-02-17 15:03:32.922101
[0m15:03:32.951498 [debug] [Thread-7 (]: Began executing node test.coffee_shop.unique_customers_ref_id.48ce3bbab4
[0m15:03:32.926921 [debug] [Thread-5 (]: Timing info for test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778 (compile): 2023-02-17 15:03:32.911675 => 2023-02-17 15:03:32.926830
[0m15:03:32.955703 [debug] [Thread-5 (]: Began executing node test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778
[0m15:03:32.932668 [debug] [Thread-6 (]: Writing injected SQL for node "test.coffee_shop.unique_customers_id.70f3d3fd20"
[0m15:03:32.960319 [debug] [Thread-6 (]: Timing info for test.coffee_shop.unique_customers_id.70f3d3fd20 (compile): 2023-02-17 15:03:32.928798 => 2023-02-17 15:03:32.960217
[0m15:03:32.960718 [debug] [Thread-6 (]: Began executing node test.coffee_shop.unique_customers_id.70f3d3fd20
[0m15:03:32.946783 [debug] [Thread-8 (]: Opening a new connection, currently in state init
[0m15:03:32.965409 [debug] [Thread-8 (]: On test.coffee_shop.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "test.coffee_shop.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `aec-students`.`dbt_milan`.`my_first_dbt_model`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m15:03:32.954994 [debug] [Thread-7 (]: Writing runtime sql for node "test.coffee_shop.unique_customers_ref_id.48ce3bbab4"
[0m15:03:32.928547 [debug] [Thread-1 (]: On test.coffee_shop.not_null_customers_id.422908bfae: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "test.coffee_shop.not_null_customers_id.422908bfae"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from `aec-students`.`dbt_milan`.`customers`
where id is null



      
    ) dbt_internal_test
[0m15:03:32.959083 [debug] [Thread-5 (]: Writing runtime sql for node "test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778"
[0m15:03:32.950994 [debug] [Thread-4 (]: Began executing node test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:03:32.964902 [debug] [Thread-6 (]: Writing runtime sql for node "test.coffee_shop.unique_customers_id.70f3d3fd20"
[0m15:03:32.974722 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m15:03:32.990187 [debug] [Thread-5 (]: On test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from `aec-students`.`dbt_milan`.`my_second_dbt_model`
where id is null



      
    ) dbt_internal_test
[0m15:03:32.981260 [debug] [Thread-4 (]: Writing runtime sql for node "test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710"
[0m15:03:32.977494 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m15:03:32.995081 [debug] [Thread-7 (]: On test.coffee_shop.unique_customers_ref_id.48ce3bbab4: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "test.coffee_shop.unique_customers_ref_id.48ce3bbab4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `aec-students`.`dbt_milan`.`customers_ref`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m15:03:32.991150 [debug] [Thread-6 (]: Opening a new connection, currently in state init
[0m15:03:32.999016 [debug] [Thread-6 (]: On test.coffee_shop.unique_customers_id.70f3d3fd20: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "test.coffee_shop.unique_customers_id.70f3d3fd20"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `aec-students`.`dbt_milan`.`customers`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m15:03:33.002989 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:03:33.003564 [debug] [Thread-4 (]: On test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from `aec-students`.`dbt_milan`.`my_first_dbt_model`
where id is null



      
    ) dbt_internal_test
[0m15:03:34.716670 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:f67fb66b-95ff-49f0-a8cd-75ff654f8ebd&page=queryresults
[0m15:03:34.718154 [debug] [Thread-1 (]: Timing info for test.coffee_shop.not_null_customers_id.422908bfae (execute): 2023-02-17 15:03:32.819190 => 2023-02-17 15:03:34.718074
[0m15:03:34.719005 [info ] [Thread-1 (]: 1 of 9 PASS not_null_customers_id .............................................. [[32mPASS[0m in 1.95s]
[0m15:03:34.721633 [debug] [Thread-1 (]: Finished running node test.coffee_shop.not_null_customers_id.422908bfae
[0m15:03:34.722175 [debug] [Thread-1 (]: Began running node test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493
[0m15:03:34.722646 [info ] [Thread-1 (]: 9 of 9 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m15:03:34.723449 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493'
[0m15:03:34.723789 [debug] [Thread-1 (]: Began compiling node test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493
[0m15:03:34.728584 [debug] [Thread-1 (]: Writing injected SQL for node "test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493"
[0m15:03:34.729175 [debug] [Thread-1 (]: Timing info for test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493 (compile): 2023-02-17 15:03:34.724044 => 2023-02-17 15:03:34.729097
[0m15:03:34.729524 [debug] [Thread-1 (]: Began executing node test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493
[0m15:03:34.732809 [debug] [Thread-1 (]: Writing runtime sql for node "test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493"
[0m15:03:34.735301 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:03:34.735907 [debug] [Thread-1 (]: On test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `aec-students`.`dbt_milan`.`my_second_dbt_model`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m15:03:34.790281 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:a5f7af8f-1383-488f-b8a2-8b83d4b5c518&page=queryresults
[0m15:03:34.791483 [debug] [Thread-4 (]: Timing info for test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710 (execute): 2023-02-17 15:03:32.978003 => 2023-02-17 15:03:34.791346
[0m15:03:34.792884 [error] [Thread-4 (]: 4 of 9 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 1.98s]
[0m15:03:34.795576 [debug] [Thread-4 (]: Finished running node test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:03:34.825709 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:35c9b1e8-347c-4dad-a378-d65c28a03c8c&page=queryresults
[0m15:03:34.826645 [debug] [Thread-2 (]: Timing info for test.coffee_shop.not_null_customers_ref_email.337290571c (execute): 2023-02-17 15:03:32.916257 => 2023-02-17 15:03:34.826545
[0m15:03:34.827905 [info ] [Thread-2 (]: 2 of 9 PASS not_null_customers_ref_email ....................................... [[32mPASS[0m in 2.05s]
[0m15:03:34.829001 [debug] [Thread-2 (]: Finished running node test.coffee_shop.not_null_customers_ref_email.337290571c
[0m15:03:34.868428 [debug] [Thread-5 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:85eb3077-124a-411d-9fb5-71a49e3cfd54&page=queryresults
[0m15:03:34.869155 [debug] [Thread-5 (]: Timing info for test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778 (execute): 2023-02-17 15:03:32.956007 => 2023-02-17 15:03:34.869082
[0m15:03:34.869934 [info ] [Thread-5 (]: 5 of 9 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 2.05s]
[0m15:03:34.870405 [debug] [Thread-5 (]: Finished running node test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778
[0m15:03:34.876271 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:c34f72c4-d032-406f-ae56-772ced91946c&page=queryresults
[0m15:03:34.876981 [debug] [Thread-3 (]: Timing info for test.coffee_shop.not_null_customers_ref_id.1480a96cf3 (execute): 2023-02-17 15:03:32.919793 => 2023-02-17 15:03:34.876914
[0m15:03:34.877836 [info ] [Thread-3 (]: 3 of 9 PASS not_null_customers_ref_id .......................................... [[32mPASS[0m in 2.07s]
[0m15:03:34.882273 [debug] [Thread-3 (]: Finished running node test.coffee_shop.not_null_customers_ref_id.1480a96cf3
[0m15:03:35.051012 [debug] [Thread-8 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:28473867-3501-4132-8576-88c721932986&page=queryresults
[0m15:03:35.052020 [debug] [Thread-8 (]: Timing info for test.coffee_shop.unique_my_first_dbt_model_id.16e066b321 (execute): 2023-02-17 15:03:32.937882 => 2023-02-17 15:03:35.051899
[0m15:03:35.056531 [debug] [Thread-7 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:a7881b46-475d-4f9a-a79a-289bbc5f0986&page=queryresults
[0m15:03:35.057395 [debug] [Thread-7 (]: Timing info for test.coffee_shop.unique_customers_ref_id.48ce3bbab4 (execute): 2023-02-17 15:03:32.951790 => 2023-02-17 15:03:35.057301
[0m15:03:35.053112 [info ] [Thread-8 (]: 8 of 9 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 2.24s]
[0m15:03:35.058384 [info ] [Thread-7 (]: 7 of 9 PASS unique_customers_ref_id ............................................ [[32mPASS[0m in 2.24s]
[0m15:03:35.059155 [debug] [Thread-8 (]: Finished running node test.coffee_shop.unique_my_first_dbt_model_id.16e066b321
[0m15:03:35.060363 [debug] [Thread-6 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:cfe38d76-c242-49a6-82f8-c0e0b27186d2&page=queryresults
[0m15:03:35.060808 [debug] [Thread-7 (]: Finished running node test.coffee_shop.unique_customers_ref_id.48ce3bbab4
[0m15:03:35.061780 [debug] [Thread-6 (]: Timing info for test.coffee_shop.unique_customers_id.70f3d3fd20 (execute): 2023-02-17 15:03:32.960964 => 2023-02-17 15:03:35.061718
[0m15:03:35.062746 [info ] [Thread-6 (]: 6 of 9 PASS unique_customers_id ................................................ [[32mPASS[0m in 2.16s]
[0m15:03:35.063276 [debug] [Thread-6 (]: Finished running node test.coffee_shop.unique_customers_id.70f3d3fd20
[0m15:03:36.094035 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:1e598575-4a4d-41e3-9709-8fd88fe70644&page=queryresults
[0m15:03:36.094802 [debug] [Thread-1 (]: Timing info for test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493 (execute): 2023-02-17 15:03:34.729766 => 2023-02-17 15:03:36.094722
[0m15:03:36.095599 [info ] [Thread-1 (]: 9 of 9 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 1.37s]
[0m15:03:36.096106 [debug] [Thread-1 (]: Finished running node test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493
[0m15:03:36.098042 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:03:36.098630 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:03:36.098851 [debug] [MainThread]: Connection 'test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m15:03:36.099026 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_customers_ref_email.337290571c' was properly closed.
[0m15:03:36.099192 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_customers_ref_id.1480a96cf3' was properly closed.
[0m15:03:36.099346 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m15:03:36.099535 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
[0m15:03:36.099687 [debug] [MainThread]: Connection 'test.coffee_shop.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m15:03:36.099842 [debug] [MainThread]: Connection 'test.coffee_shop.unique_customers_ref_id.48ce3bbab4' was properly closed.
[0m15:03:36.100836 [debug] [MainThread]: Connection 'test.coffee_shop.unique_customers_id.70f3d3fd20' was properly closed.
[0m15:03:36.101223 [info ] [MainThread]: 
[0m15:03:36.101813 [info ] [MainThread]: Finished running 9 tests in 0 hours 0 minutes and 4.47 seconds (4.47s).
[0m15:03:36.102653 [debug] [MainThread]: Command end result
[0m15:03:36.110863 [info ] [MainThread]: 
[0m15:03:36.111811 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:03:36.112312 [info ] [MainThread]: 
[0m15:03:36.113069 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
[0m15:03:36.113491 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m15:03:36.114195 [info ] [MainThread]: 
[0m15:03:36.114961 [info ] [MainThread]:   compiled Code at target/compiled/coffee_shop/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
[0m15:03:36.115542 [info ] [MainThread]: 
[0m15:03:36.116024 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=0 TOTAL=9
[0m15:03:36.117020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefec34be80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefec4279a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefede090f0>]}
[0m15:03:36.117430 [debug] [MainThread]: Flushing usage events


============================== 2023-02-17 15:07:01.789518 | 9d5fd12c-11ef-43a9-8a25-9e999ffa03fa ==============================
[0m15:07:01.789518 [info ] [MainThread]: Running with dbt=1.4.1
[0m15:07:01.793224 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
[0m15:07:01.794506 [debug] [MainThread]: Tracking: tracking
[0m15:07:01.796476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14d6c591b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14d6c58310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14d6c58b50>]}
[0m15:07:01.854956 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:07:01.855613 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:07:01.856357 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffe_shop_milan.example
[0m15:07:01.862854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9d5fd12c-11ef-43a9-8a25-9e999ffa03fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14d6c35f90>]}
[0m15:07:01.871352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9d5fd12c-11ef-43a9-8a25-9e999ffa03fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14d6b66560>]}
[0m15:07:01.872082 [info ] [MainThread]: Found 4 models, 9 tests, 0 snapshots, 0 analyses, 334 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m15:07:01.872596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d5fd12c-11ef-43a9-8a25-9e999ffa03fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14d6b665c0>]}
[0m15:07:01.874431 [info ] [MainThread]: 
[0m15:07:01.876547 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:07:01.878662 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_milan'
[0m15:07:01.879227 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:07:03.059463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d5fd12c-11ef-43a9-8a25-9e999ffa03fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14d6b66230>]}
[0m15:07:03.060798 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m15:07:03.061459 [info ] [MainThread]: 
[0m15:07:03.071569 [debug] [Thread-1 (]: Began running node model.coffee_shop.customers
[0m15:07:03.072118 [debug] [Thread-2 (]: Began running node model.coffee_shop.my_first_dbt_model
[0m15:07:03.073871 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.coffee_shop.my_first_dbt_model'
[0m15:07:03.074412 [debug] [Thread-2 (]: Began compiling node model.coffee_shop.my_first_dbt_model
[0m15:07:03.072869 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop.customers'
[0m15:07:03.080742 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.customers
[0m15:07:03.085771 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.customers"
[0m15:07:03.086643 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (compile): 2023-02-17 15:07:03.081167 => 2023-02-17 15:07:03.086533
[0m15:07:03.080169 [debug] [Thread-2 (]: Writing injected SQL for node "model.coffee_shop.my_first_dbt_model"
[0m15:07:03.088761 [debug] [Thread-2 (]: Timing info for model.coffee_shop.my_first_dbt_model (compile): 2023-02-17 15:07:03.074818 => 2023-02-17 15:07:03.088663
[0m15:07:03.089311 [debug] [Thread-2 (]: Began executing node model.coffee_shop.my_first_dbt_model
[0m15:07:03.089817 [debug] [Thread-2 (]: Timing info for model.coffee_shop.my_first_dbt_model (execute): 2023-02-17 15:07:03.089717 => 2023-02-17 15:07:03.089742
[0m15:07:03.092664 [debug] [Thread-2 (]: Finished running node model.coffee_shop.my_first_dbt_model
[0m15:07:03.087210 [debug] [Thread-1 (]: Began executing node model.coffee_shop.customers
[0m15:07:03.093675 [debug] [Thread-4 (]: Began running node model.coffee_shop.my_second_dbt_model
[0m15:07:03.095668 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.coffee_shop.my_second_dbt_model'
[0m15:07:03.094263 [debug] [Thread-6 (]: Began running node test.coffee_shop.unique_my_first_dbt_model_id.16e066b321
[0m15:07:03.096759 [debug] [Thread-6 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_my_first_dbt_model_id.16e066b321'
[0m15:07:03.097243 [debug] [Thread-6 (]: Began compiling node test.coffee_shop.unique_my_first_dbt_model_id.16e066b321
[0m15:07:03.093960 [debug] [Thread-5 (]: Began running node test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:07:03.109509 [debug] [Thread-5 (]: Acquiring new bigquery connection 'test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710'
[0m15:07:03.109820 [debug] [Thread-5 (]: Began compiling node test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:07:03.108802 [debug] [Thread-6 (]: Writing injected SQL for node "test.coffee_shop.unique_my_first_dbt_model_id.16e066b321"
[0m15:07:03.095982 [debug] [Thread-4 (]: Began compiling node model.coffee_shop.my_second_dbt_model
[0m15:07:03.094869 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (execute): 2023-02-17 15:07:03.094773 => 2023-02-17 15:07:03.094790
[0m15:07:03.119554 [debug] [Thread-5 (]: Writing injected SQL for node "test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710"
[0m15:07:03.123262 [debug] [Thread-1 (]: Finished running node model.coffee_shop.customers
[0m15:07:03.126905 [debug] [Thread-4 (]: Writing injected SQL for node "model.coffee_shop.my_second_dbt_model"
[0m15:07:03.127697 [debug] [Thread-5 (]: Timing info for test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710 (compile): 2023-02-17 15:07:03.109998 => 2023-02-17 15:07:03.127599
[0m15:07:03.128024 [debug] [Thread-6 (]: Timing info for test.coffee_shop.unique_my_first_dbt_model_id.16e066b321 (compile): 2023-02-17 15:07:03.097706 => 2023-02-17 15:07:03.127977
[0m15:07:03.130837 [debug] [Thread-6 (]: Began executing node test.coffee_shop.unique_my_first_dbt_model_id.16e066b321
[0m15:07:03.129725 [debug] [Thread-8 (]: Began running node model.coffee_shop.customers_ref
[0m15:07:03.129973 [debug] [Thread-3 (]: Began running node test.coffee_shop.not_null_customers_id.422908bfae
[0m15:07:03.132369 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.coffee_shop.not_null_customers_id.422908bfae'
[0m15:07:03.130496 [debug] [Thread-5 (]: Began executing node test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:07:03.129358 [debug] [Thread-4 (]: Timing info for model.coffee_shop.my_second_dbt_model (compile): 2023-02-17 15:07:03.120130 => 2023-02-17 15:07:03.129249
[0m15:07:03.133291 [debug] [Thread-4 (]: Began executing node model.coffee_shop.my_second_dbt_model
[0m15:07:03.133670 [debug] [Thread-4 (]: Timing info for model.coffee_shop.my_second_dbt_model (execute): 2023-02-17 15:07:03.133605 => 2023-02-17 15:07:03.133615
[0m15:07:03.132634 [debug] [Thread-3 (]: Began compiling node test.coffee_shop.not_null_customers_id.422908bfae
[0m15:07:03.130212 [debug] [Thread-2 (]: Began running node test.coffee_shop.unique_customers_id.70f3d3fd20
[0m15:07:03.201563 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_customers_id.70f3d3fd20'
[0m15:07:03.131128 [debug] [Thread-6 (]: Timing info for test.coffee_shop.unique_my_first_dbt_model_id.16e066b321 (execute): 2023-02-17 15:07:03.131071 => 2023-02-17 15:07:03.131084
[0m15:07:03.131767 [debug] [Thread-8 (]: Acquiring new bigquery connection 'model.coffee_shop.customers_ref'
[0m15:07:03.203373 [debug] [Thread-8 (]: Began compiling node model.coffee_shop.customers_ref
[0m15:07:03.134612 [debug] [Thread-4 (]: Finished running node model.coffee_shop.my_second_dbt_model
[0m15:07:03.218519 [debug] [Thread-3 (]: Writing injected SQL for node "test.coffee_shop.not_null_customers_id.422908bfae"
[0m15:07:03.203000 [debug] [Thread-6 (]: Finished running node test.coffee_shop.unique_my_first_dbt_model_id.16e066b321
[0m15:07:03.219368 [debug] [Thread-3 (]: Timing info for test.coffee_shop.not_null_customers_id.422908bfae (compile): 2023-02-17 15:07:03.134896 => 2023-02-17 15:07:03.219276
[0m15:07:03.219793 [debug] [Thread-3 (]: Began executing node test.coffee_shop.not_null_customers_id.422908bfae
[0m15:07:03.220141 [debug] [Thread-3 (]: Timing info for test.coffee_shop.not_null_customers_id.422908bfae (execute): 2023-02-17 15:07:03.220059 => 2023-02-17 15:07:03.220077
[0m15:07:03.202100 [debug] [Thread-2 (]: Began compiling node test.coffee_shop.unique_customers_id.70f3d3fd20
[0m15:07:03.132934 [debug] [Thread-5 (]: Timing info for test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710 (execute): 2023-02-17 15:07:03.132847 => 2023-02-17 15:07:03.132861
[0m15:07:03.228166 [debug] [Thread-5 (]: Finished running node test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:07:03.221111 [debug] [Thread-3 (]: Finished running node test.coffee_shop.not_null_customers_id.422908bfae
[0m15:07:03.230409 [debug] [Thread-1 (]: Began running node test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778
[0m15:07:03.207400 [debug] [Thread-8 (]: Writing injected SQL for node "model.coffee_shop.customers_ref"
[0m15:07:03.231333 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778'
[0m15:07:03.247688 [debug] [Thread-1 (]: Began compiling node test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778
[0m15:07:03.226891 [debug] [Thread-2 (]: Writing injected SQL for node "test.coffee_shop.unique_customers_id.70f3d3fd20"
[0m15:07:03.244163 [debug] [Thread-8 (]: Timing info for model.coffee_shop.customers_ref (compile): 2023-02-17 15:07:03.203675 => 2023-02-17 15:07:03.244034
[0m15:07:03.255523 [debug] [Thread-8 (]: Began executing node model.coffee_shop.customers_ref
[0m15:07:03.255952 [debug] [Thread-8 (]: Timing info for model.coffee_shop.customers_ref (execute): 2023-02-17 15:07:03.255856 => 2023-02-17 15:07:03.255874
[0m15:07:03.256938 [debug] [Thread-8 (]: Finished running node model.coffee_shop.customers_ref
[0m15:07:03.240325 [debug] [Thread-7 (]: Began running node test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493
[0m15:07:03.257876 [debug] [Thread-7 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493'
[0m15:07:03.258277 [debug] [Thread-7 (]: Began compiling node test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493
[0m15:07:03.254828 [debug] [Thread-1 (]: Writing injected SQL for node "test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778"
[0m15:07:03.269498 [debug] [Thread-1 (]: Timing info for test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778 (compile): 2023-02-17 15:07:03.248071 => 2023-02-17 15:07:03.269414
[0m15:07:03.270106 [debug] [Thread-1 (]: Began executing node test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778
[0m15:07:03.270439 [debug] [Thread-1 (]: Timing info for test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778 (execute): 2023-02-17 15:07:03.270371 => 2023-02-17 15:07:03.270386
[0m15:07:03.267699 [debug] [Thread-6 (]: Began running node test.coffee_shop.not_null_customers_ref_email.337290571c
[0m15:07:03.272335 [debug] [Thread-6 (]: Acquiring new bigquery connection 'test.coffee_shop.not_null_customers_ref_email.337290571c'
[0m15:07:03.269799 [debug] [Thread-2 (]: Timing info for test.coffee_shop.unique_customers_id.70f3d3fd20 (compile): 2023-02-17 15:07:03.221449 => 2023-02-17 15:07:03.269754
[0m15:07:03.268861 [debug] [Thread-3 (]: Began running node test.coffee_shop.unique_customers_ref_id.48ce3bbab4
[0m15:07:03.274143 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_customers_ref_id.48ce3bbab4'
[0m15:07:03.274592 [debug] [Thread-3 (]: Began compiling node test.coffee_shop.unique_customers_ref_id.48ce3bbab4
[0m15:07:03.271485 [debug] [Thread-1 (]: Finished running node test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778
[0m15:07:03.267151 [debug] [Thread-7 (]: Writing injected SQL for node "test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493"
[0m15:07:03.273105 [debug] [Thread-2 (]: Began executing node test.coffee_shop.unique_customers_id.70f3d3fd20
[0m15:07:03.282592 [debug] [Thread-3 (]: Writing injected SQL for node "test.coffee_shop.unique_customers_ref_id.48ce3bbab4"
[0m15:07:03.272734 [debug] [Thread-6 (]: Began compiling node test.coffee_shop.not_null_customers_ref_email.337290571c
[0m15:07:03.283411 [debug] [Thread-2 (]: Timing info for test.coffee_shop.unique_customers_id.70f3d3fd20 (execute): 2023-02-17 15:07:03.283327 => 2023-02-17 15:07:03.283343
[0m15:07:03.268475 [debug] [Thread-5 (]: Began running node test.coffee_shop.not_null_customers_ref_id.1480a96cf3
[0m15:07:03.292883 [debug] [Thread-5 (]: Acquiring new bigquery connection 'test.coffee_shop.not_null_customers_ref_id.1480a96cf3'
[0m15:07:03.293195 [debug] [Thread-5 (]: Began compiling node test.coffee_shop.not_null_customers_ref_id.1480a96cf3
[0m15:07:03.290766 [debug] [Thread-2 (]: Finished running node test.coffee_shop.unique_customers_id.70f3d3fd20
[0m15:07:03.292308 [debug] [Thread-3 (]: Timing info for test.coffee_shop.unique_customers_ref_id.48ce3bbab4 (compile): 2023-02-17 15:07:03.274883 => 2023-02-17 15:07:03.292253
[0m15:07:03.284004 [debug] [Thread-7 (]: Timing info for test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493 (compile): 2023-02-17 15:07:03.258545 => 2023-02-17 15:07:03.283925
[0m15:07:03.292030 [debug] [Thread-6 (]: Writing injected SQL for node "test.coffee_shop.not_null_customers_ref_email.337290571c"
[0m15:07:03.297625 [debug] [Thread-5 (]: Writing injected SQL for node "test.coffee_shop.not_null_customers_ref_id.1480a96cf3"
[0m15:07:03.298280 [debug] [Thread-3 (]: Began executing node test.coffee_shop.unique_customers_ref_id.48ce3bbab4
[0m15:07:03.298612 [debug] [Thread-7 (]: Began executing node test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493
[0m15:07:03.301694 [debug] [Thread-7 (]: Timing info for test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493 (execute): 2023-02-17 15:07:03.301623 => 2023-02-17 15:07:03.301635
[0m15:07:03.302384 [debug] [Thread-7 (]: Finished running node test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493
[0m15:07:03.301324 [debug] [Thread-3 (]: Timing info for test.coffee_shop.unique_customers_ref_id.48ce3bbab4 (execute): 2023-02-17 15:07:03.301243 => 2023-02-17 15:07:03.301261
[0m15:07:03.300525 [debug] [Thread-6 (]: Timing info for test.coffee_shop.not_null_customers_ref_email.337290571c (compile): 2023-02-17 15:07:03.284415 => 2023-02-17 15:07:03.300337
[0m15:07:03.303597 [debug] [Thread-6 (]: Began executing node test.coffee_shop.not_null_customers_ref_email.337290571c
[0m15:07:03.303262 [debug] [Thread-3 (]: Finished running node test.coffee_shop.unique_customers_ref_id.48ce3bbab4
[0m15:07:03.300953 [debug] [Thread-5 (]: Timing info for test.coffee_shop.not_null_customers_ref_id.1480a96cf3 (compile): 2023-02-17 15:07:03.293376 => 2023-02-17 15:07:03.300869
[0m15:07:03.304358 [debug] [Thread-5 (]: Began executing node test.coffee_shop.not_null_customers_ref_id.1480a96cf3
[0m15:07:03.303843 [debug] [Thread-6 (]: Timing info for test.coffee_shop.not_null_customers_ref_email.337290571c (execute): 2023-02-17 15:07:03.303776 => 2023-02-17 15:07:03.303786
[0m15:07:03.304597 [debug] [Thread-5 (]: Timing info for test.coffee_shop.not_null_customers_ref_id.1480a96cf3 (execute): 2023-02-17 15:07:03.304533 => 2023-02-17 15:07:03.304543
[0m15:07:03.305294 [debug] [Thread-6 (]: Finished running node test.coffee_shop.not_null_customers_ref_email.337290571c
[0m15:07:03.305961 [debug] [Thread-5 (]: Finished running node test.coffee_shop.not_null_customers_ref_id.1480a96cf3
[0m15:07:03.307541 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:07:03.307798 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
[0m15:07:03.308011 [debug] [MainThread]: Connection 'test.coffee_shop.unique_customers_id.70f3d3fd20' was properly closed.
[0m15:07:03.308198 [debug] [MainThread]: Connection 'model.coffee_shop.my_second_dbt_model' was properly closed.
[0m15:07:03.308400 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_customers_ref_email.337290571c' was properly closed.
[0m15:07:03.308584 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_customers_ref_id.1480a96cf3' was properly closed.
[0m15:07:03.308763 [debug] [MainThread]: Connection 'model.coffee_shop.customers_ref' was properly closed.
[0m15:07:03.308943 [debug] [MainThread]: Connection 'test.coffee_shop.unique_customers_ref_id.48ce3bbab4' was properly closed.
[0m15:07:03.309120 [debug] [MainThread]: Connection 'test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m15:07:03.309790 [debug] [MainThread]: Command end result
[0m15:07:03.318437 [info ] [MainThread]: Done.
[0m15:07:03.353997 [debug] [MainThread]: Acquiring new bigquery connection 'generate_catalog'
[0m15:07:03.354590 [info ] [MainThread]: Building catalog
[0m15:07:03.356039 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:07:03.708957 [debug] [ThreadPool]: Acquiring new bigquery connection 'aec-students.information_schema'
[0m15:07:03.727595 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:07:03.728447 [debug] [ThreadPool]: On aec-students.information_schema: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "connection_name": "aec-students.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `aec-students`.`dbt_milan`.__TABLES__
        where (upper(dataset_id) = upper('dbt_milan'))
    ),

    table_options as (
        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            JSON_VALUE(option_value) as table_comment

        from `aec-students`.`dbt_milan`.INFORMATION_SCHEMA.TABLE_OPTIONS
        where option_name = 'description'
    ),
    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `aec-students`.`dbt_milan`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `aec-students`.`dbt_milan`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,
        table_options.table_comment,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join table_options using (relation_id)
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
[0m15:07:06.208385 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:75ec95cb-4a69-4443-b006-a22ed8fe5dd5&page=queryresults
[0m15:07:06.232567 [info ] [MainThread]: Catalog written to /workspaces/ae-club-milan/coffe_shop_milan/target/catalog.json
[0m15:07:06.233372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14d6c70400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14d6c73b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14d6c70490>]}
[0m15:07:06.233919 [debug] [MainThread]: Flushing usage events
[0m15:07:06.622828 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m15:07:06.623553 [debug] [MainThread]: Connection 'aec-students.information_schema' was properly closed.


============================== 2023-02-17 15:07:31.496810 | f0668524-9774-4ded-96e3-a2b30cac3dd4 ==============================
[0m15:07:31.496810 [info ] [MainThread]: Running with dbt=1.4.1
[0m15:07:31.499484 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
[0m15:07:31.499931 [debug] [MainThread]: Tracking: tracking
[0m15:07:31.506769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec2ec4d1b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec2ec4c3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fec2ec4f2e0>]}
[0m15:07:31.511786 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
[0m15:07:31.513020 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
[0m15:07:31.514247 [info ] [MainThread]: 
[0m15:07:31.515312 [info ] [MainThread]: 
[0m15:07:31.516369 [info ] [MainThread]: Press Ctrl+C to exit.
[0m15:29:24.682309 [debug] [MainThread]: Flushing usage events
[0m15:29:25.085667 [info ] [MainThread]: ctrl-c


============================== 2023-02-17 15:30:01.234811 | 4b8a382a-a8ae-4996-a5ee-b8d8d3522aa3 ==============================
[0m15:30:01.234811 [info ] [MainThread]: Running with dbt=1.4.1
[0m15:30:01.237302 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
[0m15:30:01.237623 [debug] [MainThread]: Tracking: tracking
[0m15:30:01.242770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3231437f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3231401f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff323143850>]}
[0m15:30:01.245236 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
[0m15:30:01.245738 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
[0m15:30:01.246125 [info ] [MainThread]: 
[0m15:30:01.246474 [info ] [MainThread]: 
[0m15:30:01.246808 [info ] [MainThread]: Press Ctrl+C to exit.
[0m15:30:56.481657 [debug] [MainThread]: Flushing usage events
[0m15:30:56.884760 [info ] [MainThread]: ctrl-c


============================== 2023-02-17 15:31:20.171003 | 2abb7a7c-8ecb-4f6f-b3d7-0b808dc681f2 ==============================
[0m15:31:20.171003 [info ] [MainThread]: Running with dbt=1.4.1
[0m15:31:20.173676 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
[0m15:31:20.174100 [debug] [MainThread]: Tracking: tracking
[0m15:31:20.177431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f490e061390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f490e060610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f490e061150>]}
[0m15:31:20.227573 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:31:20.228396 [debug] [MainThread]: Partial parsing: updated file: coffee_shop://models/schema.yml
[0m15:31:20.246488 [debug] [MainThread]: 1699: static parser successfully parsed customers_ref.sql
[0m15:31:20.291023 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffe_shop_milan.example
[0m15:31:20.298269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2abb7a7c-8ecb-4f6f-b3d7-0b808dc681f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f490e02f550>]}
[0m15:31:20.359290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2abb7a7c-8ecb-4f6f-b3d7-0b808dc681f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f490e391ea0>]}
[0m15:31:20.359870 [info ] [MainThread]: Found 4 models, 9 tests, 0 snapshots, 0 analyses, 334 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m15:31:20.360566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2abb7a7c-8ecb-4f6f-b3d7-0b808dc681f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4910835ae0>]}
[0m15:31:20.362703 [info ] [MainThread]: 
[0m15:31:20.365104 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:31:20.366548 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_milan'
[0m15:31:20.366972 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:31:21.635938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2abb7a7c-8ecb-4f6f-b3d7-0b808dc681f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f490e47c790>]}
[0m15:31:21.636983 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m15:31:21.637830 [info ] [MainThread]: 
[0m15:31:21.642841 [debug] [Thread-1 (]: Began running node model.coffee_shop.customers
[0m15:31:21.643777 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop.customers'
[0m15:31:21.644181 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.customers
[0m15:31:21.648279 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.customers"
[0m15:31:21.648769 [debug] [Thread-2 (]: Began running node model.coffee_shop.my_first_dbt_model
[0m15:31:21.649894 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.coffee_shop.my_first_dbt_model'
[0m15:31:21.650429 [debug] [Thread-2 (]: Began compiling node model.coffee_shop.my_first_dbt_model
[0m15:31:21.654404 [debug] [Thread-2 (]: Writing injected SQL for node "model.coffee_shop.my_first_dbt_model"
[0m15:31:21.655492 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (compile): 2023-02-17 15:31:21.644442 => 2023-02-17 15:31:21.655366
[0m15:31:21.655811 [debug] [Thread-2 (]: Timing info for model.coffee_shop.my_first_dbt_model (compile): 2023-02-17 15:31:21.650672 => 2023-02-17 15:31:21.655747
[0m15:31:21.656074 [debug] [Thread-1 (]: Began executing node model.coffee_shop.customers
[0m15:31:21.656379 [debug] [Thread-2 (]: Began executing node model.coffee_shop.my_first_dbt_model
[0m15:31:21.656701 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (execute): 2023-02-17 15:31:21.656639 => 2023-02-17 15:31:21.656655
[0m15:31:21.656954 [debug] [Thread-2 (]: Timing info for model.coffee_shop.my_first_dbt_model (execute): 2023-02-17 15:31:21.656894 => 2023-02-17 15:31:21.656903
[0m15:31:21.658814 [debug] [Thread-1 (]: Finished running node model.coffee_shop.customers
[0m15:31:21.659620 [debug] [Thread-2 (]: Finished running node model.coffee_shop.my_first_dbt_model
[0m15:31:21.660394 [debug] [Thread-4 (]: Began running node model.coffee_shop.customers_ref
[0m15:31:21.660704 [debug] [Thread-5 (]: Began running node test.coffee_shop.not_null_customers_id.422908bfae
[0m15:31:21.660958 [debug] [Thread-6 (]: Began running node test.coffee_shop.unique_customers_id.70f3d3fd20
[0m15:31:21.661773 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.coffee_shop.customers_ref'
[0m15:31:21.662557 [debug] [Thread-5 (]: Acquiring new bigquery connection 'test.coffee_shop.not_null_customers_id.422908bfae'
[0m15:31:21.663001 [debug] [Thread-8 (]: Began running node model.coffee_shop.my_second_dbt_model
[0m15:31:21.663498 [debug] [Thread-3 (]: Began running node test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:31:21.663786 [debug] [Thread-1 (]: Began running node test.coffee_shop.unique_my_first_dbt_model_id.16e066b321
[0m15:31:21.664422 [debug] [Thread-6 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_customers_id.70f3d3fd20'
[0m15:31:21.664722 [debug] [Thread-4 (]: Began compiling node model.coffee_shop.customers_ref
[0m15:31:21.665024 [debug] [Thread-5 (]: Began compiling node test.coffee_shop.not_null_customers_id.422908bfae
[0m15:31:21.665592 [debug] [Thread-8 (]: Acquiring new bigquery connection 'model.coffee_shop.my_second_dbt_model'
[0m15:31:21.666190 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710'
[0m15:31:21.666748 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_my_first_dbt_model_id.16e066b321'
[0m15:31:21.667053 [debug] [Thread-6 (]: Began compiling node test.coffee_shop.unique_customers_id.70f3d3fd20
[0m15:31:21.670284 [debug] [Thread-4 (]: Writing injected SQL for node "model.coffee_shop.customers_ref"
[0m15:31:21.678409 [debug] [Thread-8 (]: Began compiling node model.coffee_shop.my_second_dbt_model
[0m15:31:21.688753 [debug] [Thread-3 (]: Began compiling node test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:31:21.691802 [debug] [Thread-5 (]: Writing injected SQL for node "test.coffee_shop.not_null_customers_id.422908bfae"
[0m15:31:21.692303 [debug] [Thread-1 (]: Began compiling node test.coffee_shop.unique_my_first_dbt_model_id.16e066b321
[0m15:31:21.699050 [debug] [Thread-6 (]: Writing injected SQL for node "test.coffee_shop.unique_customers_id.70f3d3fd20"
[0m15:31:21.702208 [debug] [Thread-8 (]: Writing injected SQL for node "model.coffee_shop.my_second_dbt_model"
[0m15:31:21.706624 [debug] [Thread-3 (]: Writing injected SQL for node "test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710"
[0m15:31:21.706911 [debug] [Thread-4 (]: Timing info for model.coffee_shop.customers_ref (compile): 2023-02-17 15:31:21.667341 => 2023-02-17 15:31:21.706842
[0m15:31:21.713275 [debug] [Thread-4 (]: Began executing node model.coffee_shop.customers_ref
[0m15:31:21.713621 [debug] [Thread-4 (]: Timing info for model.coffee_shop.customers_ref (execute): 2023-02-17 15:31:21.713547 => 2023-02-17 15:31:21.713565
[0m15:31:21.712224 [debug] [Thread-6 (]: Timing info for test.coffee_shop.unique_customers_id.70f3d3fd20 (compile): 2023-02-17 15:31:21.692543 => 2023-02-17 15:31:21.712059
[0m15:31:21.715014 [debug] [Thread-6 (]: Began executing node test.coffee_shop.unique_customers_id.70f3d3fd20
[0m15:31:21.714658 [debug] [Thread-4 (]: Finished running node model.coffee_shop.customers_ref
[0m15:31:21.711127 [debug] [Thread-1 (]: Writing injected SQL for node "test.coffee_shop.unique_my_first_dbt_model_id.16e066b321"
[0m15:31:21.711459 [debug] [Thread-5 (]: Timing info for test.coffee_shop.not_null_customers_id.422908bfae (compile): 2023-02-17 15:31:21.670611 => 2023-02-17 15:31:21.711351
[0m15:31:21.717324 [debug] [Thread-5 (]: Began executing node test.coffee_shop.not_null_customers_id.422908bfae
[0m15:31:21.717653 [debug] [Thread-5 (]: Timing info for test.coffee_shop.not_null_customers_id.422908bfae (execute): 2023-02-17 15:31:21.717576 => 2023-02-17 15:31:21.717590
[0m15:31:21.718597 [debug] [Thread-5 (]: Finished running node test.coffee_shop.not_null_customers_id.422908bfae
[0m15:31:21.716163 [debug] [Thread-2 (]: Began running node test.coffee_shop.not_null_customers_ref_email.337290571c
[0m15:31:21.719320 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.coffee_shop.not_null_customers_ref_email.337290571c'
[0m15:31:21.719630 [debug] [Thread-2 (]: Began compiling node test.coffee_shop.not_null_customers_ref_email.337290571c
[0m15:31:21.716450 [debug] [Thread-7 (]: Began running node test.coffee_shop.not_null_customers_ref_id.1480a96cf3
[0m15:31:21.724594 [debug] [Thread-7 (]: Acquiring new bigquery connection 'test.coffee_shop.not_null_customers_ref_id.1480a96cf3'
[0m15:31:21.724919 [debug] [Thread-7 (]: Began compiling node test.coffee_shop.not_null_customers_ref_id.1480a96cf3
[0m15:31:21.715281 [debug] [Thread-3 (]: Timing info for test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710 (compile): 2023-02-17 15:31:21.702661 => 2023-02-17 15:31:21.715231
[0m15:31:21.716738 [debug] [Thread-4 (]: Began running node test.coffee_shop.unique_customers_ref_id.48ce3bbab4
[0m15:31:21.712691 [debug] [Thread-8 (]: Timing info for model.coffee_shop.my_second_dbt_model (compile): 2023-02-17 15:31:21.699690 => 2023-02-17 15:31:21.712621
[0m15:31:21.730436 [debug] [Thread-8 (]: Began executing node model.coffee_shop.my_second_dbt_model
[0m15:31:21.730673 [debug] [Thread-8 (]: Timing info for model.coffee_shop.my_second_dbt_model (execute): 2023-02-17 15:31:21.730610 => 2023-02-17 15:31:21.730623
[0m15:31:21.729051 [debug] [Thread-7 (]: Writing injected SQL for node "test.coffee_shop.not_null_customers_ref_id.1480a96cf3"
[0m15:31:21.731786 [debug] [Thread-7 (]: Timing info for test.coffee_shop.not_null_customers_ref_id.1480a96cf3 (compile): 2023-02-17 15:31:21.725110 => 2023-02-17 15:31:21.731718
[0m15:31:21.729538 [debug] [Thread-3 (]: Began executing node test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:31:21.730134 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_customers_ref_id.48ce3bbab4'
[0m15:31:21.731274 [debug] [Thread-8 (]: Finished running node model.coffee_shop.my_second_dbt_model
[0m15:31:21.723867 [debug] [Thread-2 (]: Writing injected SQL for node "test.coffee_shop.not_null_customers_ref_email.337290571c"
[0m15:31:21.733703 [debug] [Thread-2 (]: Timing info for test.coffee_shop.not_null_customers_ref_email.337290571c (compile): 2023-02-17 15:31:21.719800 => 2023-02-17 15:31:21.733633
[0m15:31:21.734138 [debug] [Thread-2 (]: Began executing node test.coffee_shop.not_null_customers_ref_email.337290571c
[0m15:31:21.734510 [debug] [Thread-2 (]: Timing info for test.coffee_shop.not_null_customers_ref_email.337290571c (execute): 2023-02-17 15:31:21.734451 => 2023-02-17 15:31:21.734462
[0m15:31:21.732411 [debug] [Thread-3 (]: Timing info for test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710 (execute): 2023-02-17 15:31:21.732358 => 2023-02-17 15:31:21.732367
[0m15:31:21.737352 [debug] [Thread-3 (]: Finished running node test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:31:21.717932 [debug] [Thread-1 (]: Timing info for test.coffee_shop.unique_my_first_dbt_model_id.16e066b321 (compile): 2023-02-17 15:31:21.707444 => 2023-02-17 15:31:21.717884
[0m15:31:21.738059 [debug] [Thread-1 (]: Began executing node test.coffee_shop.unique_my_first_dbt_model_id.16e066b321
[0m15:31:21.738471 [debug] [Thread-1 (]: Timing info for test.coffee_shop.unique_my_first_dbt_model_id.16e066b321 (execute): 2023-02-17 15:31:21.738398 => 2023-02-17 15:31:21.738410
[0m15:31:21.739484 [debug] [Thread-1 (]: Finished running node test.coffee_shop.unique_my_first_dbt_model_id.16e066b321
[0m15:31:21.736238 [debug] [Thread-5 (]: Began running node test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778
[0m15:31:21.736521 [debug] [Thread-8 (]: Began running node test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493
[0m15:31:21.745950 [debug] [Thread-8 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493'
[0m15:31:21.715545 [debug] [Thread-6 (]: Timing info for test.coffee_shop.unique_customers_id.70f3d3fd20 (execute): 2023-02-17 15:31:21.715481 => 2023-02-17 15:31:21.715492
[0m15:31:21.732688 [debug] [Thread-4 (]: Began compiling node test.coffee_shop.unique_customers_ref_id.48ce3bbab4
[0m15:31:21.755270 [debug] [Thread-4 (]: Writing injected SQL for node "test.coffee_shop.unique_customers_ref_id.48ce3bbab4"
[0m15:31:21.746589 [debug] [Thread-8 (]: Began compiling node test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493
[0m15:31:21.747575 [debug] [Thread-6 (]: Finished running node test.coffee_shop.unique_customers_id.70f3d3fd20
[0m15:31:21.732093 [debug] [Thread-7 (]: Began executing node test.coffee_shop.not_null_customers_ref_id.1480a96cf3
[0m15:31:21.762204 [debug] [Thread-7 (]: Timing info for test.coffee_shop.not_null_customers_ref_id.1480a96cf3 (execute): 2023-02-17 15:31:21.761974 => 2023-02-17 15:31:21.762123
[0m15:31:21.763101 [debug] [Thread-7 (]: Finished running node test.coffee_shop.not_null_customers_ref_id.1480a96cf3
[0m15:31:21.735760 [debug] [Thread-2 (]: Finished running node test.coffee_shop.not_null_customers_ref_email.337290571c
[0m15:31:21.744259 [debug] [Thread-5 (]: Acquiring new bigquery connection 'test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778'
[0m15:31:21.762436 [debug] [Thread-4 (]: Timing info for test.coffee_shop.unique_customers_ref_id.48ce3bbab4 (compile): 2023-02-17 15:31:21.749064 => 2023-02-17 15:31:21.762388
[0m15:31:21.763778 [debug] [Thread-5 (]: Began compiling node test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778
[0m15:31:21.761331 [debug] [Thread-8 (]: Writing injected SQL for node "test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493"
[0m15:31:21.769867 [debug] [Thread-8 (]: Timing info for test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493 (compile): 2023-02-17 15:31:21.755878 => 2023-02-17 15:31:21.769781
[0m15:31:21.769296 [debug] [Thread-5 (]: Writing injected SQL for node "test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778"
[0m15:31:21.770211 [debug] [Thread-8 (]: Began executing node test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493
[0m15:31:21.764084 [debug] [Thread-4 (]: Began executing node test.coffee_shop.unique_customers_ref_id.48ce3bbab4
[0m15:31:21.771075 [debug] [Thread-4 (]: Timing info for test.coffee_shop.unique_customers_ref_id.48ce3bbab4 (execute): 2023-02-17 15:31:21.771010 => 2023-02-17 15:31:21.771020
[0m15:31:21.772028 [debug] [Thread-4 (]: Finished running node test.coffee_shop.unique_customers_ref_id.48ce3bbab4
[0m15:31:21.770771 [debug] [Thread-8 (]: Timing info for test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493 (execute): 2023-02-17 15:31:21.770702 => 2023-02-17 15:31:21.770718
[0m15:31:21.772885 [debug] [Thread-8 (]: Finished running node test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493
[0m15:31:21.771338 [debug] [Thread-5 (]: Timing info for test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778 (compile): 2023-02-17 15:31:21.764336 => 2023-02-17 15:31:21.771293
[0m15:31:21.773364 [debug] [Thread-5 (]: Began executing node test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778
[0m15:31:21.773604 [debug] [Thread-5 (]: Timing info for test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778 (execute): 2023-02-17 15:31:21.773539 => 2023-02-17 15:31:21.773549
[0m15:31:21.774235 [debug] [Thread-5 (]: Finished running node test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778
[0m15:31:21.775600 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:31:21.775852 [debug] [MainThread]: Connection 'test.coffee_shop.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m15:31:21.776030 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_customers_ref_email.337290571c' was properly closed.
[0m15:31:21.776188 [debug] [MainThread]: Connection 'test.coffee_shop.unique_customers_ref_id.48ce3bbab4' was properly closed.
[0m15:31:21.776339 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
[0m15:31:21.776488 [debug] [MainThread]: Connection 'test.coffee_shop.unique_customers_id.70f3d3fd20' was properly closed.
[0m15:31:21.776636 [debug] [MainThread]: Connection 'test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m15:31:21.776799 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m15:31:21.776950 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_customers_ref_id.1480a96cf3' was properly closed.
[0m15:31:21.777590 [debug] [MainThread]: Command end result
[0m15:31:21.785106 [info ] [MainThread]: Done.
[0m15:31:21.793632 [debug] [MainThread]: Acquiring new bigquery connection 'generate_catalog'
[0m15:31:21.794000 [info ] [MainThread]: Building catalog
[0m15:31:21.795238 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:31:22.094305 [debug] [ThreadPool]: Acquiring new bigquery connection 'aec-students.information_schema'
[0m15:31:22.109791 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:31:22.110673 [debug] [ThreadPool]: On aec-students.information_schema: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "connection_name": "aec-students.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `aec-students`.`dbt_milan`.__TABLES__
        where (upper(dataset_id) = upper('dbt_milan'))
    ),

    table_options as (
        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            JSON_VALUE(option_value) as table_comment

        from `aec-students`.`dbt_milan`.INFORMATION_SCHEMA.TABLE_OPTIONS
        where option_name = 'description'
    ),
    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `aec-students`.`dbt_milan`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `aec-students`.`dbt_milan`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,
        table_options.table_comment,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join table_options using (relation_id)
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
[0m15:31:24.819495 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:baf83c73-3180-4ae8-8ffd-54ac4fb4aa30&page=queryresults
[0m15:31:24.837191 [info ] [MainThread]: Catalog written to /workspaces/ae-club-milan/coffe_shop_milan/target/catalog.json
[0m15:31:24.838127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f490d97b3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f490d97ad10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f490d9663b0>]}
[0m15:31:24.838638 [debug] [MainThread]: Flushing usage events
[0m15:31:25.238414 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m15:31:25.239173 [debug] [MainThread]: Connection 'aec-students.information_schema' was properly closed.


============================== 2023-02-17 15:31:32.581557 | 38e1f2c1-9110-4b66-8f4c-6f64a5966b21 ==============================
[0m15:31:32.581557 [info ] [MainThread]: Running with dbt=1.4.1
[0m15:31:32.584675 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
[0m15:31:32.585192 [debug] [MainThread]: Tracking: tracking
[0m15:31:32.590389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f175eee8dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f175b55aa70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f175b55b730>]}
[0m15:31:32.595860 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
[0m15:31:32.596396 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
[0m15:31:32.596919 [info ] [MainThread]: 
[0m15:31:32.597488 [info ] [MainThread]: 
[0m15:31:32.597981 [info ] [MainThread]: Press Ctrl+C to exit.
[0m15:41:21.787631 [debug] [MainThread]: Flushing usage events
[0m15:41:22.238098 [info ] [MainThread]: ctrl-c


============================== 2023-02-17 15:41:31.103456 | ef1230f4-8436-4380-b618-32f53c6413cc ==============================
[0m15:41:31.103456 [info ] [MainThread]: Running with dbt=1.4.1
[0m15:41:31.107847 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
[0m15:41:31.108336 [debug] [MainThread]: Tracking: tracking
[0m15:41:31.110236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ce1c6b700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ce1c69a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ce1c6b730>]}
[0m15:41:31.169982 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m15:41:31.170676 [debug] [MainThread]: Partial parsing: updated file: coffee_shop://models/schema.yml
[0m15:41:31.171147 [debug] [MainThread]: Partial parsing: updated file: coffee_shop://models/customers_ref.sql
[0m15:41:31.184824 [debug] [MainThread]: 1699: static parser successfully parsed customers_ref.sql
[0m15:41:31.304221 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffe_shop_milan.example
[0m15:41:31.310316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ef1230f4-8436-4380-b618-32f53c6413cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ce1c1ec80>]}
[0m15:41:31.319171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ef1230f4-8436-4380-b618-32f53c6413cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ce1c0be50>]}
[0m15:41:31.319713 [info ] [MainThread]: Found 4 models, 12 tests, 0 snapshots, 0 analyses, 334 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m15:41:31.320180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef1230f4-8436-4380-b618-32f53c6413cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ce1bfbf40>]}
[0m15:41:31.322247 [info ] [MainThread]: 
[0m15:41:31.324509 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:41:31.325886 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_milan'
[0m15:41:31.326340 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:41:32.492441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef1230f4-8436-4380-b618-32f53c6413cc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ce1c0b880>]}
[0m15:41:32.493297 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m15:41:32.493929 [info ] [MainThread]: 
[0m15:41:32.499485 [debug] [Thread-1 (]: Began running node model.coffee_shop.customers
[0m15:41:32.499854 [debug] [Thread-2 (]: Began running node model.coffee_shop.customers_ref
[0m15:41:32.501972 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.coffee_shop.customers_ref'
[0m15:41:32.502244 [debug] [Thread-2 (]: Began compiling node model.coffee_shop.customers_ref
[0m15:41:32.500507 [debug] [Thread-5 (]: Began running node test.coffee_shop.source_unique_coffee_shop_customers_.40a2aff259
[0m15:41:32.500716 [debug] [Thread-6 (]: Began running node test.coffee_shop.source_unique_coffee_shop_customers_id.33a28346d5
[0m15:41:32.501362 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop.customers'
[0m15:41:32.509736 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.customers
[0m15:41:32.500305 [debug] [Thread-4 (]: Began running node test.coffee_shop.source_not_null_coffee_shop_customers_id.d265e0f7a0
[0m15:41:32.513455 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.coffee_shop.source_not_null_coffee_shop_customers_id.d265e0f7a0'
[0m15:41:32.508502 [debug] [Thread-5 (]: Acquiring new bigquery connection 'test.coffee_shop.source_unique_coffee_shop_customers_.40a2aff259'
[0m15:41:32.507326 [debug] [Thread-2 (]: Writing injected SQL for node "model.coffee_shop.customers_ref"
[0m15:41:32.514585 [debug] [Thread-2 (]: Timing info for model.coffee_shop.customers_ref (compile): 2023-02-17 15:41:32.502529 => 2023-02-17 15:41:32.514500
[0m15:41:32.512668 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.customers"
[0m15:41:32.513764 [debug] [Thread-4 (]: Began compiling node test.coffee_shop.source_not_null_coffee_shop_customers_id.d265e0f7a0
[0m15:41:32.514074 [debug] [Thread-5 (]: Began compiling node test.coffee_shop.source_unique_coffee_shop_customers_.40a2aff259
[0m15:41:32.509327 [debug] [Thread-6 (]: Acquiring new bigquery connection 'test.coffee_shop.source_unique_coffee_shop_customers_id.33a28346d5'
[0m15:41:32.535304 [debug] [Thread-6 (]: Began compiling node test.coffee_shop.source_unique_coffee_shop_customers_id.33a28346d5
[0m15:41:32.500093 [debug] [Thread-3 (]: Began running node model.coffee_shop.my_first_dbt_model
[0m15:41:32.551274 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.coffee_shop.my_first_dbt_model'
[0m15:41:32.551849 [debug] [Thread-3 (]: Began compiling node model.coffee_shop.my_first_dbt_model
[0m15:41:32.536118 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (compile): 2023-02-17 15:41:32.509923 => 2023-02-17 15:41:32.536018
[0m15:41:32.557486 [debug] [Thread-1 (]: Began executing node model.coffee_shop.customers
[0m15:41:32.557978 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (execute): 2023-02-17 15:41:32.557873 => 2023-02-17 15:41:32.557897
[0m15:41:32.514892 [debug] [Thread-2 (]: Began executing node model.coffee_shop.customers_ref
[0m15:41:32.560621 [debug] [Thread-1 (]: Finished running node model.coffee_shop.customers
[0m15:41:32.556223 [debug] [Thread-3 (]: Writing injected SQL for node "model.coffee_shop.my_first_dbt_model"
[0m15:41:32.556995 [debug] [Thread-6 (]: Writing injected SQL for node "test.coffee_shop.source_unique_coffee_shop_customers_id.33a28346d5"
[0m15:41:32.550230 [debug] [Thread-5 (]: Writing injected SQL for node "test.coffee_shop.source_unique_coffee_shop_customers_.40a2aff259"
[0m15:41:32.561093 [debug] [Thread-2 (]: Timing info for model.coffee_shop.customers_ref (execute): 2023-02-17 15:41:32.561002 => 2023-02-17 15:41:32.561016
[0m15:41:32.567236 [debug] [Thread-2 (]: Finished running node model.coffee_shop.customers_ref
[0m15:41:32.565515 [debug] [Thread-8 (]: Began running node test.coffee_shop.not_null_customers_id.422908bfae
[0m15:41:32.565940 [debug] [Thread-7 (]: Began running node test.coffee_shop.unique_customers_id.70f3d3fd20
[0m15:41:32.570361 [debug] [Thread-7 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_customers_id.70f3d3fd20'
[0m15:41:32.571099 [debug] [Thread-7 (]: Began compiling node test.coffee_shop.unique_customers_id.70f3d3fd20
[0m15:41:32.569413 [debug] [Thread-1 (]: Began running node test.coffee_shop.not_null_customers_ref_email.337290571c
[0m15:41:32.580142 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.coffee_shop.not_null_customers_ref_email.337290571c'
[0m15:41:32.581456 [debug] [Thread-1 (]: Began compiling node test.coffee_shop.not_null_customers_ref_email.337290571c
[0m15:41:32.564485 [debug] [Thread-4 (]: Writing injected SQL for node "test.coffee_shop.source_not_null_coffee_shop_customers_id.d265e0f7a0"
[0m15:41:32.570815 [debug] [Thread-2 (]: Began running node test.coffee_shop.not_null_customers_ref_id.1480a96cf3
[0m15:41:32.589365 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.coffee_shop.not_null_customers_ref_id.1480a96cf3'
[0m15:41:32.590354 [debug] [Thread-2 (]: Began compiling node test.coffee_shop.not_null_customers_ref_id.1480a96cf3
[0m15:41:32.568942 [debug] [Thread-8 (]: Acquiring new bigquery connection 'test.coffee_shop.not_null_customers_id.422908bfae'
[0m15:41:32.597169 [debug] [Thread-8 (]: Began compiling node test.coffee_shop.not_null_customers_id.422908bfae
[0m15:41:32.581776 [debug] [Thread-3 (]: Timing info for model.coffee_shop.my_first_dbt_model (compile): 2023-02-17 15:41:32.552208 => 2023-02-17 15:41:32.581717
[0m15:41:32.580757 [debug] [Thread-6 (]: Timing info for test.coffee_shop.source_unique_coffee_shop_customers_id.33a28346d5 (compile): 2023-02-17 15:41:32.536396 => 2023-02-17 15:41:32.580667
[0m15:41:32.605363 [debug] [Thread-6 (]: Began executing node test.coffee_shop.source_unique_coffee_shop_customers_id.33a28346d5
[0m15:41:32.589993 [debug] [Thread-4 (]: Timing info for test.coffee_shop.source_not_null_coffee_shop_customers_id.d265e0f7a0 (compile): 2023-02-17 15:41:32.515209 => 2023-02-17 15:41:32.589851
[0m15:41:32.579162 [debug] [Thread-7 (]: Writing injected SQL for node "test.coffee_shop.unique_customers_id.70f3d3fd20"
[0m15:41:32.606349 [debug] [Thread-7 (]: Timing info for test.coffee_shop.unique_customers_id.70f3d3fd20 (compile): 2023-02-17 15:41:32.571372 => 2023-02-17 15:41:32.606276
[0m15:41:32.606697 [debug] [Thread-7 (]: Began executing node test.coffee_shop.unique_customers_id.70f3d3fd20
[0m15:41:32.606960 [debug] [Thread-7 (]: Timing info for test.coffee_shop.unique_customers_id.70f3d3fd20 (execute): 2023-02-17 15:41:32.606876 => 2023-02-17 15:41:32.606904
[0m15:41:32.605037 [debug] [Thread-3 (]: Began executing node model.coffee_shop.my_first_dbt_model
[0m15:41:32.607911 [debug] [Thread-3 (]: Timing info for model.coffee_shop.my_first_dbt_model (execute): 2023-02-17 15:41:32.607860 => 2023-02-17 15:41:32.607869
[0m15:41:32.605620 [debug] [Thread-6 (]: Timing info for test.coffee_shop.source_unique_coffee_shop_customers_id.33a28346d5 (execute): 2023-02-17 15:41:32.605539 => 2023-02-17 15:41:32.605555
[0m15:41:32.605887 [debug] [Thread-4 (]: Began executing node test.coffee_shop.source_not_null_coffee_shop_customers_id.d265e0f7a0
[0m15:41:32.609409 [debug] [Thread-4 (]: Timing info for test.coffee_shop.source_not_null_coffee_shop_customers_id.d265e0f7a0 (execute): 2023-02-17 15:41:32.609360 => 2023-02-17 15:41:32.609369
[0m15:41:32.609957 [debug] [Thread-4 (]: Finished running node test.coffee_shop.source_not_null_coffee_shop_customers_id.d265e0f7a0
[0m15:41:32.607640 [debug] [Thread-7 (]: Finished running node test.coffee_shop.unique_customers_id.70f3d3fd20
[0m15:41:32.604676 [debug] [Thread-8 (]: Writing injected SQL for node "test.coffee_shop.not_null_customers_id.422908bfae"
[0m15:41:32.608494 [debug] [Thread-3 (]: Finished running node model.coffee_shop.my_first_dbt_model
[0m15:41:32.581128 [debug] [Thread-5 (]: Timing info for test.coffee_shop.source_unique_coffee_shop_customers_.40a2aff259 (compile): 2023-02-17 15:41:32.524114 => 2023-02-17 15:41:32.581060
[0m15:41:32.611212 [debug] [Thread-5 (]: Began executing node test.coffee_shop.source_unique_coffee_shop_customers_.40a2aff259
[0m15:41:32.610274 [debug] [Thread-4 (]: Began running node test.coffee_shop.unique_customers_ref_id.48ce3bbab4
[0m15:41:32.613397 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_customers_ref_id.48ce3bbab4'
[0m15:41:32.603746 [debug] [Thread-2 (]: Writing injected SQL for node "test.coffee_shop.not_null_customers_ref_id.1480a96cf3"
[0m15:41:32.609156 [debug] [Thread-6 (]: Finished running node test.coffee_shop.source_unique_coffee_shop_customers_id.33a28346d5
[0m15:41:32.614604 [debug] [Thread-6 (]: Began running node test.coffee_shop.unique_my_first_dbt_model_id.16e066b321
[0m15:41:32.611825 [debug] [Thread-3 (]: Began running node test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:41:32.612401 [debug] [Thread-8 (]: Timing info for test.coffee_shop.not_null_customers_id.422908bfae (compile): 2023-02-17 15:41:32.597497 => 2023-02-17 15:41:32.612317
[0m15:41:32.612706 [debug] [Thread-5 (]: Timing info for test.coffee_shop.source_unique_coffee_shop_customers_.40a2aff259 (execute): 2023-02-17 15:41:32.612654 => 2023-02-17 15:41:32.612664
[0m15:41:32.613685 [debug] [Thread-4 (]: Began compiling node test.coffee_shop.unique_customers_ref_id.48ce3bbab4
[0m15:41:32.621508 [debug] [Thread-4 (]: Writing injected SQL for node "test.coffee_shop.unique_customers_ref_id.48ce3bbab4"
[0m15:41:32.611565 [debug] [Thread-7 (]: Began running node model.coffee_shop.my_second_dbt_model
[0m15:41:32.615289 [debug] [Thread-6 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_my_first_dbt_model_id.16e066b321'
[0m15:41:32.622673 [debug] [Thread-6 (]: Began compiling node test.coffee_shop.unique_my_first_dbt_model_id.16e066b321
[0m15:41:32.615847 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710'
[0m15:41:32.616973 [debug] [Thread-5 (]: Finished running node test.coffee_shop.source_unique_coffee_shop_customers_.40a2aff259
[0m15:41:32.617184 [debug] [Thread-2 (]: Timing info for test.coffee_shop.not_null_customers_ref_id.1480a96cf3 (compile): 2023-02-17 15:41:32.590712 => 2023-02-17 15:41:32.617144
[0m15:41:32.596598 [debug] [Thread-1 (]: Writing injected SQL for node "test.coffee_shop.not_null_customers_ref_email.337290571c"
[0m15:41:32.628602 [debug] [Thread-1 (]: Timing info for test.coffee_shop.not_null_customers_ref_email.337290571c (compile): 2023-02-17 15:41:32.581935 => 2023-02-17 15:41:32.628532
[0m15:41:32.628899 [debug] [Thread-1 (]: Began executing node test.coffee_shop.not_null_customers_ref_email.337290571c
[0m15:41:32.629133 [debug] [Thread-1 (]: Timing info for test.coffee_shop.not_null_customers_ref_email.337290571c (execute): 2023-02-17 15:41:32.629067 => 2023-02-17 15:41:32.629081
[0m15:41:32.629766 [debug] [Thread-1 (]: Finished running node test.coffee_shop.not_null_customers_ref_email.337290571c
[0m15:41:32.627202 [debug] [Thread-3 (]: Began compiling node test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:41:32.628158 [debug] [Thread-2 (]: Began executing node test.coffee_shop.not_null_customers_ref_id.1480a96cf3
[0m15:41:32.636577 [debug] [Thread-2 (]: Timing info for test.coffee_shop.not_null_customers_ref_id.1480a96cf3 (execute): 2023-02-17 15:41:32.636486 => 2023-02-17 15:41:32.636503
[0m15:41:32.637567 [debug] [Thread-2 (]: Finished running node test.coffee_shop.not_null_customers_ref_id.1480a96cf3
[0m15:41:32.636005 [debug] [Thread-3 (]: Writing injected SQL for node "test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710"
[0m15:41:32.616183 [debug] [Thread-8 (]: Began executing node test.coffee_shop.not_null_customers_id.422908bfae
[0m15:41:32.639791 [debug] [Thread-8 (]: Timing info for test.coffee_shop.not_null_customers_id.422908bfae (execute): 2023-02-17 15:41:32.639687 => 2023-02-17 15:41:32.639703
[0m15:41:32.627620 [debug] [Thread-4 (]: Timing info for test.coffee_shop.unique_customers_ref_id.48ce3bbab4 (compile): 2023-02-17 15:41:32.617369 => 2023-02-17 15:41:32.627558
[0m15:41:32.641710 [debug] [Thread-4 (]: Began executing node test.coffee_shop.unique_customers_ref_id.48ce3bbab4
[0m15:41:32.642138 [debug] [Thread-4 (]: Timing info for test.coffee_shop.unique_customers_ref_id.48ce3bbab4 (execute): 2023-02-17 15:41:32.642066 => 2023-02-17 15:41:32.642078
[0m15:41:32.643026 [debug] [Thread-4 (]: Finished running node test.coffee_shop.unique_customers_ref_id.48ce3bbab4
[0m15:41:32.643576 [debug] [Thread-3 (]: Timing info for test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710 (compile): 2023-02-17 15:41:32.630160 => 2023-02-17 15:41:32.643509
[0m15:41:32.644211 [debug] [Thread-3 (]: Began executing node test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:41:32.644650 [debug] [Thread-3 (]: Timing info for test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710 (execute): 2023-02-17 15:41:32.644571 => 2023-02-17 15:41:32.644584
[0m15:41:32.645719 [debug] [Thread-3 (]: Finished running node test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:41:32.641164 [debug] [Thread-8 (]: Finished running node test.coffee_shop.not_null_customers_id.422908bfae
[0m15:41:32.626744 [debug] [Thread-6 (]: Writing injected SQL for node "test.coffee_shop.unique_my_first_dbt_model_id.16e066b321"
[0m15:41:32.622302 [debug] [Thread-7 (]: Acquiring new bigquery connection 'model.coffee_shop.my_second_dbt_model'
[0m15:41:32.647990 [debug] [Thread-7 (]: Began compiling node model.coffee_shop.my_second_dbt_model
[0m15:41:32.648291 [debug] [Thread-6 (]: Timing info for test.coffee_shop.unique_my_first_dbt_model_id.16e066b321 (compile): 2023-02-17 15:41:32.622937 => 2023-02-17 15:41:32.648218
[0m15:41:32.655551 [debug] [Thread-7 (]: Writing injected SQL for node "model.coffee_shop.my_second_dbt_model"
[0m15:41:32.656000 [debug] [Thread-6 (]: Began executing node test.coffee_shop.unique_my_first_dbt_model_id.16e066b321
[0m15:41:32.656504 [debug] [Thread-6 (]: Timing info for test.coffee_shop.unique_my_first_dbt_model_id.16e066b321 (execute): 2023-02-17 15:41:32.656394 => 2023-02-17 15:41:32.656410
[0m15:41:32.657253 [debug] [Thread-6 (]: Finished running node test.coffee_shop.unique_my_first_dbt_model_id.16e066b321
[0m15:41:32.657742 [debug] [Thread-7 (]: Timing info for model.coffee_shop.my_second_dbt_model (compile): 2023-02-17 15:41:32.651680 => 2023-02-17 15:41:32.657685
[0m15:41:32.658066 [debug] [Thread-7 (]: Began executing node model.coffee_shop.my_second_dbt_model
[0m15:41:32.658345 [debug] [Thread-7 (]: Timing info for model.coffee_shop.my_second_dbt_model (execute): 2023-02-17 15:41:32.658295 => 2023-02-17 15:41:32.658304
[0m15:41:32.659021 [debug] [Thread-7 (]: Finished running node model.coffee_shop.my_second_dbt_model
[0m15:41:32.659784 [debug] [Thread-5 (]: Began running node test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778
[0m15:41:32.660776 [debug] [Thread-5 (]: Acquiring new bigquery connection 'test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778'
[0m15:41:32.661096 [debug] [Thread-5 (]: Began compiling node test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778
[0m15:41:32.667492 [debug] [Thread-5 (]: Writing injected SQL for node "test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778"
[0m15:41:32.668566 [debug] [Thread-5 (]: Timing info for test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778 (compile): 2023-02-17 15:41:32.661289 => 2023-02-17 15:41:32.668489
[0m15:41:32.668883 [debug] [Thread-5 (]: Began executing node test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778
[0m15:41:32.669119 [debug] [Thread-5 (]: Timing info for test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778 (execute): 2023-02-17 15:41:32.669053 => 2023-02-17 15:41:32.669068
[0m15:41:32.669766 [debug] [Thread-5 (]: Finished running node test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778
[0m15:41:32.667872 [debug] [Thread-1 (]: Began running node test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493
[0m15:41:32.670527 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493'
[0m15:41:32.670862 [debug] [Thread-1 (]: Began compiling node test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493
[0m15:41:32.674903 [debug] [Thread-1 (]: Writing injected SQL for node "test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493"
[0m15:41:32.675571 [debug] [Thread-1 (]: Timing info for test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493 (compile): 2023-02-17 15:41:32.671113 => 2023-02-17 15:41:32.675484
[0m15:41:32.675949 [debug] [Thread-1 (]: Began executing node test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493
[0m15:41:32.676245 [debug] [Thread-1 (]: Timing info for test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493 (execute): 2023-02-17 15:41:32.676190 => 2023-02-17 15:41:32.676201
[0m15:41:32.676904 [debug] [Thread-1 (]: Finished running node test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493
[0m15:41:32.678324 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:41:32.678583 [debug] [MainThread]: Connection 'test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m15:41:32.678793 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_customers_ref_id.1480a96cf3' was properly closed.
[0m15:41:32.678980 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
[0m15:41:32.679158 [debug] [MainThread]: Connection 'test.coffee_shop.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m15:41:32.679333 [debug] [MainThread]: Connection 'test.coffee_shop.unique_customers_ref_id.48ce3bbab4' was properly closed.
[0m15:41:32.679542 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m15:41:32.679722 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_customers_id.422908bfae' was properly closed.
[0m15:41:32.679896 [debug] [MainThread]: Connection 'model.coffee_shop.my_second_dbt_model' was properly closed.
[0m15:41:32.680638 [debug] [MainThread]: Command end result
[0m15:41:32.687787 [info ] [MainThread]: Done.
[0m15:41:32.694962 [debug] [MainThread]: Acquiring new bigquery connection 'generate_catalog'
[0m15:41:32.695352 [info ] [MainThread]: Building catalog
[0m15:41:32.697436 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:41:33.273892 [debug] [ThreadPool]: Acquiring new bigquery connection 'aec-students.information_schema'
[0m15:41:33.274630 [debug] [ThreadPool]: Acquiring new bigquery connection 'analytics-engineers-club.information_schema'
[0m15:41:33.290413 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:41:33.292804 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:41:33.293608 [debug] [ThreadPool]: On aec-students.information_schema: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "connection_name": "aec-students.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `aec-students`.`dbt_milan`.__TABLES__
        where (upper(dataset_id) = upper('dbt_milan'))
    ),

    table_options as (
        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            JSON_VALUE(option_value) as table_comment

        from `aec-students`.`dbt_milan`.INFORMATION_SCHEMA.TABLE_OPTIONS
        where option_name = 'description'
    ),
    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `aec-students`.`dbt_milan`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `aec-students`.`dbt_milan`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,
        table_options.table_comment,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join table_options using (relation_id)
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
[0m15:41:33.294019 [debug] [ThreadPool]: On analytics-engineers-club.information_schema: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "connection_name": "analytics-engineers-club.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `analytics-engineers-club`.`coffee_shop`.__TABLES__
        where (upper(dataset_id) = upper('coffee_shop'))
    ),

    table_options as (
        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            JSON_VALUE(option_value) as table_comment

        from `analytics-engineers-club`.`coffee_shop`.INFORMATION_SCHEMA.TABLE_OPTIONS
        where option_name = 'description'
    ),
    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `analytics-engineers-club`.`coffee_shop`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `analytics-engineers-club`.`coffee_shop`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,
        table_options.table_comment,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join table_options using (relation_id)
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
[0m15:41:35.852950 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:6ace5d8c-b3ff-4520-9e8e-3d07029dd2f7&page=queryresults
[0m15:41:35.860456 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:8a8934a4-2170-4cfb-80e1-523a043af78d&page=queryresults
[0m15:41:35.881707 [info ] [MainThread]: Catalog written to /workspaces/ae-club-milan/coffe_shop_milan/target/catalog.json
[0m15:41:35.882543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ce642a260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ce1c6acb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ce1c69810>]}
[0m15:41:35.883276 [debug] [MainThread]: Flushing usage events
[0m15:41:36.260755 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m15:41:36.261321 [debug] [MainThread]: Connection 'aec-students.information_schema' was properly closed.
[0m15:41:36.261531 [debug] [MainThread]: Connection 'analytics-engineers-club.information_schema' was properly closed.


============================== 2023-02-17 15:42:03.881210 | 539c0562-13a1-4391-8cb8-e4dbc83b3045 ==============================
[0m15:42:03.881210 [info ] [MainThread]: Running with dbt=1.4.1
[0m15:42:03.884085 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m15:42:03.884626 [debug] [MainThread]: Tracking: tracking
[0m15:42:03.888503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc69f9510f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc69f950430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc69f950a90>]}
[0m15:42:03.940290 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:42:03.940920 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:42:03.941946 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffe_shop_milan.example
[0m15:42:03.951283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '539c0562-13a1-4391-8cb8-e4dbc83b3045', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc69f943ee0>]}
[0m15:42:03.961997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '539c0562-13a1-4391-8cb8-e4dbc83b3045', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc69f906fe0>]}
[0m15:42:03.962690 [info ] [MainThread]: Found 4 models, 12 tests, 0 snapshots, 0 analyses, 334 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m15:42:03.963254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '539c0562-13a1-4391-8cb8-e4dbc83b3045', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc69f907040>]}
[0m15:42:03.965062 [info ] [MainThread]: 
[0m15:42:03.967151 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:42:03.968705 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m15:42:03.969214 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:42:05.127612 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_milan'
[0m15:42:05.128105 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:42:05.509226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '539c0562-13a1-4391-8cb8-e4dbc83b3045', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc69f906c20>]}
[0m15:42:05.510008 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m15:42:05.510407 [info ] [MainThread]: 
[0m15:42:05.515588 [debug] [Thread-1 (]: Began running node model.coffee_shop.customers
[0m15:42:05.516042 [debug] [Thread-2 (]: Began running node model.coffee_shop.customers_ref
[0m15:42:05.516367 [debug] [Thread-3 (]: Began running node model.coffee_shop.my_first_dbt_model
[0m15:42:05.516690 [info ] [Thread-1 (]: 1 of 4 START sql table model dbt_milan.customers ............................... [RUN]
[0m15:42:05.517456 [info ] [Thread-2 (]: 2 of 4 START sql view model dbt_milan.customers_ref ............................ [RUN]
[0m15:42:05.518493 [info ] [Thread-3 (]: 3 of 4 START sql table model dbt_milan.my_first_dbt_model ...................... [RUN]
[0m15:42:05.520918 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.coffee_shop.my_first_dbt_model'
[0m15:42:05.520217 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.coffee_shop.customers_ref'
[0m15:42:05.521187 [debug] [Thread-3 (]: Began compiling node model.coffee_shop.my_first_dbt_model
[0m15:42:05.519379 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop.customers'
[0m15:42:05.525088 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.customers
[0m15:42:05.524599 [debug] [Thread-3 (]: Writing injected SQL for node "model.coffee_shop.my_first_dbt_model"
[0m15:42:05.521508 [debug] [Thread-2 (]: Began compiling node model.coffee_shop.customers_ref
[0m15:42:05.527693 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.customers"
[0m15:42:05.531558 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (compile): 2023-02-17 15:42:05.525368 => 2023-02-17 15:42:05.531474
[0m15:42:05.530962 [debug] [Thread-2 (]: Writing injected SQL for node "model.coffee_shop.customers_ref"
[0m15:42:05.531933 [debug] [Thread-1 (]: Began executing node model.coffee_shop.customers
[0m15:42:05.528326 [debug] [Thread-3 (]: Timing info for model.coffee_shop.my_first_dbt_model (compile): 2023-02-17 15:42:05.521721 => 2023-02-17 15:42:05.528234
[0m15:42:05.540944 [debug] [Thread-3 (]: Began executing node model.coffee_shop.my_first_dbt_model
[0m15:42:05.549853 [debug] [Thread-2 (]: Timing info for model.coffee_shop.customers_ref (compile): 2023-02-17 15:42:05.528637 => 2023-02-17 15:42:05.549738
[0m15:42:05.557105 [debug] [Thread-2 (]: Began executing node model.coffee_shop.customers_ref
[0m15:42:05.579303 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:42:05.597774 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:42:05.660199 [debug] [Thread-2 (]: Writing runtime sql for node "model.coffee_shop.customers_ref"
[0m15:42:05.663276 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:42:05.664081 [debug] [Thread-2 (]: On model.coffee_shop.customers_ref: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.customers_ref"} */


  create or replace view `aec-students`.`dbt_milan`.`customers_ref`
  OPTIONS()
  as Select *
from `analytics-engineers-club`.`coffee_shop`.`customers`;


[0m15:42:06.088167 [debug] [Thread-3 (]: Writing runtime sql for node "model.coffee_shop.my_first_dbt_model"
[0m15:42:06.088862 [debug] [Thread-3 (]: On model.coffee_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.my_first_dbt_model"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`my_first_dbt_model`
    
    
    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m15:42:06.110826 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop.customers"
[0m15:42:06.111511 [debug] [Thread-1 (]: On model.coffee_shop.customers: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.customers"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`customers`
    
    
    OPTIONS()
    as (
      

select * from `analytics-engineers-club.coffee_shop.customers`
limit 9000
    );
  
[0m15:42:06.657956 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:c2606840-fc31-41e4-803e-681a78a92ab7&page=queryresults
[0m15:42:06.676049 [debug] [Thread-2 (]: Timing info for model.coffee_shop.customers_ref (execute): 2023-02-17 15:42:05.557447 => 2023-02-17 15:42:06.675983
[0m15:42:06.676896 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '539c0562-13a1-4391-8cb8-e4dbc83b3045', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc69f847dc0>]}
[0m15:42:06.677437 [info ] [Thread-2 (]: 2 of 4 OK created sql view model dbt_milan.customers_ref ....................... [[32mCREATE VIEW (0 processed)[0m in 1.16s]
[0m15:42:06.679429 [debug] [Thread-2 (]: Finished running node model.coffee_shop.customers_ref
[0m15:42:08.308548 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:9697043c-3d5d-48a8-9e93-cd1717b4fac7&page=queryresults
[0m15:42:08.310370 [debug] [Thread-3 (]: Timing info for model.coffee_shop.my_first_dbt_model (execute): 2023-02-17 15:42:05.541298 => 2023-02-17 15:42:08.310280
[0m15:42:08.311066 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '539c0562-13a1-4391-8cb8-e4dbc83b3045', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc69f802aa0>]}
[0m15:42:08.311639 [info ] [Thread-3 (]: 3 of 4 OK created sql table model dbt_milan.my_first_dbt_model ................. [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 2.79s]
[0m15:42:08.312154 [debug] [Thread-3 (]: Finished running node model.coffee_shop.my_first_dbt_model
[0m15:42:08.313027 [debug] [Thread-5 (]: Began running node model.coffee_shop.my_second_dbt_model
[0m15:42:08.313439 [info ] [Thread-5 (]: 4 of 4 START sql view model dbt_milan.my_second_dbt_model ...................... [RUN]
[0m15:42:08.314623 [debug] [Thread-5 (]: Acquiring new bigquery connection 'model.coffee_shop.my_second_dbt_model'
[0m15:42:08.314920 [debug] [Thread-5 (]: Began compiling node model.coffee_shop.my_second_dbt_model
[0m15:42:08.318258 [debug] [Thread-5 (]: Writing injected SQL for node "model.coffee_shop.my_second_dbt_model"
[0m15:42:08.319013 [debug] [Thread-5 (]: Timing info for model.coffee_shop.my_second_dbt_model (compile): 2023-02-17 15:42:08.315099 => 2023-02-17 15:42:08.318907
[0m15:42:08.319485 [debug] [Thread-5 (]: Began executing node model.coffee_shop.my_second_dbt_model
[0m15:42:08.322629 [debug] [Thread-5 (]: Writing runtime sql for node "model.coffee_shop.my_second_dbt_model"
[0m15:42:08.323287 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m15:42:08.323770 [debug] [Thread-5 (]: On model.coffee_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.my_second_dbt_model"} */


  create or replace view `aec-students`.`dbt_milan`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `aec-students`.`dbt_milan`.`my_first_dbt_model`
where id = 1;


[0m15:42:08.686610 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:4ce89272-3cc4-47fa-a106-7dd5fdfcfd7b&page=queryresults
[0m15:42:08.688610 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (execute): 2023-02-17 15:42:05.532356 => 2023-02-17 15:42:08.688546
[0m15:42:08.689387 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '539c0562-13a1-4391-8cb8-e4dbc83b3045', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc69c66d630>]}
[0m15:42:08.689922 [info ] [Thread-1 (]: 1 of 4 OK created sql table model dbt_milan.customers .......................... [[32mCREATE TABLE (9.0k rows, 12.8 MB processed)[0m in 3.17s]
[0m15:42:08.690603 [debug] [Thread-1 (]: Finished running node model.coffee_shop.customers
[0m15:42:09.118497 [debug] [Thread-5 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:ac9707e9-a3a2-4445-9d0b-7db8a785d04c&page=queryresults
[0m15:42:09.121016 [debug] [Thread-5 (]: Timing info for model.coffee_shop.my_second_dbt_model (execute): 2023-02-17 15:42:08.319758 => 2023-02-17 15:42:09.120952
[0m15:42:09.121862 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '539c0562-13a1-4391-8cb8-e4dbc83b3045', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc69f803400>]}
[0m15:42:09.122439 [info ] [Thread-5 (]: 4 of 4 OK created sql view model dbt_milan.my_second_dbt_model ................. [[32mCREATE VIEW (0 processed)[0m in 0.81s]
[0m15:42:09.123006 [debug] [Thread-5 (]: Finished running node model.coffee_shop.my_second_dbt_model
[0m15:42:09.124844 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:42:09.125458 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:42:09.125684 [debug] [MainThread]: Connection 'model.coffee_shop.customers' was properly closed.
[0m15:42:09.125899 [debug] [MainThread]: Connection 'model.coffee_shop.customers_ref' was properly closed.
[0m15:42:09.126091 [debug] [MainThread]: Connection 'model.coffee_shop.my_first_dbt_model' was properly closed.
[0m15:42:09.126283 [debug] [MainThread]: Connection 'model.coffee_shop.my_second_dbt_model' was properly closed.
[0m15:42:09.126569 [info ] [MainThread]: 
[0m15:42:09.126917 [info ] [MainThread]: Finished running 2 view models, 2 table models in 0 hours 0 minutes and 5.16 seconds (5.16s).
[0m15:42:09.129120 [debug] [MainThread]: Command end result
[0m15:42:09.141205 [info ] [MainThread]: 
[0m15:42:09.141800 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:42:09.142256 [info ] [MainThread]: 
[0m15:42:09.142669 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m15:42:09.143633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc69c65d210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc69fd6c790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc69fb37340>]}
[0m15:42:09.144411 [debug] [MainThread]: Flushing usage events


============================== 2023-02-17 15:42:16.952459 | 919fef0d-f852-4d01-8548-c7a0650ae840 ==============================
[0m15:42:16.952459 [info ] [MainThread]: Running with dbt=1.4.1
[0m15:42:16.955114 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m15:42:16.955511 [debug] [MainThread]: Tracking: tracking
[0m15:42:16.957828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3507bf4dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f350426b6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f350426b700>]}
[0m15:42:17.009919 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:42:17.010424 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:42:17.011576 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffe_shop_milan.example
[0m15:42:17.021974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '919fef0d-f852-4d01-8548-c7a0650ae840', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35040580d0>]}
[0m15:42:17.034698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '919fef0d-f852-4d01-8548-c7a0650ae840', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f350421b370>]}
[0m15:42:17.035371 [info ] [MainThread]: Found 4 models, 12 tests, 0 snapshots, 0 analyses, 334 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m15:42:17.035994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '919fef0d-f852-4d01-8548-c7a0650ae840', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3507bf4dc0>]}
[0m15:42:17.038583 [info ] [MainThread]: 
[0m15:42:17.041373 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:42:17.043293 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_milan'
[0m15:42:17.043909 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:42:18.259337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '919fef0d-f852-4d01-8548-c7a0650ae840', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3504218340>]}
[0m15:42:18.260212 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m15:42:18.260930 [info ] [MainThread]: 
[0m15:42:18.265822 [debug] [Thread-1 (]: Began running node test.coffee_shop.not_null_customers_id.422908bfae
[0m15:42:18.266160 [debug] [Thread-2 (]: Began running node test.coffee_shop.not_null_customers_ref_email.337290571c
[0m15:42:18.266503 [debug] [Thread-3 (]: Began running node test.coffee_shop.not_null_customers_ref_id.1480a96cf3
[0m15:42:18.266969 [debug] [Thread-4 (]: Began running node test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:42:18.267337 [debug] [Thread-5 (]: Began running node test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778
[0m15:42:18.267680 [debug] [Thread-6 (]: Began running node test.coffee_shop.source_not_null_coffee_shop_customers_id.d265e0f7a0
[0m15:42:18.267905 [debug] [Thread-7 (]: Began running node test.coffee_shop.source_unique_coffee_shop_customers_.40a2aff259
[0m15:42:18.268102 [debug] [Thread-8 (]: Began running node test.coffee_shop.source_unique_coffee_shop_customers_id.33a28346d5
[0m15:42:18.268521 [info ] [Thread-1 (]: 1 of 12 START test not_null_customers_id ....................................... [RUN]
[0m15:42:18.271996 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.coffee_shop.not_null_customers_id.422908bfae'
[0m15:42:18.268823 [info ] [Thread-2 (]: 2 of 12 START test not_null_customers_ref_email ................................ [RUN]
[0m15:42:18.274473 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.coffee_shop.not_null_customers_ref_email.337290571c'
[0m15:42:18.269773 [info ] [Thread-5 (]: 5 of 12 START test not_null_my_second_dbt_model_id ............................. [RUN]
[0m15:42:18.270754 [info ] [Thread-7 (]: 7 of 12 START test source_unique_coffee_shop_customers_ ........................ [RUN]
[0m15:42:18.271070 [info ] [Thread-8 (]: 8 of 12 START test source_unique_coffee_shop_customers_id ...................... [RUN]
[0m15:42:18.277275 [debug] [Thread-8 (]: Acquiring new bigquery connection 'test.coffee_shop.source_unique_coffee_shop_customers_id.33a28346d5'
[0m15:42:18.277554 [debug] [Thread-8 (]: Began compiling node test.coffee_shop.source_unique_coffee_shop_customers_id.33a28346d5
[0m15:42:18.270286 [info ] [Thread-6 (]: 6 of 12 START test source_not_null_coffee_shop_customers_id .................... [RUN]
[0m15:42:18.289315 [debug] [Thread-6 (]: Acquiring new bigquery connection 'test.coffee_shop.source_not_null_coffee_shop_customers_id.d265e0f7a0'
[0m15:42:18.289654 [debug] [Thread-6 (]: Began compiling node test.coffee_shop.source_not_null_coffee_shop_customers_id.d265e0f7a0
[0m15:42:18.276101 [debug] [Thread-5 (]: Acquiring new bigquery connection 'test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778'
[0m15:42:18.276691 [debug] [Thread-7 (]: Acquiring new bigquery connection 'test.coffee_shop.source_unique_coffee_shop_customers_.40a2aff259'
[0m15:42:18.269156 [info ] [Thread-3 (]: 3 of 12 START test not_null_customers_ref_id ................................... [RUN]
[0m15:42:18.301002 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.coffee_shop.not_null_customers_ref_id.1480a96cf3'
[0m15:42:18.273410 [debug] [Thread-1 (]: Began compiling node test.coffee_shop.not_null_customers_id.422908bfae
[0m15:42:18.269466 [info ] [Thread-4 (]: 4 of 12 START test not_null_my_first_dbt_model_id .............................. [RUN]
[0m15:42:18.274842 [debug] [Thread-2 (]: Began compiling node test.coffee_shop.not_null_customers_ref_email.337290571c
[0m15:42:18.299542 [debug] [Thread-6 (]: Writing injected SQL for node "test.coffee_shop.source_not_null_coffee_shop_customers_id.d265e0f7a0"
[0m15:42:18.300017 [debug] [Thread-5 (]: Began compiling node test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778
[0m15:42:18.300360 [debug] [Thread-7 (]: Began compiling node test.coffee_shop.source_unique_coffee_shop_customers_.40a2aff259
[0m15:42:18.288525 [debug] [Thread-8 (]: Writing injected SQL for node "test.coffee_shop.source_unique_coffee_shop_customers_id.33a28346d5"
[0m15:42:18.301296 [debug] [Thread-3 (]: Began compiling node test.coffee_shop.not_null_customers_ref_id.1480a96cf3
[0m15:42:18.305927 [debug] [Thread-1 (]: Writing injected SQL for node "test.coffee_shop.not_null_customers_id.422908bfae"
[0m15:42:18.306665 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710'
[0m15:42:18.312948 [debug] [Thread-5 (]: Writing injected SQL for node "test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778"
[0m15:42:18.318423 [debug] [Thread-7 (]: Writing injected SQL for node "test.coffee_shop.source_unique_coffee_shop_customers_.40a2aff259"
[0m15:42:18.322897 [debug] [Thread-2 (]: Writing injected SQL for node "test.coffee_shop.not_null_customers_ref_email.337290571c"
[0m15:42:18.393012 [debug] [Thread-5 (]: Timing info for test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778 (compile): 2023-02-17 15:42:18.308897 => 2023-02-17 15:42:18.392957
[0m15:42:18.391013 [debug] [Thread-3 (]: Writing injected SQL for node "test.coffee_shop.not_null_customers_ref_id.1480a96cf3"
[0m15:42:18.391605 [debug] [Thread-4 (]: Began compiling node test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:42:18.398538 [debug] [Thread-4 (]: Writing injected SQL for node "test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710"
[0m15:42:18.392444 [debug] [Thread-1 (]: Timing info for test.coffee_shop.not_null_customers_id.422908bfae (compile): 2023-02-17 15:42:18.301529 => 2023-02-17 15:42:18.392373
[0m15:42:18.386258 [debug] [Thread-8 (]: Timing info for test.coffee_shop.source_unique_coffee_shop_customers_id.33a28346d5 (compile): 2023-02-17 15:42:18.277737 => 2023-02-17 15:42:18.386031
[0m15:42:18.393430 [debug] [Thread-7 (]: Timing info for test.coffee_shop.source_unique_coffee_shop_customers_.40a2aff259 (compile): 2023-02-17 15:42:18.314267 => 2023-02-17 15:42:18.393368
[0m15:42:18.400476 [debug] [Thread-7 (]: Began executing node test.coffee_shop.source_unique_coffee_shop_customers_.40a2aff259
[0m15:42:18.393984 [debug] [Thread-2 (]: Timing info for test.coffee_shop.not_null_customers_ref_email.337290571c (compile): 2023-02-17 15:42:18.306975 => 2023-02-17 15:42:18.393942
[0m15:42:18.392017 [debug] [Thread-6 (]: Timing info for test.coffee_shop.source_not_null_coffee_shop_customers_id.d265e0f7a0 (compile): 2023-02-17 15:42:18.289835 => 2023-02-17 15:42:18.391922
[0m15:42:18.399229 [debug] [Thread-1 (]: Began executing node test.coffee_shop.not_null_customers_id.422908bfae
[0m15:42:18.399585 [debug] [Thread-3 (]: Timing info for test.coffee_shop.not_null_customers_ref_id.1480a96cf3 (compile): 2023-02-17 15:42:18.323621 => 2023-02-17 15:42:18.399515
[0m15:42:18.399947 [debug] [Thread-8 (]: Began executing node test.coffee_shop.source_unique_coffee_shop_customers_id.33a28346d5
[0m15:42:18.425241 [debug] [Thread-8 (]: Writing runtime sql for node "test.coffee_shop.source_unique_coffee_shop_customers_id.33a28346d5"
[0m15:42:18.393787 [debug] [Thread-5 (]: Began executing node test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778
[0m15:42:18.419198 [debug] [Thread-7 (]: Writing runtime sql for node "test.coffee_shop.source_unique_coffee_shop_customers_.40a2aff259"
[0m15:42:18.419658 [debug] [Thread-2 (]: Began executing node test.coffee_shop.not_null_customers_ref_email.337290571c
[0m15:42:18.420038 [debug] [Thread-6 (]: Began executing node test.coffee_shop.source_not_null_coffee_shop_customers_id.d265e0f7a0
[0m15:42:18.422457 [debug] [Thread-1 (]: Writing runtime sql for node "test.coffee_shop.not_null_customers_id.422908bfae"
[0m15:42:18.433972 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:42:18.435043 [debug] [Thread-1 (]: On test.coffee_shop.not_null_customers_id.422908bfae: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "test.coffee_shop.not_null_customers_id.422908bfae"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from `aec-students`.`dbt_milan`.`customers`
where id is null



      
    ) dbt_internal_test
[0m15:42:18.427889 [debug] [Thread-5 (]: Writing runtime sql for node "test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778"
[0m15:42:18.437355 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m15:42:18.437871 [debug] [Thread-5 (]: On test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from `aec-students`.`dbt_milan`.`my_second_dbt_model`
where id is null



      
    ) dbt_internal_test
[0m15:42:18.422887 [debug] [Thread-3 (]: Began executing node test.coffee_shop.not_null_customers_ref_id.1480a96cf3
[0m15:42:18.446547 [debug] [Thread-3 (]: Writing runtime sql for node "test.coffee_shop.not_null_customers_ref_id.1480a96cf3"
[0m15:42:18.400241 [debug] [Thread-4 (]: Timing info for test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710 (compile): 2023-02-17 15:42:18.394476 => 2023-02-17 15:42:18.400194
[0m15:42:18.447544 [debug] [Thread-4 (]: Began executing node test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:42:18.430984 [debug] [Thread-2 (]: Writing runtime sql for node "test.coffee_shop.not_null_customers_ref_email.337290571c"
[0m15:42:18.433153 [debug] [Thread-6 (]: Writing runtime sql for node "test.coffee_shop.source_not_null_coffee_shop_customers_id.d265e0f7a0"
[0m15:42:18.428805 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m15:42:18.452670 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:42:18.461026 [debug] [Thread-3 (]: On test.coffee_shop.not_null_customers_ref_id.1480a96cf3: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "test.coffee_shop.not_null_customers_ref_id.1480a96cf3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from `aec-students`.`dbt_milan`.`customers_ref`
where id is null



      
    ) dbt_internal_test
[0m15:42:18.453518 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:42:18.462654 [debug] [Thread-2 (]: On test.coffee_shop.not_null_customers_ref_email.337290571c: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "test.coffee_shop.not_null_customers_ref_email.337290571c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select email
from `aec-students`.`dbt_milan`.`customers_ref`
where email is null



      
    ) dbt_internal_test
[0m15:42:18.452228 [debug] [Thread-4 (]: Writing runtime sql for node "test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710"
[0m15:42:18.428218 [debug] [Thread-8 (]: Opening a new connection, currently in state init
[0m15:42:18.469380 [debug] [Thread-8 (]: On test.coffee_shop.source_unique_coffee_shop_customers_id.33a28346d5: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "test.coffee_shop.source_unique_coffee_shop_customers_id.33a28346d5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `analytics-engineers-club`.`coffee_shop`.`customers`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m15:42:18.459725 [debug] [Thread-6 (]: Opening a new connection, currently in state init
[0m15:42:18.468249 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:42:18.472482 [debug] [Thread-4 (]: On test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from `aec-students`.`dbt_milan`.`my_first_dbt_model`
where id is null



      
    ) dbt_internal_test
[0m15:42:18.471804 [debug] [Thread-6 (]: On test.coffee_shop.source_not_null_coffee_shop_customers_id.d265e0f7a0: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "test.coffee_shop.source_not_null_coffee_shop_customers_id.d265e0f7a0"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from `analytics-engineers-club`.`coffee_shop`.`customers`
where id is null



      
    ) dbt_internal_test
[0m15:42:18.460512 [debug] [Thread-7 (]: On test.coffee_shop.source_unique_coffee_shop_customers_.40a2aff259: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "test.coffee_shop.source_unique_coffee_shop_customers_.40a2aff259"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select  as unique_field
  from `analytics-engineers-club`.`coffee_shop`.`customers`
  where  is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m15:42:19.315454 [debug] [Thread-7 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Syntax error: SELECT list must not be empty at [14:3]')
[0m15:42:20.073027 [error] [Thread-7 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:19dd2067-3ca9-4339-be4a-cfb1651a60de&page=queryresults
[0m15:42:20.074018 [debug] [Thread-7 (]: Timing info for test.coffee_shop.source_unique_coffee_shop_customers_.40a2aff259 (execute): 2023-02-17 15:42:18.400641 => 2023-02-17 15:42:20.073896
[0m15:42:20.077691 [debug] [Thread-7 (]: Database Error in test source_unique_coffee_shop_customers_ (models/schema.yml)
  Syntax error: SELECT list must not be empty at [14:3]
  compiled Code at target/run/coffee_shop/models/schema.yml/source_unique_coffee_shop_customers_.sql
[0m15:42:20.078204 [error] [Thread-7 (]: 7 of 12 ERROR source_unique_coffee_shop_customers_ ............................. [[31mERROR[0m in 1.80s]
[0m15:42:20.080785 [debug] [Thread-7 (]: Finished running node test.coffee_shop.source_unique_coffee_shop_customers_.40a2aff259
[0m15:42:20.081315 [debug] [Thread-7 (]: Began running node test.coffee_shop.unique_customers_id.70f3d3fd20
[0m15:42:20.081806 [info ] [Thread-7 (]: 9 of 12 START test unique_customers_id ......................................... [RUN]
[0m15:42:20.082639 [debug] [Thread-7 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_customers_id.70f3d3fd20'
[0m15:42:20.082941 [debug] [Thread-7 (]: Began compiling node test.coffee_shop.unique_customers_id.70f3d3fd20
[0m15:42:20.087875 [debug] [Thread-7 (]: Writing injected SQL for node "test.coffee_shop.unique_customers_id.70f3d3fd20"
[0m15:42:20.088472 [debug] [Thread-7 (]: Timing info for test.coffee_shop.unique_customers_id.70f3d3fd20 (compile): 2023-02-17 15:42:20.083134 => 2023-02-17 15:42:20.088373
[0m15:42:20.088824 [debug] [Thread-7 (]: Began executing node test.coffee_shop.unique_customers_id.70f3d3fd20
[0m15:42:20.091099 [debug] [Thread-7 (]: Writing runtime sql for node "test.coffee_shop.unique_customers_id.70f3d3fd20"
[0m15:42:20.091683 [debug] [Thread-7 (]: Opening a new connection, currently in state closed
[0m15:42:20.092138 [debug] [Thread-7 (]: On test.coffee_shop.unique_customers_id.70f3d3fd20: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "test.coffee_shop.unique_customers_id.70f3d3fd20"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `aec-students`.`dbt_milan`.`customers`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m15:42:20.297198 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:502f9011-c093-49b7-b4ce-6f5f5a676bab&page=queryresults
[0m15:42:20.299079 [debug] [Thread-1 (]: Timing info for test.coffee_shop.not_null_customers_id.422908bfae (execute): 2023-02-17 15:42:18.420335 => 2023-02-17 15:42:20.298985
[0m15:42:20.299908 [info ] [Thread-1 (]: 1 of 12 PASS not_null_customers_id ............................................. [[32mPASS[0m in 2.03s]
[0m15:42:20.300664 [debug] [Thread-1 (]: Finished running node test.coffee_shop.not_null_customers_id.422908bfae
[0m15:42:20.301039 [debug] [Thread-1 (]: Began running node test.coffee_shop.unique_customers_ref_id.48ce3bbab4
[0m15:42:20.301417 [info ] [Thread-1 (]: 10 of 12 START test unique_customers_ref_id .................................... [RUN]
[0m15:42:20.302377 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_customers_ref_id.48ce3bbab4'
[0m15:42:20.302665 [debug] [Thread-1 (]: Began compiling node test.coffee_shop.unique_customers_ref_id.48ce3bbab4
[0m15:42:20.307773 [debug] [Thread-1 (]: Writing injected SQL for node "test.coffee_shop.unique_customers_ref_id.48ce3bbab4"
[0m15:42:20.308747 [debug] [Thread-5 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:fc67ea2c-b7eb-470a-ac9d-c1cfbd5a6e6b&page=queryresults
[0m15:42:20.309472 [debug] [Thread-5 (]: Timing info for test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778 (execute): 2023-02-17 15:42:18.425928 => 2023-02-17 15:42:20.309392
[0m15:42:20.310203 [info ] [Thread-5 (]: 5 of 12 PASS not_null_my_second_dbt_model_id ................................... [[32mPASS[0m in 2.03s]
[0m15:42:20.310681 [debug] [Thread-5 (]: Finished running node test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778
[0m15:42:20.311101 [debug] [Thread-5 (]: Began running node test.coffee_shop.unique_my_first_dbt_model_id.16e066b321
[0m15:42:20.311654 [info ] [Thread-5 (]: 11 of 12 START test unique_my_first_dbt_model_id ............................... [RUN]
[0m15:42:20.312558 [debug] [Thread-5 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_my_first_dbt_model_id.16e066b321'
[0m15:42:20.313289 [debug] [Thread-5 (]: Began compiling node test.coffee_shop.unique_my_first_dbt_model_id.16e066b321
[0m15:42:20.313531 [debug] [Thread-1 (]: Timing info for test.coffee_shop.unique_customers_ref_id.48ce3bbab4 (compile): 2023-02-17 15:42:20.302848 => 2023-02-17 15:42:20.313469
[0m15:42:20.319595 [debug] [Thread-5 (]: Writing injected SQL for node "test.coffee_shop.unique_my_first_dbt_model_id.16e066b321"
[0m15:42:20.320826 [debug] [Thread-6 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:88b21c98-5ea9-4bb7-9268-7c60c0e3b838&page=queryresults
[0m15:42:20.322051 [debug] [Thread-6 (]: Timing info for test.coffee_shop.source_not_null_coffee_shop_customers_id.d265e0f7a0 (execute): 2023-02-17 15:42:18.431288 => 2023-02-17 15:42:20.321984
[0m15:42:20.321140 [debug] [Thread-1 (]: Began executing node test.coffee_shop.unique_customers_ref_id.48ce3bbab4
[0m15:42:20.326229 [debug] [Thread-1 (]: Writing runtime sql for node "test.coffee_shop.unique_customers_ref_id.48ce3bbab4"
[0m15:42:20.322780 [info ] [Thread-6 (]: 6 of 12 PASS source_not_null_coffee_shop_customers_id .......................... [[32mPASS[0m in 2.03s]
[0m15:42:20.327031 [debug] [Thread-6 (]: Finished running node test.coffee_shop.source_not_null_coffee_shop_customers_id.d265e0f7a0
[0m15:42:20.327799 [debug] [Thread-6 (]: Began running node test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493
[0m15:42:20.327307 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:42:20.323491 [debug] [Thread-5 (]: Timing info for test.coffee_shop.unique_my_first_dbt_model_id.16e066b321 (compile): 2023-02-17 15:42:20.313744 => 2023-02-17 15:42:20.323382
[0m15:42:20.329320 [debug] [Thread-5 (]: Began executing node test.coffee_shop.unique_my_first_dbt_model_id.16e066b321
[0m15:42:20.328956 [debug] [Thread-1 (]: On test.coffee_shop.unique_customers_ref_id.48ce3bbab4: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "test.coffee_shop.unique_customers_ref_id.48ce3bbab4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `aec-students`.`dbt_milan`.`customers_ref`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m15:42:20.332076 [debug] [Thread-5 (]: Writing runtime sql for node "test.coffee_shop.unique_my_first_dbt_model_id.16e066b321"
[0m15:42:20.328243 [info ] [Thread-6 (]: 12 of 12 START test unique_my_second_dbt_model_id .............................. [RUN]
[0m15:42:20.352118 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:a6253720-70ea-4377-8711-2d9559b50149&page=queryresults
[0m15:42:20.354392 [debug] [Thread-2 (]: Timing info for test.coffee_shop.not_null_customers_ref_email.337290571c (execute): 2023-02-17 15:42:18.429001 => 2023-02-17 15:42:20.354289
[0m15:42:20.364476 [info ] [Thread-2 (]: 2 of 12 PASS not_null_customers_ref_email ...................................... [[32mPASS[0m in 2.09s]
[0m15:42:20.365896 [debug] [Thread-2 (]: Finished running node test.coffee_shop.not_null_customers_ref_email.337290571c
[0m15:42:20.353517 [debug] [Thread-6 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493'
[0m15:42:20.367219 [debug] [Thread-6 (]: Began compiling node test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493
[0m15:42:20.374239 [debug] [Thread-6 (]: Writing injected SQL for node "test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493"
[0m15:42:20.374930 [debug] [Thread-5 (]: Opening a new connection, currently in state closed
[0m15:42:20.375747 [debug] [Thread-5 (]: On test.coffee_shop.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "test.coffee_shop.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `aec-students`.`dbt_milan`.`my_first_dbt_model`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m15:42:20.379537 [debug] [Thread-6 (]: Timing info for test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493 (compile): 2023-02-17 15:42:20.367751 => 2023-02-17 15:42:20.379370
[0m15:42:20.380230 [debug] [Thread-6 (]: Began executing node test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493
[0m15:42:20.384505 [debug] [Thread-6 (]: Writing runtime sql for node "test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493"
[0m15:42:20.385874 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:2b9956c0-7cbb-4cd5-a525-b7604711069c&page=queryresults
[0m15:42:20.387136 [debug] [Thread-3 (]: Timing info for test.coffee_shop.not_null_customers_ref_id.1480a96cf3 (execute): 2023-02-17 15:42:18.444445 => 2023-02-17 15:42:20.386918
[0m15:42:20.388147 [info ] [Thread-3 (]: 3 of 12 PASS not_null_customers_ref_id ......................................... [[32mPASS[0m in 2.09s]
[0m15:42:20.389201 [debug] [Thread-3 (]: Finished running node test.coffee_shop.not_null_customers_ref_id.1480a96cf3
[0m15:42:20.391006 [debug] [Thread-6 (]: Opening a new connection, currently in state closed
[0m15:42:20.391706 [debug] [Thread-6 (]: On test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `aec-students`.`dbt_milan`.`my_second_dbt_model`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m15:42:20.731717 [debug] [Thread-8 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:f2e625ed-4305-4904-94e0-e80ec4601487&page=queryresults
[0m15:42:20.732528 [debug] [Thread-8 (]: Timing info for test.coffee_shop.source_unique_coffee_shop_customers_id.33a28346d5 (execute): 2023-02-17 15:42:18.423202 => 2023-02-17 15:42:20.732449
[0m15:42:20.733466 [info ] [Thread-8 (]: 8 of 12 PASS source_unique_coffee_shop_customers_id ............................ [[32mPASS[0m in 2.46s]
[0m15:42:20.734385 [debug] [Thread-8 (]: Finished running node test.coffee_shop.source_unique_coffee_shop_customers_id.33a28346d5
[0m15:42:20.743994 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:83ee0737-b348-4333-b84a-8ad4a42243c4&page=queryresults
[0m15:42:20.744946 [debug] [Thread-4 (]: Timing info for test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710 (execute): 2023-02-17 15:42:18.447866 => 2023-02-17 15:42:20.744843
[0m15:42:20.746005 [error] [Thread-4 (]: 4 of 12 FAIL 1 not_null_my_first_dbt_model_id .................................. [[31mFAIL 1[0m in 2.44s]
[0m15:42:20.747064 [debug] [Thread-4 (]: Finished running node test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:42:21.472311 [debug] [Thread-7 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:a093b9f1-cc85-4946-8b86-6d5343c39947&page=queryresults
[0m15:42:21.473094 [debug] [Thread-7 (]: Timing info for test.coffee_shop.unique_customers_id.70f3d3fd20 (execute): 2023-02-17 15:42:20.089003 => 2023-02-17 15:42:21.473013
[0m15:42:21.473905 [info ] [Thread-7 (]: 9 of 12 PASS unique_customers_id ............................................... [[32mPASS[0m in 1.39s]
[0m15:42:21.474596 [debug] [Thread-7 (]: Finished running node test.coffee_shop.unique_customers_id.70f3d3fd20
[0m15:42:21.872812 [debug] [Thread-5 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:c6f2ae85-9400-4674-80a9-1a19c5567a49&page=queryresults
[0m15:42:21.873658 [debug] [Thread-5 (]: Timing info for test.coffee_shop.unique_my_first_dbt_model_id.16e066b321 (execute): 2023-02-17 15:42:20.329566 => 2023-02-17 15:42:21.873582
[0m15:42:21.874459 [info ] [Thread-5 (]: 11 of 12 PASS unique_my_first_dbt_model_id ..................................... [[32mPASS[0m in 1.56s]
[0m15:42:21.875203 [debug] [Thread-5 (]: Finished running node test.coffee_shop.unique_my_first_dbt_model_id.16e066b321
[0m15:42:21.978474 [debug] [Thread-6 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:96ed5b2c-aa06-4bb3-bb9a-807c05a3794f&page=queryresults
[0m15:42:21.979287 [debug] [Thread-6 (]: Timing info for test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493 (execute): 2023-02-17 15:42:20.380586 => 2023-02-17 15:42:21.979211
[0m15:42:21.980160 [info ] [Thread-6 (]: 12 of 12 PASS unique_my_second_dbt_model_id .................................... [[32mPASS[0m in 1.63s]
[0m15:42:21.980948 [debug] [Thread-6 (]: Finished running node test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493
[0m15:42:22.268475 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:e4ff9d4b-8ff4-4e44-a6cc-386317a5bb76&page=queryresults
[0m15:42:22.269274 [debug] [Thread-1 (]: Timing info for test.coffee_shop.unique_customers_ref_id.48ce3bbab4 (execute): 2023-02-17 15:42:20.323888 => 2023-02-17 15:42:22.269200
[0m15:42:22.270108 [info ] [Thread-1 (]: 10 of 12 PASS unique_customers_ref_id .......................................... [[32mPASS[0m in 1.97s]
[0m15:42:22.270691 [debug] [Thread-1 (]: Finished running node test.coffee_shop.unique_customers_ref_id.48ce3bbab4
[0m15:42:22.273204 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:42:22.273793 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:42:22.274026 [debug] [MainThread]: Connection 'test.coffee_shop.unique_customers_ref_id.48ce3bbab4' was properly closed.
[0m15:42:22.274208 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_customers_ref_email.337290571c' was properly closed.
[0m15:42:22.274374 [debug] [MainThread]: Connection 'test.coffee_shop.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m15:42:22.274526 [debug] [MainThread]: Connection 'test.coffee_shop.unique_customers_id.70f3d3fd20' was properly closed.
[0m15:42:22.274678 [debug] [MainThread]: Connection 'test.coffee_shop.source_unique_coffee_shop_customers_id.33a28346d5' was properly closed.
[0m15:42:22.274828 [debug] [MainThread]: Connection 'test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m15:42:22.274980 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_customers_ref_id.1480a96cf3' was properly closed.
[0m15:42:22.275128 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m15:42:22.275344 [info ] [MainThread]: 
[0m15:42:22.275730 [info ] [MainThread]: Finished running 12 tests in 0 hours 0 minutes and 5.24 seconds (5.24s).
[0m15:42:22.276525 [debug] [MainThread]: Command end result
[0m15:42:22.286700 [info ] [MainThread]: 
[0m15:42:22.287718 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m15:42:22.288184 [info ] [MainThread]: 
[0m15:42:22.288640 [error] [MainThread]: [33mDatabase Error in test source_unique_coffee_shop_customers_ (models/schema.yml)[0m
[0m15:42:22.289116 [error] [MainThread]:   Syntax error: SELECT list must not be empty at [14:3]
[0m15:42:22.289602 [error] [MainThread]:   compiled Code at target/run/coffee_shop/models/schema.yml/source_unique_coffee_shop_customers_.sql
[0m15:42:22.290084 [info ] [MainThread]: 
[0m15:42:22.293440 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
[0m15:42:22.294113 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m15:42:22.294588 [info ] [MainThread]: 
[0m15:42:22.295130 [info ] [MainThread]:   compiled Code at target/compiled/coffee_shop/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
[0m15:42:22.295665 [info ] [MainThread]: 
[0m15:42:22.296092 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=2 SKIP=0 TOTAL=12
[0m15:42:22.296672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f34e27263e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f350421b1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3504218340>]}
[0m15:42:22.297227 [debug] [MainThread]: Flushing usage events


============================== 2023-02-17 15:42:36.866770 | 0a32ef4a-9add-46cb-9876-914e1b219446 ==============================
[0m15:42:36.866770 [info ] [MainThread]: Running with dbt=1.4.1
[0m15:42:36.870410 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
[0m15:42:36.871808 [debug] [MainThread]: Tracking: tracking
[0m15:42:36.874173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c29245840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c29062c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c29063b20>]}
[0m15:42:36.923522 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:42:36.923966 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:42:36.924703 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffe_shop_milan.example
[0m15:42:36.931451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0a32ef4a-9add-46cb-9876-914e1b219446', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c28e4e680>]}
[0m15:42:36.941591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0a32ef4a-9add-46cb-9876-914e1b219446', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c29016c50>]}
[0m15:42:36.942192 [info ] [MainThread]: Found 4 models, 12 tests, 0 snapshots, 0 analyses, 334 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m15:42:36.943283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a32ef4a-9add-46cb-9876-914e1b219446', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c29016cb0>]}
[0m15:42:36.945849 [info ] [MainThread]: 
[0m15:42:36.950132 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:42:36.952255 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_milan'
[0m15:42:36.952704 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:42:38.051347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a32ef4a-9add-46cb-9876-914e1b219446', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c29016890>]}
[0m15:42:38.052437 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m15:42:38.053424 [info ] [MainThread]: 
[0m15:42:38.062005 [debug] [Thread-1 (]: Began running node model.coffee_shop.customers
[0m15:42:38.062589 [debug] [Thread-2 (]: Began running node model.coffee_shop.customers_ref
[0m15:42:38.066299 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.coffee_shop.customers_ref'
[0m15:42:38.066718 [debug] [Thread-2 (]: Began compiling node model.coffee_shop.customers_ref
[0m15:42:38.062930 [debug] [Thread-3 (]: Began running node model.coffee_shop.my_first_dbt_model
[0m15:42:38.064231 [debug] [Thread-6 (]: Began running node test.coffee_shop.source_unique_coffee_shop_customers_id.33a28346d5
[0m15:42:38.074663 [debug] [Thread-6 (]: Acquiring new bigquery connection 'test.coffee_shop.source_unique_coffee_shop_customers_id.33a28346d5'
[0m15:42:38.075117 [debug] [Thread-6 (]: Began compiling node test.coffee_shop.source_unique_coffee_shop_customers_id.33a28346d5
[0m15:42:38.063290 [debug] [Thread-4 (]: Began running node test.coffee_shop.source_not_null_coffee_shop_customers_id.d265e0f7a0
[0m15:42:38.081298 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.coffee_shop.source_not_null_coffee_shop_customers_id.d265e0f7a0'
[0m15:42:38.081787 [debug] [Thread-4 (]: Began compiling node test.coffee_shop.source_not_null_coffee_shop_customers_id.d265e0f7a0
[0m15:42:38.065389 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop.customers'
[0m15:42:38.093105 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.customers
[0m15:42:38.063821 [debug] [Thread-5 (]: Began running node test.coffee_shop.source_unique_coffee_shop_customers_.40a2aff259
[0m15:42:38.098452 [debug] [Thread-5 (]: Acquiring new bigquery connection 'test.coffee_shop.source_unique_coffee_shop_customers_.40a2aff259'
[0m15:42:38.098910 [debug] [Thread-5 (]: Began compiling node test.coffee_shop.source_unique_coffee_shop_customers_.40a2aff259
[0m15:42:38.073468 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.coffee_shop.my_first_dbt_model'
[0m15:42:38.108697 [debug] [Thread-3 (]: Began compiling node model.coffee_shop.my_first_dbt_model
[0m15:42:38.072260 [debug] [Thread-2 (]: Writing injected SQL for node "model.coffee_shop.customers_ref"
[0m15:42:38.123338 [debug] [Thread-2 (]: Timing info for model.coffee_shop.customers_ref (compile): 2023-02-17 15:42:38.067007 => 2023-02-17 15:42:38.123194
[0m15:42:38.123923 [debug] [Thread-2 (]: Began executing node model.coffee_shop.customers_ref
[0m15:42:38.124272 [debug] [Thread-2 (]: Timing info for model.coffee_shop.customers_ref (execute): 2023-02-17 15:42:38.124181 => 2023-02-17 15:42:38.124203
[0m15:42:38.126768 [debug] [Thread-2 (]: Finished running node model.coffee_shop.customers_ref
[0m15:42:38.097344 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.customers"
[0m15:42:38.113139 [debug] [Thread-3 (]: Writing injected SQL for node "model.coffee_shop.my_first_dbt_model"
[0m15:42:38.134305 [debug] [Thread-6 (]: Writing injected SQL for node "test.coffee_shop.source_unique_coffee_shop_customers_id.33a28346d5"
[0m15:42:38.247615 [debug] [Thread-4 (]: Writing injected SQL for node "test.coffee_shop.source_not_null_coffee_shop_customers_id.d265e0f7a0"
[0m15:42:38.260400 [debug] [Thread-6 (]: Timing info for test.coffee_shop.source_unique_coffee_shop_customers_id.33a28346d5 (compile): 2023-02-17 15:42:38.075375 => 2023-02-17 15:42:38.260318
[0m15:42:38.260800 [debug] [Thread-6 (]: Began executing node test.coffee_shop.source_unique_coffee_shop_customers_id.33a28346d5
[0m15:42:38.253403 [debug] [Thread-5 (]: Writing injected SQL for node "test.coffee_shop.source_unique_coffee_shop_customers_.40a2aff259"
[0m15:42:38.255586 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (compile): 2023-02-17 15:42:38.093479 => 2023-02-17 15:42:38.255526
[0m15:42:38.259398 [debug] [Thread-7 (]: Began running node test.coffee_shop.not_null_customers_ref_id.1480a96cf3
[0m15:42:38.259734 [debug] [Thread-2 (]: Began running node test.coffee_shop.unique_customers_ref_id.48ce3bbab4
[0m15:42:38.263775 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_customers_ref_id.48ce3bbab4'
[0m15:42:38.264071 [debug] [Thread-2 (]: Began compiling node test.coffee_shop.unique_customers_ref_id.48ce3bbab4
[0m15:42:38.261159 [debug] [Thread-6 (]: Timing info for test.coffee_shop.source_unique_coffee_shop_customers_id.33a28346d5 (execute): 2023-02-17 15:42:38.261066 => 2023-02-17 15:42:38.261083
[0m15:42:38.270597 [debug] [Thread-6 (]: Finished running node test.coffee_shop.source_unique_coffee_shop_customers_id.33a28346d5
[0m15:42:38.261753 [debug] [Thread-4 (]: Timing info for test.coffee_shop.source_not_null_coffee_shop_customers_id.d265e0f7a0 (compile): 2023-02-17 15:42:38.082229 => 2023-02-17 15:42:38.261683
[0m15:42:38.271056 [debug] [Thread-4 (]: Began executing node test.coffee_shop.source_not_null_coffee_shop_customers_id.d265e0f7a0
[0m15:42:38.262004 [debug] [Thread-1 (]: Began executing node model.coffee_shop.customers
[0m15:42:38.271716 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (execute): 2023-02-17 15:42:38.271645 => 2023-02-17 15:42:38.271656
[0m15:42:38.272363 [debug] [Thread-1 (]: Finished running node model.coffee_shop.customers
[0m15:42:38.255311 [debug] [Thread-8 (]: Began running node test.coffee_shop.not_null_customers_ref_email.337290571c
[0m15:42:38.269536 [debug] [Thread-2 (]: Writing injected SQL for node "test.coffee_shop.unique_customers_ref_id.48ce3bbab4"
[0m15:42:38.271329 [debug] [Thread-4 (]: Timing info for test.coffee_shop.source_not_null_coffee_shop_customers_id.d265e0f7a0 (execute): 2023-02-17 15:42:38.271251 => 2023-02-17 15:42:38.271264
[0m15:42:38.274623 [debug] [Thread-4 (]: Finished running node test.coffee_shop.source_not_null_coffee_shop_customers_id.d265e0f7a0
[0m15:42:38.273055 [debug] [Thread-8 (]: Acquiring new bigquery connection 'test.coffee_shop.not_null_customers_ref_email.337290571c'
[0m15:42:38.275165 [debug] [Thread-8 (]: Began compiling node test.coffee_shop.not_null_customers_ref_email.337290571c
[0m15:42:38.262711 [debug] [Thread-7 (]: Acquiring new bigquery connection 'test.coffee_shop.not_null_customers_ref_id.1480a96cf3'
[0m15:42:38.280511 [debug] [Thread-7 (]: Began compiling node test.coffee_shop.not_null_customers_ref_id.1480a96cf3
[0m15:42:38.273586 [debug] [Thread-6 (]: Began running node test.coffee_shop.not_null_customers_id.422908bfae
[0m15:42:38.263085 [debug] [Thread-5 (]: Timing info for test.coffee_shop.source_unique_coffee_shop_customers_.40a2aff259 (compile): 2023-02-17 15:42:38.106329 => 2023-02-17 15:42:38.263020
[0m15:42:38.254793 [debug] [Thread-3 (]: Timing info for model.coffee_shop.my_first_dbt_model (compile): 2023-02-17 15:42:38.109115 => 2023-02-17 15:42:38.254685
[0m15:42:38.279847 [debug] [Thread-8 (]: Writing injected SQL for node "test.coffee_shop.not_null_customers_ref_email.337290571c"
[0m15:42:38.280139 [debug] [Thread-2 (]: Timing info for test.coffee_shop.unique_customers_ref_id.48ce3bbab4 (compile): 2023-02-17 15:42:38.264244 => 2023-02-17 15:42:38.280074
[0m15:42:38.273890 [debug] [Thread-1 (]: Began running node test.coffee_shop.unique_customers_id.70f3d3fd20
[0m15:42:38.284942 [debug] [Thread-7 (]: Writing injected SQL for node "test.coffee_shop.not_null_customers_ref_id.1480a96cf3"
[0m15:42:38.285637 [debug] [Thread-6 (]: Acquiring new bigquery connection 'test.coffee_shop.not_null_customers_id.422908bfae'
[0m15:42:38.289646 [debug] [Thread-6 (]: Began compiling node test.coffee_shop.not_null_customers_id.422908bfae
[0m15:42:38.286340 [debug] [Thread-3 (]: Began executing node model.coffee_shop.my_first_dbt_model
[0m15:42:38.294743 [debug] [Thread-3 (]: Timing info for model.coffee_shop.my_first_dbt_model (execute): 2023-02-17 15:42:38.294661 => 2023-02-17 15:42:38.294678
[0m15:42:38.288239 [debug] [Thread-1 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_customers_id.70f3d3fd20'
[0m15:42:38.295778 [debug] [Thread-1 (]: Began compiling node test.coffee_shop.unique_customers_id.70f3d3fd20
[0m15:42:38.286049 [debug] [Thread-5 (]: Began executing node test.coffee_shop.source_unique_coffee_shop_customers_.40a2aff259
[0m15:42:38.303109 [debug] [Thread-5 (]: Timing info for test.coffee_shop.source_unique_coffee_shop_customers_.40a2aff259 (execute): 2023-02-17 15:42:38.303006 => 2023-02-17 15:42:38.303027
[0m15:42:38.294331 [debug] [Thread-6 (]: Writing injected SQL for node "test.coffee_shop.not_null_customers_id.422908bfae"
[0m15:42:38.286813 [debug] [Thread-2 (]: Began executing node test.coffee_shop.unique_customers_ref_id.48ce3bbab4
[0m15:42:38.295396 [debug] [Thread-3 (]: Finished running node model.coffee_shop.my_first_dbt_model
[0m15:42:38.288931 [debug] [Thread-7 (]: Timing info for test.coffee_shop.not_null_customers_ref_id.1480a96cf3 (compile): 2023-02-17 15:42:38.280717 => 2023-02-17 15:42:38.288837
[0m15:42:38.307154 [debug] [Thread-7 (]: Began executing node test.coffee_shop.not_null_customers_ref_id.1480a96cf3
[0m15:42:38.289234 [debug] [Thread-8 (]: Timing info for test.coffee_shop.not_null_customers_ref_email.337290571c (compile): 2023-02-17 15:42:38.275391 => 2023-02-17 15:42:38.289169
[0m15:42:38.307758 [debug] [Thread-8 (]: Began executing node test.coffee_shop.not_null_customers_ref_email.337290571c
[0m15:42:38.305258 [debug] [Thread-2 (]: Timing info for test.coffee_shop.unique_customers_ref_id.48ce3bbab4 (execute): 2023-02-17 15:42:38.305178 => 2023-02-17 15:42:38.305191
[0m15:42:38.308746 [debug] [Thread-2 (]: Finished running node test.coffee_shop.unique_customers_ref_id.48ce3bbab4
[0m15:42:38.306351 [debug] [Thread-4 (]: Began running node model.coffee_shop.my_second_dbt_model
[0m15:42:38.309756 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.coffee_shop.my_second_dbt_model'
[0m15:42:38.307406 [debug] [Thread-7 (]: Timing info for test.coffee_shop.not_null_customers_ref_id.1480a96cf3 (execute): 2023-02-17 15:42:38.307339 => 2023-02-17 15:42:38.307350
[0m15:42:38.310667 [debug] [Thread-7 (]: Finished running node test.coffee_shop.not_null_customers_ref_id.1480a96cf3
[0m15:42:38.308065 [debug] [Thread-8 (]: Timing info for test.coffee_shop.not_null_customers_ref_email.337290571c (execute): 2023-02-17 15:42:38.308012 => 2023-02-17 15:42:38.308022
[0m15:42:38.304008 [debug] [Thread-5 (]: Finished running node test.coffee_shop.source_unique_coffee_shop_customers_.40a2aff259
[0m15:42:38.306024 [debug] [Thread-6 (]: Timing info for test.coffee_shop.not_null_customers_id.422908bfae (compile): 2023-02-17 15:42:38.289848 => 2023-02-17 15:42:38.305962
[0m15:42:38.312014 [debug] [Thread-6 (]: Began executing node test.coffee_shop.not_null_customers_id.422908bfae
[0m15:42:38.310018 [debug] [Thread-4 (]: Began compiling node model.coffee_shop.my_second_dbt_model
[0m15:42:38.315004 [debug] [Thread-4 (]: Writing injected SQL for node "model.coffee_shop.my_second_dbt_model"
[0m15:42:38.306590 [debug] [Thread-3 (]: Began running node test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:42:38.316280 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710'
[0m15:42:38.316563 [debug] [Thread-3 (]: Began compiling node test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:42:38.312283 [debug] [Thread-6 (]: Timing info for test.coffee_shop.not_null_customers_id.422908bfae (execute): 2023-02-17 15:42:38.312207 => 2023-02-17 15:42:38.312218
[0m15:42:38.299979 [debug] [Thread-1 (]: Writing injected SQL for node "test.coffee_shop.unique_customers_id.70f3d3fd20"
[0m15:42:38.315686 [debug] [Thread-4 (]: Timing info for model.coffee_shop.my_second_dbt_model (compile): 2023-02-17 15:42:38.312487 => 2023-02-17 15:42:38.315473
[0m15:42:38.322241 [debug] [Thread-4 (]: Began executing node model.coffee_shop.my_second_dbt_model
[0m15:42:38.322638 [debug] [Thread-4 (]: Timing info for model.coffee_shop.my_second_dbt_model (execute): 2023-02-17 15:42:38.322552 => 2023-02-17 15:42:38.322567
[0m15:42:38.320846 [debug] [Thread-3 (]: Writing injected SQL for node "test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710"
[0m15:42:38.321670 [debug] [Thread-6 (]: Finished running node test.coffee_shop.not_null_customers_id.422908bfae
[0m15:42:38.311489 [debug] [Thread-8 (]: Finished running node test.coffee_shop.not_null_customers_ref_email.337290571c
[0m15:42:38.309121 [debug] [Thread-2 (]: Began running node test.coffee_shop.unique_my_first_dbt_model_id.16e066b321
[0m15:42:38.324937 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_my_first_dbt_model_id.16e066b321'
[0m15:42:38.325476 [debug] [Thread-2 (]: Began compiling node test.coffee_shop.unique_my_first_dbt_model_id.16e066b321
[0m15:42:38.323665 [debug] [Thread-4 (]: Finished running node model.coffee_shop.my_second_dbt_model
[0m15:42:38.325183 [debug] [Thread-3 (]: Timing info for test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710 (compile): 2023-02-17 15:42:38.316733 => 2023-02-17 15:42:38.325130
[0m15:42:38.322996 [debug] [Thread-1 (]: Timing info for test.coffee_shop.unique_customers_id.70f3d3fd20 (compile): 2023-02-17 15:42:38.295957 => 2023-02-17 15:42:38.322948
[0m15:42:38.329758 [debug] [Thread-2 (]: Writing injected SQL for node "test.coffee_shop.unique_my_first_dbt_model_id.16e066b321"
[0m15:42:38.330622 [debug] [Thread-7 (]: Began running node test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778
[0m15:42:38.332262 [debug] [Thread-7 (]: Acquiring new bigquery connection 'test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778'
[0m15:42:38.331154 [debug] [Thread-5 (]: Began running node test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493
[0m15:42:38.335613 [debug] [Thread-5 (]: Acquiring new bigquery connection 'test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493'
[0m15:42:38.336054 [debug] [Thread-5 (]: Began compiling node test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493
[0m15:42:38.331487 [debug] [Thread-1 (]: Began executing node test.coffee_shop.unique_customers_id.70f3d3fd20
[0m15:42:38.343538 [debug] [Thread-1 (]: Timing info for test.coffee_shop.unique_customers_id.70f3d3fd20 (execute): 2023-02-17 15:42:38.343432 => 2023-02-17 15:42:38.343452
[0m15:42:38.332726 [debug] [Thread-7 (]: Began compiling node test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778
[0m15:42:38.330911 [debug] [Thread-3 (]: Began executing node test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:42:38.351397 [debug] [Thread-3 (]: Timing info for test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710 (execute): 2023-02-17 15:42:38.351301 => 2023-02-17 15:42:38.351317
[0m15:42:38.344297 [debug] [Thread-1 (]: Finished running node test.coffee_shop.unique_customers_id.70f3d3fd20
[0m15:42:38.332968 [debug] [Thread-2 (]: Timing info for test.coffee_shop.unique_my_first_dbt_model_id.16e066b321 (compile): 2023-02-17 15:42:38.325659 => 2023-02-17 15:42:38.332914
[0m15:42:38.352483 [debug] [Thread-3 (]: Finished running node test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710
[0m15:42:38.343013 [debug] [Thread-5 (]: Writing injected SQL for node "test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493"
[0m15:42:38.354095 [debug] [Thread-5 (]: Timing info for test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493 (compile): 2023-02-17 15:42:38.336291 => 2023-02-17 15:42:38.354023
[0m15:42:38.354564 [debug] [Thread-5 (]: Began executing node test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493
[0m15:42:38.354967 [debug] [Thread-5 (]: Timing info for test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493 (execute): 2023-02-17 15:42:38.354901 => 2023-02-17 15:42:38.354912
[0m15:42:38.355816 [debug] [Thread-5 (]: Finished running node test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493
[0m15:42:38.350894 [debug] [Thread-7 (]: Writing injected SQL for node "test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778"
[0m15:42:38.356576 [debug] [Thread-7 (]: Timing info for test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778 (compile): 2023-02-17 15:42:38.344571 => 2023-02-17 15:42:38.356506
[0m15:42:38.353243 [debug] [Thread-2 (]: Began executing node test.coffee_shop.unique_my_first_dbt_model_id.16e066b321
[0m15:42:38.357220 [debug] [Thread-2 (]: Timing info for test.coffee_shop.unique_my_first_dbt_model_id.16e066b321 (execute): 2023-02-17 15:42:38.357149 => 2023-02-17 15:42:38.357162
[0m15:42:38.357855 [debug] [Thread-2 (]: Finished running node test.coffee_shop.unique_my_first_dbt_model_id.16e066b321
[0m15:42:38.356941 [debug] [Thread-7 (]: Began executing node test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778
[0m15:42:38.358269 [debug] [Thread-7 (]: Timing info for test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778 (execute): 2023-02-17 15:42:38.358202 => 2023-02-17 15:42:38.358212
[0m15:42:38.359086 [debug] [Thread-7 (]: Finished running node test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778
[0m15:42:38.362371 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:42:38.362797 [debug] [MainThread]: Connection 'test.coffee_shop.unique_customers_id.70f3d3fd20' was properly closed.
[0m15:42:38.363126 [debug] [MainThread]: Connection 'test.coffee_shop.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m15:42:38.363407 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m15:42:38.363703 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_customers_id.422908bfae' was properly closed.
[0m15:42:38.363971 [debug] [MainThread]: Connection 'model.coffee_shop.my_second_dbt_model' was properly closed.
[0m15:42:38.364238 [debug] [MainThread]: Connection 'test.coffee_shop.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m15:42:38.364589 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
[0m15:42:38.364807 [debug] [MainThread]: Connection 'test.coffee_shop.not_null_customers_ref_email.337290571c' was properly closed.
[0m15:42:38.365853 [debug] [MainThread]: Command end result
[0m15:42:38.374565 [info ] [MainThread]: Done.
[0m15:42:38.378078 [debug] [MainThread]: Acquiring new bigquery connection 'generate_catalog'
[0m15:42:38.378492 [info ] [MainThread]: Building catalog
[0m15:42:38.379723 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:42:38.909110 [debug] [ThreadPool]: Acquiring new bigquery connection 'aec-students.information_schema'
[0m15:42:38.909869 [debug] [ThreadPool]: Acquiring new bigquery connection 'analytics-engineers-club.information_schema'
[0m15:42:38.925503 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:42:38.927928 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:42:38.928708 [debug] [ThreadPool]: On aec-students.information_schema: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "connection_name": "aec-students.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `aec-students`.`dbt_milan`.__TABLES__
        where (upper(dataset_id) = upper('dbt_milan'))
    ),

    table_options as (
        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            JSON_VALUE(option_value) as table_comment

        from `aec-students`.`dbt_milan`.INFORMATION_SCHEMA.TABLE_OPTIONS
        where option_name = 'description'
    ),
    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `aec-students`.`dbt_milan`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `aec-students`.`dbt_milan`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,
        table_options.table_comment,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join table_options using (relation_id)
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
[0m15:42:38.929172 [debug] [ThreadPool]: On analytics-engineers-club.information_schema: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "connection_name": "analytics-engineers-club.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `analytics-engineers-club`.`coffee_shop`.__TABLES__
        where (upper(dataset_id) = upper('coffee_shop'))
    ),

    table_options as (
        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            JSON_VALUE(option_value) as table_comment

        from `analytics-engineers-club`.`coffee_shop`.INFORMATION_SCHEMA.TABLE_OPTIONS
        where option_name = 'description'
    ),
    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `analytics-engineers-club`.`coffee_shop`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `analytics-engineers-club`.`coffee_shop`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,
        table_options.table_comment,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join table_options using (relation_id)
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
[0m15:42:41.677047 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:28d2c5bc-6a69-40b9-b93e-d444103b98ee&page=queryresults
[0m15:42:41.735202 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:98252f8f-8b69-45f4-902f-4aed3d22fda8&page=queryresults
[0m15:42:41.823183 [info ] [MainThread]: Catalog written to /workspaces/ae-club-milan/coffe_shop_milan/target/catalog.json
[0m15:42:41.833762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c29245840>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c29470bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0c29471720>]}
[0m15:42:41.834263 [debug] [MainThread]: Flushing usage events
[0m15:42:42.245313 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m15:42:42.246115 [debug] [MainThread]: Connection 'aec-students.information_schema' was properly closed.
[0m15:42:42.246440 [debug] [MainThread]: Connection 'analytics-engineers-club.information_schema' was properly closed.


============================== 2023-02-17 15:42:52.880060 | 1ffd6aa8-f023-4feb-8883-694f1406db64 ==============================
[0m15:42:52.880060 [info ] [MainThread]: Running with dbt=1.4.1
[0m15:42:52.883856 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
[0m15:42:52.885270 [debug] [MainThread]: Tracking: tracking
[0m15:42:52.887389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a85253730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a85251a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6a85253880>]}
[0m15:42:52.893283 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
[0m15:42:52.895326 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
[0m15:42:52.896532 [info ] [MainThread]: 
[0m15:42:52.898195 [info ] [MainThread]: 
[0m15:42:52.901145 [info ] [MainThread]: Press Ctrl+C to exit.
[0m15:49:51.466631 [debug] [MainThread]: Flushing usage events
[0m15:49:51.880408 [info ] [MainThread]: ctrl-c


============================== 2023-02-17 15:50:04.280940 | 32badbcd-7066-448e-90e5-e8b67d492045 ==============================
[0m15:50:04.280940 [info ] [MainThread]: Running with dbt=1.4.1
[0m15:50:04.288880 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'source-freshness', 'rpc_method': 'source-freshness', 'indirect_selection': 'eager'}
[0m15:50:04.290204 [debug] [MainThread]: Tracking: tracking
[0m15:50:04.303289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f335ee3d7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f335ec5a560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f335ec5b9a0>]}
[0m15:50:04.365201 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:50:04.365833 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:50:04.366741 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffe_shop_milan.example
[0m15:50:04.373480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '32badbcd-7066-448e-90e5-e8b67d492045', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f335ec425c0>]}
[0m15:50:04.382580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '32badbcd-7066-448e-90e5-e8b67d492045', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f335ec0eb60>]}
[0m15:50:04.383078 [info ] [MainThread]: Found 4 models, 12 tests, 0 snapshots, 0 analyses, 334 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m15:50:04.383558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '32badbcd-7066-448e-90e5-e8b67d492045', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f335ee3d7b0>]}
[0m15:50:04.385032 [info ] [MainThread]: 
[0m15:50:04.385845 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m15:50:04.392115 [info ] [MainThread]: Done.
[0m15:50:04.392811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f335ec0e770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f335ec0c250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f335ec0e7a0>]}
[0m15:50:04.393289 [debug] [MainThread]: Flushing usage events


============================== 2023-02-17 15:51:41.495674 | 4adec956-37df-447b-9bde-74f39d80694e ==============================
[0m15:51:41.495674 [info ] [MainThread]: Running with dbt=1.4.1
[0m15:51:41.498266 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'source-freshness', 'rpc_method': 'source-freshness', 'indirect_selection': 'eager'}
[0m15:51:41.498611 [debug] [MainThread]: Tracking: tracking
[0m15:51:41.501178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a2945f850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a2945d900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a2945fd60>]}
[0m15:51:41.560472 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:51:41.561272 [debug] [MainThread]: Partial parsing: updated file: coffee_shop://models/schema.yml
[0m15:51:41.576094 [debug] [MainThread]: 1699: static parser successfully parsed customers_ref.sql
[0m15:51:41.690587 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffe_shop_milan.example
[0m15:51:41.696706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4adec956-37df-447b-9bde-74f39d80694e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a2941f4f0>]}
[0m15:51:41.705753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4adec956-37df-447b-9bde-74f39d80694e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a2941f7f0>]}
[0m15:51:41.706370 [info ] [MainThread]: Found 4 models, 12 tests, 0 snapshots, 0 analyses, 334 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m15:51:41.706831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4adec956-37df-447b-9bde-74f39d80694e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a2cd2ef50>]}
[0m15:51:41.708639 [info ] [MainThread]: 
[0m15:51:41.710764 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:51:41.712218 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_milan'
[0m15:51:41.712642 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:51:42.981669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4adec956-37df-447b-9bde-74f39d80694e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a2941f9d0>]}
[0m15:51:42.982472 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m15:51:42.983093 [info ] [MainThread]: 
[0m15:51:42.987679 [debug] [Thread-1 (]: Began running node source.coffee_shop.coffee_shop.customers
[0m15:51:42.988046 [info ] [Thread-1 (]: 1 of 1 START freshness of coffee_shop.customers ................................ [RUN]
[0m15:51:42.988809 [debug] [Thread-1 (]: Acquiring new bigquery connection 'source.coffee_shop.coffee_shop.customers'
[0m15:51:42.989091 [debug] [Thread-1 (]: Began compiling node source.coffee_shop.coffee_shop.customers
[0m15:51:42.989314 [debug] [Thread-1 (]: Timing info for source.coffee_shop.coffee_shop.customers (compile): 2023-02-17 15:51:42.989254 => 2023-02-17 15:51:42.989261
[0m15:51:42.989531 [debug] [Thread-1 (]: Began executing node source.coffee_shop.coffee_shop.customers
[0m15:51:42.990394 [debug] [Thread-1 (]: Acquiring new bigquery connection 'source.coffee_shop.coffee_shop.customers'
[0m15:51:43.003856 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:51:43.004672 [debug] [Thread-1 (]: On source.coffee_shop.coffee_shop.customers: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "source.coffee_shop.coffee_shop.customers"} */
select
      max(created_at) as max_loaded_at,
      current_timestamp() as snapshotted_at
    from `analytics-engineers-club`.`coffee_shop`.`customers`
    
  
[0m15:51:43.501225 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Unrecognized name: created_at at [3:11]')
[0m15:51:44.082234 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:c1335af8-912f-4d38-ad02-b8d8f1b27c7b&page=queryresults
[0m15:51:44.082925 [debug] [Thread-1 (]: BigQuery adapter: Unhandled error while running:
macro collect_freshness
[0m15:51:44.083810 [debug] [Thread-1 (]: BigQuery adapter: Database Error
  Unrecognized name: created_at at [3:11]
[0m15:51:44.084895 [debug] [Thread-1 (]: Timing info for source.coffee_shop.coffee_shop.customers (execute): 2023-02-17 15:51:42.989735 => 2023-02-17 15:51:44.084816
[0m15:51:44.091280 [debug] [Thread-1 (]: Database Error in source customers (models/schema.yml)
  Unrecognized name: created_at at [3:11]
[0m15:51:44.091818 [error] [Thread-1 (]: 1 of 1 ERROR freshness of coffee_shop.customers ................................ [[31mERROR[0m in 1.10s]
[0m15:51:44.093588 [debug] [Thread-1 (]: Finished running node source.coffee_shop.coffee_shop.customers
[0m15:51:44.095257 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:51:44.095574 [debug] [MainThread]: Connection 'source.coffee_shop.coffee_shop.customers' was properly closed.
[0m15:51:44.102890 [info ] [MainThread]: 
[0m15:51:44.103443 [error] [MainThread]: [33mDatabase Error in source customers (models/schema.yml)[0m
[0m15:51:44.103915 [error] [MainThread]:   Unrecognized name: created_at at [3:11]
[0m15:51:44.104337 [info ] [MainThread]: Done.
[0m15:51:44.105195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a2941f970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a2940d540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a2940d510>]}
[0m15:51:44.105581 [debug] [MainThread]: Flushing usage events


============================== 2023-03-03 13:46:51.420503 | 7d86db6f-7009-4169-bfa9-91db3d45284a ==============================
[0m13:46:51.420503 [info ] [MainThread]: Running with dbt=1.4.1
[0m13:46:51.427748 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:46:51.428127 [debug] [MainThread]: Tracking: tracking
[0m13:46:51.438259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb84c15b700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb84c159a80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb84c15b730>]}
[0m13:46:51.607307 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 4 files added, 2 files changed.
[0m13:46:51.607883 [debug] [MainThread]: Partial parsing: added file: coffee_shop://models/product_prices.sql
[0m13:46:51.608236 [debug] [MainThread]: Partial parsing: added file: coffee_shop://models/products.sql
[0m13:46:51.608534 [debug] [MainThread]: Partial parsing: added file: coffee_shop://models/order_items.sql
[0m13:46:51.608815 [debug] [MainThread]: Partial parsing: added file: coffee_shop://models/orders.sql
[0m13:46:51.609293 [debug] [MainThread]: Partial parsing: updated file: coffee_shop://models/schema.yml
[0m13:46:51.609531 [debug] [MainThread]: Partial parsing: deleted file: coffee_shop://models/customers_ref.sql
[0m13:46:51.609856 [debug] [MainThread]: Partial parsing: updated file: coffee_shop://models/customers.sql
[0m13:46:51.623386 [debug] [MainThread]: 1699: static parser successfully parsed product_prices.sql
[0m13:46:51.640010 [debug] [MainThread]: 1699: static parser successfully parsed products.sql
[0m13:46:51.642843 [debug] [MainThread]: 1699: static parser successfully parsed order_items.sql
[0m13:46:51.645564 [debug] [MainThread]: 1699: static parser successfully parsed orders.sql
[0m13:46:51.649294 [debug] [MainThread]: 1699: static parser successfully parsed customers.sql
[0m13:46:51.738638 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffe_shop_milan.example
[0m13:46:51.744303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7d86db6f-7009-4169-bfa9-91db3d45284a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb84c0e28f0>]}
[0m13:46:51.754740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7d86db6f-7009-4169-bfa9-91db3d45284a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb84c103ee0>]}
[0m13:46:51.755289 [info ] [MainThread]: Found 7 models, 9 tests, 0 snapshots, 0 analyses, 334 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m13:46:51.755773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7d86db6f-7009-4169-bfa9-91db3d45284a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb84c103fa0>]}
[0m13:46:51.757919 [info ] [MainThread]: 
[0m13:46:51.759930 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:46:51.761325 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m13:46:51.761744 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:46:54.715302 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_milan'
[0m13:46:54.715778 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:46:55.026729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7d86db6f-7009-4169-bfa9-91db3d45284a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb84c4583a0>]}
[0m13:46:55.028552 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m13:46:55.029190 [info ] [MainThread]: 
[0m13:46:55.053082 [debug] [Thread-1 (]: Began running node model.coffee_shop.customers
[0m13:46:55.053701 [debug] [Thread-2 (]: Began running node model.coffee_shop.my_first_dbt_model
[0m13:46:55.053981 [debug] [Thread-3 (]: Began running node model.coffee_shop.order_items
[0m13:46:55.054253 [debug] [Thread-4 (]: Began running node model.coffee_shop.orders
[0m13:46:55.054630 [debug] [Thread-5 (]: Began running node model.coffee_shop.product_prices
[0m13:46:55.054969 [debug] [Thread-6 (]: Began running node model.coffee_shop.products
[0m13:46:55.059121 [info ] [Thread-6 (]: 6 of 7 START sql table model dbt_milan.products ................................ [RUN]
[0m13:46:55.056240 [info ] [Thread-2 (]: 2 of 7 START sql table model dbt_milan.my_first_dbt_model ...................... [RUN]
[0m13:46:55.056795 [info ] [Thread-3 (]: 3 of 7 START sql table model dbt_milan.order_items ............................. [RUN]
[0m13:46:55.057613 [info ] [Thread-4 (]: 4 of 7 START sql table model dbt_milan.orders .................................. [RUN]
[0m13:46:55.062391 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.coffee_shop.orders'
[0m13:46:55.060305 [debug] [Thread-6 (]: Acquiring new bigquery connection 'model.coffee_shop.products'
[0m13:46:55.063082 [debug] [Thread-6 (]: Began compiling node model.coffee_shop.products
[0m13:46:55.060952 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.coffee_shop.my_first_dbt_model'
[0m13:46:55.061809 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.coffee_shop.order_items'
[0m13:46:55.062685 [debug] [Thread-4 (]: Began compiling node model.coffee_shop.orders
[0m13:46:55.070797 [debug] [Thread-4 (]: Writing injected SQL for node "model.coffee_shop.orders"
[0m13:46:55.055520 [info ] [Thread-1 (]: 1 of 7 START sql table model dbt_milan.customers ............................... [RUN]
[0m13:46:55.071884 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop.customers'
[0m13:46:55.067236 [debug] [Thread-2 (]: Began compiling node model.coffee_shop.my_first_dbt_model
[0m13:46:55.067559 [debug] [Thread-3 (]: Began compiling node model.coffee_shop.order_items
[0m13:46:55.071265 [debug] [Thread-4 (]: Timing info for model.coffee_shop.orders (compile): 2023-03-03 13:46:55.068572 => 2023-03-03 13:46:55.071179
[0m13:46:55.077714 [debug] [Thread-4 (]: Began executing node model.coffee_shop.orders
[0m13:46:55.072189 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.customers
[0m13:46:55.066879 [debug] [Thread-6 (]: Writing injected SQL for node "model.coffee_shop.products"
[0m13:46:55.074548 [debug] [Thread-2 (]: Writing injected SQL for node "model.coffee_shop.my_first_dbt_model"
[0m13:46:55.076840 [debug] [Thread-3 (]: Writing injected SQL for node "model.coffee_shop.order_items"
[0m13:46:55.058376 [info ] [Thread-5 (]: 5 of 7 START sql table model dbt_milan.product_prices .......................... [RUN]
[0m13:46:55.117242 [debug] [Thread-5 (]: Acquiring new bigquery connection 'model.coffee_shop.product_prices'
[0m13:46:55.115666 [debug] [Thread-4 (]: Writing runtime sql for node "model.coffee_shop.orders"
[0m13:46:55.116540 [debug] [Thread-2 (]: Timing info for model.coffee_shop.my_first_dbt_model (compile): 2023-03-03 13:46:55.072391 => 2023-03-03 13:46:55.116450
[0m13:46:55.118731 [debug] [Thread-2 (]: Began executing node model.coffee_shop.my_first_dbt_model
[0m13:46:55.117697 [debug] [Thread-5 (]: Began compiling node model.coffee_shop.product_prices
[0m13:46:55.100636 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.customers"
[0m13:46:55.124461 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (compile): 2023-03-03 13:46:55.098611 => 2023-03-03 13:46:55.124391
[0m13:46:55.121584 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:46:55.118192 [debug] [Thread-3 (]: Timing info for model.coffee_shop.order_items (compile): 2023-03-03 13:46:55.074834 => 2023-03-03 13:46:55.118108
[0m13:46:55.123904 [debug] [Thread-5 (]: Writing injected SQL for node "model.coffee_shop.product_prices"
[0m13:46:55.127833 [debug] [Thread-5 (]: Timing info for model.coffee_shop.product_prices (compile): 2023-03-03 13:46:55.121884 => 2023-03-03 13:46:55.127765
[0m13:46:55.128196 [debug] [Thread-5 (]: Began executing node model.coffee_shop.product_prices
[0m13:46:55.126293 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:46:55.131438 [debug] [Thread-4 (]: On model.coffee_shop.orders: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.orders"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`orders`
    
    
    OPTIONS()
    as (
      

select * from `analytics-engineers-club.coffee_shop.orders`
    );
  
[0m13:46:55.130767 [debug] [Thread-5 (]: Writing runtime sql for node "model.coffee_shop.product_prices"
[0m13:46:55.118410 [debug] [Thread-6 (]: Timing info for model.coffee_shop.products (compile): 2023-03-03 13:46:55.063460 => 2023-03-03 13:46:55.118370
[0m13:46:55.133955 [debug] [Thread-6 (]: Began executing node model.coffee_shop.products
[0m13:46:55.127345 [debug] [Thread-3 (]: Began executing node model.coffee_shop.order_items
[0m13:46:55.124785 [debug] [Thread-1 (]: Began executing node model.coffee_shop.customers
[0m13:46:55.134456 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m13:46:55.138300 [debug] [Thread-6 (]: Writing runtime sql for node "model.coffee_shop.products"
[0m13:46:55.146826 [debug] [Thread-6 (]: Opening a new connection, currently in state init
[0m13:46:55.142205 [debug] [Thread-3 (]: Writing runtime sql for node "model.coffee_shop.order_items"
[0m13:46:55.147714 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:46:55.147209 [debug] [Thread-6 (]: On model.coffee_shop.products: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.products"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`products`
    
    
    OPTIONS()
    as (
      

select * from `analytics-engineers-club.coffee_shop.products`
    );
  
[0m13:46:55.145034 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:46:55.148039 [debug] [Thread-3 (]: On model.coffee_shop.order_items: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.order_items"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`order_items`
    
    
    OPTIONS()
    as (
      

select * from `analytics-engineers-club.coffee_shop.order_items`
    );
  
[0m13:46:55.146314 [debug] [Thread-5 (]: On model.coffee_shop.product_prices: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.product_prices"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`product_prices`
    
    
    OPTIONS()
    as (
      

select * from `analytics-engineers-club.coffee_shop.product_prices`
    );
  
[0m13:46:55.847549 [debug] [Thread-2 (]: Writing runtime sql for node "model.coffee_shop.my_first_dbt_model"
[0m13:46:55.848242 [debug] [Thread-2 (]: On model.coffee_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.my_first_dbt_model"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`my_first_dbt_model`
    
    
    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m13:46:55.852619 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop.customers"
[0m13:46:55.853178 [debug] [Thread-1 (]: On model.coffee_shop.customers: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.customers"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`customers`
    
    
    OPTIONS()
    as (
      

select * from `analytics-engineers-club.coffee_shop.customers`
    );
  
[0m13:46:57.924117 [debug] [Thread-5 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:6afd272c-2ac6-48da-826d-5b826bade582&page=queryresults
[0m13:46:57.939402 [debug] [Thread-5 (]: Timing info for model.coffee_shop.product_prices (execute): 2023-03-03 13:46:55.128366 => 2023-03-03 13:46:57.939342
[0m13:46:57.940183 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d86db6f-7009-4169-bfa9-91db3d45284a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb84814c640>]}
[0m13:46:57.940706 [info ] [Thread-5 (]: 5 of 7 OK created sql table model dbt_milan.product_prices ..................... [[32mCREATE TABLE (15.0 rows, 600.0 Bytes processed)[0m in 2.82s]
[0m13:46:57.942609 [debug] [Thread-5 (]: Finished running node model.coffee_shop.product_prices
[0m13:46:58.058452 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:1d04e794-8169-47a4-af18-1fefa52d9748&page=queryresults
[0m13:46:58.062681 [debug] [Thread-2 (]: Timing info for model.coffee_shop.my_first_dbt_model (execute): 2023-03-03 13:46:55.118938 => 2023-03-03 13:46:58.062620
[0m13:46:58.063440 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d86db6f-7009-4169-bfa9-91db3d45284a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb84814dc00>]}
[0m13:46:58.063950 [info ] [Thread-2 (]: 2 of 7 OK created sql table model dbt_milan.my_first_dbt_model ................. [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 3.00s]
[0m13:46:58.064613 [debug] [Thread-2 (]: Finished running node model.coffee_shop.my_first_dbt_model
[0m13:46:58.065238 [debug] [Thread-8 (]: Began running node model.coffee_shop.my_second_dbt_model
[0m13:46:58.065680 [info ] [Thread-8 (]: 7 of 7 START sql view model dbt_milan.my_second_dbt_model ...................... [RUN]
[0m13:46:58.066876 [debug] [Thread-8 (]: Acquiring new bigquery connection 'model.coffee_shop.my_second_dbt_model'
[0m13:46:58.067187 [debug] [Thread-8 (]: Began compiling node model.coffee_shop.my_second_dbt_model
[0m13:46:58.070712 [debug] [Thread-8 (]: Writing injected SQL for node "model.coffee_shop.my_second_dbt_model"
[0m13:46:58.071271 [debug] [Thread-8 (]: Timing info for model.coffee_shop.my_second_dbt_model (compile): 2023-03-03 13:46:58.067379 => 2023-03-03 13:46:58.071193
[0m13:46:58.071599 [debug] [Thread-8 (]: Began executing node model.coffee_shop.my_second_dbt_model
[0m13:46:58.091168 [debug] [Thread-8 (]: Writing runtime sql for node "model.coffee_shop.my_second_dbt_model"
[0m13:46:58.094691 [debug] [Thread-8 (]: Opening a new connection, currently in state init
[0m13:46:58.095100 [debug] [Thread-8 (]: On model.coffee_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.my_second_dbt_model"} */


  create or replace view `aec-students`.`dbt_milan`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `aec-students`.`dbt_milan`.`my_first_dbt_model`
where id = 1;


[0m13:46:58.308438 [debug] [Thread-6 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:45532e1f-807d-4ae9-8c7d-1e2d06e2079c&page=queryresults
[0m13:46:58.310207 [debug] [Thread-6 (]: Timing info for model.coffee_shop.products (execute): 2023-03-03 13:46:55.135949 => 2023-03-03 13:46:58.310147
[0m13:46:58.310958 [debug] [Thread-6 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d86db6f-7009-4169-bfa9-91db3d45284a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb84c121480>]}
[0m13:46:58.311478 [info ] [Thread-6 (]: 6 of 7 OK created sql table model dbt_milan.products ........................... [[32mCREATE TABLE (7.0 rows, 278.0 Bytes processed)[0m in 3.25s]
[0m13:46:58.311965 [debug] [Thread-6 (]: Finished running node model.coffee_shop.products
[0m13:46:58.864147 [debug] [Thread-8 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:e6be2442-29e4-4943-80a0-85d2cb38c471&page=queryresults
[0m13:46:58.868314 [debug] [Thread-8 (]: Timing info for model.coffee_shop.my_second_dbt_model (execute): 2023-03-03 13:46:58.071793 => 2023-03-03 13:46:58.868254
[0m13:46:58.869091 [debug] [Thread-8 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d86db6f-7009-4169-bfa9-91db3d45284a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb84814d8d0>]}
[0m13:46:58.869584 [info ] [Thread-8 (]: 7 of 7 OK created sql view model dbt_milan.my_second_dbt_model ................. [[32mCREATE VIEW (0 processed)[0m in 0.80s]
[0m13:46:58.870346 [debug] [Thread-8 (]: Finished running node model.coffee_shop.my_second_dbt_model
[0m13:46:59.889111 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:e486530f-369c-41b0-9d97-7e0168f81fc2&page=queryresults
[0m13:46:59.891071 [debug] [Thread-1 (]: Timing info for model.coffee_shop.customers (execute): 2023-03-03 13:46:55.142550 => 2023-03-03 13:46:59.891012
[0m13:46:59.891778 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d86db6f-7009-4169-bfa9-91db3d45284a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb84c1253c0>]}
[0m13:46:59.892271 [info ] [Thread-1 (]: 1 of 7 OK created sql table model dbt_milan.customers .......................... [[32mCREATE TABLE (174.4k rows, 12.8 MB processed)[0m in 4.82s]
[0m13:46:59.892930 [debug] [Thread-1 (]: Finished running node model.coffee_shop.customers
[0m13:47:00.434994 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:127b3152-fe26-4761-a797-41703cb8daa0&page=queryresults
[0m13:47:00.436673 [debug] [Thread-4 (]: Timing info for model.coffee_shop.orders (execute): 2023-03-03 13:46:55.077913 => 2023-03-03 13:47:00.436614
[0m13:47:00.437481 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d86db6f-7009-4169-bfa9-91db3d45284a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb84c10a350>]}
[0m13:47:00.438019 [info ] [Thread-4 (]: 4 of 7 OK created sql table model dbt_milan.orders ............................. [[32mCREATE TABLE (192.0k rows, 24.7 MB processed)[0m in 5.38s]
[0m13:47:00.438499 [debug] [Thread-4 (]: Finished running node model.coffee_shop.orders
[0m13:47:00.729903 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:d9fbed57-2065-4a1f-9655-6a92538897ab&page=queryresults
[0m13:47:00.731612 [debug] [Thread-3 (]: Timing info for model.coffee_shop.order_items (execute): 2023-03-03 13:46:55.138584 => 2023-03-03 13:47:00.731553
[0m13:47:00.732372 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d86db6f-7009-4169-bfa9-91db3d45284a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb84ba6fd30>]}
[0m13:47:00.732865 [info ] [Thread-3 (]: 3 of 7 OK created sql table model dbt_milan.order_items ........................ [[32mCREATE TABLE (383.8k rows, 30.7 MB processed)[0m in 5.67s]
[0m13:47:00.733424 [debug] [Thread-3 (]: Finished running node model.coffee_shop.order_items
[0m13:47:00.735726 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:47:00.736301 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:47:00.736552 [debug] [MainThread]: Connection 'model.coffee_shop.customers' was properly closed.
[0m13:47:00.736781 [debug] [MainThread]: Connection 'model.coffee_shop.products' was properly closed.
[0m13:47:00.736990 [debug] [MainThread]: Connection 'model.coffee_shop.my_first_dbt_model' was properly closed.
[0m13:47:00.737199 [debug] [MainThread]: Connection 'model.coffee_shop.order_items' was properly closed.
[0m13:47:00.737403 [debug] [MainThread]: Connection 'model.coffee_shop.orders' was properly closed.
[0m13:47:00.737601 [debug] [MainThread]: Connection 'model.coffee_shop.product_prices' was properly closed.
[0m13:47:00.737828 [debug] [MainThread]: Connection 'model.coffee_shop.my_second_dbt_model' was properly closed.
[0m13:47:00.738121 [info ] [MainThread]: 
[0m13:47:00.738646 [info ] [MainThread]: Finished running 6 table models, 1 view model in 0 hours 0 minutes and 8.98 seconds (8.98s).
[0m13:47:00.739414 [debug] [MainThread]: Command end result
[0m13:47:00.748030 [info ] [MainThread]: 
[0m13:47:00.748504 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:47:00.748931 [info ] [MainThread]: 
[0m13:47:00.749342 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m13:47:00.749870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb84c0e2950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb84c102f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb84c103ca0>]}
[0m13:47:00.750392 [debug] [MainThread]: Flushing usage events


============================== 2023-03-08 18:23:37.806152 | 4de2528d-fbe7-4b5a-a169-d4a659219f36 ==============================
[0m18:23:37.806152 [info ] [MainThread]: Running with dbt=1.4.1
[0m18:23:37.809081 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:23:37.809669 [debug] [MainThread]: Tracking: tracking
[0m18:23:37.815096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f960f75b850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f960f759ae0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f960f75be20>]}
[0m18:23:37.986210 [debug] [MainThread]: Partial parsing enabled: 6 files deleted, 6 files added, 0 files changed.
[0m18:23:37.986865 [debug] [MainThread]: Partial parsing: added file: coffee_shop://models/staging/coffee_shop/stg_coffee_shop_product_prices.sql
[0m18:23:37.987332 [debug] [MainThread]: Partial parsing: added file: coffee_shop://models/staging/coffee_shop/stg_coffee_shop_sources.yml
[0m18:23:37.987659 [debug] [MainThread]: Partial parsing: added file: coffee_shop://models/staging/coffee_shop/stg_coffee_shop_products.sql
[0m18:23:37.987968 [debug] [MainThread]: Partial parsing: added file: coffee_shop://models/staging/coffee_shop/stg_coffee_shop_orders.sql
[0m18:23:37.988284 [debug] [MainThread]: Partial parsing: added file: coffee_shop://models/staging/coffee_shop/stg_coffee_shop_order_items.sql
[0m18:23:37.988589 [debug] [MainThread]: Partial parsing: added file: coffee_shop://models/staging/coffee_shop/stg_coffee_shop_customers.sql
[0m18:23:37.988965 [debug] [MainThread]: Partial parsing: deleted file: coffee_shop://models/order_items.sql
[0m18:23:37.989219 [debug] [MainThread]: Partial parsing: deleted file: coffee_shop://models/products.sql
[0m18:23:37.989459 [debug] [MainThread]: Partial parsing: deleted file: coffee_shop://models/orders.sql
[0m18:23:37.989707 [debug] [MainThread]: Partial parsing: deleted file: coffee_shop://models/customers.sql
[0m18:23:37.989938 [debug] [MainThread]: Partial parsing: deleted file: coffee_shop://models/product_prices.sql
[0m18:23:38.004118 [debug] [MainThread]: 1699: static parser successfully parsed staging/coffee_shop/stg_coffee_shop_product_prices.sql
[0m18:23:38.019908 [debug] [MainThread]: 1699: static parser successfully parsed staging/coffee_shop/stg_coffee_shop_products.sql
[0m18:23:38.022897 [debug] [MainThread]: 1699: static parser successfully parsed staging/coffee_shop/stg_coffee_shop_orders.sql
[0m18:23:38.025789 [debug] [MainThread]: 1699: static parser successfully parsed staging/coffee_shop/stg_coffee_shop_order_items.sql
[0m18:23:38.028782 [debug] [MainThread]: 1699: static parser successfully parsed staging/coffee_shop/stg_coffee_shop_customers.sql
[0m18:23:38.038644 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'customers' in the 'models' section of file 'models/staging/coffee_shop/stg_coffee_shop_sources.yml'
[0m18:23:38.131664 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.coffee_shop.unique_customers_id.70f3d3fd20' (models/staging/coffee_shop/stg_coffee_shop_sources.yml) depends on a node named 'customers' in package '' which was not found
[0m18:23:38.132457 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.coffee_shop.not_null_customers_id.422908bfae' (models/staging/coffee_shop/stg_coffee_shop_sources.yml) depends on a node named 'customers' in package '' which was not found
[0m18:23:38.139861 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffe_shop_milan.example
[0m18:23:38.147645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4de2528d-fbe7-4b5a-a169-d4a659219f36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f960f728070>]}
[0m18:23:38.157856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4de2528d-fbe7-4b5a-a169-d4a659219f36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f960f70f940>]}
[0m18:23:38.158320 [info ] [MainThread]: Found 7 models, 7 tests, 0 snapshots, 0 analyses, 334 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m18:23:38.158747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4de2528d-fbe7-4b5a-a169-d4a659219f36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f960f6ea8f0>]}
[0m18:23:38.160613 [info ] [MainThread]: 
[0m18:23:38.162782 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:23:38.164518 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m18:23:38.166640 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:23:41.272729 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_milan'
[0m18:23:41.273390 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:23:41.576141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4de2528d-fbe7-4b5a-a169-d4a659219f36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96119ef3a0>]}
[0m18:23:41.577180 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m18:23:41.578156 [info ] [MainThread]: 
[0m18:23:41.603919 [debug] [Thread-1 (]: Began running node model.coffee_shop.my_first_dbt_model
[0m18:23:41.604799 [debug] [Thread-2 (]: Began running node model.coffee_shop.stg_coffee_shop_customers
[0m18:23:41.605188 [debug] [Thread-3 (]: Began running node model.coffee_shop.stg_coffee_shop_order_items
[0m18:23:41.605809 [debug] [Thread-4 (]: Began running node model.coffee_shop.stg_coffee_shop_orders
[0m18:23:41.606163 [debug] [Thread-5 (]: Began running node model.coffee_shop.stg_coffee_shop_product_prices
[0m18:23:41.607112 [debug] [Thread-6 (]: Began running node model.coffee_shop.stg_coffee_shop_products
[0m18:23:41.606831 [info ] [Thread-1 (]: 1 of 7 START sql table model dbt_milan.my_first_dbt_model ...................... [RUN]
[0m18:23:41.607672 [info ] [Thread-2 (]: 2 of 7 START sql table model dbt_milan.stg_coffee_shop_customers ............... [RUN]
[0m18:23:41.608794 [info ] [Thread-4 (]: 4 of 7 START sql table model dbt_milan.stg_coffee_shop_orders .................. [RUN]
[0m18:23:41.613784 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.coffee_shop.stg_coffee_shop_orders'
[0m18:23:41.610428 [info ] [Thread-6 (]: 6 of 7 START sql table model dbt_milan.stg_coffee_shop_products ................ [RUN]
[0m18:23:41.612639 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.coffee_shop.stg_coffee_shop_customers'
[0m18:23:41.615081 [debug] [Thread-2 (]: Began compiling node model.coffee_shop.stg_coffee_shop_customers
[0m18:23:41.609513 [info ] [Thread-5 (]: 5 of 7 START sql table model dbt_milan.stg_coffee_shop_product_prices .......... [RUN]
[0m18:23:41.614103 [debug] [Thread-4 (]: Began compiling node model.coffee_shop.stg_coffee_shop_orders
[0m18:23:41.621812 [debug] [Thread-4 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop_orders"
[0m18:23:41.614714 [debug] [Thread-6 (]: Acquiring new bigquery connection 'model.coffee_shop.stg_coffee_shop_products'
[0m18:23:41.622754 [debug] [Thread-6 (]: Began compiling node model.coffee_shop.stg_coffee_shop_products
[0m18:23:41.617962 [debug] [Thread-2 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop_customers"
[0m18:23:41.618618 [debug] [Thread-5 (]: Acquiring new bigquery connection 'model.coffee_shop.stg_coffee_shop_product_prices'
[0m18:23:41.622436 [debug] [Thread-4 (]: Timing info for model.coffee_shop.stg_coffee_shop_orders (compile): 2023-03-08 18:23:41.619282 => 2023-03-08 18:23:41.622337
[0m18:23:41.608054 [info ] [Thread-3 (]: 3 of 7 START sql table model dbt_milan.stg_coffee_shop_order_items ............. [RUN]
[0m18:23:41.627071 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.coffee_shop.stg_coffee_shop_order_items'
[0m18:23:41.627394 [debug] [Thread-3 (]: Began compiling node model.coffee_shop.stg_coffee_shop_order_items
[0m18:23:41.625824 [debug] [Thread-5 (]: Began compiling node model.coffee_shop.stg_coffee_shop_product_prices
[0m18:23:41.632921 [debug] [Thread-5 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop_product_prices"
[0m18:23:41.633380 [debug] [Thread-5 (]: Timing info for model.coffee_shop.stg_coffee_shop_product_prices (compile): 2023-03-08 18:23:41.630789 => 2023-03-08 18:23:41.633309
[0m18:23:41.630530 [debug] [Thread-3 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop_order_items"
[0m18:23:41.634128 [debug] [Thread-3 (]: Timing info for model.coffee_shop.stg_coffee_shop_order_items (compile): 2023-03-08 18:23:41.627596 => 2023-03-08 18:23:41.634046
[0m18:23:41.634504 [debug] [Thread-3 (]: Began executing node model.coffee_shop.stg_coffee_shop_order_items
[0m18:23:41.633689 [debug] [Thread-5 (]: Began executing node model.coffee_shop.stg_coffee_shop_product_prices
[0m18:23:41.626201 [debug] [Thread-2 (]: Timing info for model.coffee_shop.stg_coffee_shop_customers (compile): 2023-03-08 18:23:41.615298 => 2023-03-08 18:23:41.626130
[0m18:23:41.626467 [debug] [Thread-4 (]: Began executing node model.coffee_shop.stg_coffee_shop_orders
[0m18:23:41.625295 [debug] [Thread-6 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop_products"
[0m18:23:41.690323 [debug] [Thread-6 (]: Timing info for model.coffee_shop.stg_coffee_shop_products (compile): 2023-03-08 18:23:41.622959 => 2023-03-08 18:23:41.690235
[0m18:23:41.684926 [debug] [Thread-3 (]: Writing runtime sql for node "model.coffee_shop.stg_coffee_shop_order_items"
[0m18:23:41.686439 [debug] [Thread-5 (]: Writing runtime sql for node "model.coffee_shop.stg_coffee_shop_product_prices"
[0m18:23:41.686792 [debug] [Thread-2 (]: Began executing node model.coffee_shop.stg_coffee_shop_customers
[0m18:23:41.689793 [debug] [Thread-4 (]: Writing runtime sql for node "model.coffee_shop.stg_coffee_shop_orders"
[0m18:23:41.690645 [debug] [Thread-6 (]: Began executing node model.coffee_shop.stg_coffee_shop_products
[0m18:23:41.611389 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop.my_first_dbt_model'
[0m18:23:41.698135 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.my_first_dbt_model
[0m18:23:41.694599 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:23:41.697727 [debug] [Thread-6 (]: Writing runtime sql for node "model.coffee_shop.stg_coffee_shop_products"
[0m18:23:41.702612 [debug] [Thread-6 (]: Opening a new connection, currently in state init
[0m18:23:41.703045 [debug] [Thread-6 (]: On model.coffee_shop.stg_coffee_shop_products: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.stg_coffee_shop_products"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`stg_coffee_shop_products`
    
    
    OPTIONS()
    as (
      

select * from `analytics-engineers-club.coffee_shop.products`
    );
  
[0m18:23:41.700683 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.my_first_dbt_model"
[0m18:23:41.705384 [debug] [Thread-1 (]: Timing info for model.coffee_shop.my_first_dbt_model (compile): 2023-03-08 18:23:41.698423 => 2023-03-08 18:23:41.705282
[0m18:23:41.702145 [debug] [Thread-4 (]: On model.coffee_shop.stg_coffee_shop_orders: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.stg_coffee_shop_orders"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`stg_coffee_shop_orders`
    
    
    OPTIONS()
    as (
      

select * from `analytics-engineers-club.coffee_shop.orders`
    );
  
[0m18:23:41.694031 [debug] [Thread-2 (]: Writing runtime sql for node "model.coffee_shop.stg_coffee_shop_customers"
[0m18:23:41.708337 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:23:41.705961 [debug] [Thread-1 (]: Began executing node model.coffee_shop.my_first_dbt_model
[0m18:23:41.701043 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:23:41.711675 [debug] [Thread-3 (]: On model.coffee_shop.stg_coffee_shop_order_items: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.stg_coffee_shop_order_items"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`stg_coffee_shop_order_items`
    
    
    OPTIONS()
    as (
      

select * from `analytics-engineers-club.coffee_shop.order_items`
    );
  
[0m18:23:41.711173 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:23:41.701466 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m18:23:41.708778 [debug] [Thread-2 (]: On model.coffee_shop.stg_coffee_shop_customers: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.stg_coffee_shop_customers"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`stg_coffee_shop_customers`
    
    
    OPTIONS()
    as (
      

select * from `analytics-engineers-club.coffee_shop.customers`
    );
  
[0m18:23:41.716197 [debug] [Thread-5 (]: On model.coffee_shop.stg_coffee_shop_product_prices: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.stg_coffee_shop_product_prices"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`stg_coffee_shop_product_prices`
    
    
    OPTIONS()
    as (
      

select * from `analytics-engineers-club.coffee_shop.product_prices`
    );
  
[0m18:23:42.357069 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop.my_first_dbt_model"
[0m18:23:42.358227 [debug] [Thread-1 (]: On model.coffee_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.my_first_dbt_model"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`my_first_dbt_model`
    
    
    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m18:23:44.554776 [debug] [Thread-5 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:21357486-3fd4-4999-8859-a523d3c2dab2&page=queryresults
[0m18:23:44.570676 [debug] [Thread-5 (]: Timing info for model.coffee_shop.stg_coffee_shop_product_prices (execute): 2023-03-08 18:23:41.655625 => 2023-03-08 18:23:44.570604
[0m18:23:44.571560 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4de2528d-fbe7-4b5a-a169-d4a659219f36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f960f718d00>]}
[0m18:23:44.572163 [info ] [Thread-5 (]: 5 of 7 OK created sql table model dbt_milan.stg_coffee_shop_product_prices ..... [[32mCREATE TABLE (15.0 rows, 600.0 Bytes processed)[0m in 2.95s]
[0m18:23:44.574433 [debug] [Thread-5 (]: Finished running node model.coffee_shop.stg_coffee_shop_product_prices
[0m18:23:44.620106 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:638754ec-4ba9-4149-b13e-4068612bd2fb&page=queryresults
[0m18:23:44.625333 [debug] [Thread-1 (]: Timing info for model.coffee_shop.my_first_dbt_model (execute): 2023-03-08 18:23:41.709102 => 2023-03-08 18:23:44.625267
[0m18:23:44.626085 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4de2528d-fbe7-4b5a-a169-d4a659219f36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f960f10f1c0>]}
[0m18:23:44.626613 [info ] [Thread-1 (]: 1 of 7 OK created sql table model dbt_milan.my_first_dbt_model ................. [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 3.02s]
[0m18:23:44.627389 [debug] [Thread-1 (]: Finished running node model.coffee_shop.my_first_dbt_model
[0m18:23:44.628073 [debug] [Thread-8 (]: Began running node model.coffee_shop.my_second_dbt_model
[0m18:23:44.628504 [info ] [Thread-8 (]: 7 of 7 START sql view model dbt_milan.my_second_dbt_model ...................... [RUN]
[0m18:23:44.629311 [debug] [Thread-8 (]: Acquiring new bigquery connection 'model.coffee_shop.my_second_dbt_model'
[0m18:23:44.629643 [debug] [Thread-8 (]: Began compiling node model.coffee_shop.my_second_dbt_model
[0m18:23:44.632444 [debug] [Thread-8 (]: Writing injected SQL for node "model.coffee_shop.my_second_dbt_model"
[0m18:23:44.632954 [debug] [Thread-8 (]: Timing info for model.coffee_shop.my_second_dbt_model (compile): 2023-03-08 18:23:44.629855 => 2023-03-08 18:23:44.632870
[0m18:23:44.633371 [debug] [Thread-8 (]: Began executing node model.coffee_shop.my_second_dbt_model
[0m18:23:44.653719 [debug] [Thread-8 (]: Writing runtime sql for node "model.coffee_shop.my_second_dbt_model"
[0m18:23:44.654308 [debug] [Thread-8 (]: Opening a new connection, currently in state init
[0m18:23:44.654757 [debug] [Thread-8 (]: On model.coffee_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.my_second_dbt_model"} */


  create or replace view `aec-students`.`dbt_milan`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `aec-students`.`dbt_milan`.`my_first_dbt_model`
where id = 1;


[0m18:23:44.816074 [debug] [Thread-6 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:a8ae0923-dbe8-4c0a-b858-66aa430e0352&page=queryresults
[0m18:23:44.818134 [debug] [Thread-6 (]: Timing info for model.coffee_shop.stg_coffee_shop_products (execute): 2023-03-08 18:23:41.694975 => 2023-03-08 18:23:44.818066
[0m18:23:44.819048 [debug] [Thread-6 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4de2528d-fbe7-4b5a-a169-d4a659219f36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f960f5783d0>]}
[0m18:23:44.819658 [info ] [Thread-6 (]: 6 of 7 OK created sql table model dbt_milan.stg_coffee_shop_products ........... [[32mCREATE TABLE (7.0 rows, 278.0 Bytes processed)[0m in 3.20s]
[0m18:23:44.820301 [debug] [Thread-6 (]: Finished running node model.coffee_shop.stg_coffee_shop_products
[0m18:23:45.470259 [debug] [Thread-8 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:808a1a1b-8676-40c5-9c04-5554fb696978&page=queryresults
[0m18:23:45.472672 [debug] [Thread-8 (]: Timing info for model.coffee_shop.my_second_dbt_model (execute): 2023-03-08 18:23:44.633639 => 2023-03-08 18:23:45.472607
[0m18:23:45.473554 [debug] [Thread-8 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4de2528d-fbe7-4b5a-a169-d4a659219f36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f960f7197e0>]}
[0m18:23:45.474109 [info ] [Thread-8 (]: 7 of 7 OK created sql view model dbt_milan.my_second_dbt_model ................. [[32mCREATE VIEW (0 processed)[0m in 0.84s]
[0m18:23:45.474655 [debug] [Thread-8 (]: Finished running node model.coffee_shop.my_second_dbt_model
[0m18:23:46.104402 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:2b6d6f8a-3a4d-485e-9495-cecea5e94f52&page=queryresults
[0m18:23:46.106725 [debug] [Thread-2 (]: Timing info for model.coffee_shop.stg_coffee_shop_customers (execute): 2023-03-08 18:23:41.691497 => 2023-03-08 18:23:46.106655
[0m18:23:46.107563 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4de2528d-fbe7-4b5a-a169-d4a659219f36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f960f7401c0>]}
[0m18:23:46.108105 [info ] [Thread-2 (]: 2 of 7 OK created sql table model dbt_milan.stg_coffee_shop_customers .......... [[32mCREATE TABLE (174.4k rows, 12.8 MB processed)[0m in 4.50s]
[0m18:23:46.108915 [debug] [Thread-2 (]: Finished running node model.coffee_shop.stg_coffee_shop_customers
[0m18:23:46.691123 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:0b26a224-9f84-4303-958e-e5de349affd9&page=queryresults
[0m18:23:46.693609 [debug] [Thread-4 (]: Timing info for model.coffee_shop.stg_coffee_shop_orders (execute): 2023-03-08 18:23:41.687072 => 2023-03-08 18:23:46.693530
[0m18:23:46.694699 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4de2528d-fbe7-4b5a-a169-d4a659219f36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f960f72bc70>]}
[0m18:23:46.695425 [info ] [Thread-4 (]: 4 of 7 OK created sql table model dbt_milan.stg_coffee_shop_orders ............. [[32mCREATE TABLE (192.0k rows, 24.7 MB processed)[0m in 5.08s]
[0m18:23:46.696437 [debug] [Thread-4 (]: Finished running node model.coffee_shop.stg_coffee_shop_orders
[0m18:23:47.540303 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:4dc010db-0066-430b-8bfb-b28450634a26&page=queryresults
[0m18:23:47.542740 [debug] [Thread-3 (]: Timing info for model.coffee_shop.stg_coffee_shop_order_items (execute): 2023-03-08 18:23:41.634796 => 2023-03-08 18:23:47.542661
[0m18:23:47.543829 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4de2528d-fbe7-4b5a-a169-d4a659219f36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f960f72b520>]}
[0m18:23:47.544539 [info ] [Thread-3 (]: 3 of 7 OK created sql table model dbt_milan.stg_coffee_shop_order_items ........ [[32mCREATE TABLE (383.8k rows, 30.7 MB processed)[0m in 5.92s]
[0m18:23:47.545513 [debug] [Thread-3 (]: Finished running node model.coffee_shop.stg_coffee_shop_order_items
[0m18:23:47.548628 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:23:47.549658 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:23:47.550035 [debug] [MainThread]: Connection 'model.coffee_shop.my_first_dbt_model' was properly closed.
[0m18:23:47.551787 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop_customers' was properly closed.
[0m18:23:47.552134 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop_orders' was properly closed.
[0m18:23:47.552713 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop_products' was properly closed.
[0m18:23:47.553065 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop_product_prices' was properly closed.
[0m18:23:47.553483 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop_order_items' was properly closed.
[0m18:23:47.553839 [debug] [MainThread]: Connection 'model.coffee_shop.my_second_dbt_model' was properly closed.
[0m18:23:47.554344 [info ] [MainThread]: 
[0m18:23:47.555859 [info ] [MainThread]: Finished running 6 table models, 1 view model in 0 hours 0 minutes and 9.39 seconds (9.39s).
[0m18:23:47.558211 [debug] [MainThread]: Command end result
[0m18:23:47.572015 [info ] [MainThread]: 
[0m18:23:47.573715 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:23:47.574838 [info ] [MainThread]: 
[0m18:23:47.576163 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m18:23:47.577812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f960fb88fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9613030c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f96119ef3a0>]}
[0m18:23:47.580048 [debug] [MainThread]: Flushing usage events


============================== 2023-03-08 18:27:23.043096 | 3173a935-b5d7-45a0-80e7-c2e9bb471da3 ==============================
[0m18:27:23.043096 [info ] [MainThread]: Running with dbt=1.4.1
[0m18:27:23.045976 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m18:27:23.046521 [debug] [MainThread]: Tracking: tracking
[0m18:27:23.048854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47dace6bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47d73569e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47d7357640>]}
[0m18:27:23.101169 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:27:23.101648 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:27:23.102533 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffe_shop_milan.example
[0m18:27:23.110123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3173a935-b5d7-45a0-80e7-c2e9bb471da3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47d73400d0>]}
[0m18:27:23.122841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3173a935-b5d7-45a0-80e7-c2e9bb471da3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47d730b9a0>]}
[0m18:27:23.123281 [info ] [MainThread]: Found 7 models, 7 tests, 0 snapshots, 0 analyses, 334 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m18:27:23.123690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3173a935-b5d7-45a0-80e7-c2e9bb471da3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47dace6bc0>]}
[0m18:27:23.125578 [info ] [MainThread]: 
[0m18:27:23.127910 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:27:23.129421 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m18:27:23.129941 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:27:24.264701 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_milan'
[0m18:27:24.265389 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:27:24.541785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3173a935-b5d7-45a0-80e7-c2e9bb471da3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47d730ace0>]}
[0m18:27:24.542778 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m18:27:24.543564 [info ] [MainThread]: 
[0m18:27:24.548593 [debug] [Thread-1 (]: Began running node model.coffee_shop.my_first_dbt_model
[0m18:27:24.549387 [debug] [Thread-2 (]: Began running node model.coffee_shop.stg_coffee_shop_customers
[0m18:27:24.549046 [info ] [Thread-1 (]: 1 of 7 START sql table model dbt_milan.my_first_dbt_model ...................... [RUN]
[0m18:27:24.551341 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop.my_first_dbt_model'
[0m18:27:24.551771 [debug] [Thread-3 (]: Began running node model.coffee_shop.stg_coffee_shop_order_items
[0m18:27:24.554099 [info ] [Thread-3 (]: 3 of 7 START sql table model dbt_milan.stg_coffee_shop_order_items ............. [RUN]
[0m18:27:24.549881 [info ] [Thread-2 (]: 2 of 7 START sql table model dbt_milan.stg_coffee_shop_customers ............... [RUN]
[0m18:27:24.552968 [debug] [Thread-5 (]: Began running node model.coffee_shop.stg_coffee_shop_product_prices
[0m18:27:24.553252 [debug] [Thread-6 (]: Began running node model.coffee_shop.stg_coffee_shop_products
[0m18:27:24.553588 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.my_first_dbt_model
[0m18:27:24.554835 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.coffee_shop.stg_coffee_shop_order_items'
[0m18:27:24.552457 [debug] [Thread-4 (]: Began running node model.coffee_shop.stg_coffee_shop_orders
[0m18:27:24.555675 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.coffee_shop.stg_coffee_shop_customers'
[0m18:27:24.567820 [debug] [Thread-2 (]: Began compiling node model.coffee_shop.stg_coffee_shop_customers
[0m18:27:24.560317 [info ] [Thread-6 (]: 6 of 7 START sql table model dbt_milan.stg_coffee_shop_products ................ [RUN]
[0m18:27:24.565329 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.my_first_dbt_model"
[0m18:27:24.565810 [debug] [Thread-3 (]: Began compiling node model.coffee_shop.stg_coffee_shop_order_items
[0m18:27:24.567260 [info ] [Thread-4 (]: 4 of 7 START sql table model dbt_milan.stg_coffee_shop_orders .................. [RUN]
[0m18:27:24.559860 [info ] [Thread-5 (]: 5 of 7 START sql table model dbt_milan.stg_coffee_shop_product_prices .......... [RUN]
[0m18:27:24.570729 [debug] [Thread-2 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop_customers"
[0m18:27:24.571435 [debug] [Thread-6 (]: Acquiring new bigquery connection 'model.coffee_shop.stg_coffee_shop_products'
[0m18:27:24.576993 [debug] [Thread-6 (]: Began compiling node model.coffee_shop.stg_coffee_shop_products
[0m18:27:24.579973 [debug] [Thread-6 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop_products"
[0m18:27:24.575744 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.coffee_shop.stg_coffee_shop_orders'
[0m18:27:24.576386 [debug] [Thread-5 (]: Acquiring new bigquery connection 'model.coffee_shop.stg_coffee_shop_product_prices'
[0m18:27:24.574631 [debug] [Thread-3 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop_order_items"
[0m18:27:24.575169 [debug] [Thread-1 (]: Timing info for model.coffee_shop.my_first_dbt_model (compile): 2023-03-08 18:27:24.561302 => 2023-03-08 18:27:24.575061
[0m18:27:24.580605 [debug] [Thread-4 (]: Began compiling node model.coffee_shop.stg_coffee_shop_orders
[0m18:27:24.580867 [debug] [Thread-2 (]: Timing info for model.coffee_shop.stg_coffee_shop_customers (compile): 2023-03-08 18:27:24.568031 => 2023-03-08 18:27:24.580794
[0m18:27:24.581087 [debug] [Thread-6 (]: Timing info for model.coffee_shop.stg_coffee_shop_products (compile): 2023-03-08 18:27:24.577280 => 2023-03-08 18:27:24.581038
[0m18:27:24.581403 [debug] [Thread-5 (]: Began compiling node model.coffee_shop.stg_coffee_shop_product_prices
[0m18:27:24.581985 [debug] [Thread-1 (]: Began executing node model.coffee_shop.my_first_dbt_model
[0m18:27:24.583958 [debug] [Thread-3 (]: Timing info for model.coffee_shop.stg_coffee_shop_order_items (compile): 2023-03-08 18:27:24.571889 => 2023-03-08 18:27:24.583865
[0m18:27:24.585421 [debug] [Thread-2 (]: Began executing node model.coffee_shop.stg_coffee_shop_customers
[0m18:27:24.588279 [debug] [Thread-4 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop_orders"
[0m18:27:24.671971 [debug] [Thread-4 (]: Timing info for model.coffee_shop.stg_coffee_shop_orders (compile): 2023-03-08 18:27:24.582246 => 2023-03-08 18:27:24.671882
[0m18:27:24.672288 [debug] [Thread-4 (]: Began executing node model.coffee_shop.stg_coffee_shop_orders
[0m18:27:24.668939 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:27:24.669393 [debug] [Thread-3 (]: Began executing node model.coffee_shop.stg_coffee_shop_order_items
[0m18:27:24.671419 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:27:24.588551 [debug] [Thread-6 (]: Began executing node model.coffee_shop.stg_coffee_shop_products
[0m18:27:24.681806 [debug] [Thread-6 (]: Opening a new connection, currently in state init
[0m18:27:24.654207 [debug] [Thread-5 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop_product_prices"
[0m18:27:24.678173 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:27:24.674159 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:27:24.688057 [debug] [Thread-5 (]: Timing info for model.coffee_shop.stg_coffee_shop_product_prices (compile): 2023-03-08 18:27:24.588778 => 2023-03-08 18:27:24.687958
[0m18:27:24.688513 [debug] [Thread-5 (]: Began executing node model.coffee_shop.stg_coffee_shop_product_prices
[0m18:27:24.691531 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m18:27:25.285900 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop.my_first_dbt_model"
[0m18:27:25.288082 [debug] [Thread-2 (]: Writing runtime sql for node "model.coffee_shop.stg_coffee_shop_customers"
[0m18:27:25.289735 [debug] [Thread-1 (]: On model.coffee_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.my_first_dbt_model"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`my_first_dbt_model`
    
    
    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m18:27:25.291862 [debug] [Thread-4 (]: Writing runtime sql for node "model.coffee_shop.stg_coffee_shop_orders"
[0m18:27:25.293280 [debug] [Thread-3 (]: Writing runtime sql for node "model.coffee_shop.stg_coffee_shop_order_items"
[0m18:27:25.295112 [debug] [Thread-5 (]: Writing runtime sql for node "model.coffee_shop.stg_coffee_shop_product_prices"
[0m18:27:25.300511 [debug] [Thread-5 (]: On model.coffee_shop.stg_coffee_shop_product_prices: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.stg_coffee_shop_product_prices"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`stg_coffee_shop_product_prices`
    
    
    OPTIONS()
    as (
      

select * from `analytics-engineers-club.coffee_shop.product_prices`
    );
  
[0m18:27:25.296011 [debug] [Thread-2 (]: On model.coffee_shop.stg_coffee_shop_customers: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.stg_coffee_shop_customers"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`stg_coffee_shop_customers`
    
    
    OPTIONS()
    as (
      

select * from `analytics-engineers-club.coffee_shop.customers`
    );
  
[0m18:27:25.298079 [debug] [Thread-6 (]: Writing runtime sql for node "model.coffee_shop.stg_coffee_shop_products"
[0m18:27:25.299827 [debug] [Thread-4 (]: On model.coffee_shop.stg_coffee_shop_orders: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.stg_coffee_shop_orders"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`stg_coffee_shop_orders`
    
    
    OPTIONS()
    as (
      

select * from `analytics-engineers-club.coffee_shop.orders`
    );
  
[0m18:27:25.303779 [debug] [Thread-6 (]: On model.coffee_shop.stg_coffee_shop_products: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.stg_coffee_shop_products"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`stg_coffee_shop_products`
    
    
    OPTIONS()
    as (
      

select * from `analytics-engineers-club.coffee_shop.products`
    );
  
[0m18:27:25.306893 [debug] [Thread-3 (]: On model.coffee_shop.stg_coffee_shop_order_items: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.stg_coffee_shop_order_items"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`stg_coffee_shop_order_items`
    
    
    OPTIONS()
    as (
      

select * from `analytics-engineers-club.coffee_shop.order_items`
    );
  
[0m18:27:27.620071 [debug] [Thread-5 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:4e8915ef-c376-4aab-b64e-2a9892d351a4&page=queryresults
[0m18:27:27.638075 [debug] [Thread-5 (]: Timing info for model.coffee_shop.stg_coffee_shop_product_prices (execute): 2023-03-08 18:27:24.688822 => 2023-03-08 18:27:27.637983
[0m18:27:27.639016 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3173a935-b5d7-45a0-80e7-c2e9bb471da3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47d7206a10>]}
[0m18:27:27.639667 [info ] [Thread-5 (]: 5 of 7 OK created sql table model dbt_milan.stg_coffee_shop_product_prices ..... [[32mCREATE TABLE (15.0 rows, 600.0 Bytes processed)[0m in 3.06s]
[0m18:27:27.641904 [debug] [Thread-5 (]: Finished running node model.coffee_shop.stg_coffee_shop_product_prices
[0m18:27:27.757116 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:dad54d37-78cd-4d0b-b4e2-b2bd523b8099&page=queryresults
[0m18:27:27.763247 [debug] [Thread-1 (]: Timing info for model.coffee_shop.my_first_dbt_model (execute): 2023-03-08 18:27:24.654599 => 2023-03-08 18:27:27.763136
[0m18:27:27.764608 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3173a935-b5d7-45a0-80e7-c2e9bb471da3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47d73431f0>]}
[0m18:27:27.765655 [info ] [Thread-1 (]: 1 of 7 OK created sql table model dbt_milan.my_first_dbt_model ................. [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 3.21s]
[0m18:27:27.768597 [debug] [Thread-1 (]: Finished running node model.coffee_shop.my_first_dbt_model
[0m18:27:27.769934 [debug] [Thread-8 (]: Began running node model.coffee_shop.my_second_dbt_model
[0m18:27:27.770475 [info ] [Thread-8 (]: 7 of 7 START sql view model dbt_milan.my_second_dbt_model ...................... [RUN]
[0m18:27:27.771498 [debug] [Thread-8 (]: Acquiring new bigquery connection 'model.coffee_shop.my_second_dbt_model'
[0m18:27:27.771921 [debug] [Thread-8 (]: Began compiling node model.coffee_shop.my_second_dbt_model
[0m18:27:27.777366 [debug] [Thread-8 (]: Writing injected SQL for node "model.coffee_shop.my_second_dbt_model"
[0m18:27:27.778774 [debug] [Thread-8 (]: Timing info for model.coffee_shop.my_second_dbt_model (compile): 2023-03-08 18:27:27.772211 => 2023-03-08 18:27:27.778653
[0m18:27:27.779283 [debug] [Thread-8 (]: Began executing node model.coffee_shop.my_second_dbt_model
[0m18:27:27.819770 [debug] [Thread-8 (]: Writing runtime sql for node "model.coffee_shop.my_second_dbt_model"
[0m18:27:27.820825 [debug] [Thread-8 (]: Opening a new connection, currently in state init
[0m18:27:27.821385 [debug] [Thread-8 (]: On model.coffee_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.my_second_dbt_model"} */


  create or replace view `aec-students`.`dbt_milan`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `aec-students`.`dbt_milan`.`my_first_dbt_model`
where id = 1;


[0m18:27:27.872866 [debug] [Thread-6 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:33c9543c-6e38-4577-b4eb-8145263e4544&page=queryresults
[0m18:27:27.876982 [debug] [Thread-6 (]: Timing info for model.coffee_shop.stg_coffee_shop_products (execute): 2023-03-08 18:27:24.679999 => 2023-03-08 18:27:27.876880
[0m18:27:27.878427 [debug] [Thread-6 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3173a935-b5d7-45a0-80e7-c2e9bb471da3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47d72063b0>]}
[0m18:27:27.879263 [info ] [Thread-6 (]: 6 of 7 OK created sql table model dbt_milan.stg_coffee_shop_products ........... [[32mCREATE TABLE (7.0 rows, 278.0 Bytes processed)[0m in 3.31s]
[0m18:27:27.880506 [debug] [Thread-6 (]: Finished running node model.coffee_shop.stg_coffee_shop_products
[0m18:27:28.616112 [debug] [Thread-8 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:493adfa0-d779-416f-a109-6f1a2526f36b&page=queryresults
[0m18:27:28.618564 [debug] [Thread-8 (]: Timing info for model.coffee_shop.my_second_dbt_model (execute): 2023-03-08 18:27:27.779646 => 2023-03-08 18:27:28.618498
[0m18:27:28.619470 [debug] [Thread-8 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3173a935-b5d7-45a0-80e7-c2e9bb471da3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47d7202140>]}
[0m18:27:28.620062 [info ] [Thread-8 (]: 7 of 7 OK created sql view model dbt_milan.my_second_dbt_model ................. [[32mCREATE VIEW (0 processed)[0m in 0.85s]
[0m18:27:28.620653 [debug] [Thread-8 (]: Finished running node model.coffee_shop.my_second_dbt_model
[0m18:27:29.876640 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:12c155d2-0750-4f2d-a8b7-b2b163ea429b&page=queryresults
[0m18:27:29.878871 [debug] [Thread-2 (]: Timing info for model.coffee_shop.stg_coffee_shop_customers (execute): 2023-03-08 18:27:24.669725 => 2023-03-08 18:27:29.878806
[0m18:27:29.879699 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3173a935-b5d7-45a0-80e7-c2e9bb471da3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47d732c1f0>]}
[0m18:27:29.880234 [info ] [Thread-2 (]: 2 of 7 OK created sql table model dbt_milan.stg_coffee_shop_customers .......... [[32mCREATE TABLE (174.4k rows, 12.8 MB processed)[0m in 5.32s]
[0m18:27:29.880837 [debug] [Thread-2 (]: Finished running node model.coffee_shop.stg_coffee_shop_customers
[0m18:27:29.989889 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:c987b92f-d631-491f-909b-fd3437950ac7&page=queryresults
[0m18:27:29.992042 [debug] [Thread-4 (]: Timing info for model.coffee_shop.stg_coffee_shop_orders (execute): 2023-03-08 18:27:24.672488 => 2023-03-08 18:27:29.991974
[0m18:27:29.992915 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3173a935-b5d7-45a0-80e7-c2e9bb471da3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47d73429e0>]}
[0m18:27:29.993460 [info ] [Thread-4 (]: 4 of 7 OK created sql table model dbt_milan.stg_coffee_shop_orders ............. [[32mCREATE TABLE (192.0k rows, 24.7 MB processed)[0m in 5.42s]
[0m18:27:29.993975 [debug] [Thread-4 (]: Finished running node model.coffee_shop.stg_coffee_shop_orders
[0m18:27:31.092467 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:f9003a07-ee5e-4226-8c1d-51dd7726bd0b&page=queryresults
[0m18:27:31.094953 [debug] [Thread-3 (]: Timing info for model.coffee_shop.stg_coffee_shop_order_items (execute): 2023-03-08 18:27:24.676275 => 2023-03-08 18:27:31.094890
[0m18:27:31.095843 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3173a935-b5d7-45a0-80e7-c2e9bb471da3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47d7341c60>]}
[0m18:27:31.096435 [info ] [Thread-3 (]: 3 of 7 OK created sql table model dbt_milan.stg_coffee_shop_order_items ........ [[32mCREATE TABLE (383.8k rows, 30.7 MB processed)[0m in 6.54s]
[0m18:27:31.097332 [debug] [Thread-3 (]: Finished running node model.coffee_shop.stg_coffee_shop_order_items
[0m18:27:31.099810 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:27:31.100369 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:27:31.100599 [debug] [MainThread]: Connection 'model.coffee_shop.my_first_dbt_model' was properly closed.
[0m18:27:31.100792 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop_order_items' was properly closed.
[0m18:27:31.100972 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop_customers' was properly closed.
[0m18:27:31.101188 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop_products' was properly closed.
[0m18:27:31.101386 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop_orders' was properly closed.
[0m18:27:31.101566 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop_product_prices' was properly closed.
[0m18:27:31.101745 [debug] [MainThread]: Connection 'model.coffee_shop.my_second_dbt_model' was properly closed.
[0m18:27:31.102003 [info ] [MainThread]: 
[0m18:27:31.102382 [info ] [MainThread]: Finished running 6 table models, 1 view model in 0 hours 0 minutes and 7.98 seconds (7.98s).
[0m18:27:31.103668 [debug] [MainThread]: Command end result
[0m18:27:31.113540 [info ] [MainThread]: 
[0m18:27:31.114106 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:27:31.114619 [info ] [MainThread]: 
[0m18:27:31.115112 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m18:27:31.116055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47d7202170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47d7308a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47d730b520>]}
[0m18:27:31.116463 [debug] [MainThread]: Flushing usage events


============================== 2023-03-09 16:04:46.496650 | bc68caa5-4371-47f2-849c-6314e0f29bc4 ==============================
[0m16:04:46.496650 [info ] [MainThread]: Running with dbt=1.4.1
[0m16:04:46.502454 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:04:46.503011 [debug] [MainThread]: Tracking: tracking
[0m16:04:46.511231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25abe53700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25abe50190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25abe53730>]}
[0m16:04:46.730058 [debug] [MainThread]: Partial parsing enabled: 6 files deleted, 7 files added, 0 files changed.
[0m16:04:46.730678 [debug] [MainThread]: Partial parsing: added file: coffee_shop://models/staging/coffee_shop/stg_coffee_shop__orders.sql
[0m16:04:46.731101 [debug] [MainThread]: Partial parsing: added file: coffee_shop://models/staging/coffee_shop/stg_coffee_shop__product_prices.sql
[0m16:04:46.731468 [debug] [MainThread]: Partial parsing: added file: coffee_shop://models/staging/web_tracking/stg_web_tracking__sources.yml
[0m16:04:46.731804 [debug] [MainThread]: Partial parsing: added file: coffee_shop://models/staging/coffee_shop/stg_coffee_shop__customers.sql
[0m16:04:46.732206 [debug] [MainThread]: Partial parsing: added file: coffee_shop://models/staging/coffee_shop/stg_coffee_shop__sources.yml
[0m16:04:46.732530 [debug] [MainThread]: Partial parsing: added file: coffee_shop://models/staging/coffee_shop/stg_coffee_shop__products.sql
[0m16:04:46.732879 [debug] [MainThread]: Partial parsing: added file: coffee_shop://models/staging/coffee_shop/stg_coffee_shop__order_items.sql
[0m16:04:46.733216 [debug] [MainThread]: Partial parsing: deleted file: coffee_shop://models/staging/coffee_shop/stg_coffee_shop_product_prices.sql
[0m16:04:46.733486 [debug] [MainThread]: Partial parsing: deleted file: coffee_shop://models/staging/coffee_shop/stg_coffee_shop_orders.sql
[0m16:04:46.733755 [debug] [MainThread]: Partial parsing: deleted file: coffee_shop://models/staging/coffee_shop/stg_coffee_shop_order_items.sql
[0m16:04:46.734017 [debug] [MainThread]: Partial parsing: deleted file: coffee_shop://models/staging/coffee_shop/stg_coffee_shop_products.sql
[0m16:04:46.734272 [debug] [MainThread]: Partial parsing: deleted file: coffee_shop://models/staging/coffee_shop/stg_coffee_shop_customers.sql
[0m16:04:46.747444 [debug] [MainThread]: 1699: static parser successfully parsed staging/coffee_shop/stg_coffee_shop__orders.sql
[0m16:04:46.766494 [debug] [MainThread]: 1699: static parser successfully parsed staging/coffee_shop/stg_coffee_shop__product_prices.sql
[0m16:04:46.776839 [debug] [MainThread]: 1699: static parser successfully parsed staging/coffee_shop/stg_coffee_shop__customers.sql
[0m16:04:46.783856 [debug] [MainThread]: 1699: static parser successfully parsed staging/coffee_shop/stg_coffee_shop__products.sql
[0m16:04:46.789087 [debug] [MainThread]: 1699: static parser successfully parsed staging/coffee_shop/stg_coffee_shop__order_items.sql
[0m16:04:46.802847 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'customers' in the 'models' section of file 'models/staging/coffee_shop/stg_coffee_shop__sources.yml'
[0m16:04:46.888581 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.coffee_shop.unique_customers_id.70f3d3fd20' (models/staging/coffee_shop/stg_coffee_shop__sources.yml) depends on a node named 'customers' in package '' which was not found
[0m16:04:46.889360 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.coffee_shop.not_null_customers_id.422908bfae' (models/staging/coffee_shop/stg_coffee_shop__sources.yml) depends on a node named 'customers' in package '' which was not found
[0m16:04:46.897094 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffe_shop_milan.example
[0m16:04:46.902938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bc68caa5-4371-47f2-849c-6314e0f29bc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25abe203d0>]}
[0m16:04:46.910766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bc68caa5-4371-47f2-849c-6314e0f29bc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25abe07760>]}
[0m16:04:46.911208 [info ] [MainThread]: Found 7 models, 7 tests, 0 snapshots, 0 analyses, 334 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m16:04:46.911628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc68caa5-4371-47f2-849c-6314e0f29bc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25abe077f0>]}
[0m16:04:46.913297 [info ] [MainThread]: 
[0m16:04:46.915413 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:04:46.916940 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m16:04:46.917505 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:04:50.374652 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_milan'
[0m16:04:50.375275 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:04:50.659591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc68caa5-4371-47f2-849c-6314e0f29bc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25ac275cc0>]}
[0m16:04:50.660531 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m16:04:50.660993 [info ] [MainThread]: 
[0m16:04:50.689117 [debug] [Thread-1 (]: Began running node model.coffee_shop.my_first_dbt_model
[0m16:04:50.689814 [debug] [Thread-2 (]: Began running node model.coffee_shop.stg_coffee_shop__customers
[0m16:04:50.690247 [debug] [Thread-3 (]: Began running node model.coffee_shop.stg_coffee_shop__order_items
[0m16:04:50.690889 [debug] [Thread-4 (]: Began running node model.coffee_shop.stg_coffee_shop__orders
[0m16:04:50.691343 [debug] [Thread-5 (]: Began running node model.coffee_shop.stg_coffee_shop__product_prices
[0m16:04:50.691623 [debug] [Thread-6 (]: Began running node model.coffee_shop.stg_coffee_shop__products
[0m16:04:50.692089 [info ] [Thread-1 (]: 1 of 7 START sql table model dbt_milan.my_first_dbt_model ...................... [RUN]
[0m16:04:50.692537 [info ] [Thread-2 (]: 2 of 7 START sql table model dbt_milan.stg_coffee_shop__customers .............. [RUN]
[0m16:04:50.695103 [info ] [Thread-5 (]: 5 of 7 START sql table model dbt_milan.stg_coffee_shop__product_prices ......... [RUN]
[0m16:04:50.699067 [debug] [Thread-5 (]: Acquiring new bigquery connection 'model.coffee_shop.stg_coffee_shop__product_prices'
[0m16:04:50.693810 [info ] [Thread-4 (]: 4 of 7 START sql table model dbt_milan.stg_coffee_shop__orders ................. [RUN]
[0m16:04:50.700252 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.coffee_shop.stg_coffee_shop__orders'
[0m16:04:50.693145 [info ] [Thread-3 (]: 3 of 7 START sql table model dbt_milan.stg_coffee_shop__order_items ............ [RUN]
[0m16:04:50.699471 [debug] [Thread-5 (]: Began compiling node model.coffee_shop.stg_coffee_shop__product_prices
[0m16:04:50.704487 [debug] [Thread-5 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop__product_prices"
[0m16:04:50.695949 [info ] [Thread-6 (]: 6 of 7 START sql table model dbt_milan.stg_coffee_shop__products ............... [RUN]
[0m16:04:50.700571 [debug] [Thread-4 (]: Began compiling node model.coffee_shop.stg_coffee_shop__orders
[0m16:04:50.708340 [debug] [Thread-4 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop__orders"
[0m16:04:50.701524 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.coffee_shop.stg_coffee_shop__order_items'
[0m16:04:50.696770 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop.my_first_dbt_model'
[0m16:04:50.709570 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.my_first_dbt_model
[0m16:04:50.705846 [debug] [Thread-6 (]: Acquiring new bigquery connection 'model.coffee_shop.stg_coffee_shop__products'
[0m16:04:50.708794 [debug] [Thread-4 (]: Timing info for model.coffee_shop.stg_coffee_shop__orders (compile): 2023-03-09 16:04:50.706094 => 2023-03-09 16:04:50.708706
[0m16:04:50.697776 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.coffee_shop.stg_coffee_shop__customers'
[0m16:04:50.713016 [debug] [Thread-2 (]: Began compiling node model.coffee_shop.stg_coffee_shop__customers
[0m16:04:50.711950 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.my_first_dbt_model"
[0m16:04:50.715724 [debug] [Thread-1 (]: Timing info for model.coffee_shop.my_first_dbt_model (compile): 2023-03-09 16:04:50.709807 => 2023-03-09 16:04:50.715568
[0m16:04:50.712326 [debug] [Thread-6 (]: Began compiling node model.coffee_shop.stg_coffee_shop__products
[0m16:04:50.712665 [debug] [Thread-4 (]: Began executing node model.coffee_shop.stg_coffee_shop__orders
[0m16:04:50.709253 [debug] [Thread-3 (]: Began compiling node model.coffee_shop.stg_coffee_shop__order_items
[0m16:04:50.715155 [debug] [Thread-2 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop__customers"
[0m16:04:50.716065 [debug] [Thread-1 (]: Began executing node model.coffee_shop.my_first_dbt_model
[0m16:04:50.705034 [debug] [Thread-5 (]: Timing info for model.coffee_shop.stg_coffee_shop__product_prices (compile): 2023-03-09 16:04:50.701811 => 2023-03-09 16:04:50.704941
[0m16:04:50.718422 [debug] [Thread-6 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop__products"
[0m16:04:50.759525 [debug] [Thread-6 (]: Timing info for model.coffee_shop.stg_coffee_shop__products (compile): 2023-03-09 16:04:50.716305 => 2023-03-09 16:04:50.759451
[0m16:04:50.756006 [debug] [Thread-4 (]: Writing runtime sql for node "model.coffee_shop.stg_coffee_shop__orders"
[0m16:04:50.758267 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:04:50.758701 [debug] [Thread-5 (]: Began executing node model.coffee_shop.stg_coffee_shop__product_prices
[0m16:04:50.759043 [debug] [Thread-2 (]: Timing info for model.coffee_shop.stg_coffee_shop__customers (compile): 2023-03-09 16:04:50.713253 => 2023-03-09 16:04:50.758983
[0m16:04:50.764946 [debug] [Thread-2 (]: Began executing node model.coffee_shop.stg_coffee_shop__customers
[0m16:04:50.767923 [debug] [Thread-2 (]: Writing runtime sql for node "model.coffee_shop.stg_coffee_shop__customers"
[0m16:04:50.764493 [debug] [Thread-5 (]: Writing runtime sql for node "model.coffee_shop.stg_coffee_shop__product_prices"
[0m16:04:50.768542 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m16:04:50.769436 [debug] [Thread-5 (]: On model.coffee_shop.stg_coffee_shop__product_prices: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.stg_coffee_shop__product_prices"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`stg_coffee_shop__product_prices`
    
    
    OPTIONS()
    as (
      

select * from `analytics-engineers-club.coffee_shop.product_prices`
    );
  
[0m16:04:50.746521 [debug] [Thread-3 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop__order_items"
[0m16:04:50.773852 [debug] [Thread-3 (]: Timing info for model.coffee_shop.stg_coffee_shop__order_items (compile): 2023-03-09 16:04:50.744486 => 2023-03-09 16:04:50.773768
[0m16:04:50.774277 [debug] [Thread-3 (]: Began executing node model.coffee_shop.stg_coffee_shop__order_items
[0m16:04:50.759947 [debug] [Thread-6 (]: Began executing node model.coffee_shop.stg_coffee_shop__products
[0m16:04:50.774878 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:04:50.783126 [debug] [Thread-6 (]: Writing runtime sql for node "model.coffee_shop.stg_coffee_shop__products"
[0m16:04:50.784779 [debug] [Thread-6 (]: Opening a new connection, currently in state init
[0m16:04:50.785229 [debug] [Thread-6 (]: On model.coffee_shop.stg_coffee_shop__products: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.stg_coffee_shop__products"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`stg_coffee_shop__products`
    
    
    OPTIONS()
    as (
      

select * from `analytics-engineers-club.coffee_shop.products`
    );
  
[0m16:04:50.784185 [debug] [Thread-4 (]: On model.coffee_shop.stg_coffee_shop__orders: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.stg_coffee_shop__orders"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`stg_coffee_shop__orders`
    
    
    OPTIONS()
    as (
      

select * from `analytics-engineers-club.coffee_shop.orders`
    );
  
[0m16:04:50.783809 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:04:50.789474 [debug] [Thread-2 (]: On model.coffee_shop.stg_coffee_shop__customers: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.stg_coffee_shop__customers"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`stg_coffee_shop__customers`
    
    
    OPTIONS()
    as (
      

select * from `analytics-engineers-club.coffee_shop.customers`
    );
  
[0m16:04:50.779048 [debug] [Thread-3 (]: Writing runtime sql for node "model.coffee_shop.stg_coffee_shop__order_items"
[0m16:04:50.792524 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:04:50.792938 [debug] [Thread-3 (]: On model.coffee_shop.stg_coffee_shop__order_items: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.stg_coffee_shop__order_items"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`stg_coffee_shop__order_items`
    
    
    OPTIONS()
    as (
      

select * from `analytics-engineers-club.coffee_shop.order_items`
    );
  
[0m16:04:51.456880 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop.my_first_dbt_model"
[0m16:04:51.458296 [debug] [Thread-1 (]: On model.coffee_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.my_first_dbt_model"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`my_first_dbt_model`
    
    
    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m16:04:53.654099 [debug] [Thread-6 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:0bcd22c0-17ef-470a-92b5-a80ffbaa3759&page=queryresults
[0m16:04:53.669585 [debug] [Thread-6 (]: Timing info for model.coffee_shop.stg_coffee_shop__products (execute): 2023-03-09 16:04:50.779420 => 2023-03-09 16:04:53.669519
[0m16:04:53.670426 [debug] [Thread-6 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc68caa5-4371-47f2-849c-6314e0f29bc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25abe21930>]}
[0m16:04:53.670991 [info ] [Thread-6 (]: 6 of 7 OK created sql table model dbt_milan.stg_coffee_shop__products .......... [[32mCREATE TABLE (7.0 rows, 278.0 Bytes processed)[0m in 2.96s]
[0m16:04:53.672946 [debug] [Thread-6 (]: Finished running node model.coffee_shop.stg_coffee_shop__products
[0m16:04:53.678082 [debug] [Thread-5 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:37c45ba8-4b32-4835-a310-ec8255308d31&page=queryresults
[0m16:04:53.679674 [debug] [Thread-5 (]: Timing info for model.coffee_shop.stg_coffee_shop__product_prices (execute): 2023-03-09 16:04:50.761929 => 2023-03-09 16:04:53.679625
[0m16:04:53.680378 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc68caa5-4371-47f2-849c-6314e0f29bc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25abc6a6e0>]}
[0m16:04:53.680855 [info ] [Thread-5 (]: 5 of 7 OK created sql table model dbt_milan.stg_coffee_shop__product_prices .... [[32mCREATE TABLE (15.0 rows, 600.0 Bytes processed)[0m in 2.98s]
[0m16:04:53.681358 [debug] [Thread-5 (]: Finished running node model.coffee_shop.stg_coffee_shop__product_prices
[0m16:04:53.830924 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:14a7bf59-9313-4fe3-83ce-a212cd46742f&page=queryresults
[0m16:04:53.837371 [debug] [Thread-1 (]: Timing info for model.coffee_shop.my_first_dbt_model (execute): 2023-03-09 16:04:50.756420 => 2023-03-09 16:04:53.836933
[0m16:04:53.838394 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc68caa5-4371-47f2-849c-6314e0f29bc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25abe22e00>]}
[0m16:04:53.838916 [info ] [Thread-1 (]: 1 of 7 OK created sql table model dbt_milan.my_first_dbt_model ................. [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 3.14s]
[0m16:04:53.839416 [debug] [Thread-1 (]: Finished running node model.coffee_shop.my_first_dbt_model
[0m16:04:53.840244 [debug] [Thread-8 (]: Began running node model.coffee_shop.my_second_dbt_model
[0m16:04:53.840822 [info ] [Thread-8 (]: 7 of 7 START sql view model dbt_milan.my_second_dbt_model ...................... [RUN]
[0m16:04:53.842197 [debug] [Thread-8 (]: Acquiring new bigquery connection 'model.coffee_shop.my_second_dbt_model'
[0m16:04:53.842558 [debug] [Thread-8 (]: Began compiling node model.coffee_shop.my_second_dbt_model
[0m16:04:53.845135 [debug] [Thread-8 (]: Writing injected SQL for node "model.coffee_shop.my_second_dbt_model"
[0m16:04:53.845918 [debug] [Thread-8 (]: Timing info for model.coffee_shop.my_second_dbt_model (compile): 2023-03-09 16:04:53.842797 => 2023-03-09 16:04:53.845832
[0m16:04:53.846318 [debug] [Thread-8 (]: Began executing node model.coffee_shop.my_second_dbt_model
[0m16:04:53.869409 [debug] [Thread-8 (]: Writing runtime sql for node "model.coffee_shop.my_second_dbt_model"
[0m16:04:53.870207 [debug] [Thread-8 (]: Opening a new connection, currently in state init
[0m16:04:53.870623 [debug] [Thread-8 (]: On model.coffee_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.my_second_dbt_model"} */


  create or replace view `aec-students`.`dbt_milan`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `aec-students`.`dbt_milan`.`my_first_dbt_model`
where id = 1;


[0m16:04:54.637587 [debug] [Thread-8 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:d6c63e4f-ccd5-472a-8fb8-846cf0115187&page=queryresults
[0m16:04:54.640439 [debug] [Thread-8 (]: Timing info for model.coffee_shop.my_second_dbt_model (execute): 2023-03-09 16:04:53.846670 => 2023-03-09 16:04:54.640373
[0m16:04:54.641286 [debug] [Thread-8 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc68caa5-4371-47f2-849c-6314e0f29bc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25abe22050>]}
[0m16:04:54.641845 [info ] [Thread-8 (]: 7 of 7 OK created sql view model dbt_milan.my_second_dbt_model ................. [[32mCREATE VIEW (0 processed)[0m in 0.80s]
[0m16:04:54.642713 [debug] [Thread-8 (]: Finished running node model.coffee_shop.my_second_dbt_model
[0m16:04:54.692699 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:52ed0c94-b5c5-4459-abae-5079fe4e46bd&page=queryresults
[0m16:04:54.694605 [debug] [Thread-2 (]: Timing info for model.coffee_shop.stg_coffee_shop__customers (execute): 2023-03-09 16:04:50.765294 => 2023-03-09 16:04:54.694541
[0m16:04:54.695464 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc68caa5-4371-47f2-849c-6314e0f29bc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25abe0fa90>]}
[0m16:04:54.696042 [info ] [Thread-2 (]: 2 of 7 OK created sql table model dbt_milan.stg_coffee_shop__customers ......... [[32mCREATE TABLE (174.4k rows, 12.8 MB processed)[0m in 4.00s]
[0m16:04:54.696640 [debug] [Thread-2 (]: Finished running node model.coffee_shop.stg_coffee_shop__customers
[0m16:04:56.979525 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:2e0cd4d9-2d4b-4eb9-aee5-96e7b73b298f&page=queryresults
[0m16:04:56.981642 [debug] [Thread-4 (]: Timing info for model.coffee_shop.stg_coffee_shop__orders (execute): 2023-03-09 16:04:50.718677 => 2023-03-09 16:04:56.981575
[0m16:04:56.982511 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc68caa5-4371-47f2-849c-6314e0f29bc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25abe23070>]}
[0m16:04:56.983067 [info ] [Thread-4 (]: 4 of 7 OK created sql table model dbt_milan.stg_coffee_shop__orders ............ [[32mCREATE TABLE (192.0k rows, 24.7 MB processed)[0m in 6.28s]
[0m16:04:56.983597 [debug] [Thread-4 (]: Finished running node model.coffee_shop.stg_coffee_shop__orders
[0m16:04:58.071786 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:2c4007b8-10ef-4fe5-9c64-23c4a89ba3c8&page=queryresults
[0m16:04:58.074071 [debug] [Thread-3 (]: Timing info for model.coffee_shop.stg_coffee_shop__order_items (execute): 2023-03-09 16:04:50.775132 => 2023-03-09 16:04:58.073949
[0m16:04:58.075033 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc68caa5-4371-47f2-849c-6314e0f29bc4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25ab7841c0>]}
[0m16:04:58.075586 [info ] [Thread-3 (]: 3 of 7 OK created sql table model dbt_milan.stg_coffee_shop__order_items ....... [[32mCREATE TABLE (383.8k rows, 30.7 MB processed)[0m in 7.37s]
[0m16:04:58.076110 [debug] [Thread-3 (]: Finished running node model.coffee_shop.stg_coffee_shop__order_items
[0m16:04:58.078784 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:04:58.079386 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:04:58.079632 [debug] [MainThread]: Connection 'model.coffee_shop.my_first_dbt_model' was properly closed.
[0m16:04:58.079896 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop__customers' was properly closed.
[0m16:04:58.080128 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop__product_prices' was properly closed.
[0m16:04:58.080357 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop__orders' was properly closed.
[0m16:04:58.080584 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop__order_items' was properly closed.
[0m16:04:58.080810 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop__products' was properly closed.
[0m16:04:58.081034 [debug] [MainThread]: Connection 'model.coffee_shop.my_second_dbt_model' was properly closed.
[0m16:04:58.081409 [info ] [MainThread]: 
[0m16:04:58.082067 [info ] [MainThread]: Finished running 6 table models, 1 view model in 0 hours 0 minutes and 11.17 seconds (11.17s).
[0m16:04:58.082979 [debug] [MainThread]: Command end result
[0m16:04:58.098779 [info ] [MainThread]: 
[0m16:04:58.099242 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:04:58.099736 [info ] [MainThread]: 
[0m16:04:58.100212 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m16:04:58.100827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25abe330d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25ac275c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f25ac275c00>]}
[0m16:04:58.101300 [debug] [MainThread]: Flushing usage events


============================== 2023-03-09 16:11:49.824589 | 24db90d1-33f0-4eb3-a21a-3b2ebcf87862 ==============================
[0m16:11:49.824589 [info ] [MainThread]: Running with dbt=1.4.1
[0m16:11:49.827396 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m16:11:49.827953 [debug] [MainThread]: Tracking: tracking
[0m16:11:49.847153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8f9c6b700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8f9c68130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8f9c6b730>]}
[0m16:11:49.894824 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m16:11:49.895337 [debug] [MainThread]: Partial parsing: added file: coffee_shop://models/staging/web_tracking/stg_web_tracking__pageviews.sql
[0m16:11:49.909141 [debug] [MainThread]: 1699: static parser successfully parsed staging/web_tracking/stg_web_tracking__pageviews.sql
[0m16:11:49.925864 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffe_shop_milan.example
[0m16:11:49.931512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '24db90d1-33f0-4eb3-a21a-3b2ebcf87862', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8f9aac340>]}
[0m16:11:49.941962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '24db90d1-33f0-4eb3-a21a-3b2ebcf87862', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8f9c13eb0>]}
[0m16:11:49.942649 [info ] [MainThread]: Found 8 models, 7 tests, 0 snapshots, 0 analyses, 334 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
[0m16:11:49.944256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '24db90d1-33f0-4eb3-a21a-3b2ebcf87862', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8f9c13f40>]}
[0m16:11:49.946736 [info ] [MainThread]: 
[0m16:11:49.952372 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:11:49.953801 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m16:11:49.954251 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:11:51.079990 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_milan'
[0m16:11:51.080550 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:11:51.425936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '24db90d1-33f0-4eb3-a21a-3b2ebcf87862', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8f9f68100>]}
[0m16:11:51.427011 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m16:11:51.427502 [info ] [MainThread]: 
[0m16:11:51.434994 [debug] [Thread-1 (]: Began running node model.coffee_shop.my_first_dbt_model
[0m16:11:51.435471 [info ] [Thread-1 (]: 1 of 8 START sql table model dbt_milan.my_first_dbt_model ...................... [RUN]
[0m16:11:51.436414 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop.my_first_dbt_model'
[0m16:11:51.436762 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.my_first_dbt_model
[0m16:11:51.440441 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.my_first_dbt_model"
[0m16:11:51.440764 [debug] [Thread-2 (]: Began running node model.coffee_shop.stg_coffee_shop__customers
[0m16:11:51.441339 [debug] [Thread-3 (]: Began running node model.coffee_shop.stg_coffee_shop__order_items
[0m16:11:51.443833 [info ] [Thread-2 (]: 2 of 8 START sql table model dbt_milan.stg_coffee_shop__customers .............. [RUN]
[0m16:11:51.441842 [debug] [Thread-5 (]: Began running node model.coffee_shop.stg_coffee_shop__product_prices
[0m16:11:51.442634 [debug] [Thread-6 (]: Began running node model.coffee_shop.stg_coffee_shop__products
[0m16:11:51.442930 [debug] [Thread-7 (]: Began running node model.coffee_shop.stg_web_tracking__pageviews
[0m16:11:51.441586 [debug] [Thread-4 (]: Began running node model.coffee_shop.stg_coffee_shop__orders
[0m16:11:51.445138 [debug] [Thread-1 (]: Timing info for model.coffee_shop.my_first_dbt_model (compile): 2023-03-09 16:11:51.437007 => 2023-03-09 16:11:51.445011
[0m16:11:51.449650 [debug] [Thread-1 (]: Began executing node model.coffee_shop.my_first_dbt_model
[0m16:11:51.444271 [info ] [Thread-3 (]: 3 of 8 START sql table model dbt_milan.stg_coffee_shop__order_items ............ [RUN]
[0m16:11:51.446752 [info ] [Thread-5 (]: 5 of 8 START sql table model dbt_milan.stg_coffee_shop__product_prices ......... [RUN]
[0m16:11:51.471201 [debug] [Thread-5 (]: Acquiring new bigquery connection 'model.coffee_shop.stg_coffee_shop__product_prices'
[0m16:11:51.448189 [info ] [Thread-7 (]: 7 of 8 START sql table model dbt_milan.stg_web_tracking__pageviews ............. [RUN]
[0m16:11:51.446185 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.coffee_shop.stg_coffee_shop__customers'
[0m16:11:51.461530 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.coffee_shop.stg_coffee_shop__order_items'
[0m16:11:51.448713 [info ] [Thread-4 (]: 4 of 8 START sql table model dbt_milan.stg_coffee_shop__orders ................. [RUN]
[0m16:11:51.470527 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:11:51.471529 [debug] [Thread-5 (]: Began compiling node model.coffee_shop.stg_coffee_shop__product_prices
[0m16:11:51.478023 [debug] [Thread-5 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop__product_prices"
[0m16:11:51.472193 [debug] [Thread-7 (]: Acquiring new bigquery connection 'model.coffee_shop.stg_web_tracking__pageviews'
[0m16:11:51.472540 [debug] [Thread-2 (]: Began compiling node model.coffee_shop.stg_coffee_shop__customers
[0m16:11:51.472882 [debug] [Thread-3 (]: Began compiling node model.coffee_shop.stg_coffee_shop__order_items
[0m16:11:51.473506 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.coffee_shop.stg_coffee_shop__orders'
[0m16:11:51.483942 [debug] [Thread-4 (]: Began compiling node model.coffee_shop.stg_coffee_shop__orders
[0m16:11:51.478663 [debug] [Thread-7 (]: Began compiling node model.coffee_shop.stg_web_tracking__pageviews
[0m16:11:51.481156 [debug] [Thread-2 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop__customers"
[0m16:11:51.492089 [debug] [Thread-2 (]: Timing info for model.coffee_shop.stg_coffee_shop__customers (compile): 2023-03-09 16:11:51.479051 => 2023-03-09 16:11:51.492006
[0m16:11:51.483532 [debug] [Thread-3 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop__order_items"
[0m16:11:51.493768 [debug] [Thread-3 (]: Timing info for model.coffee_shop.stg_coffee_shop__order_items (compile): 2023-03-09 16:11:51.481445 => 2023-03-09 16:11:51.493655
[0m16:11:51.487903 [debug] [Thread-4 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop__orders"
[0m16:11:51.494861 [debug] [Thread-4 (]: Timing info for model.coffee_shop.stg_coffee_shop__orders (compile): 2023-03-09 16:11:51.484501 => 2023-03-09 16:11:51.494778
[0m16:11:51.491510 [debug] [Thread-7 (]: Writing injected SQL for node "model.coffee_shop.stg_web_tracking__pageviews"
[0m16:11:51.447574 [info ] [Thread-6 (]: 6 of 8 START sql table model dbt_milan.stg_coffee_shop__products ............... [RUN]
[0m16:11:51.494307 [debug] [Thread-3 (]: Began executing node model.coffee_shop.stg_coffee_shop__order_items
[0m16:11:51.484207 [debug] [Thread-5 (]: Timing info for model.coffee_shop.stg_coffee_shop__product_prices (compile): 2023-03-09 16:11:51.475584 => 2023-03-09 16:11:51.484125
[0m16:11:51.495242 [debug] [Thread-4 (]: Began executing node model.coffee_shop.stg_coffee_shop__orders
[0m16:11:51.492494 [debug] [Thread-2 (]: Began executing node model.coffee_shop.stg_coffee_shop__customers
[0m16:11:51.496299 [debug] [Thread-6 (]: Acquiring new bigquery connection 'model.coffee_shop.stg_coffee_shop__products'
[0m16:11:51.506550 [debug] [Thread-6 (]: Began compiling node model.coffee_shop.stg_coffee_shop__products
[0m16:11:51.500422 [debug] [Thread-5 (]: Began executing node model.coffee_shop.stg_coffee_shop__product_prices
[0m16:11:51.512999 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m16:11:51.502755 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:11:51.506212 [debug] [Thread-7 (]: Timing info for model.coffee_shop.stg_web_tracking__pageviews (compile): 2023-03-09 16:11:51.488457 => 2023-03-09 16:11:51.506156
[0m16:11:51.516027 [debug] [Thread-7 (]: Began executing node model.coffee_shop.stg_web_tracking__pageviews
[0m16:11:51.499848 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:11:51.510112 [debug] [Thread-6 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop__products"
[0m16:11:51.505891 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:11:51.530203 [debug] [Thread-6 (]: Timing info for model.coffee_shop.stg_coffee_shop__products (compile): 2023-03-09 16:11:51.506857 => 2023-03-09 16:11:51.530108
[0m16:11:51.532434 [debug] [Thread-6 (]: Began executing node model.coffee_shop.stg_coffee_shop__products
[0m16:11:51.537412 [debug] [Thread-6 (]: Opening a new connection, currently in state init
[0m16:11:51.575595 [debug] [Thread-7 (]: Writing runtime sql for node "model.coffee_shop.stg_web_tracking__pageviews"
[0m16:11:51.577024 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m16:11:51.578084 [debug] [Thread-7 (]: On model.coffee_shop.stg_web_tracking__pageviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.stg_web_tracking__pageviews"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`stg_web_tracking__pageviews`
    
    
    OPTIONS()
    as (
      

select * from `analytics-engineers-club.web_tracking.pageviews`
    );
  
[0m16:11:52.013758 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop.my_first_dbt_model"
[0m16:11:52.017832 [debug] [Thread-1 (]: On model.coffee_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.my_first_dbt_model"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`my_first_dbt_model`
    
    
    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m16:11:52.147993 [debug] [Thread-4 (]: Writing runtime sql for node "model.coffee_shop.stg_coffee_shop__orders"
[0m16:11:52.148908 [debug] [Thread-4 (]: On model.coffee_shop.stg_coffee_shop__orders: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.stg_coffee_shop__orders"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`stg_coffee_shop__orders`
    
    
    OPTIONS()
    as (
      

select * from `analytics-engineers-club.coffee_shop.orders`
    );
  
[0m16:11:52.226327 [debug] [Thread-3 (]: Writing runtime sql for node "model.coffee_shop.stg_coffee_shop__order_items"
[0m16:11:52.227433 [debug] [Thread-3 (]: On model.coffee_shop.stg_coffee_shop__order_items: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.stg_coffee_shop__order_items"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`stg_coffee_shop__order_items`
    
    
    OPTIONS()
    as (
      

select * from `analytics-engineers-club.coffee_shop.order_items`
    );
  
[0m16:11:52.242857 [debug] [Thread-6 (]: Writing runtime sql for node "model.coffee_shop.stg_coffee_shop__products"
[0m16:11:52.243776 [debug] [Thread-6 (]: On model.coffee_shop.stg_coffee_shop__products: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.stg_coffee_shop__products"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`stg_coffee_shop__products`
    
    
    OPTIONS()
    as (
      

select * from `analytics-engineers-club.coffee_shop.products`
    );
  
[0m16:11:52.299504 [debug] [Thread-2 (]: Writing runtime sql for node "model.coffee_shop.stg_coffee_shop__customers"
[0m16:11:52.300717 [debug] [Thread-2 (]: On model.coffee_shop.stg_coffee_shop__customers: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.stg_coffee_shop__customers"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`stg_coffee_shop__customers`
    
    
    OPTIONS()
    as (
      

select * from `analytics-engineers-club.coffee_shop.customers`
    );
  
[0m16:11:52.304493 [debug] [Thread-5 (]: Writing runtime sql for node "model.coffee_shop.stg_coffee_shop__product_prices"
[0m16:11:52.306342 [debug] [Thread-5 (]: On model.coffee_shop.stg_coffee_shop__product_prices: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.stg_coffee_shop__product_prices"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`stg_coffee_shop__product_prices`
    
    
    OPTIONS()
    as (
      

select * from `analytics-engineers-club.coffee_shop.product_prices`
    );
  
[0m16:11:54.405254 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:75d06f8c-4a54-4743-b730-e63d8b29373f&page=queryresults
[0m16:11:54.422431 [debug] [Thread-1 (]: Timing info for model.coffee_shop.my_first_dbt_model (execute): 2023-03-09 16:11:51.450343 => 2023-03-09 16:11:54.422360
[0m16:11:54.423833 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24db90d1-33f0-4eb3-a21a-3b2ebcf87862', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8f9c6c1f0>]}
[0m16:11:54.426238 [info ] [Thread-1 (]: 1 of 8 OK created sql table model dbt_milan.my_first_dbt_model ................. [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 2.99s]
[0m16:11:54.429111 [debug] [Thread-1 (]: Finished running node model.coffee_shop.my_first_dbt_model
[0m16:11:54.429796 [debug] [Thread-8 (]: Began running node model.coffee_shop.my_second_dbt_model
[0m16:11:54.430241 [info ] [Thread-8 (]: 8 of 8 START sql view model dbt_milan.my_second_dbt_model ...................... [RUN]
[0m16:11:54.431270 [debug] [Thread-8 (]: Acquiring new bigquery connection 'model.coffee_shop.my_second_dbt_model'
[0m16:11:54.431609 [debug] [Thread-8 (]: Began compiling node model.coffee_shop.my_second_dbt_model
[0m16:11:54.434565 [debug] [Thread-8 (]: Writing injected SQL for node "model.coffee_shop.my_second_dbt_model"
[0m16:11:54.435667 [debug] [Thread-8 (]: Timing info for model.coffee_shop.my_second_dbt_model (compile): 2023-03-09 16:11:54.431901 => 2023-03-09 16:11:54.435593
[0m16:11:54.436022 [debug] [Thread-8 (]: Began executing node model.coffee_shop.my_second_dbt_model
[0m16:11:54.455394 [debug] [Thread-8 (]: Writing runtime sql for node "model.coffee_shop.my_second_dbt_model"
[0m16:11:54.456191 [debug] [Thread-8 (]: Opening a new connection, currently in state init
[0m16:11:54.457025 [debug] [Thread-8 (]: On model.coffee_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.my_second_dbt_model"} */


  create or replace view `aec-students`.`dbt_milan`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `aec-students`.`dbt_milan`.`my_first_dbt_model`
where id = 1;


[0m16:11:54.568887 [debug] [Thread-6 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:3830ee48-01ee-4c45-8295-0a47eaf00b10&page=queryresults
[0m16:11:54.571245 [debug] [Thread-6 (]: Timing info for model.coffee_shop.stg_coffee_shop__products (execute): 2023-03-09 16:11:51.533444 => 2023-03-09 16:11:54.571178
[0m16:11:54.572095 [debug] [Thread-6 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24db90d1-33f0-4eb3-a21a-3b2ebcf87862', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8f9c3b9a0>]}
[0m16:11:54.572655 [info ] [Thread-6 (]: 6 of 8 OK created sql table model dbt_milan.stg_coffee_shop__products .......... [[32mCREATE TABLE (7.0 rows, 278.0 Bytes processed)[0m in 3.08s]
[0m16:11:54.573220 [debug] [Thread-6 (]: Finished running node model.coffee_shop.stg_coffee_shop__products
[0m16:11:54.694113 [debug] [Thread-5 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:5293f86a-2871-4d18-a4e1-4d39b0829972&page=queryresults
[0m16:11:54.696141 [debug] [Thread-5 (]: Timing info for model.coffee_shop.stg_coffee_shop__product_prices (execute): 2023-03-09 16:11:51.510450 => 2023-03-09 16:11:54.696076
[0m16:11:54.696960 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24db90d1-33f0-4eb3-a21a-3b2ebcf87862', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8f9c359f0>]}
[0m16:11:54.697492 [info ] [Thread-5 (]: 5 of 8 OK created sql table model dbt_milan.stg_coffee_shop__product_prices .... [[32mCREATE TABLE (15.0 rows, 600.0 Bytes processed)[0m in 3.23s]
[0m16:11:54.698402 [debug] [Thread-5 (]: Finished running node model.coffee_shop.stg_coffee_shop__product_prices
[0m16:11:55.350866 [debug] [Thread-8 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:574c781e-c06c-419d-8ec6-e4ca9f53f3ae&page=queryresults
[0m16:11:55.353584 [debug] [Thread-8 (]: Timing info for model.coffee_shop.my_second_dbt_model (execute): 2023-03-09 16:11:54.436255 => 2023-03-09 16:11:55.353510
[0m16:11:55.354613 [debug] [Thread-8 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24db90d1-33f0-4eb3-a21a-3b2ebcf87862', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8f9569150>]}
[0m16:11:55.355140 [info ] [Thread-8 (]: 8 of 8 OK created sql view model dbt_milan.my_second_dbt_model ................. [[32mCREATE VIEW (0 processed)[0m in 0.92s]
[0m16:11:55.355661 [debug] [Thread-8 (]: Finished running node model.coffee_shop.my_second_dbt_model
[0m16:11:56.055268 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:770f7f32-56ca-4a8c-933e-68a5dcac2043&page=queryresults
[0m16:11:56.058087 [debug] [Thread-2 (]: Timing info for model.coffee_shop.stg_coffee_shop__customers (execute): 2023-03-09 16:11:51.503120 => 2023-03-09 16:11:56.058006
[0m16:11:56.058930 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24db90d1-33f0-4eb3-a21a-3b2ebcf87862', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8f9c35870>]}
[0m16:11:56.059476 [info ] [Thread-2 (]: 2 of 8 OK created sql table model dbt_milan.stg_coffee_shop__customers ......... [[32mCREATE TABLE (174.4k rows, 12.8 MB processed)[0m in 4.61s]
[0m16:11:56.060003 [debug] [Thread-2 (]: Finished running node model.coffee_shop.stg_coffee_shop__customers
[0m16:11:56.888893 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:5234f006-5452-495d-9f3e-cd28b2a08747&page=queryresults
[0m16:11:56.891085 [debug] [Thread-4 (]: Timing info for model.coffee_shop.stg_coffee_shop__orders (execute): 2023-03-09 16:11:51.500753 => 2023-03-09 16:11:56.891020
[0m16:11:56.891943 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24db90d1-33f0-4eb3-a21a-3b2ebcf87862', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8f956ac50>]}
[0m16:11:56.892484 [info ] [Thread-4 (]: 4 of 8 OK created sql table model dbt_milan.stg_coffee_shop__orders ............ [[32mCREATE TABLE (192.0k rows, 24.7 MB processed)[0m in 5.42s]
[0m16:11:56.893012 [debug] [Thread-4 (]: Finished running node model.coffee_shop.stg_coffee_shop__orders
[0m16:11:57.291958 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:9c91cf50-088a-4a3c-b25c-e4dee64d1e32&page=queryresults
[0m16:11:57.294637 [debug] [Thread-3 (]: Timing info for model.coffee_shop.stg_coffee_shop__order_items (execute): 2023-03-09 16:11:51.496688 => 2023-03-09 16:11:57.294561
[0m16:11:57.295606 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24db90d1-33f0-4eb3-a21a-3b2ebcf87862', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8f956a740>]}
[0m16:11:57.296253 [info ] [Thread-3 (]: 3 of 8 OK created sql table model dbt_milan.stg_coffee_shop__order_items ....... [[32mCREATE TABLE (383.8k rows, 30.7 MB processed)[0m in 5.83s]
[0m16:11:57.297282 [debug] [Thread-3 (]: Finished running node model.coffee_shop.stg_coffee_shop__order_items
[0m16:12:00.388305 [debug] [Thread-7 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:e7ae186e-1db7-49cf-8610-09e50e24e533&page=queryresults
[0m16:12:00.391170 [debug] [Thread-7 (]: Timing info for model.coffee_shop.stg_web_tracking__pageviews (execute): 2023-03-09 16:11:51.516299 => 2023-03-09 16:12:00.391078
[0m16:12:00.392075 [debug] [Thread-7 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '24db90d1-33f0-4eb3-a21a-3b2ebcf87862', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8f9c34220>]}
[0m16:12:00.392592 [info ] [Thread-7 (]: 7 of 8 OK created sql table model dbt_milan.stg_web_tracking__pageviews ........ [[32mCREATE TABLE (5.8m rows, 606.0 MB processed)[0m in 8.92s]
[0m16:12:00.393126 [debug] [Thread-7 (]: Finished running node model.coffee_shop.stg_web_tracking__pageviews
[0m16:12:00.395451 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:12:00.396484 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:12:00.396790 [debug] [MainThread]: Connection 'model.coffee_shop.my_first_dbt_model' was properly closed.
[0m16:12:00.397048 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop__customers' was properly closed.
[0m16:12:00.397296 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop__order_items' was properly closed.
[0m16:12:00.397549 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop__product_prices' was properly closed.
[0m16:12:00.397821 [debug] [MainThread]: Connection 'model.coffee_shop.stg_web_tracking__pageviews' was properly closed.
[0m16:12:00.398064 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop__orders' was properly closed.
[0m16:12:00.398364 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop__products' was properly closed.
[0m16:12:00.398627 [debug] [MainThread]: Connection 'model.coffee_shop.my_second_dbt_model' was properly closed.
[0m16:12:00.399051 [info ] [MainThread]: 
[0m16:12:00.399486 [info ] [MainThread]: Finished running 7 table models, 1 view model in 0 hours 0 minutes and 10.45 seconds (10.45s).
[0m16:12:00.400661 [debug] [MainThread]: Command end result
[0m16:12:00.429440 [info ] [MainThread]: 
[0m16:12:00.430157 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:12:00.430789 [info ] [MainThread]: 
[0m16:12:00.431400 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m16:12:00.432120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8f9c7c400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8f9c7ee30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8f9c7fb80>]}
[0m16:12:00.432741 [debug] [MainThread]: Flushing usage events


============================== 2023-03-10 13:33:46.273494 | 0d396060-2764-483e-82f4-dfed60e50246 ==============================
[0m13:33:46.273494 [info ] [MainThread]: Running with dbt=1.4.1
[0m13:33:46.280227 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:33:46.280810 [debug] [MainThread]: Tracking: tracking
[0m13:33:46.291087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f381e665030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f381e665f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f381e665060>]}
[0m13:33:46.544524 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m13:33:46.545283 [debug] [MainThread]: Partial parsing: updated file: coffee_shop://models/staging/web_tracking/stg_web_tracking__sources.yml
[0m13:33:46.545758 [debug] [MainThread]: Partial parsing: updated file: coffee_shop://models/staging/web_tracking/stg_web_tracking__pageviews.sql
[0m13:33:46.559656 [debug] [MainThread]: 1699: static parser successfully parsed staging/web_tracking/stg_web_tracking__pageviews.sql
[0m13:33:46.581476 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'pageviews' in the 'models' section of file 'models/staging/web_tracking/stg_web_tracking__sources.yml'
[0m13:33:46.666301 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.coffee_shop.unique_pageviews_id.9561984f36' (models/staging/web_tracking/stg_web_tracking__sources.yml) depends on a node named 'pageviews' in package '' which was not found
[0m13:33:46.667178 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.coffee_shop.not_null_pageviews_id.877003fcbb' (models/staging/web_tracking/stg_web_tracking__sources.yml) depends on a node named 'pageviews' in package '' which was not found
[0m13:33:46.674691 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffe_shop_milan.example
[0m13:33:46.680553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0d396060-2764-483e-82f4-dfed60e50246', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f381e633dc0>]}
[0m13:33:46.689088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0d396060-2764-483e-82f4-dfed60e50246', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f381e610910>]}
[0m13:33:46.689530 [info ] [MainThread]: Found 8 models, 10 tests, 0 snapshots, 0 analyses, 334 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
[0m13:33:46.690043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d396060-2764-483e-82f4-dfed60e50246', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f381e613fa0>]}
[0m13:33:46.692017 [info ] [MainThread]: 
[0m13:33:46.694369 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:33:46.696014 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m13:33:46.696487 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:33:49.988913 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_milan'
[0m13:33:49.989702 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:33:50.396682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d396060-2764-483e-82f4-dfed60e50246', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f381e613640>]}
[0m13:33:50.397794 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m13:33:50.398858 [info ] [MainThread]: 
[0m13:33:50.426894 [debug] [Thread-1 (]: Began running node model.coffee_shop.my_first_dbt_model
[0m13:33:50.427310 [debug] [Thread-2 (]: Began running node model.coffee_shop.stg_coffee_shop__customers
[0m13:33:50.427623 [debug] [Thread-3 (]: Began running node model.coffee_shop.stg_coffee_shop__order_items
[0m13:33:50.427880 [debug] [Thread-4 (]: Began running node model.coffee_shop.stg_coffee_shop__orders
[0m13:33:50.431641 [info ] [Thread-4 (]: 4 of 8 START sql table model dbt_milan.stg_coffee_shop__orders ................. [RUN]
[0m13:33:50.432372 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.coffee_shop.stg_coffee_shop__orders'
[0m13:33:50.428176 [debug] [Thread-5 (]: Began running node model.coffee_shop.stg_coffee_shop__product_prices
[0m13:33:50.433480 [info ] [Thread-5 (]: 5 of 8 START sql table model dbt_milan.stg_coffee_shop__product_prices ......... [RUN]
[0m13:33:50.434320 [debug] [Thread-5 (]: Acquiring new bigquery connection 'model.coffee_shop.stg_coffee_shop__product_prices'
[0m13:33:50.431139 [info ] [Thread-3 (]: 3 of 8 START sql table model dbt_milan.stg_coffee_shop__order_items ............ [RUN]
[0m13:33:50.428476 [debug] [Thread-6 (]: Began running node model.coffee_shop.stg_coffee_shop__products
[0m13:33:50.435883 [info ] [Thread-6 (]: 6 of 8 START sql table model dbt_milan.stg_coffee_shop__products ............... [RUN]
[0m13:33:50.429034 [debug] [Thread-7 (]: Began running node model.coffee_shop.stg_web_tracking__pageviews
[0m13:33:50.434615 [debug] [Thread-5 (]: Began compiling node model.coffee_shop.stg_coffee_shop__product_prices
[0m13:33:50.432954 [debug] [Thread-4 (]: Began compiling node model.coffee_shop.stg_coffee_shop__orders
[0m13:33:50.447957 [debug] [Thread-4 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop__orders"
[0m13:33:50.435444 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.coffee_shop.stg_coffee_shop__order_items'
[0m13:33:50.436871 [debug] [Thread-6 (]: Acquiring new bigquery connection 'model.coffee_shop.stg_coffee_shop__products'
[0m13:33:50.437732 [info ] [Thread-7 (]: 7 of 8 START sql table model dbt_milan.stg_web_tracking__pageviews ............. [RUN]
[0m13:33:50.429551 [info ] [Thread-1 (]: 1 of 8 START sql table model dbt_milan.my_first_dbt_model ...................... [RUN]
[0m13:33:50.451163 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop.my_first_dbt_model'
[0m13:33:50.451543 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.my_first_dbt_model
[0m13:33:50.448492 [debug] [Thread-4 (]: Timing info for model.coffee_shop.stg_coffee_shop__orders (compile): 2023-03-10 13:33:50.444762 => 2023-03-10 13:33:50.448397
[0m13:33:50.449312 [debug] [Thread-3 (]: Began compiling node model.coffee_shop.stg_coffee_shop__order_items
[0m13:33:50.449681 [debug] [Thread-6 (]: Began compiling node model.coffee_shop.stg_coffee_shop__products
[0m13:33:50.459172 [debug] [Thread-6 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop__products"
[0m13:33:50.459624 [debug] [Thread-6 (]: Timing info for model.coffee_shop.stg_coffee_shop__products (compile): 2023-03-10 13:33:50.457226 => 2023-03-10 13:33:50.459552
[0m13:33:50.454085 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.my_first_dbt_model"
[0m13:33:50.443077 [debug] [Thread-5 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop__product_prices"
[0m13:33:50.454518 [debug] [Thread-4 (]: Began executing node model.coffee_shop.stg_coffee_shop__orders
[0m13:33:50.456972 [debug] [Thread-3 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop__order_items"
[0m13:33:50.459922 [debug] [Thread-6 (]: Began executing node model.coffee_shop.stg_coffee_shop__products
[0m13:33:50.450411 [debug] [Thread-7 (]: Acquiring new bigquery connection 'model.coffee_shop.stg_web_tracking__pageviews'
[0m13:33:50.460419 [debug] [Thread-1 (]: Timing info for model.coffee_shop.my_first_dbt_model (compile): 2023-03-10 13:33:50.451749 => 2023-03-10 13:33:50.460342
[0m13:33:50.430274 [info ] [Thread-2 (]: 2 of 8 START sql table model dbt_milan.stg_coffee_shop__customers .............. [RUN]
[0m13:33:50.469298 [debug] [Thread-5 (]: Timing info for model.coffee_shop.stg_coffee_shop__product_prices (compile): 2023-03-10 13:33:50.438856 => 2023-03-10 13:33:50.469212
[0m13:33:50.483632 [debug] [Thread-5 (]: Began executing node model.coffee_shop.stg_coffee_shop__product_prices
[0m13:33:50.479314 [debug] [Thread-6 (]: Opening a new connection, currently in state init
[0m13:33:50.479582 [debug] [Thread-7 (]: Began compiling node model.coffee_shop.stg_web_tracking__pageviews
[0m13:33:50.482373 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:33:50.482673 [debug] [Thread-1 (]: Began executing node model.coffee_shop.my_first_dbt_model
[0m13:33:50.494798 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:33:50.487352 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m13:33:50.474860 [debug] [Thread-3 (]: Timing info for model.coffee_shop.stg_coffee_shop__order_items (compile): 2023-03-10 13:33:50.454790 => 2023-03-10 13:33:50.474789
[0m13:33:50.500371 [debug] [Thread-3 (]: Began executing node model.coffee_shop.stg_coffee_shop__order_items
[0m13:33:50.483321 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.coffee_shop.stg_coffee_shop__customers'
[0m13:33:50.504190 [debug] [Thread-2 (]: Began compiling node model.coffee_shop.stg_coffee_shop__customers
[0m13:33:50.507809 [debug] [Thread-2 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop__customers"
[0m13:33:50.492243 [debug] [Thread-7 (]: Writing injected SQL for node "model.coffee_shop.stg_web_tracking__pageviews"
[0m13:33:50.509275 [debug] [Thread-7 (]: Timing info for model.coffee_shop.stg_web_tracking__pageviews (compile): 2023-03-10 13:33:50.489499 => 2023-03-10 13:33:50.509183
[0m13:33:50.509959 [debug] [Thread-7 (]: Began executing node model.coffee_shop.stg_web_tracking__pageviews
[0m13:33:50.513403 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m13:33:50.503728 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:33:50.513984 [debug] [Thread-2 (]: Timing info for model.coffee_shop.stg_coffee_shop__customers (compile): 2023-03-10 13:33:50.504502 => 2023-03-10 13:33:50.513900
[0m13:33:50.520129 [debug] [Thread-2 (]: Began executing node model.coffee_shop.stg_coffee_shop__customers
[0m13:33:50.523153 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:33:51.209627 [debug] [Thread-7 (]: Writing runtime sql for node "model.coffee_shop.stg_web_tracking__pageviews"
[0m13:33:51.210956 [debug] [Thread-5 (]: Writing runtime sql for node "model.coffee_shop.stg_coffee_shop__product_prices"
[0m13:33:51.212809 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop.my_first_dbt_model"
[0m13:33:51.214538 [debug] [Thread-6 (]: Writing runtime sql for node "model.coffee_shop.stg_coffee_shop__products"
[0m13:33:51.216151 [debug] [Thread-3 (]: Writing runtime sql for node "model.coffee_shop.stg_coffee_shop__order_items"
[0m13:33:51.217389 [debug] [Thread-4 (]: Writing runtime sql for node "model.coffee_shop.stg_coffee_shop__orders"
[0m13:33:51.220178 [debug] [Thread-4 (]: On model.coffee_shop.stg_coffee_shop__orders: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.stg_coffee_shop__orders"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`stg_coffee_shop__orders`
    
    
    OPTIONS()
    as (
      

select * from `analytics-engineers-club.coffee_shop.orders`
    );
  
[0m13:33:51.219259 [debug] [Thread-1 (]: On model.coffee_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.my_first_dbt_model"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`my_first_dbt_model`
    
    
    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m13:33:51.218671 [debug] [Thread-5 (]: On model.coffee_shop.stg_coffee_shop__product_prices: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.stg_coffee_shop__product_prices"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`stg_coffee_shop__product_prices`
    
    
    OPTIONS()
    as (
      

select * from `analytics-engineers-club.coffee_shop.product_prices`
    );
  
[0m13:33:51.220654 [debug] [Thread-7 (]: On model.coffee_shop.stg_web_tracking__pageviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.stg_web_tracking__pageviews"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`stg_web_tracking__pageviews`
    
    
    OPTIONS()
    as (
      

select * from `analytics-engineers-club`.`web_tracking`.`pageviews`
    );
  
[0m13:33:51.221603 [debug] [Thread-3 (]: On model.coffee_shop.stg_coffee_shop__order_items: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.stg_coffee_shop__order_items"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`stg_coffee_shop__order_items`
    
    
    OPTIONS()
    as (
      

select * from `analytics-engineers-club.coffee_shop.order_items`
    );
  
[0m13:33:51.226130 [debug] [Thread-6 (]: On model.coffee_shop.stg_coffee_shop__products: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.stg_coffee_shop__products"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`stg_coffee_shop__products`
    
    
    OPTIONS()
    as (
      

select * from `analytics-engineers-club.coffee_shop.products`
    );
  
[0m13:33:51.279987 [debug] [Thread-2 (]: Writing runtime sql for node "model.coffee_shop.stg_coffee_shop__customers"
[0m13:33:51.280715 [debug] [Thread-2 (]: On model.coffee_shop.stg_coffee_shop__customers: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.stg_coffee_shop__customers"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`stg_coffee_shop__customers`
    
    
    OPTIONS()
    as (
      

select * from `analytics-engineers-club.coffee_shop.customers`
    );
  
[0m13:33:53.496922 [debug] [Thread-6 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:fa6c744f-2f82-4649-89c6-6ef727cb7bea&page=queryresults
[0m13:33:53.515052 [debug] [Thread-6 (]: Timing info for model.coffee_shop.stg_coffee_shop__products (execute): 2023-03-10 13:33:50.463683 => 2023-03-10 13:33:53.514986
[0m13:33:53.515812 [debug] [Thread-6 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d396060-2764-483e-82f4-dfed60e50246', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f381e6411b0>]}
[0m13:33:53.516341 [info ] [Thread-6 (]: 6 of 8 OK created sql table model dbt_milan.stg_coffee_shop__products .......... [[32mCREATE TABLE (7.0 rows, 278.0 Bytes processed)[0m in 3.08s]
[0m13:33:53.518335 [debug] [Thread-6 (]: Finished running node model.coffee_shop.stg_coffee_shop__products
[0m13:33:53.527132 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:797c35d3-7064-4a78-9682-9b647e4e5f7f&page=queryresults
[0m13:33:53.528811 [debug] [Thread-1 (]: Timing info for model.coffee_shop.my_first_dbt_model (execute): 2023-03-10 13:33:50.493140 => 2023-03-10 13:33:53.528764
[0m13:33:53.529503 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d396060-2764-483e-82f4-dfed60e50246', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f381dfbce80>]}
[0m13:33:53.529986 [info ] [Thread-1 (]: 1 of 8 OK created sql table model dbt_milan.my_first_dbt_model ................. [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 3.08s]
[0m13:33:53.530535 [debug] [Thread-1 (]: Finished running node model.coffee_shop.my_first_dbt_model
[0m13:33:53.532117 [debug] [Thread-8 (]: Began running node model.coffee_shop.my_second_dbt_model
[0m13:33:53.532541 [info ] [Thread-8 (]: 8 of 8 START sql view model dbt_milan.my_second_dbt_model ...................... [RUN]
[0m13:33:53.533551 [debug] [Thread-8 (]: Acquiring new bigquery connection 'model.coffee_shop.my_second_dbt_model'
[0m13:33:53.533973 [debug] [Thread-8 (]: Began compiling node model.coffee_shop.my_second_dbt_model
[0m13:33:53.536706 [debug] [Thread-8 (]: Writing injected SQL for node "model.coffee_shop.my_second_dbt_model"
[0m13:33:53.537244 [debug] [Thread-8 (]: Timing info for model.coffee_shop.my_second_dbt_model (compile): 2023-03-10 13:33:53.534203 => 2023-03-10 13:33:53.537158
[0m13:33:53.537618 [debug] [Thread-8 (]: Began executing node model.coffee_shop.my_second_dbt_model
[0m13:33:53.556697 [debug] [Thread-8 (]: Writing runtime sql for node "model.coffee_shop.my_second_dbt_model"
[0m13:33:53.557292 [debug] [Thread-8 (]: Opening a new connection, currently in state init
[0m13:33:53.557701 [debug] [Thread-8 (]: On model.coffee_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.my_second_dbt_model"} */


  create or replace view `aec-students`.`dbt_milan`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `aec-students`.`dbt_milan`.`my_first_dbt_model`
where id = 1;


[0m13:33:53.617784 [debug] [Thread-5 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:a709d16c-d12c-4352-9261-9ecb4b7dc7a7&page=queryresults
[0m13:33:53.627278 [debug] [Thread-5 (]: Timing info for model.coffee_shop.stg_coffee_shop__product_prices (execute): 2023-03-10 13:33:50.483830 => 2023-03-10 13:33:53.627193
[0m13:33:53.629585 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d396060-2764-483e-82f4-dfed60e50246', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f381dfbab00>]}
[0m13:33:53.630412 [info ] [Thread-5 (]: 5 of 8 OK created sql table model dbt_milan.stg_coffee_shop__product_prices .... [[32mCREATE TABLE (15.0 rows, 600.0 Bytes processed)[0m in 3.20s]
[0m13:33:53.634382 [debug] [Thread-5 (]: Finished running node model.coffee_shop.stg_coffee_shop__product_prices
[0m13:33:54.357132 [debug] [Thread-8 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:897c65ec-ea74-41c0-bcf5-bd029916582f&page=queryresults
[0m13:33:54.359313 [debug] [Thread-8 (]: Timing info for model.coffee_shop.my_second_dbt_model (execute): 2023-03-10 13:33:53.537822 => 2023-03-10 13:33:54.359234
[0m13:33:54.360318 [debug] [Thread-8 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d396060-2764-483e-82f4-dfed60e50246', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f381e643310>]}
[0m13:33:54.361038 [info ] [Thread-8 (]: 8 of 8 OK created sql view model dbt_milan.my_second_dbt_model ................. [[32mCREATE VIEW (0 processed)[0m in 0.83s]
[0m13:33:54.361665 [debug] [Thread-8 (]: Finished running node model.coffee_shop.my_second_dbt_model
[0m13:33:54.495921 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:86d8a812-3ca4-4d2c-a465-15fbf1fde8b1&page=queryresults
[0m13:33:54.498406 [debug] [Thread-2 (]: Timing info for model.coffee_shop.stg_coffee_shop__customers (execute): 2023-03-10 13:33:50.520432 => 2023-03-10 13:33:54.498339
[0m13:33:54.499413 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d396060-2764-483e-82f4-dfed60e50246', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f381e642d40>]}
[0m13:33:54.500111 [info ] [Thread-2 (]: 2 of 8 OK created sql table model dbt_milan.stg_coffee_shop__customers ......... [[32mCREATE TABLE (174.4k rows, 12.8 MB processed)[0m in 4.02s]
[0m13:33:54.501032 [debug] [Thread-2 (]: Finished running node model.coffee_shop.stg_coffee_shop__customers
[0m13:33:54.958405 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:326ad7cc-cb26-4b39-96ec-0f159e18acb0&page=queryresults
[0m13:33:54.961159 [debug] [Thread-4 (]: Timing info for model.coffee_shop.stg_coffee_shop__orders (execute): 2023-03-10 13:33:50.461138 => 2023-03-10 13:33:54.961084
[0m13:33:54.962213 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d396060-2764-483e-82f4-dfed60e50246', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f381e642050>]}
[0m13:33:54.962918 [info ] [Thread-4 (]: 4 of 8 OK created sql table model dbt_milan.stg_coffee_shop__orders ............ [[32mCREATE TABLE (192.0k rows, 24.7 MB processed)[0m in 4.53s]
[0m13:33:54.963756 [debug] [Thread-4 (]: Finished running node model.coffee_shop.stg_coffee_shop__orders
[0m13:33:57.414123 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:39b54574-f88f-4af8-a45a-a778da535196&page=queryresults
[0m13:33:57.417011 [debug] [Thread-3 (]: Timing info for model.coffee_shop.stg_coffee_shop__order_items (execute): 2023-03-10 13:33:50.500922 => 2023-03-10 13:33:57.416938
[0m13:33:57.417989 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d396060-2764-483e-82f4-dfed60e50246', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f381e5703d0>]}
[0m13:33:57.418623 [info ] [Thread-3 (]: 3 of 8 OK created sql table model dbt_milan.stg_coffee_shop__order_items ....... [[32mCREATE TABLE (383.8k rows, 30.7 MB processed)[0m in 6.98s]
[0m13:33:57.419542 [debug] [Thread-3 (]: Finished running node model.coffee_shop.stg_coffee_shop__order_items
[0m13:34:00.298542 [debug] [Thread-7 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:951c6d85-704c-46df-af9b-89483d0a41fa&page=queryresults
[0m13:34:00.301137 [debug] [Thread-7 (]: Timing info for model.coffee_shop.stg_web_tracking__pageviews (execute): 2023-03-10 13:33:50.510375 => 2023-03-10 13:34:00.301071
[0m13:34:00.302134 [debug] [Thread-7 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d396060-2764-483e-82f4-dfed60e50246', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f381df9d240>]}
[0m13:34:00.302739 [info ] [Thread-7 (]: 7 of 8 OK created sql table model dbt_milan.stg_web_tracking__pageviews ........ [[32mCREATE TABLE (5.8m rows, 606.0 MB processed)[0m in 9.85s]
[0m13:34:00.303561 [debug] [Thread-7 (]: Finished running node model.coffee_shop.stg_web_tracking__pageviews
[0m13:34:00.306321 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:34:00.306935 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:34:00.307181 [debug] [MainThread]: Connection 'model.coffee_shop.my_first_dbt_model' was properly closed.
[0m13:34:00.307425 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop__orders' was properly closed.
[0m13:34:00.307657 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop__product_prices' was properly closed.
[0m13:34:00.307892 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop__order_items' was properly closed.
[0m13:34:00.308123 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop__products' was properly closed.
[0m13:34:00.308382 [debug] [MainThread]: Connection 'model.coffee_shop.stg_web_tracking__pageviews' was properly closed.
[0m13:34:00.308677 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop__customers' was properly closed.
[0m13:34:00.308908 [debug] [MainThread]: Connection 'model.coffee_shop.my_second_dbt_model' was properly closed.
[0m13:34:00.309242 [info ] [MainThread]: 
[0m13:34:00.309753 [info ] [MainThread]: Finished running 7 table models, 1 view model in 0 hours 0 minutes and 13.62 seconds (13.62s).
[0m13:34:00.310905 [debug] [MainThread]: Command end result
[0m13:34:00.321655 [info ] [MainThread]: 
[0m13:34:00.322202 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:34:00.322711 [info ] [MainThread]: 
[0m13:34:00.323206 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m13:34:00.323975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f381dfbce80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f381e6119c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f381e6124d0>]}
[0m13:34:00.324449 [debug] [MainThread]: Flushing usage events


============================== 2023-03-10 13:44:09.662747 | 5540ba34-f810-4c6c-90bb-b22647728964 ==============================
[0m13:44:09.662747 [info ] [MainThread]: Running with dbt=1.4.1
[0m13:44:09.665624 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:44:09.666213 [debug] [MainThread]: Tracking: tracking
[0m13:44:09.671782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ea645f7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ea645e8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ea645f850>]}
[0m13:44:09.724382 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m13:44:09.724977 [debug] [MainThread]: Partial parsing: added file: coffee_shop://models/marts/web_tracking/pageviews_with_user_id.sql
[0m13:44:09.741734 [debug] [MainThread]: 1699: static parser successfully parsed marts/web_tracking/pageviews_with_user_id.sql
[0m13:44:09.754857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ea6439570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ea626af20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7ea626ad10>]}
[0m13:44:09.755266 [debug] [MainThread]: Flushing usage events
[0m13:44:10.150946 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.coffee_shop.pageviews_with_user_id' (models/marts/web_tracking/pageviews_with_user_id.sql) depends on a node named 'stg_web_tracking_pageviews' which was not found


============================== 2023-03-10 13:45:34.510867 | 599f48d6-7ea0-478f-8241-8c60d07d6b8a ==============================
[0m13:45:34.510867 [info ] [MainThread]: Running with dbt=1.4.1
[0m13:45:34.513436 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:45:34.513945 [debug] [MainThread]: Tracking: tracking
[0m13:45:34.518267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4231a614b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4231a621a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4231a631c0>]}
[0m13:45:34.573747 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m13:45:34.574305 [debug] [MainThread]: Partial parsing: added file: coffee_shop://models/marts/web_tracking/pageviews_with_user_id.sql
[0m13:45:34.587702 [debug] [MainThread]: 1699: static parser successfully parsed marts/web_tracking/pageviews_with_user_id.sql
[0m13:45:34.606176 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffe_shop_milan.example
[0m13:45:34.611896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '599f48d6-7ea0-478f-8241-8c60d07d6b8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42318b5120>]}
[0m13:45:34.622073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '599f48d6-7ea0-478f-8241-8c60d07d6b8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f423186f280>]}
[0m13:45:34.622619 [info ] [MainThread]: Found 9 models, 10 tests, 0 snapshots, 0 analyses, 334 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
[0m13:45:34.623064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '599f48d6-7ea0-478f-8241-8c60d07d6b8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f423186f2b0>]}
[0m13:45:34.625538 [info ] [MainThread]: 
[0m13:45:34.687732 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:45:34.689460 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m13:45:34.690044 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:45:35.847318 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_milan'
[0m13:45:35.848001 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:45:36.203370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '599f48d6-7ea0-478f-8241-8c60d07d6b8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4231e8ce50>]}
[0m13:45:36.204427 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m13:45:36.205207 [info ] [MainThread]: 
[0m13:45:36.211471 [debug] [Thread-1 (]: Began running node model.coffee_shop.my_first_dbt_model
[0m13:45:36.211783 [debug] [Thread-2 (]: Began running node model.coffee_shop.stg_coffee_shop__customers
[0m13:45:36.212063 [debug] [Thread-3 (]: Began running node model.coffee_shop.stg_coffee_shop__order_items
[0m13:45:36.212369 [debug] [Thread-4 (]: Began running node model.coffee_shop.stg_coffee_shop__orders
[0m13:45:36.212649 [debug] [Thread-5 (]: Began running node model.coffee_shop.stg_coffee_shop__product_prices
[0m13:45:36.212931 [debug] [Thread-6 (]: Began running node model.coffee_shop.stg_coffee_shop__products
[0m13:45:36.213236 [debug] [Thread-7 (]: Began running node model.coffee_shop.stg_web_tracking__pageviews
[0m13:45:36.213651 [info ] [Thread-1 (]: 1 of 9 START sql table model dbt_milan.my_first_dbt_model ...................... [RUN]
[0m13:45:36.218625 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop.my_first_dbt_model'
[0m13:45:36.219182 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.my_first_dbt_model
[0m13:45:36.215807 [info ] [Thread-4 (]: 4 of 9 START sql table model dbt_milan.stg_coffee_shop__orders ................. [RUN]
[0m13:45:36.223561 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.coffee_shop.stg_coffee_shop__orders'
[0m13:45:36.216394 [info ] [Thread-5 (]: 5 of 9 START sql table model dbt_milan.stg_coffee_shop__product_prices ......... [RUN]
[0m13:45:36.214892 [info ] [Thread-3 (]: 3 of 9 START sql table model dbt_milan.stg_coffee_shop__order_items ............ [RUN]
[0m13:45:36.226002 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.coffee_shop.stg_coffee_shop__order_items'
[0m13:45:36.217768 [info ] [Thread-7 (]: 7 of 9 START sql table model dbt_milan.stg_web_tracking__pageviews ............. [RUN]
[0m13:45:36.214120 [info ] [Thread-2 (]: 2 of 9 START sql table model dbt_milan.stg_coffee_shop__customers .............. [RUN]
[0m13:45:36.217246 [info ] [Thread-6 (]: 6 of 9 START sql table model dbt_milan.stg_coffee_shop__products ............... [RUN]
[0m13:45:36.224042 [debug] [Thread-4 (]: Began compiling node model.coffee_shop.stg_coffee_shop__orders
[0m13:45:36.225286 [debug] [Thread-5 (]: Acquiring new bigquery connection 'model.coffee_shop.stg_coffee_shop__product_prices'
[0m13:45:36.226336 [debug] [Thread-3 (]: Began compiling node model.coffee_shop.stg_coffee_shop__order_items
[0m13:45:36.222636 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.my_first_dbt_model"
[0m13:45:36.226942 [debug] [Thread-7 (]: Acquiring new bigquery connection 'model.coffee_shop.stg_web_tracking__pageviews'
[0m13:45:36.227616 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.coffee_shop.stg_coffee_shop__customers'
[0m13:45:36.228228 [debug] [Thread-6 (]: Acquiring new bigquery connection 'model.coffee_shop.stg_coffee_shop__products'
[0m13:45:36.230837 [debug] [Thread-4 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop__orders"
[0m13:45:36.231179 [debug] [Thread-5 (]: Began compiling node model.coffee_shop.stg_coffee_shop__product_prices
[0m13:45:36.233602 [debug] [Thread-3 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop__order_items"
[0m13:45:36.234181 [debug] [Thread-7 (]: Began compiling node model.coffee_shop.stg_web_tracking__pageviews
[0m13:45:36.234667 [debug] [Thread-2 (]: Began compiling node model.coffee_shop.stg_coffee_shop__customers
[0m13:45:36.235095 [debug] [Thread-1 (]: Timing info for model.coffee_shop.my_first_dbt_model (compile): 2023-03-10 13:45:36.219504 => 2023-03-10 13:45:36.234960
[0m13:45:36.235343 [debug] [Thread-6 (]: Began compiling node model.coffee_shop.stg_coffee_shop__products
[0m13:45:36.235899 [debug] [Thread-4 (]: Timing info for model.coffee_shop.stg_coffee_shop__orders (compile): 2023-03-10 13:45:36.228516 => 2023-03-10 13:45:36.235819
[0m13:45:36.239144 [debug] [Thread-5 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop__product_prices"
[0m13:45:36.245302 [debug] [Thread-7 (]: Writing injected SQL for node "model.coffee_shop.stg_web_tracking__pageviews"
[0m13:45:36.258639 [debug] [Thread-7 (]: Timing info for model.coffee_shop.stg_web_tracking__pageviews (compile): 2023-03-10 13:45:36.239503 => 2023-03-10 13:45:36.258550
[0m13:45:36.259215 [debug] [Thread-7 (]: Began executing node model.coffee_shop.stg_web_tracking__pageviews
[0m13:45:36.250328 [debug] [Thread-3 (]: Timing info for model.coffee_shop.stg_coffee_shop__order_items (compile): 2023-03-10 13:45:36.231456 => 2023-03-10 13:45:36.250275
[0m13:45:36.252508 [debug] [Thread-6 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop__products"
[0m13:45:36.252938 [debug] [Thread-4 (]: Began executing node model.coffee_shop.stg_coffee_shop__orders
[0m13:45:36.257247 [debug] [Thread-5 (]: Timing info for model.coffee_shop.stg_coffee_shop__product_prices (compile): 2023-03-10 13:45:36.236237 => 2023-03-10 13:45:36.257147
[0m13:45:36.250089 [debug] [Thread-1 (]: Began executing node model.coffee_shop.my_first_dbt_model
[0m13:45:36.249461 [debug] [Thread-2 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop__customers"
[0m13:45:36.265284 [debug] [Thread-3 (]: Began executing node model.coffee_shop.stg_coffee_shop__order_items
[0m13:45:36.298762 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:45:36.289343 [debug] [Thread-5 (]: Began executing node model.coffee_shop.stg_coffee_shop__product_prices
[0m13:45:36.302565 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m13:45:36.288297 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:45:36.293615 [debug] [Thread-6 (]: Timing info for model.coffee_shop.stg_coffee_shop__products (compile): 2023-03-10 13:45:36.250548 => 2023-03-10 13:45:36.293522
[0m13:45:36.294970 [debug] [Thread-2 (]: Timing info for model.coffee_shop.stg_coffee_shop__customers (compile): 2023-03-10 13:45:36.245565 => 2023-03-10 13:45:36.294892
[0m13:45:36.292644 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:45:36.285308 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m13:45:36.315538 [debug] [Thread-6 (]: Began executing node model.coffee_shop.stg_coffee_shop__products
[0m13:45:36.316035 [debug] [Thread-2 (]: Began executing node model.coffee_shop.stg_coffee_shop__customers
[0m13:45:36.330734 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:45:36.327848 [debug] [Thread-6 (]: Opening a new connection, currently in state init
[0m13:45:37.061125 [debug] [Thread-7 (]: Writing runtime sql for node "model.coffee_shop.stg_web_tracking__pageviews"
[0m13:45:37.062812 [debug] [Thread-7 (]: On model.coffee_shop.stg_web_tracking__pageviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.stg_web_tracking__pageviews"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`stg_web_tracking__pageviews`
    
    
    OPTIONS()
    as (
      

select * from `analytics-engineers-club`.`web_tracking`.`pageviews`
    );
  
[0m13:45:37.064303 [debug] [Thread-3 (]: Writing runtime sql for node "model.coffee_shop.stg_coffee_shop__order_items"
[0m13:45:37.066510 [debug] [Thread-3 (]: On model.coffee_shop.stg_coffee_shop__order_items: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.stg_coffee_shop__order_items"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`stg_coffee_shop__order_items`
    
    
    OPTIONS()
    as (
      

select * from `analytics-engineers-club.coffee_shop.order_items`
    );
  
[0m13:45:37.081765 [debug] [Thread-2 (]: Writing runtime sql for node "model.coffee_shop.stg_coffee_shop__customers"
[0m13:45:37.082235 [debug] [Thread-2 (]: On model.coffee_shop.stg_coffee_shop__customers: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.stg_coffee_shop__customers"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`stg_coffee_shop__customers`
    
    
    OPTIONS()
    as (
      

select * from `analytics-engineers-club.coffee_shop.customers`
    );
  
[0m13:45:37.088686 [debug] [Thread-4 (]: Writing runtime sql for node "model.coffee_shop.stg_coffee_shop__orders"
[0m13:45:37.089407 [debug] [Thread-4 (]: On model.coffee_shop.stg_coffee_shop__orders: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.stg_coffee_shop__orders"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`stg_coffee_shop__orders`
    
    
    OPTIONS()
    as (
      

select * from `analytics-engineers-club.coffee_shop.orders`
    );
  
[0m13:45:37.094792 [debug] [Thread-5 (]: Writing runtime sql for node "model.coffee_shop.stg_coffee_shop__product_prices"
[0m13:45:37.095546 [debug] [Thread-5 (]: On model.coffee_shop.stg_coffee_shop__product_prices: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.stg_coffee_shop__product_prices"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`stg_coffee_shop__product_prices`
    
    
    OPTIONS()
    as (
      

select * from `analytics-engineers-club.coffee_shop.product_prices`
    );
  
[0m13:45:37.143286 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop.my_first_dbt_model"
[0m13:45:37.144172 [debug] [Thread-1 (]: On model.coffee_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.my_first_dbt_model"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`my_first_dbt_model`
    
    
    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m13:45:37.205174 [debug] [Thread-6 (]: Writing runtime sql for node "model.coffee_shop.stg_coffee_shop__products"
[0m13:45:37.205934 [debug] [Thread-6 (]: On model.coffee_shop.stg_coffee_shop__products: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.stg_coffee_shop__products"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`stg_coffee_shop__products`
    
    
    OPTIONS()
    as (
      

select * from `analytics-engineers-club.coffee_shop.products`
    );
  
[0m13:45:39.389649 [debug] [Thread-5 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:d3e48cdb-6335-43c6-8378-e61c2fc5d5a4&page=queryresults
[0m13:45:39.406461 [debug] [Thread-5 (]: Timing info for model.coffee_shop.stg_coffee_shop__product_prices (execute): 2023-03-10 13:45:36.299863 => 2023-03-10 13:45:39.406388
[0m13:45:39.407399 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '599f48d6-7ea0-478f-8241-8c60d07d6b8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f423185e590>]}
[0m13:45:39.408042 [info ] [Thread-5 (]: 5 of 9 OK created sql table model dbt_milan.stg_coffee_shop__product_prices .... [[32mCREATE TABLE (15.0 rows, 600.0 Bytes processed)[0m in 3.18s]
[0m13:45:39.410584 [debug] [Thread-5 (]: Finished running node model.coffee_shop.stg_coffee_shop__product_prices
[0m13:45:39.450051 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:2a50ab36-d877-44c2-afba-c0c4952f15a9&page=queryresults
[0m13:45:39.452234 [debug] [Thread-1 (]: Timing info for model.coffee_shop.my_first_dbt_model (execute): 2023-03-10 13:45:36.289657 => 2023-03-10 13:45:39.452169
[0m13:45:39.453124 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '599f48d6-7ea0-478f-8241-8c60d07d6b8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4231a839d0>]}
[0m13:45:39.453722 [info ] [Thread-1 (]: 1 of 9 OK created sql table model dbt_milan.my_first_dbt_model ................. [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 3.23s]
[0m13:45:39.454571 [debug] [Thread-1 (]: Finished running node model.coffee_shop.my_first_dbt_model
[0m13:45:39.455333 [debug] [Thread-8 (]: Began running node model.coffee_shop.my_second_dbt_model
[0m13:45:39.455916 [info ] [Thread-8 (]: 8 of 9 START sql view model dbt_milan.my_second_dbt_model ...................... [RUN]
[0m13:45:39.457090 [debug] [Thread-8 (]: Acquiring new bigquery connection 'model.coffee_shop.my_second_dbt_model'
[0m13:45:39.458651 [debug] [Thread-8 (]: Began compiling node model.coffee_shop.my_second_dbt_model
[0m13:45:39.462182 [debug] [Thread-8 (]: Writing injected SQL for node "model.coffee_shop.my_second_dbt_model"
[0m13:45:39.462725 [debug] [Thread-8 (]: Timing info for model.coffee_shop.my_second_dbt_model (compile): 2023-03-10 13:45:39.459110 => 2023-03-10 13:45:39.462641
[0m13:45:39.463105 [debug] [Thread-8 (]: Began executing node model.coffee_shop.my_second_dbt_model
[0m13:45:39.482917 [debug] [Thread-8 (]: Writing runtime sql for node "model.coffee_shop.my_second_dbt_model"
[0m13:45:39.483557 [debug] [Thread-8 (]: Opening a new connection, currently in state init
[0m13:45:39.484005 [debug] [Thread-8 (]: On model.coffee_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.my_second_dbt_model"} */


  create or replace view `aec-students`.`dbt_milan`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `aec-students`.`dbt_milan`.`my_first_dbt_model`
where id = 1;


[0m13:45:39.991737 [debug] [Thread-6 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:42686636-9647-45c5-bd2e-78a8de3cf745&page=queryresults
[0m13:45:39.994444 [debug] [Thread-6 (]: Timing info for model.coffee_shop.stg_coffee_shop__products (execute): 2023-03-10 13:45:36.322335 => 2023-03-10 13:45:39.994367
[0m13:45:39.995458 [debug] [Thread-6 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '599f48d6-7ea0-478f-8241-8c60d07d6b8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42313564d0>]}
[0m13:45:39.996137 [info ] [Thread-6 (]: 6 of 9 OK created sql table model dbt_milan.stg_coffee_shop__products .......... [[32mCREATE TABLE (7.0 rows, 278.0 Bytes processed)[0m in 3.77s]
[0m13:45:39.996841 [debug] [Thread-6 (]: Finished running node model.coffee_shop.stg_coffee_shop__products
[0m13:45:40.232460 [debug] [Thread-8 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:716d6853-2575-4a19-85b5-c73ea2bcdb7d&page=queryresults
[0m13:45:40.235135 [debug] [Thread-8 (]: Timing info for model.coffee_shop.my_second_dbt_model (execute): 2023-03-10 13:45:39.463311 => 2023-03-10 13:45:40.235046
[0m13:45:40.237517 [debug] [Thread-8 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '599f48d6-7ea0-478f-8241-8c60d07d6b8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4231a83ca0>]}
[0m13:45:40.238291 [info ] [Thread-8 (]: 8 of 9 OK created sql view model dbt_milan.my_second_dbt_model ................. [[32mCREATE VIEW (0 processed)[0m in 0.78s]
[0m13:45:40.238957 [debug] [Thread-8 (]: Finished running node model.coffee_shop.my_second_dbt_model
[0m13:45:40.834926 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:d94f76d9-b65b-458d-8b95-4a4cb424bce5&page=queryresults
[0m13:45:40.837156 [debug] [Thread-2 (]: Timing info for model.coffee_shop.stg_coffee_shop__customers (execute): 2023-03-10 13:45:36.328036 => 2023-03-10 13:45:40.837091
[0m13:45:40.841860 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '599f48d6-7ea0-478f-8241-8c60d07d6b8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42318d7040>]}
[0m13:45:40.842592 [info ] [Thread-2 (]: 2 of 9 OK created sql table model dbt_milan.stg_coffee_shop__customers ......... [[32mCREATE TABLE (174.4k rows, 12.8 MB processed)[0m in 4.61s]
[0m13:45:40.844066 [debug] [Thread-2 (]: Finished running node model.coffee_shop.stg_coffee_shop__customers
[0m13:45:42.171703 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:0273cd1c-3c19-44b5-b8e3-5e56074afa5b&page=queryresults
[0m13:45:42.174451 [debug] [Thread-3 (]: Timing info for model.coffee_shop.stg_coffee_shop__order_items (execute): 2023-03-10 13:45:36.295948 => 2023-03-10 13:45:42.174377
[0m13:45:42.175494 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '599f48d6-7ea0-478f-8241-8c60d07d6b8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4231a82a10>]}
[0m13:45:42.176200 [info ] [Thread-3 (]: 3 of 9 OK created sql table model dbt_milan.stg_coffee_shop__order_items ....... [[32mCREATE TABLE (383.8k rows, 30.7 MB processed)[0m in 5.95s]
[0m13:45:42.177261 [debug] [Thread-3 (]: Finished running node model.coffee_shop.stg_coffee_shop__order_items
[0m13:45:43.179668 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:ca5c1ccf-036e-4b7f-b300-22a8babcb5c8&page=queryresults
[0m13:45:43.183449 [debug] [Thread-4 (]: Timing info for model.coffee_shop.stg_coffee_shop__orders (execute): 2023-03-10 13:45:36.285698 => 2023-03-10 13:45:43.183350
[0m13:45:43.184760 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '599f48d6-7ea0-478f-8241-8c60d07d6b8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4231a63940>]}
[0m13:45:43.185650 [info ] [Thread-4 (]: 4 of 9 OK created sql table model dbt_milan.stg_coffee_shop__orders ............ [[32mCREATE TABLE (192.0k rows, 24.7 MB processed)[0m in 6.96s]
[0m13:45:43.187398 [debug] [Thread-4 (]: Finished running node model.coffee_shop.stg_coffee_shop__orders
[0m13:45:44.934445 [debug] [Thread-7 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:c61079ef-dc21-45a1-9d9f-1435e354221b&page=queryresults
[0m13:45:44.936888 [debug] [Thread-7 (]: Timing info for model.coffee_shop.stg_web_tracking__pageviews (execute): 2023-03-10 13:45:36.259758 => 2023-03-10 13:45:44.936821
[0m13:45:44.937751 [debug] [Thread-7 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '599f48d6-7ea0-478f-8241-8c60d07d6b8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42318d70d0>]}
[0m13:45:44.938367 [info ] [Thread-7 (]: 7 of 9 OK created sql table model dbt_milan.stg_web_tracking__pageviews ........ [[32mCREATE TABLE (5.8m rows, 606.0 MB processed)[0m in 8.71s]
[0m13:45:44.939014 [debug] [Thread-7 (]: Finished running node model.coffee_shop.stg_web_tracking__pageviews
[0m13:45:44.939878 [debug] [Thread-1 (]: Began running node model.coffee_shop.pageviews_with_user_id
[0m13:45:44.940516 [info ] [Thread-1 (]: 9 of 9 START sql view model dbt_milan.pageviews_with_user_id ................... [RUN]
[0m13:45:44.941589 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop.pageviews_with_user_id'
[0m13:45:44.942170 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.pageviews_with_user_id
[0m13:45:44.948017 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.pageviews_with_user_id"
[0m13:45:44.948614 [debug] [Thread-1 (]: Timing info for model.coffee_shop.pageviews_with_user_id (compile): 2023-03-10 13:45:44.942400 => 2023-03-10 13:45:44.948510
[0m13:45:44.948998 [debug] [Thread-1 (]: Began executing node model.coffee_shop.pageviews_with_user_id
[0m13:45:44.952023 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop.pageviews_with_user_id"
[0m13:45:44.952620 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:45:44.953022 [debug] [Thread-1 (]: On model.coffee_shop.pageviews_with_user_id: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.pageviews_with_user_id"} */


  create or replace view `aec-students`.`dbt_milan`.`pageviews_with_user_id`
  OPTIONS()
  as 

select *
from `aec-students`.`dbt_milan`.`stg_web_tracking__pageviews`;


[0m13:45:45.788469 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:d38b3c82-eef2-45ca-9c65-ab73a135a9bd&page=queryresults
[0m13:45:45.790637 [debug] [Thread-1 (]: Timing info for model.coffee_shop.pageviews_with_user_id (execute): 2023-03-10 13:45:44.949259 => 2023-03-10 13:45:45.790572
[0m13:45:45.791488 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '599f48d6-7ea0-478f-8241-8c60d07d6b8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f423027ca90>]}
[0m13:45:45.792087 [info ] [Thread-1 (]: 9 of 9 OK created sql view model dbt_milan.pageviews_with_user_id .............. [[32mCREATE VIEW (0 processed)[0m in 0.85s]
[0m13:45:45.792712 [debug] [Thread-1 (]: Finished running node model.coffee_shop.pageviews_with_user_id
[0m13:45:45.795011 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:45:45.795608 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:45:45.795853 [debug] [MainThread]: Connection 'model.coffee_shop.pageviews_with_user_id' was properly closed.
[0m13:45:45.796096 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop__orders' was properly closed.
[0m13:45:45.796340 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop__product_prices' was properly closed.
[0m13:45:45.796804 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop__order_items' was properly closed.
[0m13:45:45.797070 [debug] [MainThread]: Connection 'model.coffee_shop.stg_web_tracking__pageviews' was properly closed.
[0m13:45:45.797303 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop__customers' was properly closed.
[0m13:45:45.797531 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop__products' was properly closed.
[0m13:45:45.797816 [debug] [MainThread]: Connection 'model.coffee_shop.my_second_dbt_model' was properly closed.
[0m13:45:45.798166 [info ] [MainThread]: 
[0m13:45:45.798576 [info ] [MainThread]: Finished running 7 table models, 2 view models in 0 hours 0 minutes and 11.17 seconds (11.17s).
[0m13:45:45.799412 [debug] [MainThread]: Command end result
[0m13:45:45.810043 [info ] [MainThread]: 
[0m13:45:45.810542 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:45:45.811064 [info ] [MainThread]: 
[0m13:45:45.811533 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m13:45:45.812177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f423203f430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4231d646a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4231d65ed0>]}
[0m13:45:45.812565 [debug] [MainThread]: Flushing usage events


============================== 2023-03-10 13:56:02.942587 | 642bca5b-d515-42a8-bc78-d1689588e31f ==============================
[0m13:56:02.942587 [info ] [MainThread]: Running with dbt=1.4.1
[0m13:56:02.945378 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:56:02.945914 [debug] [MainThread]: Tracking: tracking
[0m13:56:02.954630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f299e053850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f299e050130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f299e053cd0>]}
[0m13:56:03.006072 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:56:03.006694 [debug] [MainThread]: Partial parsing: updated file: coffee_shop://models/marts/web_tracking/pageviews_with_user_id.sql
[0m13:56:03.020865 [debug] [MainThread]: 1699: static parser successfully parsed marts/web_tracking/pageviews_with_user_id.sql
[0m13:56:03.052353 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffe_shop_milan.example
[0m13:56:03.060912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '642bca5b-d515-42a8-bc78-d1689588e31f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f299dea5930>]}
[0m13:56:03.075667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '642bca5b-d515-42a8-bc78-d1689588e31f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f299de68160>]}
[0m13:56:03.076331 [info ] [MainThread]: Found 9 models, 10 tests, 0 snapshots, 0 analyses, 334 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
[0m13:56:03.076962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '642bca5b-d515-42a8-bc78-d1689588e31f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29a1926f50>]}
[0m13:56:03.079664 [info ] [MainThread]: 
[0m13:56:03.135531 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:56:03.137204 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m13:56:03.137748 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:56:04.256701 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_milan'
[0m13:56:04.257681 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:56:04.561032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '642bca5b-d515-42a8-bc78-d1689588e31f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f299e2035b0>]}
[0m13:56:04.562091 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m13:56:04.563118 [info ] [MainThread]: 
[0m13:56:04.569884 [debug] [Thread-1 (]: Began running node model.coffee_shop.my_first_dbt_model
[0m13:56:04.570202 [debug] [Thread-2 (]: Began running node model.coffee_shop.stg_coffee_shop__customers
[0m13:56:04.570506 [debug] [Thread-3 (]: Began running node model.coffee_shop.stg_coffee_shop__order_items
[0m13:56:04.570813 [debug] [Thread-4 (]: Began running node model.coffee_shop.stg_coffee_shop__orders
[0m13:56:04.571121 [debug] [Thread-5 (]: Began running node model.coffee_shop.stg_coffee_shop__product_prices
[0m13:56:04.571368 [debug] [Thread-6 (]: Began running node model.coffee_shop.stg_coffee_shop__products
[0m13:56:04.571600 [debug] [Thread-7 (]: Began running node model.coffee_shop.stg_web_tracking__pageviews
[0m13:56:04.572018 [info ] [Thread-1 (]: 1 of 9 START sql table model dbt_milan.my_first_dbt_model ...................... [RUN]
[0m13:56:04.572479 [info ] [Thread-2 (]: 2 of 9 START sql table model dbt_milan.stg_coffee_shop__customers .............. [RUN]
[0m13:56:04.575942 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop.my_first_dbt_model'
[0m13:56:04.573061 [info ] [Thread-3 (]: 3 of 9 START sql table model dbt_milan.stg_coffee_shop__order_items ............ [RUN]
[0m13:56:04.579819 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.coffee_shop.stg_coffee_shop__order_items'
[0m13:56:04.574520 [info ] [Thread-5 (]: 5 of 9 START sql table model dbt_milan.stg_coffee_shop__product_prices ......... [RUN]
[0m13:56:04.576844 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.coffee_shop.stg_coffee_shop__customers'
[0m13:56:04.573730 [info ] [Thread-4 (]: 4 of 9 START sql table model dbt_milan.stg_coffee_shop__orders ................. [RUN]
[0m13:56:04.574878 [info ] [Thread-6 (]: 6 of 9 START sql table model dbt_milan.stg_coffee_shop__products ............... [RUN]
[0m13:56:04.578994 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.my_first_dbt_model
[0m13:56:04.580113 [debug] [Thread-3 (]: Began compiling node model.coffee_shop.stg_coffee_shop__order_items
[0m13:56:04.588644 [debug] [Thread-3 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop__order_items"
[0m13:56:04.580825 [debug] [Thread-5 (]: Acquiring new bigquery connection 'model.coffee_shop.stg_coffee_shop__product_prices'
[0m13:56:04.575184 [info ] [Thread-7 (]: 7 of 9 START sql table model dbt_milan.stg_web_tracking__pageviews ............. [RUN]
[0m13:56:04.589972 [debug] [Thread-7 (]: Acquiring new bigquery connection 'model.coffee_shop.stg_web_tracking__pageviews'
[0m13:56:04.582832 [debug] [Thread-6 (]: Acquiring new bigquery connection 'model.coffee_shop.stg_coffee_shop__products'
[0m13:56:04.586099 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.my_first_dbt_model"
[0m13:56:04.589146 [debug] [Thread-5 (]: Began compiling node model.coffee_shop.stg_coffee_shop__product_prices
[0m13:56:04.581199 [debug] [Thread-2 (]: Began compiling node model.coffee_shop.stg_coffee_shop__customers
[0m13:56:04.581847 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.coffee_shop.stg_coffee_shop__orders'
[0m13:56:04.590337 [debug] [Thread-7 (]: Began compiling node model.coffee_shop.stg_web_tracking__pageviews
[0m13:56:04.590599 [debug] [Thread-3 (]: Timing info for model.coffee_shop.stg_coffee_shop__order_items (compile): 2023-03-10 13:56:04.586375 => 2023-03-10 13:56:04.590528
[0m13:56:04.590914 [debug] [Thread-6 (]: Began compiling node model.coffee_shop.stg_coffee_shop__products
[0m13:56:04.593528 [debug] [Thread-5 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop__product_prices"
[0m13:56:04.607955 [debug] [Thread-5 (]: Timing info for model.coffee_shop.stg_coffee_shop__product_prices (compile): 2023-03-10 13:56:04.591283 => 2023-03-10 13:56:04.607881
[0m13:56:04.596746 [debug] [Thread-1 (]: Timing info for model.coffee_shop.my_first_dbt_model (compile): 2023-03-10 13:56:04.583130 => 2023-03-10 13:56:04.596670
[0m13:56:04.597033 [debug] [Thread-4 (]: Began compiling node model.coffee_shop.stg_coffee_shop__orders
[0m13:56:04.602895 [debug] [Thread-7 (]: Writing injected SQL for node "model.coffee_shop.stg_web_tracking__pageviews"
[0m13:56:04.603315 [debug] [Thread-3 (]: Began executing node model.coffee_shop.stg_coffee_shop__order_items
[0m13:56:04.607467 [debug] [Thread-6 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop__products"
[0m13:56:04.608264 [debug] [Thread-5 (]: Began executing node model.coffee_shop.stg_coffee_shop__product_prices
[0m13:56:04.596404 [debug] [Thread-2 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop__customers"
[0m13:56:04.611101 [debug] [Thread-4 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop__orders"
[0m13:56:04.608627 [debug] [Thread-1 (]: Began executing node model.coffee_shop.my_first_dbt_model
[0m13:56:04.626379 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:56:04.626807 [debug] [Thread-7 (]: Timing info for model.coffee_shop.stg_web_tracking__pageviews (compile): 2023-03-10 13:56:04.597288 => 2023-03-10 13:56:04.626717
[0m13:56:04.633274 [debug] [Thread-7 (]: Began executing node model.coffee_shop.stg_web_tracking__pageviews
[0m13:56:04.631187 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:56:04.631664 [debug] [Thread-4 (]: Timing info for model.coffee_shop.stg_coffee_shop__orders (compile): 2023-03-10 13:56:04.608924 => 2023-03-10 13:56:04.631583
[0m13:56:04.638919 [debug] [Thread-4 (]: Began executing node model.coffee_shop.stg_coffee_shop__orders
[0m13:56:04.628945 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m13:56:04.632941 [debug] [Thread-2 (]: Timing info for model.coffee_shop.stg_coffee_shop__customers (compile): 2023-03-10 13:56:04.593874 => 2023-03-10 13:56:04.632869
[0m13:56:04.642850 [debug] [Thread-2 (]: Began executing node model.coffee_shop.stg_coffee_shop__customers
[0m13:56:04.640861 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:56:04.633554 [debug] [Thread-6 (]: Timing info for model.coffee_shop.stg_coffee_shop__products (compile): 2023-03-10 13:56:04.603558 => 2023-03-10 13:56:04.633500
[0m13:56:04.636692 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m13:56:04.648790 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m13:56:04.656821 [debug] [Thread-6 (]: Began executing node model.coffee_shop.stg_coffee_shop__products
[0m13:56:04.670939 [debug] [Thread-6 (]: Opening a new connection, currently in state init
[0m13:56:05.265888 [debug] [Thread-5 (]: Writing runtime sql for node "model.coffee_shop.stg_coffee_shop__product_prices"
[0m13:56:05.267096 [debug] [Thread-5 (]: On model.coffee_shop.stg_coffee_shop__product_prices: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.stg_coffee_shop__product_prices"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`stg_coffee_shop__product_prices`
    
    
    OPTIONS()
    as (
      

select * from `analytics-engineers-club.coffee_shop.product_prices`
    );
  
[0m13:56:05.375148 [debug] [Thread-3 (]: Writing runtime sql for node "model.coffee_shop.stg_coffee_shop__order_items"
[0m13:56:05.375985 [debug] [Thread-3 (]: On model.coffee_shop.stg_coffee_shop__order_items: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.stg_coffee_shop__order_items"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`stg_coffee_shop__order_items`
    
    
    OPTIONS()
    as (
      

select * from `analytics-engineers-club.coffee_shop.order_items`
    );
  
[0m13:56:05.379429 [debug] [Thread-2 (]: Writing runtime sql for node "model.coffee_shop.stg_coffee_shop__customers"
[0m13:56:05.380487 [debug] [Thread-2 (]: On model.coffee_shop.stg_coffee_shop__customers: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.stg_coffee_shop__customers"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`stg_coffee_shop__customers`
    
    
    OPTIONS()
    as (
      

select * from `analytics-engineers-club.coffee_shop.customers`
    );
  
[0m13:56:05.406124 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop.my_first_dbt_model"
[0m13:56:05.406817 [debug] [Thread-1 (]: On model.coffee_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.my_first_dbt_model"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`my_first_dbt_model`
    
    
    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m13:56:05.410720 [debug] [Thread-7 (]: Writing runtime sql for node "model.coffee_shop.stg_web_tracking__pageviews"
[0m13:56:05.411383 [debug] [Thread-7 (]: On model.coffee_shop.stg_web_tracking__pageviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.stg_web_tracking__pageviews"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`stg_web_tracking__pageviews`
    
    
    OPTIONS()
    as (
      

select * from `analytics-engineers-club`.`web_tracking`.`pageviews`
    );
  
[0m13:56:05.428730 [debug] [Thread-4 (]: Writing runtime sql for node "model.coffee_shop.stg_coffee_shop__orders"
[0m13:56:05.429544 [debug] [Thread-4 (]: On model.coffee_shop.stg_coffee_shop__orders: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.stg_coffee_shop__orders"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`stg_coffee_shop__orders`
    
    
    OPTIONS()
    as (
      

select * from `analytics-engineers-club.coffee_shop.orders`
    );
  
[0m13:56:05.589075 [debug] [Thread-6 (]: Writing runtime sql for node "model.coffee_shop.stg_coffee_shop__products"
[0m13:56:05.589882 [debug] [Thread-6 (]: On model.coffee_shop.stg_coffee_shop__products: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.stg_coffee_shop__products"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`stg_coffee_shop__products`
    
    
    OPTIONS()
    as (
      

select * from `analytics-engineers-club.coffee_shop.products`
    );
  
[0m13:56:07.524896 [debug] [Thread-5 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:6e56b466-81b4-45ac-91ec-d245f78cab7e&page=queryresults
[0m13:56:07.541747 [debug] [Thread-5 (]: Timing info for model.coffee_shop.stg_coffee_shop__product_prices (execute): 2023-03-10 13:56:04.627151 => 2023-03-10 13:56:07.541677
[0m13:56:07.542532 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '642bca5b-d515-42a8-bc78-d1689588e31f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f299e057f40>]}
[0m13:56:07.543073 [info ] [Thread-5 (]: 5 of 9 OK created sql table model dbt_milan.stg_coffee_shop__product_prices .... [[32mCREATE TABLE (15.0 rows, 600.0 Bytes processed)[0m in 2.96s]
[0m13:56:07.544924 [debug] [Thread-5 (]: Finished running node model.coffee_shop.stg_coffee_shop__product_prices
[0m13:56:07.865191 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:6c3c32db-d23f-4293-b257-87cb24fa53f3&page=queryresults
[0m13:56:07.868959 [debug] [Thread-1 (]: Timing info for model.coffee_shop.my_first_dbt_model (execute): 2023-03-10 13:56:04.629554 => 2023-03-10 13:56:07.868880
[0m13:56:07.870071 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '642bca5b-d515-42a8-bc78-d1689588e31f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f299e056560>]}
[0m13:56:07.870726 [info ] [Thread-1 (]: 1 of 9 OK created sql table model dbt_milan.my_first_dbt_model ................. [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 3.29s]
[0m13:56:07.871383 [debug] [Thread-1 (]: Finished running node model.coffee_shop.my_first_dbt_model
[0m13:56:07.872271 [debug] [Thread-8 (]: Began running node model.coffee_shop.my_second_dbt_model
[0m13:56:07.872886 [info ] [Thread-8 (]: 8 of 9 START sql view model dbt_milan.my_second_dbt_model ...................... [RUN]
[0m13:56:07.874194 [debug] [Thread-8 (]: Acquiring new bigquery connection 'model.coffee_shop.my_second_dbt_model'
[0m13:56:07.874529 [debug] [Thread-8 (]: Began compiling node model.coffee_shop.my_second_dbt_model
[0m13:56:07.878030 [debug] [Thread-8 (]: Writing injected SQL for node "model.coffee_shop.my_second_dbt_model"
[0m13:56:07.879483 [debug] [Thread-8 (]: Timing info for model.coffee_shop.my_second_dbt_model (compile): 2023-03-10 13:56:07.874742 => 2023-03-10 13:56:07.879395
[0m13:56:07.879839 [debug] [Thread-8 (]: Began executing node model.coffee_shop.my_second_dbt_model
[0m13:56:07.898909 [debug] [Thread-8 (]: Writing runtime sql for node "model.coffee_shop.my_second_dbt_model"
[0m13:56:07.899498 [debug] [Thread-8 (]: Opening a new connection, currently in state init
[0m13:56:07.899920 [debug] [Thread-8 (]: On model.coffee_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.my_second_dbt_model"} */


  create or replace view `aec-students`.`dbt_milan`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `aec-students`.`dbt_milan`.`my_first_dbt_model`
where id = 1;


[0m13:56:08.017418 [debug] [Thread-6 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:fb49d46d-c84b-4e6d-9c9a-3daadda244f0&page=queryresults
[0m13:56:08.020528 [debug] [Thread-6 (]: Timing info for model.coffee_shop.stg_coffee_shop__products (execute): 2023-03-10 13:56:04.667853 => 2023-03-10 13:56:08.020448
[0m13:56:08.021550 [debug] [Thread-6 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '642bca5b-d515-42a8-bc78-d1689588e31f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f299d94c880>]}
[0m13:56:08.022201 [info ] [Thread-6 (]: 6 of 9 OK created sql table model dbt_milan.stg_coffee_shop__products .......... [[32mCREATE TABLE (7.0 rows, 278.0 Bytes processed)[0m in 3.44s]
[0m13:56:08.022857 [debug] [Thread-6 (]: Finished running node model.coffee_shop.stg_coffee_shop__products
[0m13:56:08.671830 [debug] [Thread-8 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:d2bbb4ff-f433-44bf-ad85-a4a910262350&page=queryresults
[0m13:56:08.674663 [debug] [Thread-8 (]: Timing info for model.coffee_shop.my_second_dbt_model (execute): 2023-03-10 13:56:07.880046 => 2023-03-10 13:56:08.674590
[0m13:56:08.675679 [debug] [Thread-8 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '642bca5b-d515-42a8-bc78-d1689588e31f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f299e056710>]}
[0m13:56:08.676336 [info ] [Thread-8 (]: 8 of 9 OK created sql view model dbt_milan.my_second_dbt_model ................. [[32mCREATE VIEW (0 processed)[0m in 0.80s]
[0m13:56:08.677174 [debug] [Thread-8 (]: Finished running node model.coffee_shop.my_second_dbt_model
[0m13:56:08.845585 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:fedf219c-b5b0-4f4d-9066-4cac89945249&page=queryresults
[0m13:56:08.847699 [debug] [Thread-2 (]: Timing info for model.coffee_shop.stg_coffee_shop__customers (execute): 2023-03-10 13:56:04.643879 => 2023-03-10 13:56:08.847635
[0m13:56:08.848643 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '642bca5b-d515-42a8-bc78-d1689588e31f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f299e0548b0>]}
[0m13:56:08.849248 [info ] [Thread-2 (]: 2 of 9 OK created sql table model dbt_milan.stg_coffee_shop__customers ......... [[32mCREATE TABLE (174.4k rows, 12.8 MB processed)[0m in 4.27s]
[0m13:56:08.849878 [debug] [Thread-2 (]: Finished running node model.coffee_shop.stg_coffee_shop__customers
[0m13:56:09.273460 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:42d0ba6f-ced7-4301-854e-4dbcc532d1eb&page=queryresults
[0m13:56:09.275956 [debug] [Thread-4 (]: Timing info for model.coffee_shop.stg_coffee_shop__orders (execute): 2023-03-10 13:56:04.639150 => 2023-03-10 13:56:09.275882
[0m13:56:09.276942 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '642bca5b-d515-42a8-bc78-d1689588e31f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f299d94e020>]}
[0m13:56:09.277579 [info ] [Thread-4 (]: 4 of 9 OK created sql table model dbt_milan.stg_coffee_shop__orders ............ [[32mCREATE TABLE (192.0k rows, 24.7 MB processed)[0m in 4.70s]
[0m13:56:09.278236 [debug] [Thread-4 (]: Finished running node model.coffee_shop.stg_coffee_shop__orders
[0m13:56:10.396164 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:3e7c89d7-8452-42bc-af76-cdc1fa5718d4&page=queryresults
[0m13:56:10.398961 [debug] [Thread-3 (]: Timing info for model.coffee_shop.stg_coffee_shop__order_items (execute): 2023-03-10 13:56:04.611839 => 2023-03-10 13:56:10.398882
[0m13:56:10.400010 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '642bca5b-d515-42a8-bc78-d1689588e31f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f299d94cb20>]}
[0m13:56:10.400743 [info ] [Thread-3 (]: 3 of 9 OK created sql table model dbt_milan.stg_coffee_shop__order_items ....... [[32mCREATE TABLE (383.8k rows, 30.7 MB processed)[0m in 5.82s]
[0m13:56:10.401509 [debug] [Thread-3 (]: Finished running node model.coffee_shop.stg_coffee_shop__order_items
[0m13:56:14.925711 [debug] [Thread-7 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:fb6984ca-9d2c-444a-8077-6effcf255cf6&page=queryresults
[0m13:56:14.928426 [debug] [Thread-7 (]: Timing info for model.coffee_shop.stg_web_tracking__pageviews (execute): 2023-03-10 13:56:04.634715 => 2023-03-10 13:56:14.928349
[0m13:56:14.929503 [debug] [Thread-7 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '642bca5b-d515-42a8-bc78-d1689588e31f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f299de4ef80>]}
[0m13:56:14.930235 [info ] [Thread-7 (]: 7 of 9 OK created sql table model dbt_milan.stg_web_tracking__pageviews ........ [[32mCREATE TABLE (5.8m rows, 606.0 MB processed)[0m in 10.34s]
[0m13:56:14.931192 [debug] [Thread-7 (]: Finished running node model.coffee_shop.stg_web_tracking__pageviews
[0m13:56:14.932223 [debug] [Thread-1 (]: Began running node model.coffee_shop.pageviews_with_user_id
[0m13:56:14.932735 [info ] [Thread-1 (]: 9 of 9 START sql table model dbt_milan.pageviews_with_user_id .................. [RUN]
[0m13:56:14.933509 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop.pageviews_with_user_id'
[0m13:56:14.933802 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.pageviews_with_user_id
[0m13:56:14.939975 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.pageviews_with_user_id"
[0m13:56:14.940568 [debug] [Thread-1 (]: Timing info for model.coffee_shop.pageviews_with_user_id (compile): 2023-03-10 13:56:14.934000 => 2023-03-10 13:56:14.940491
[0m13:56:14.940955 [debug] [Thread-1 (]: Began executing node model.coffee_shop.pageviews_with_user_id
[0m13:56:14.943661 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop.pageviews_with_user_id"
[0m13:56:14.944236 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:56:14.944688 [debug] [Thread-1 (]: On model.coffee_shop.pageviews_with_user_id: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.pageviews_with_user_id"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`pageviews_with_user_id`
    
    
    OPTIONS()
    as (
      


with visitor_who_is_a_customer as 
(
Select distinct visitor_id, customer_id 
from `aec-students`.`dbt_milan`.`stg_web_tracking__pageviews`
where customer_id is not null

)


SELECT
  id,
  pageviews.visitor_id,
  pageviews.customer_id,
  coalesce(visitor_who_is_a_customer.customer_id,pageviews.visitor_id)
  AS user_id,
  device_type,
  timestamp,
  page
FROM
  `aec-students`.`dbt_milan`.`stg_web_tracking__pageviews` as pageviews
LEFT JOIN visitor_who_is_a_customer
ON pageviews.visitor_id=visitor_who_is_a_customer.visitor_id
order by pageviews.visitor_id, timestamp
    );
  
[0m13:56:27.623786 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:c1fd1d75-b1a8-489e-8ec0-2a3c611ffea2&page=queryresults
[0m13:56:27.626496 [debug] [Thread-1 (]: Timing info for model.coffee_shop.pageviews_with_user_id (execute): 2023-03-10 13:56:14.941235 => 2023-03-10 13:56:27.626397
[0m13:56:27.627605 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '642bca5b-d515-42a8-bc78-d1689588e31f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f299e3507f0>]}
[0m13:56:27.628305 [info ] [Thread-1 (]: 9 of 9 OK created sql table model dbt_milan.pageviews_with_user_id ............. [[32mCREATE TABLE (5.8m rows, 606.0 MB processed)[0m in 12.69s]
[0m13:56:27.635336 [debug] [Thread-1 (]: Finished running node model.coffee_shop.pageviews_with_user_id
[0m13:56:27.638856 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m13:56:27.639468 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:56:27.639712 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop__customers' was properly closed.
[0m13:56:27.639960 [debug] [MainThread]: Connection 'model.coffee_shop.pageviews_with_user_id' was properly closed.
[0m13:56:27.640218 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop__order_items' was properly closed.
[0m13:56:27.640695 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop__product_prices' was properly closed.
[0m13:56:27.642145 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop__orders' was properly closed.
[0m13:56:27.642589 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop__products' was properly closed.
[0m13:56:27.643037 [debug] [MainThread]: Connection 'model.coffee_shop.stg_web_tracking__pageviews' was properly closed.
[0m13:56:27.643473 [debug] [MainThread]: Connection 'model.coffee_shop.my_second_dbt_model' was properly closed.
[0m13:56:27.644029 [info ] [MainThread]: 
[0m13:56:27.645428 [info ] [MainThread]: Finished running 8 table models, 1 view model in 0 hours 0 minutes and 24.56 seconds (24.56s).
[0m13:56:27.649009 [debug] [MainThread]: Command end result
[0m13:56:27.659966 [info ] [MainThread]: 
[0m13:56:27.663644 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:56:27.664985 [info ] [MainThread]: 
[0m13:56:27.665705 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m13:56:27.666535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f299de68280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f299c060100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f299e233ac0>]}
[0m13:56:27.667150 [debug] [MainThread]: Flushing usage events


============================== 2023-03-10 14:08:31.107275 | 18604ef8-fa7f-44dc-bc16-fe8a0d2c6a9d ==============================
[0m14:08:31.107275 [info ] [MainThread]: Running with dbt=1.4.1
[0m14:08:31.110556 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:08:31.110927 [debug] [MainThread]: Tracking: tracking
[0m14:08:31.117046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe759a6b700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe759a69a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe759a6b730>]}
[0m14:08:31.178039 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m14:08:31.178979 [debug] [MainThread]: Partial parsing: added file: coffee_shop://models/marts/web_tracking/pageviews_with_stiched_user_id.sql
[0m14:08:31.179403 [debug] [MainThread]: Partial parsing: deleted file: coffee_shop://models/marts/web_tracking/pageviews_with_user_id.sql
[0m14:08:31.194617 [debug] [MainThread]: 1699: static parser successfully parsed marts/web_tracking/pageviews_with_stiched_user_id.sql
[0m14:08:31.213206 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffe_shop_milan.example
[0m14:08:31.220474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '18604ef8-fa7f-44dc-bc16-fe8a0d2c6a9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7598bd960>]}
[0m14:08:31.231243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '18604ef8-fa7f-44dc-bc16-fe8a0d2c6a9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe759880250>]}
[0m14:08:31.231749 [info ] [MainThread]: Found 9 models, 10 tests, 0 snapshots, 0 analyses, 334 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
[0m14:08:31.232275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '18604ef8-fa7f-44dc-bc16-fe8a0d2c6a9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe759880220>]}
[0m14:08:31.234399 [info ] [MainThread]: 
[0m14:08:31.310064 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:08:31.312995 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m14:08:31.313760 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:08:32.927491 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_milan'
[0m14:08:32.928137 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:08:33.181271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '18604ef8-fa7f-44dc-bc16-fe8a0d2c6a9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe759e80400>]}
[0m14:08:33.182245 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m14:08:33.183031 [info ] [MainThread]: 
[0m14:08:33.187476 [debug] [Thread-1 (]: Began running node model.coffee_shop.my_first_dbt_model
[0m14:08:33.187976 [info ] [Thread-1 (]: 1 of 9 START sql table model dbt_milan.my_first_dbt_model ...................... [RUN]
[0m14:08:33.188830 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop.my_first_dbt_model'
[0m14:08:33.189162 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.my_first_dbt_model
[0m14:08:33.192418 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.my_first_dbt_model"
[0m14:08:33.192846 [debug] [Thread-2 (]: Began running node model.coffee_shop.stg_coffee_shop__customers
[0m14:08:33.195093 [info ] [Thread-2 (]: 2 of 9 START sql table model dbt_milan.stg_coffee_shop__customers .............. [RUN]
[0m14:08:33.195918 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.coffee_shop.stg_coffee_shop__customers'
[0m14:08:33.196279 [debug] [Thread-2 (]: Began compiling node model.coffee_shop.stg_coffee_shop__customers
[0m14:08:33.194289 [debug] [Thread-6 (]: Began running node model.coffee_shop.stg_coffee_shop__products
[0m14:08:33.200029 [info ] [Thread-6 (]: 6 of 9 START sql table model dbt_milan.stg_coffee_shop__products ............... [RUN]
[0m14:08:33.193182 [debug] [Thread-3 (]: Began running node model.coffee_shop.stg_coffee_shop__order_items
[0m14:08:33.201796 [info ] [Thread-3 (]: 3 of 9 START sql table model dbt_milan.stg_coffee_shop__order_items ............ [RUN]
[0m14:08:33.202581 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.coffee_shop.stg_coffee_shop__order_items'
[0m14:08:33.202886 [debug] [Thread-3 (]: Began compiling node model.coffee_shop.stg_coffee_shop__order_items
[0m14:08:33.194545 [debug] [Thread-7 (]: Began running node model.coffee_shop.stg_web_tracking__pageviews
[0m14:08:33.200543 [debug] [Thread-1 (]: Timing info for model.coffee_shop.my_first_dbt_model (compile): 2023-03-10 14:08:33.189428 => 2023-03-10 14:08:33.200449
[0m14:08:33.201373 [debug] [Thread-6 (]: Acquiring new bigquery connection 'model.coffee_shop.stg_coffee_shop__products'
[0m14:08:33.207181 [debug] [Thread-6 (]: Began compiling node model.coffee_shop.stg_coffee_shop__products
[0m14:08:33.193978 [debug] [Thread-5 (]: Began running node model.coffee_shop.stg_coffee_shop__product_prices
[0m14:08:33.199591 [debug] [Thread-2 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop__customers"
[0m14:08:33.205844 [debug] [Thread-3 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop__order_items"
[0m14:08:33.206248 [info ] [Thread-7 (]: 7 of 9 START sql table model dbt_milan.stg_web_tracking__pageviews ............. [RUN]
[0m14:08:33.211694 [debug] [Thread-7 (]: Acquiring new bigquery connection 'model.coffee_shop.stg_web_tracking__pageviews'
[0m14:08:33.193536 [debug] [Thread-4 (]: Began running node model.coffee_shop.stg_coffee_shop__orders
[0m14:08:33.209980 [debug] [Thread-6 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop__products"
[0m14:08:33.210420 [info ] [Thread-5 (]: 5 of 9 START sql table model dbt_milan.stg_coffee_shop__product_prices ......... [RUN]
[0m14:08:33.214058 [debug] [Thread-5 (]: Acquiring new bigquery connection 'model.coffee_shop.stg_coffee_shop__product_prices'
[0m14:08:33.214470 [debug] [Thread-5 (]: Began compiling node model.coffee_shop.stg_coffee_shop__product_prices
[0m14:08:33.212619 [info ] [Thread-4 (]: 4 of 9 START sql table model dbt_milan.stg_coffee_shop__orders ................. [RUN]
[0m14:08:33.219800 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.coffee_shop.stg_coffee_shop__orders'
[0m14:08:33.212086 [debug] [Thread-7 (]: Began compiling node model.coffee_shop.stg_web_tracking__pageviews
[0m14:08:33.214927 [debug] [Thread-6 (]: Timing info for model.coffee_shop.stg_coffee_shop__products (compile): 2023-03-10 14:08:33.207391 => 2023-03-10 14:08:33.214829
[0m14:08:33.224353 [debug] [Thread-6 (]: Began executing node model.coffee_shop.stg_coffee_shop__products
[0m14:08:33.220229 [debug] [Thread-4 (]: Began compiling node model.coffee_shop.stg_coffee_shop__orders
[0m14:08:33.222992 [debug] [Thread-7 (]: Writing injected SQL for node "model.coffee_shop.stg_web_tracking__pageviews"
[0m14:08:33.223352 [debug] [Thread-3 (]: Timing info for model.coffee_shop.stg_coffee_shop__order_items (compile): 2023-03-10 14:08:33.203082 => 2023-03-10 14:08:33.223271
[0m14:08:33.249099 [debug] [Thread-3 (]: Began executing node model.coffee_shop.stg_coffee_shop__order_items
[0m14:08:33.206772 [debug] [Thread-1 (]: Began executing node model.coffee_shop.my_first_dbt_model
[0m14:08:33.240476 [debug] [Thread-6 (]: Opening a new connection, currently in state init
[0m14:08:33.243478 [debug] [Thread-5 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop__product_prices"
[0m14:08:33.248530 [debug] [Thread-4 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop__orders"
[0m14:08:33.224001 [debug] [Thread-2 (]: Timing info for model.coffee_shop.stg_coffee_shop__customers (compile): 2023-03-10 14:08:33.196513 => 2023-03-10 14:08:33.223938
[0m14:08:33.256720 [debug] [Thread-2 (]: Began executing node model.coffee_shop.stg_coffee_shop__customers
[0m14:08:33.251614 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:08:33.253681 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:08:33.256158 [debug] [Thread-5 (]: Timing info for model.coffee_shop.stg_coffee_shop__product_prices (compile): 2023-03-10 14:08:33.215462 => 2023-03-10 14:08:33.256059
[0m14:08:33.259005 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:08:33.249547 [debug] [Thread-7 (]: Timing info for model.coffee_shop.stg_web_tracking__pageviews (compile): 2023-03-10 14:08:33.220490 => 2023-03-10 14:08:33.249452
[0m14:08:33.265010 [debug] [Thread-7 (]: Began executing node model.coffee_shop.stg_web_tracking__pageviews
[0m14:08:33.267153 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m14:08:33.263374 [debug] [Thread-4 (]: Timing info for model.coffee_shop.stg_coffee_shop__orders (compile): 2023-03-10 14:08:33.243774 => 2023-03-10 14:08:33.263274
[0m14:08:33.273638 [debug] [Thread-4 (]: Began executing node model.coffee_shop.stg_coffee_shop__orders
[0m14:08:33.263828 [debug] [Thread-5 (]: Began executing node model.coffee_shop.stg_coffee_shop__product_prices
[0m14:08:33.279870 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m14:08:33.276903 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:08:33.906644 [debug] [Thread-5 (]: Writing runtime sql for node "model.coffee_shop.stg_coffee_shop__product_prices"
[0m14:08:33.907947 [debug] [Thread-5 (]: On model.coffee_shop.stg_coffee_shop__product_prices: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.stg_coffee_shop__product_prices"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`stg_coffee_shop__product_prices`
    
    
    OPTIONS()
    as (
      

select * from `analytics-engineers-club.coffee_shop.product_prices`
    );
  
[0m14:08:33.909377 [debug] [Thread-4 (]: Writing runtime sql for node "model.coffee_shop.stg_coffee_shop__orders"
[0m14:08:33.911837 [debug] [Thread-4 (]: On model.coffee_shop.stg_coffee_shop__orders: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.stg_coffee_shop__orders"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`stg_coffee_shop__orders`
    
    
    OPTIONS()
    as (
      

select * from `analytics-engineers-club.coffee_shop.orders`
    );
  
[0m14:08:33.949992 [debug] [Thread-2 (]: Writing runtime sql for node "model.coffee_shop.stg_coffee_shop__customers"
[0m14:08:33.950958 [debug] [Thread-2 (]: On model.coffee_shop.stg_coffee_shop__customers: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.stg_coffee_shop__customers"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`stg_coffee_shop__customers`
    
    
    OPTIONS()
    as (
      

select * from `analytics-engineers-club.coffee_shop.customers`
    );
  
[0m14:08:33.953662 [debug] [Thread-3 (]: Writing runtime sql for node "model.coffee_shop.stg_coffee_shop__order_items"
[0m14:08:33.956614 [debug] [Thread-3 (]: On model.coffee_shop.stg_coffee_shop__order_items: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.stg_coffee_shop__order_items"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`stg_coffee_shop__order_items`
    
    
    OPTIONS()
    as (
      

select * from `analytics-engineers-club.coffee_shop.order_items`
    );
  
[0m14:08:33.955315 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop.my_first_dbt_model"
[0m14:08:33.961888 [debug] [Thread-1 (]: On model.coffee_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.my_first_dbt_model"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`my_first_dbt_model`
    
    
    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m14:08:33.991494 [debug] [Thread-6 (]: Writing runtime sql for node "model.coffee_shop.stg_coffee_shop__products"
[0m14:08:33.992168 [debug] [Thread-6 (]: On model.coffee_shop.stg_coffee_shop__products: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.stg_coffee_shop__products"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`stg_coffee_shop__products`
    
    
    OPTIONS()
    as (
      

select * from `analytics-engineers-club.coffee_shop.products`
    );
  
[0m14:08:33.995315 [debug] [Thread-7 (]: Writing runtime sql for node "model.coffee_shop.stg_web_tracking__pageviews"
[0m14:08:33.995836 [debug] [Thread-7 (]: On model.coffee_shop.stg_web_tracking__pageviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.stg_web_tracking__pageviews"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`stg_web_tracking__pageviews`
    
    
    OPTIONS()
    as (
      

select * from `analytics-engineers-club`.`web_tracking`.`pageviews`
    );
  
[0m14:08:36.044434 [debug] [Thread-6 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:0183db8f-b459-4084-af0f-7ef666f342f9&page=queryresults
[0m14:08:36.061846 [debug] [Thread-6 (]: Timing info for model.coffee_shop.stg_coffee_shop__products (execute): 2023-03-10 14:08:33.224562 => 2023-03-10 14:08:36.061760
[0m14:08:36.062786 [debug] [Thread-6 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18604ef8-fa7f-44dc-bc16-fe8a0d2c6a9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe759a7c8e0>]}
[0m14:08:36.063404 [info ] [Thread-6 (]: 6 of 9 OK created sql table model dbt_milan.stg_coffee_shop__products .......... [[32mCREATE TABLE (7.0 rows, 278.0 Bytes processed)[0m in 2.86s]
[0m14:08:36.065772 [debug] [Thread-6 (]: Finished running node model.coffee_shop.stg_coffee_shop__products
[0m14:08:36.239243 [debug] [Thread-5 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:1b208f9c-f4be-4cdd-a55b-11b269dbb707&page=queryresults
[0m14:08:36.242111 [debug] [Thread-5 (]: Timing info for model.coffee_shop.stg_coffee_shop__product_prices (execute): 2023-03-10 14:08:33.278128 => 2023-03-10 14:08:36.242002
[0m14:08:36.243391 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18604ef8-fa7f-44dc-bc16-fe8a0d2c6a9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe758269ff0>]}
[0m14:08:36.244226 [info ] [Thread-5 (]: 5 of 9 OK created sql table model dbt_milan.stg_coffee_shop__product_prices .... [[32mCREATE TABLE (15.0 rows, 600.0 Bytes processed)[0m in 3.03s]
[0m14:08:36.245426 [debug] [Thread-5 (]: Finished running node model.coffee_shop.stg_coffee_shop__product_prices
[0m14:08:36.259196 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:f6e9fe6a-56bc-4ca3-b291-db73b88f1bcb&page=queryresults
[0m14:08:36.261002 [debug] [Thread-1 (]: Timing info for model.coffee_shop.my_first_dbt_model (execute): 2023-03-10 14:08:33.251937 => 2023-03-10 14:08:36.260949
[0m14:08:36.261721 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18604ef8-fa7f-44dc-bc16-fe8a0d2c6a9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe759a6fdc0>]}
[0m14:08:36.262216 [info ] [Thread-1 (]: 1 of 9 OK created sql table model dbt_milan.my_first_dbt_model ................. [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 3.07s]
[0m14:08:36.263035 [debug] [Thread-1 (]: Finished running node model.coffee_shop.my_first_dbt_model
[0m14:08:36.263724 [debug] [Thread-8 (]: Began running node model.coffee_shop.my_second_dbt_model
[0m14:08:36.264192 [info ] [Thread-8 (]: 8 of 9 START sql view model dbt_milan.my_second_dbt_model ...................... [RUN]
[0m14:08:36.265324 [debug] [Thread-8 (]: Acquiring new bigquery connection 'model.coffee_shop.my_second_dbt_model'
[0m14:08:36.265618 [debug] [Thread-8 (]: Began compiling node model.coffee_shop.my_second_dbt_model
[0m14:08:36.269270 [debug] [Thread-8 (]: Writing injected SQL for node "model.coffee_shop.my_second_dbt_model"
[0m14:08:36.270122 [debug] [Thread-8 (]: Timing info for model.coffee_shop.my_second_dbt_model (compile): 2023-03-10 14:08:36.265812 => 2023-03-10 14:08:36.270038
[0m14:08:36.270531 [debug] [Thread-8 (]: Began executing node model.coffee_shop.my_second_dbt_model
[0m14:08:36.290425 [debug] [Thread-8 (]: Writing runtime sql for node "model.coffee_shop.my_second_dbt_model"
[0m14:08:36.291355 [debug] [Thread-8 (]: Opening a new connection, currently in state init
[0m14:08:36.291827 [debug] [Thread-8 (]: On model.coffee_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.my_second_dbt_model"} */


  create or replace view `aec-students`.`dbt_milan`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `aec-students`.`dbt_milan`.`my_first_dbt_model`
where id = 1;


[0m14:08:36.992544 [debug] [Thread-8 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:6f16831b-a0b2-479f-8fae-55468756d8d5&page=queryresults
[0m14:08:36.994942 [debug] [Thread-8 (]: Timing info for model.coffee_shop.my_second_dbt_model (execute): 2023-03-10 14:08:36.270807 => 2023-03-10 14:08:36.994873
[0m14:08:36.995751 [debug] [Thread-8 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18604ef8-fa7f-44dc-bc16-fe8a0d2c6a9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe759a6f100>]}
[0m14:08:36.996296 [info ] [Thread-8 (]: 8 of 9 OK created sql view model dbt_milan.my_second_dbt_model ................. [[32mCREATE VIEW (0 processed)[0m in 0.73s]
[0m14:08:36.997721 [debug] [Thread-8 (]: Finished running node model.coffee_shop.my_second_dbt_model
[0m14:08:37.612951 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:723da350-ee12-413f-a4ea-d4937f19e5e5&page=queryresults
[0m14:08:37.615251 [debug] [Thread-4 (]: Timing info for model.coffee_shop.stg_coffee_shop__orders (execute): 2023-03-10 14:08:33.274026 => 2023-03-10 14:08:37.615162
[0m14:08:37.616103 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18604ef8-fa7f-44dc-bc16-fe8a0d2c6a9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe75935ca30>]}
[0m14:08:37.616695 [info ] [Thread-4 (]: 4 of 9 OK created sql table model dbt_milan.stg_coffee_shop__orders ............ [[32mCREATE TABLE (192.0k rows, 24.7 MB processed)[0m in 4.40s]
[0m14:08:37.617514 [debug] [Thread-4 (]: Finished running node model.coffee_shop.stg_coffee_shop__orders
[0m14:08:37.639582 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:d722af1b-abfe-4412-9468-87961c2a8f72&page=queryresults
[0m14:08:37.642522 [debug] [Thread-2 (]: Timing info for model.coffee_shop.stg_coffee_shop__customers (execute): 2023-03-10 14:08:33.257003 => 2023-03-10 14:08:37.642465
[0m14:08:37.643338 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18604ef8-fa7f-44dc-bc16-fe8a0d2c6a9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe75985fc40>]}
[0m14:08:37.643902 [info ] [Thread-2 (]: 2 of 9 OK created sql table model dbt_milan.stg_coffee_shop__customers ......... [[32mCREATE TABLE (174.4k rows, 12.8 MB processed)[0m in 4.45s]
[0m14:08:37.644653 [debug] [Thread-2 (]: Finished running node model.coffee_shop.stg_coffee_shop__customers
[0m14:08:38.924081 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:d7f66c5d-e394-45bb-8856-a9ebe0979efe&page=queryresults
[0m14:08:38.926951 [debug] [Thread-3 (]: Timing info for model.coffee_shop.stg_coffee_shop__order_items (execute): 2023-03-10 14:08:33.249866 => 2023-03-10 14:08:38.926871
[0m14:08:38.927952 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18604ef8-fa7f-44dc-bc16-fe8a0d2c6a9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe75935e080>]}
[0m14:08:38.928614 [info ] [Thread-3 (]: 3 of 9 OK created sql table model dbt_milan.stg_coffee_shop__order_items ....... [[32mCREATE TABLE (383.8k rows, 30.7 MB processed)[0m in 5.73s]
[0m14:08:38.929513 [debug] [Thread-3 (]: Finished running node model.coffee_shop.stg_coffee_shop__order_items
[0m14:08:43.869467 [debug] [Thread-7 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:1d4f2f8a-6796-4bba-8389-871f1b65162a&page=queryresults
[0m14:08:43.871769 [debug] [Thread-7 (]: Timing info for model.coffee_shop.stg_web_tracking__pageviews (execute): 2023-03-10 14:08:33.265310 => 2023-03-10 14:08:43.871695
[0m14:08:43.872612 [debug] [Thread-7 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18604ef8-fa7f-44dc-bc16-fe8a0d2c6a9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe75985fbe0>]}
[0m14:08:43.873164 [info ] [Thread-7 (]: 7 of 9 OK created sql table model dbt_milan.stg_web_tracking__pageviews ........ [[32mCREATE TABLE (5.8m rows, 606.0 MB processed)[0m in 10.66s]
[0m14:08:43.874074 [debug] [Thread-7 (]: Finished running node model.coffee_shop.stg_web_tracking__pageviews
[0m14:08:43.874919 [debug] [Thread-5 (]: Began running node model.coffee_shop.pageviews_with_stiched_user_id
[0m14:08:43.875418 [info ] [Thread-5 (]: 9 of 9 START sql table model dbt_milan.pageviews_with_stiched_user_id .......... [RUN]
[0m14:08:43.876492 [debug] [Thread-5 (]: Acquiring new bigquery connection 'model.coffee_shop.pageviews_with_stiched_user_id'
[0m14:08:43.876838 [debug] [Thread-5 (]: Began compiling node model.coffee_shop.pageviews_with_stiched_user_id
[0m14:08:43.881092 [debug] [Thread-5 (]: Writing injected SQL for node "model.coffee_shop.pageviews_with_stiched_user_id"
[0m14:08:43.881635 [debug] [Thread-5 (]: Timing info for model.coffee_shop.pageviews_with_stiched_user_id (compile): 2023-03-10 14:08:43.877017 => 2023-03-10 14:08:43.881570
[0m14:08:43.881997 [debug] [Thread-5 (]: Began executing node model.coffee_shop.pageviews_with_stiched_user_id
[0m14:08:43.884946 [debug] [Thread-5 (]: Writing runtime sql for node "model.coffee_shop.pageviews_with_stiched_user_id"
[0m14:08:43.885474 [debug] [Thread-5 (]: Opening a new connection, currently in state closed
[0m14:08:43.885903 [debug] [Thread-5 (]: On model.coffee_shop.pageviews_with_stiched_user_id: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.pageviews_with_stiched_user_id"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`pageviews_with_stiched_user_id`
    
    
    OPTIONS()
    as (
      

SELECT
    *,
    COALESCE (FIRST_VALUE(customer_id IGNORE NULLS) OVER (PARTITION BY visitor_id ORDER BY visitor_id ASC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING),visitor_id) AS user_id
FROM
  `aec-students`.`dbt_milan`.`stg_web_tracking__pageviews` as pageviews
    order by visitor_id, timestamp
    );
  
[0m14:08:55.334843 [debug] [Thread-5 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:84b9e83e-9645-433a-8ead-48a3a1170cff&page=queryresults
[0m14:08:55.338163 [debug] [Thread-5 (]: Timing info for model.coffee_shop.pageviews_with_stiched_user_id (execute): 2023-03-10 14:08:43.882276 => 2023-03-10 14:08:55.338060
[0m14:08:55.339352 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18604ef8-fa7f-44dc-bc16-fe8a0d2c6a9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe759a6f8b0>]}
[0m14:08:55.340065 [info ] [Thread-5 (]: 9 of 9 OK created sql table model dbt_milan.pageviews_with_stiched_user_id ..... [[32mCREATE TABLE (5.8m rows, 606.0 MB processed)[0m in 11.46s]
[0m14:08:55.341083 [debug] [Thread-5 (]: Finished running node model.coffee_shop.pageviews_with_stiched_user_id
[0m14:08:55.343758 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:08:55.345075 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:08:55.346543 [debug] [MainThread]: Connection 'model.coffee_shop.my_first_dbt_model' was properly closed.
[0m14:08:55.347182 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop__customers' was properly closed.
[0m14:08:55.347608 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop__products' was properly closed.
[0m14:08:55.348080 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop__order_items' was properly closed.
[0m14:08:55.348541 [debug] [MainThread]: Connection 'model.coffee_shop.stg_web_tracking__pageviews' was properly closed.
[0m14:08:55.348998 [debug] [MainThread]: Connection 'model.coffee_shop.pageviews_with_stiched_user_id' was properly closed.
[0m14:08:55.349422 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop__orders' was properly closed.
[0m14:08:55.350302 [debug] [MainThread]: Connection 'model.coffee_shop.my_second_dbt_model' was properly closed.
[0m14:08:55.350862 [info ] [MainThread]: 
[0m14:08:55.351455 [info ] [MainThread]: Finished running 8 table models, 1 view model in 0 hours 0 minutes and 24.12 seconds (24.12s).
[0m14:08:55.352847 [debug] [MainThread]: Command end result
[0m14:08:55.368478 [info ] [MainThread]: 
[0m14:08:55.369040 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:08:55.369563 [info ] [MainThread]: 
[0m14:08:55.370347 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m14:08:55.370937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe759a1f820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe7593cc0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe759a4edd0>]}
[0m14:08:55.371366 [debug] [MainThread]: Flushing usage events


============================== 2023-03-10 14:20:47.217664 | e54ff708-0a67-41b5-9b24-8b629aefaada ==============================
[0m14:20:47.217664 [info ] [MainThread]: Running with dbt=1.4.1
[0m14:20:47.220329 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:20:47.220844 [debug] [MainThread]: Tracking: tracking
[0m14:20:47.229717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd230b5b700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd230b58190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd230b5b730>]}
[0m14:20:47.279378 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m14:20:47.280012 [debug] [MainThread]: Partial parsing: added file: coffee_shop://models/marts/web_tracking/pageviews.sql
[0m14:20:47.280392 [debug] [MainThread]: Partial parsing: deleted file: coffee_shop://models/marts/web_tracking/pageviews_with_stiched_user_id.sql
[0m14:20:47.293830 [debug] [MainThread]: 1699: static parser successfully parsed marts/web_tracking/pageviews.sql
[0m14:20:47.311622 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffe_shop_milan.example
[0m14:20:47.317377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e54ff708-0a67-41b5-9b24-8b629aefaada', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2309a9840>]}
[0m14:20:47.326178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e54ff708-0a67-41b5-9b24-8b629aefaada', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd230970130>]}
[0m14:20:47.326650 [info ] [MainThread]: Found 9 models, 10 tests, 0 snapshots, 0 analyses, 334 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
[0m14:20:47.327146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e54ff708-0a67-41b5-9b24-8b629aefaada', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd230970100>]}
[0m14:20:47.329384 [info ] [MainThread]: 
[0m14:20:47.386325 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:20:47.388532 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m14:20:47.389038 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:20:48.480376 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_milan'
[0m14:20:48.481611 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:20:48.790446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e54ff708-0a67-41b5-9b24-8b629aefaada', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd230e860b0>]}
[0m14:20:48.791503 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m14:20:48.792053 [info ] [MainThread]: 
[0m14:20:48.798053 [debug] [Thread-1 (]: Began running node model.coffee_shop.my_first_dbt_model
[0m14:20:48.798511 [info ] [Thread-1 (]: 1 of 9 START sql table model dbt_milan.my_first_dbt_model ...................... [RUN]
[0m14:20:48.799378 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop.my_first_dbt_model'
[0m14:20:48.799700 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.my_first_dbt_model
[0m14:20:48.802865 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.my_first_dbt_model"
[0m14:20:48.803224 [debug] [Thread-2 (]: Began running node model.coffee_shop.stg_coffee_shop__customers
[0m14:20:48.803669 [debug] [Thread-3 (]: Began running node model.coffee_shop.stg_coffee_shop__order_items
[0m14:20:48.803949 [debug] [Thread-4 (]: Began running node model.coffee_shop.stg_coffee_shop__orders
[0m14:20:48.804191 [debug] [Thread-5 (]: Began running node model.coffee_shop.stg_coffee_shop__product_prices
[0m14:20:48.804423 [debug] [Thread-6 (]: Began running node model.coffee_shop.stg_coffee_shop__products
[0m14:20:48.804749 [debug] [Thread-7 (]: Began running node model.coffee_shop.stg_web_tracking__pageviews
[0m14:20:48.805261 [debug] [Thread-1 (]: Timing info for model.coffee_shop.my_first_dbt_model (compile): 2023-03-10 14:20:48.799906 => 2023-03-10 14:20:48.805166
[0m14:20:48.805660 [info ] [Thread-2 (]: 2 of 9 START sql table model dbt_milan.stg_coffee_shop__customers .............. [RUN]
[0m14:20:48.806092 [info ] [Thread-3 (]: 3 of 9 START sql table model dbt_milan.stg_coffee_shop__order_items ............ [RUN]
[0m14:20:48.806873 [info ] [Thread-5 (]: 5 of 9 START sql table model dbt_milan.stg_coffee_shop__product_prices ......... [RUN]
[0m14:20:48.807532 [info ] [Thread-7 (]: 7 of 9 START sql table model dbt_milan.stg_web_tracking__pageviews ............. [RUN]
[0m14:20:48.812514 [debug] [Thread-7 (]: Acquiring new bigquery connection 'model.coffee_shop.stg_web_tracking__pageviews'
[0m14:20:48.809331 [debug] [Thread-1 (]: Began executing node model.coffee_shop.my_first_dbt_model
[0m14:20:48.806528 [info ] [Thread-4 (]: 4 of 9 START sql table model dbt_milan.stg_coffee_shop__orders ................. [RUN]
[0m14:20:48.810346 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.coffee_shop.stg_coffee_shop__customers'
[0m14:20:48.811022 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.coffee_shop.stg_coffee_shop__order_items'
[0m14:20:48.823292 [debug] [Thread-3 (]: Began compiling node model.coffee_shop.stg_coffee_shop__order_items
[0m14:20:48.812850 [debug] [Thread-7 (]: Began compiling node model.coffee_shop.stg_web_tracking__pageviews
[0m14:20:48.807197 [info ] [Thread-6 (]: 6 of 9 START sql table model dbt_milan.stg_coffee_shop__products ............... [RUN]
[0m14:20:48.822143 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.coffee_shop.stg_coffee_shop__orders'
[0m14:20:48.822834 [debug] [Thread-2 (]: Began compiling node model.coffee_shop.stg_coffee_shop__customers
[0m14:20:48.811742 [debug] [Thread-5 (]: Acquiring new bigquery connection 'model.coffee_shop.stg_coffee_shop__product_prices'
[0m14:20:48.832803 [debug] [Thread-7 (]: Writing injected SQL for node "model.coffee_shop.stg_web_tracking__pageviews"
[0m14:20:48.827656 [debug] [Thread-3 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop__order_items"
[0m14:20:48.838750 [debug] [Thread-6 (]: Acquiring new bigquery connection 'model.coffee_shop.stg_coffee_shop__products'
[0m14:20:48.857343 [debug] [Thread-6 (]: Began compiling node model.coffee_shop.stg_coffee_shop__products
[0m14:20:48.860109 [debug] [Thread-6 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop__products"
[0m14:20:48.855093 [debug] [Thread-5 (]: Began compiling node model.coffee_shop.stg_coffee_shop__product_prices
[0m14:20:48.856749 [debug] [Thread-7 (]: Timing info for model.coffee_shop.stg_web_tracking__pageviews (compile): 2023-03-10 14:20:48.828020 => 2023-03-10 14:20:48.856652
[0m14:20:48.848868 [debug] [Thread-4 (]: Began compiling node model.coffee_shop.stg_coffee_shop__orders
[0m14:20:48.853186 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:20:48.863029 [debug] [Thread-2 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop__customers"
[0m14:20:48.863285 [debug] [Thread-3 (]: Timing info for model.coffee_shop.stg_coffee_shop__order_items (compile): 2023-03-10 14:20:48.823688 => 2023-03-10 14:20:48.863213
[0m14:20:48.873748 [debug] [Thread-3 (]: Began executing node model.coffee_shop.stg_coffee_shop__order_items
[0m14:20:48.868664 [debug] [Thread-5 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop__product_prices"
[0m14:20:48.869098 [debug] [Thread-7 (]: Began executing node model.coffee_shop.stg_web_tracking__pageviews
[0m14:20:48.879829 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m14:20:48.863868 [debug] [Thread-6 (]: Timing info for model.coffee_shop.stg_coffee_shop__products (compile): 2023-03-10 14:20:48.857999 => 2023-03-10 14:20:48.863788
[0m14:20:48.877046 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:20:48.871445 [debug] [Thread-4 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop__orders"
[0m14:20:48.880906 [debug] [Thread-6 (]: Began executing node model.coffee_shop.stg_coffee_shop__products
[0m14:20:48.884615 [debug] [Thread-6 (]: Opening a new connection, currently in state init
[0m14:20:48.885702 [debug] [Thread-2 (]: Timing info for model.coffee_shop.stg_coffee_shop__customers (compile): 2023-03-10 14:20:48.853540 => 2023-03-10 14:20:48.885617
[0m14:20:48.887086 [debug] [Thread-4 (]: Timing info for model.coffee_shop.stg_coffee_shop__orders (compile): 2023-03-10 14:20:48.869333 => 2023-03-10 14:20:48.887001
[0m14:20:48.892364 [debug] [Thread-4 (]: Began executing node model.coffee_shop.stg_coffee_shop__orders
[0m14:20:48.895143 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:20:48.887491 [debug] [Thread-5 (]: Timing info for model.coffee_shop.stg_coffee_shop__product_prices (compile): 2023-03-10 14:20:48.864189 => 2023-03-10 14:20:48.887418
[0m14:20:48.898381 [debug] [Thread-5 (]: Began executing node model.coffee_shop.stg_coffee_shop__product_prices
[0m14:20:48.891731 [debug] [Thread-2 (]: Began executing node model.coffee_shop.stg_coffee_shop__customers
[0m14:20:48.901312 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m14:20:48.905763 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:20:49.671876 [debug] [Thread-5 (]: Writing runtime sql for node "model.coffee_shop.stg_coffee_shop__product_prices"
[0m14:20:49.674010 [debug] [Thread-3 (]: Writing runtime sql for node "model.coffee_shop.stg_coffee_shop__order_items"
[0m14:20:49.675876 [debug] [Thread-7 (]: Writing runtime sql for node "model.coffee_shop.stg_web_tracking__pageviews"
[0m14:20:49.677701 [debug] [Thread-2 (]: Writing runtime sql for node "model.coffee_shop.stg_coffee_shop__customers"
[0m14:20:49.681728 [debug] [Thread-2 (]: On model.coffee_shop.stg_coffee_shop__customers: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.stg_coffee_shop__customers"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`stg_coffee_shop__customers`
    
    
    OPTIONS()
    as (
      

select * from `analytics-engineers-club.coffee_shop.customers`
    );
  
[0m14:20:49.680443 [debug] [Thread-5 (]: On model.coffee_shop.stg_coffee_shop__product_prices: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.stg_coffee_shop__product_prices"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`stg_coffee_shop__product_prices`
    
    
    OPTIONS()
    as (
      

select * from `analytics-engineers-club.coffee_shop.product_prices`
    );
  
[0m14:20:49.681125 [debug] [Thread-7 (]: On model.coffee_shop.stg_web_tracking__pageviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.stg_web_tracking__pageviews"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`stg_web_tracking__pageviews`
    
    
    OPTIONS()
    as (
      

select * from `analytics-engineers-club`.`web_tracking`.`pageviews`
    );
  
[0m14:20:49.679430 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop.my_first_dbt_model"
[0m14:20:49.686802 [debug] [Thread-3 (]: On model.coffee_shop.stg_coffee_shop__order_items: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.stg_coffee_shop__order_items"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`stg_coffee_shop__order_items`
    
    
    OPTIONS()
    as (
      

select * from `analytics-engineers-club.coffee_shop.order_items`
    );
  
[0m14:20:49.687883 [debug] [Thread-1 (]: On model.coffee_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.my_first_dbt_model"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`my_first_dbt_model`
    
    
    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m14:20:49.771357 [debug] [Thread-4 (]: Writing runtime sql for node "model.coffee_shop.stg_coffee_shop__orders"
[0m14:20:49.772162 [debug] [Thread-4 (]: On model.coffee_shop.stg_coffee_shop__orders: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.stg_coffee_shop__orders"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`stg_coffee_shop__orders`
    
    
    OPTIONS()
    as (
      

select * from `analytics-engineers-club.coffee_shop.orders`
    );
  
[0m14:20:50.069378 [debug] [Thread-6 (]: Writing runtime sql for node "model.coffee_shop.stg_coffee_shop__products"
[0m14:20:50.070154 [debug] [Thread-6 (]: On model.coffee_shop.stg_coffee_shop__products: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.stg_coffee_shop__products"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`stg_coffee_shop__products`
    
    
    OPTIONS()
    as (
      

select * from `analytics-engineers-club.coffee_shop.products`
    );
  
[0m14:20:51.954023 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:3072bb4a-2d28-428e-8a4c-6199162aa3d8&page=queryresults
[0m14:20:51.970705 [debug] [Thread-1 (]: Timing info for model.coffee_shop.my_first_dbt_model (execute): 2023-03-10 14:20:48.813155 => 2023-03-10 14:20:51.970634
[0m14:20:51.971603 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e54ff708-0a67-41b5-9b24-8b629aefaada', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd230b5f850>]}
[0m14:20:51.972214 [info ] [Thread-1 (]: 1 of 9 OK created sql table model dbt_milan.my_first_dbt_model ................. [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 3.17s]
[0m14:20:51.974073 [debug] [Thread-1 (]: Finished running node model.coffee_shop.my_first_dbt_model
[0m14:20:51.975031 [debug] [Thread-1 (]: Began running node model.coffee_shop.my_second_dbt_model
[0m14:20:51.975974 [info ] [Thread-1 (]: 8 of 9 START sql view model dbt_milan.my_second_dbt_model ...................... [RUN]
[0m14:20:51.978524 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop.my_second_dbt_model'
[0m14:20:51.979043 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.my_second_dbt_model
[0m14:20:51.982180 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.my_second_dbt_model"
[0m14:20:51.983143 [debug] [Thread-1 (]: Timing info for model.coffee_shop.my_second_dbt_model (compile): 2023-03-10 14:20:51.979702 => 2023-03-10 14:20:51.983066
[0m14:20:51.983534 [debug] [Thread-1 (]: Began executing node model.coffee_shop.my_second_dbt_model
[0m14:20:52.001753 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop.my_second_dbt_model"
[0m14:20:52.002586 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:20:52.003030 [debug] [Thread-1 (]: On model.coffee_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.my_second_dbt_model"} */


  create or replace view `aec-students`.`dbt_milan`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `aec-students`.`dbt_milan`.`my_first_dbt_model`
where id = 1;


[0m14:20:52.025895 [debug] [Thread-5 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:6af29074-ee5f-4251-9937-ad069e9bab57&page=queryresults
[0m14:20:52.028671 [debug] [Thread-5 (]: Timing info for model.coffee_shop.stg_coffee_shop__product_prices (execute): 2023-03-10 14:20:48.898710 => 2023-03-10 14:20:52.028566
[0m14:20:52.030232 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e54ff708-0a67-41b5-9b24-8b629aefaada', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2309ab640>]}
[0m14:20:52.031006 [info ] [Thread-5 (]: 5 of 9 OK created sql table model dbt_milan.stg_coffee_shop__product_prices .... [[32mCREATE TABLE (15.0 rows, 600.0 Bytes processed)[0m in 3.22s]
[0m14:20:52.033032 [debug] [Thread-5 (]: Finished running node model.coffee_shop.stg_coffee_shop__product_prices
[0m14:20:52.504402 [debug] [Thread-6 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:da578a13-412f-4548-a1e7-c3f570ab3463&page=queryresults
[0m14:20:52.507693 [debug] [Thread-6 (]: Timing info for model.coffee_shop.stg_coffee_shop__products (execute): 2023-03-10 14:20:48.883047 => 2023-03-10 14:20:52.507617
[0m14:20:52.508693 [debug] [Thread-6 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e54ff708-0a67-41b5-9b24-8b629aefaada', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd23094ee00>]}
[0m14:20:52.509338 [info ] [Thread-6 (]: 6 of 9 OK created sql table model dbt_milan.stg_coffee_shop__products .......... [[32mCREATE TABLE (7.0 rows, 278.0 Bytes processed)[0m in 3.67s]
[0m14:20:52.510315 [debug] [Thread-6 (]: Finished running node model.coffee_shop.stg_coffee_shop__products
[0m14:20:52.822615 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:a08a048e-578d-4b7d-b7e7-0e6ffc9a26fb&page=queryresults
[0m14:20:52.825519 [debug] [Thread-1 (]: Timing info for model.coffee_shop.my_second_dbt_model (execute): 2023-03-10 14:20:51.983818 => 2023-03-10 14:20:52.825447
[0m14:20:52.826496 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e54ff708-0a67-41b5-9b24-8b629aefaada', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd230b5df90>]}
[0m14:20:52.827193 [info ] [Thread-1 (]: 8 of 9 OK created sql view model dbt_milan.my_second_dbt_model ................. [[32mCREATE VIEW (0 processed)[0m in 0.85s]
[0m14:20:52.827956 [debug] [Thread-1 (]: Finished running node model.coffee_shop.my_second_dbt_model
[0m14:20:52.916816 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:d98d6d92-5a9a-4627-ba2d-3f872d496df8&page=queryresults
[0m14:20:52.919318 [debug] [Thread-2 (]: Timing info for model.coffee_shop.stg_coffee_shop__customers (execute): 2023-03-10 14:20:48.901809 => 2023-03-10 14:20:52.919242
[0m14:20:52.920112 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e54ff708-0a67-41b5-9b24-8b629aefaada', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd23094fbe0>]}
[0m14:20:52.920843 [info ] [Thread-2 (]: 2 of 9 OK created sql table model dbt_milan.stg_coffee_shop__customers ......... [[32mCREATE TABLE (174.4k rows, 12.8 MB processed)[0m in 4.11s]
[0m14:20:52.921495 [debug] [Thread-2 (]: Finished running node model.coffee_shop.stg_coffee_shop__customers
[0m14:20:53.891435 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:12262e49-1944-4acd-8d7b-023f66a07baf&page=queryresults
[0m14:20:53.893640 [debug] [Thread-4 (]: Timing info for model.coffee_shop.stg_coffee_shop__orders (execute): 2023-03-10 14:20:48.892697 => 2023-03-10 14:20:53.893574
[0m14:20:53.894567 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e54ff708-0a67-41b5-9b24-8b629aefaada', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2304aa890>]}
[0m14:20:53.895414 [info ] [Thread-4 (]: 4 of 9 OK created sql table model dbt_milan.stg_coffee_shop__orders ............ [[32mCREATE TABLE (192.0k rows, 24.7 MB processed)[0m in 5.07s]
[0m14:20:53.896138 [debug] [Thread-4 (]: Finished running node model.coffee_shop.stg_coffee_shop__orders
[0m14:20:54.018259 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:c21c9e1e-b121-41e1-9327-5093a3c6b043&page=queryresults
[0m14:20:54.020420 [debug] [Thread-3 (]: Timing info for model.coffee_shop.stg_coffee_shop__order_items (execute): 2023-03-10 14:20:48.874058 => 2023-03-10 14:20:54.020328
[0m14:20:54.021307 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e54ff708-0a67-41b5-9b24-8b629aefaada', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd23094d6f0>]}
[0m14:20:54.021896 [info ] [Thread-3 (]: 3 of 9 OK created sql table model dbt_milan.stg_coffee_shop__order_items ....... [[32mCREATE TABLE (383.8k rows, 30.7 MB processed)[0m in 5.21s]
[0m14:20:54.022725 [debug] [Thread-3 (]: Finished running node model.coffee_shop.stg_coffee_shop__order_items
[0m14:20:59.632533 [debug] [Thread-7 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:deb2a103-8b8b-4663-8495-a87edaf75c3b&page=queryresults
[0m14:20:59.635188 [debug] [Thread-7 (]: Timing info for model.coffee_shop.stg_web_tracking__pageviews (execute): 2023-03-10 14:20:48.877981 => 2023-03-10 14:20:59.635111
[0m14:20:59.636226 [debug] [Thread-7 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e54ff708-0a67-41b5-9b24-8b629aefaada', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd23094c100>]}
[0m14:20:59.636940 [info ] [Thread-7 (]: 7 of 9 OK created sql table model dbt_milan.stg_web_tracking__pageviews ........ [[32mCREATE TABLE (5.8m rows, 606.0 MB processed)[0m in 10.82s]
[0m14:20:59.637749 [debug] [Thread-7 (]: Finished running node model.coffee_shop.stg_web_tracking__pageviews
[0m14:20:59.638994 [debug] [Thread-8 (]: Began running node model.coffee_shop.pageviews
[0m14:20:59.639908 [info ] [Thread-8 (]: 9 of 9 START sql table model dbt_milan.pageviews ............................... [RUN]
[0m14:20:59.640791 [debug] [Thread-8 (]: Acquiring new bigquery connection 'model.coffee_shop.pageviews'
[0m14:20:59.642065 [debug] [Thread-8 (]: Began compiling node model.coffee_shop.pageviews
[0m14:20:59.646601 [debug] [Thread-8 (]: Writing injected SQL for node "model.coffee_shop.pageviews"
[0m14:20:59.647083 [debug] [Thread-8 (]: Timing info for model.coffee_shop.pageviews (compile): 2023-03-10 14:20:59.642317 => 2023-03-10 14:20:59.647010
[0m14:20:59.647401 [debug] [Thread-8 (]: Began executing node model.coffee_shop.pageviews
[0m14:20:59.651776 [debug] [Thread-8 (]: Writing runtime sql for node "model.coffee_shop.pageviews"
[0m14:20:59.652264 [debug] [Thread-8 (]: Opening a new connection, currently in state init
[0m14:20:59.652676 [debug] [Thread-8 (]: On model.coffee_shop.pageviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.pageviews"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`pageviews`
    
    
    OPTIONS()
    as (
      

WITH
  pageview_with_stiched_user_id AS 
(
SELECT
    *,
    COALESCE (FIRST_VALUE(customer_id IGNORE NULLS) OVER (PARTITION BY visitor_id ORDER BY visitor_id ASC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING),visitor_id) AS user_id
FROM
  `aec-students`.`dbt_milan`.`stg_web_tracking__pageviews` as pageviews
),

  session_calculator as
(
SELECT
  *,
  if (TIMESTAMP_DIFF (timestamp,LAG(timestamp) OVER (PARTITION BY user_id ORDER BY timestamp ASC), SECOND)>1800, 1, 0) AS session_number_increment
FROM
  pageview_with_stiched_user_id
)

SELECT *,
  FARM_FINGERPRINT(USER_ID || SUM(session_number_increment) OVER (PARTITION BY user_id ORDER BY TIMESTAMP ASC)) as session_id
FROM session_calculator
order by visitor_id, timestamp
    );
  
[0m14:21:13.150926 [debug] [Thread-8 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:91496857-097d-4afc-8478-1e4eca05aefc&page=queryresults
[0m14:21:13.152972 [debug] [Thread-8 (]: Timing info for model.coffee_shop.pageviews (execute): 2023-03-10 14:20:59.647602 => 2023-03-10 14:21:13.152881
[0m14:21:13.153970 [debug] [Thread-8 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e54ff708-0a67-41b5-9b24-8b629aefaada', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd23038dba0>]}
[0m14:21:13.154508 [info ] [Thread-8 (]: 9 of 9 OK created sql table model dbt_milan.pageviews .......................... [[32mCREATE TABLE (5.8m rows, 606.0 MB processed)[0m in 13.51s]
[0m14:21:13.155023 [debug] [Thread-8 (]: Finished running node model.coffee_shop.pageviews
[0m14:21:13.157644 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:21:13.158454 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:21:13.158854 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop__customers' was properly closed.
[0m14:21:13.159119 [debug] [MainThread]: Connection 'model.coffee_shop.my_second_dbt_model' was properly closed.
[0m14:21:13.159474 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop__order_items' was properly closed.
[0m14:21:13.159761 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop__product_prices' was properly closed.
[0m14:21:13.160036 [debug] [MainThread]: Connection 'model.coffee_shop.stg_web_tracking__pageviews' was properly closed.
[0m14:21:13.160311 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop__orders' was properly closed.
[0m14:21:13.160697 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop__products' was properly closed.
[0m14:21:13.161001 [debug] [MainThread]: Connection 'model.coffee_shop.pageviews' was properly closed.
[0m14:21:13.161371 [info ] [MainThread]: 
[0m14:21:13.161860 [info ] [MainThread]: Finished running 8 table models, 1 view model in 0 hours 0 minutes and 25.83 seconds (25.83s).
[0m14:21:13.162996 [debug] [MainThread]: Command end result
[0m14:21:13.172881 [info ] [MainThread]: 
[0m14:21:13.173427 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:21:13.173922 [info ] [MainThread]: 
[0m14:21:13.174414 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m14:21:13.175296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd234312500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd230d3a500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd23112fd90>]}
[0m14:21:13.175717 [debug] [MainThread]: Flushing usage events


============================== 2023-03-10 14:25:51.639039 | b71ef2f2-71ea-4705-b310-6314099f6f79 ==============================
[0m14:25:51.639039 [info ] [MainThread]: Running with dbt=1.4.1
[0m14:25:51.644466 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:25:51.645801 [debug] [MainThread]: Tracking: tracking
[0m14:25:51.651782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5768a32230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f576884d810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f576884fa90>]}
[0m14:25:51.704974 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:25:51.705672 [debug] [MainThread]: Partial parsing: updated file: coffee_shop://models/marts/web_tracking/pageviews.sql
[0m14:25:51.719790 [debug] [MainThread]: 1699: static parser successfully parsed marts/web_tracking/pageviews.sql
[0m14:25:51.741477 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffe_shop_milan.example
[0m14:25:51.751613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b71ef2f2-71ea-4705-b310-6314099f6f79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57686a9390>]}
[0m14:25:51.764447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b71ef2f2-71ea-4705-b310-6314099f6f79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f576866b3a0>]}
[0m14:25:51.764940 [info ] [MainThread]: Found 9 models, 10 tests, 0 snapshots, 0 analyses, 334 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
[0m14:25:51.765578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b71ef2f2-71ea-4705-b310-6314099f6f79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5768a32230>]}
[0m14:25:51.767615 [info ] [MainThread]: 
[0m14:25:51.825201 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:25:51.827377 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m14:25:51.827943 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:25:53.025852 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_milan'
[0m14:25:53.026632 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:25:53.343635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b71ef2f2-71ea-4705-b310-6314099f6f79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f576c84db70>]}
[0m14:25:53.344565 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m14:25:53.345074 [info ] [MainThread]: 
[0m14:25:53.351370 [debug] [Thread-1 (]: Began running node model.coffee_shop.my_first_dbt_model
[0m14:25:53.351823 [debug] [Thread-2 (]: Began running node model.coffee_shop.stg_coffee_shop__customers
[0m14:25:53.352156 [debug] [Thread-3 (]: Began running node model.coffee_shop.stg_coffee_shop__order_items
[0m14:25:53.352397 [debug] [Thread-4 (]: Began running node model.coffee_shop.stg_coffee_shop__orders
[0m14:25:53.352860 [debug] [Thread-5 (]: Began running node model.coffee_shop.stg_coffee_shop__product_prices
[0m14:25:53.353244 [debug] [Thread-6 (]: Began running node model.coffee_shop.stg_coffee_shop__products
[0m14:25:53.353580 [debug] [Thread-7 (]: Began running node model.coffee_shop.stg_web_tracking__pageviews
[0m14:25:53.354670 [info ] [Thread-2 (]: 2 of 9 START sql table model dbt_milan.stg_coffee_shop__customers .............. [RUN]
[0m14:25:53.358839 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.coffee_shop.stg_coffee_shop__customers'
[0m14:25:53.359270 [debug] [Thread-2 (]: Began compiling node model.coffee_shop.stg_coffee_shop__customers
[0m14:25:53.354166 [info ] [Thread-1 (]: 1 of 9 START sql table model dbt_milan.my_first_dbt_model ...................... [RUN]
[0m14:25:53.362519 [debug] [Thread-2 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop__customers"
[0m14:25:53.355109 [info ] [Thread-3 (]: 3 of 9 START sql table model dbt_milan.stg_coffee_shop__order_items ............ [RUN]
[0m14:25:53.356917 [info ] [Thread-6 (]: 6 of 9 START sql table model dbt_milan.stg_coffee_shop__products ............... [RUN]
[0m14:25:53.364260 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop.my_first_dbt_model'
[0m14:25:53.355575 [info ] [Thread-4 (]: 4 of 9 START sql table model dbt_milan.stg_coffee_shop__orders ................. [RUN]
[0m14:25:53.368785 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.coffee_shop.stg_coffee_shop__orders'
[0m14:25:53.369088 [debug] [Thread-4 (]: Began compiling node model.coffee_shop.stg_coffee_shop__orders
[0m14:25:53.365756 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.coffee_shop.stg_coffee_shop__order_items'
[0m14:25:53.357505 [info ] [Thread-7 (]: 7 of 9 START sql table model dbt_milan.stg_web_tracking__pageviews ............. [RUN]
[0m14:25:53.372537 [debug] [Thread-7 (]: Acquiring new bigquery connection 'model.coffee_shop.stg_web_tracking__pageviews'
[0m14:25:53.368121 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.my_first_dbt_model
[0m14:25:53.371513 [debug] [Thread-4 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop__orders"
[0m14:25:53.356120 [info ] [Thread-5 (]: 5 of 9 START sql table model dbt_milan.stg_coffee_shop__product_prices ......... [RUN]
[0m14:25:53.376257 [debug] [Thread-5 (]: Acquiring new bigquery connection 'model.coffee_shop.stg_coffee_shop__product_prices'
[0m14:25:53.371890 [debug] [Thread-3 (]: Began compiling node model.coffee_shop.stg_coffee_shop__order_items
[0m14:25:53.372866 [debug] [Thread-7 (]: Began compiling node model.coffee_shop.stg_web_tracking__pageviews
[0m14:25:53.367547 [debug] [Thread-2 (]: Timing info for model.coffee_shop.stg_coffee_shop__customers (compile): 2023-03-10 14:25:53.359585 => 2023-03-10 14:25:53.367448
[0m14:25:53.375512 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.my_first_dbt_model"
[0m14:25:53.376558 [debug] [Thread-5 (]: Began compiling node model.coffee_shop.stg_coffee_shop__product_prices
[0m14:25:53.366694 [debug] [Thread-6 (]: Acquiring new bigquery connection 'model.coffee_shop.stg_coffee_shop__products'
[0m14:25:53.390796 [debug] [Thread-6 (]: Began compiling node model.coffee_shop.stg_coffee_shop__products
[0m14:25:53.393440 [debug] [Thread-6 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop__products"
[0m14:25:53.385603 [debug] [Thread-7 (]: Writing injected SQL for node "model.coffee_shop.stg_web_tracking__pageviews"
[0m14:25:53.394021 [debug] [Thread-7 (]: Timing info for model.coffee_shop.stg_web_tracking__pageviews (compile): 2023-03-10 14:25:53.379685 => 2023-03-10 14:25:53.393942
[0m14:25:53.390439 [debug] [Thread-5 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop__product_prices"
[0m14:25:53.379320 [debug] [Thread-3 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop__order_items"
[0m14:25:53.395476 [debug] [Thread-3 (]: Timing info for model.coffee_shop.stg_coffee_shop__order_items (compile): 2023-03-10 14:25:53.376839 => 2023-03-10 14:25:53.395401
[0m14:25:53.382976 [debug] [Thread-4 (]: Timing info for model.coffee_shop.stg_coffee_shop__orders (compile): 2023-03-10 14:25:53.369289 => 2023-03-10 14:25:53.382817
[0m14:25:53.396553 [debug] [Thread-4 (]: Began executing node model.coffee_shop.stg_coffee_shop__orders
[0m14:25:53.394435 [debug] [Thread-7 (]: Began executing node model.coffee_shop.stg_web_tracking__pageviews
[0m14:25:53.394941 [debug] [Thread-6 (]: Timing info for model.coffee_shop.stg_coffee_shop__products (compile): 2023-03-10 14:25:53.391453 => 2023-03-10 14:25:53.394867
[0m14:25:53.395803 [debug] [Thread-3 (]: Began executing node model.coffee_shop.stg_coffee_shop__order_items
[0m14:25:53.414825 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:25:53.396171 [debug] [Thread-5 (]: Timing info for model.coffee_shop.stg_coffee_shop__product_prices (compile): 2023-03-10 14:25:53.386200 => 2023-03-10 14:25:53.396099
[0m14:25:53.385874 [debug] [Thread-2 (]: Began executing node model.coffee_shop.stg_coffee_shop__customers
[0m14:25:53.410739 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:25:53.412657 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m14:25:53.413013 [debug] [Thread-6 (]: Began executing node model.coffee_shop.stg_coffee_shop__products
[0m14:25:53.416766 [debug] [Thread-5 (]: Began executing node model.coffee_shop.stg_coffee_shop__product_prices
[0m14:25:53.426533 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m14:25:53.418817 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:25:53.424503 [debug] [Thread-6 (]: Opening a new connection, currently in state init
[0m14:25:53.391186 [debug] [Thread-1 (]: Timing info for model.coffee_shop.my_first_dbt_model (compile): 2023-03-10 14:25:53.373169 => 2023-03-10 14:25:53.391108
[0m14:25:53.435360 [debug] [Thread-1 (]: Began executing node model.coffee_shop.my_first_dbt_model
[0m14:25:53.438658 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:25:54.146339 [debug] [Thread-7 (]: Writing runtime sql for node "model.coffee_shop.stg_web_tracking__pageviews"
[0m14:25:54.147696 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop.my_first_dbt_model"
[0m14:25:54.150068 [debug] [Thread-4 (]: Writing runtime sql for node "model.coffee_shop.stg_coffee_shop__orders"
[0m14:25:54.151470 [debug] [Thread-4 (]: On model.coffee_shop.stg_coffee_shop__orders: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.stg_coffee_shop__orders"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`stg_coffee_shop__orders`
    
    
    OPTIONS()
    as (
      

select * from `analytics-engineers-club.coffee_shop.orders`
    );
  
[0m14:25:54.151919 [debug] [Thread-1 (]: On model.coffee_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.my_first_dbt_model"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`my_first_dbt_model`
    
    
    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m14:25:54.152233 [debug] [Thread-7 (]: On model.coffee_shop.stg_web_tracking__pageviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.stg_web_tracking__pageviews"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`stg_web_tracking__pageviews`
    
    
    OPTIONS()
    as (
      

select * from `analytics-engineers-club`.`web_tracking`.`pageviews`
    );
  
[0m14:25:54.160258 [debug] [Thread-5 (]: Writing runtime sql for node "model.coffee_shop.stg_coffee_shop__product_prices"
[0m14:25:54.160788 [debug] [Thread-5 (]: On model.coffee_shop.stg_coffee_shop__product_prices: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.stg_coffee_shop__product_prices"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`stg_coffee_shop__product_prices`
    
    
    OPTIONS()
    as (
      

select * from `analytics-engineers-club.coffee_shop.product_prices`
    );
  
[0m14:25:54.205574 [debug] [Thread-3 (]: Writing runtime sql for node "model.coffee_shop.stg_coffee_shop__order_items"
[0m14:25:54.206252 [debug] [Thread-3 (]: On model.coffee_shop.stg_coffee_shop__order_items: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.stg_coffee_shop__order_items"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`stg_coffee_shop__order_items`
    
    
    OPTIONS()
    as (
      

select * from `analytics-engineers-club.coffee_shop.order_items`
    );
  
[0m14:25:54.210678 [debug] [Thread-2 (]: Writing runtime sql for node "model.coffee_shop.stg_coffee_shop__customers"
[0m14:25:54.211786 [debug] [Thread-2 (]: On model.coffee_shop.stg_coffee_shop__customers: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.stg_coffee_shop__customers"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`stg_coffee_shop__customers`
    
    
    OPTIONS()
    as (
      

select * from `analytics-engineers-club.coffee_shop.customers`
    );
  
[0m14:25:54.250702 [debug] [Thread-6 (]: Writing runtime sql for node "model.coffee_shop.stg_coffee_shop__products"
[0m14:25:54.251755 [debug] [Thread-6 (]: On model.coffee_shop.stg_coffee_shop__products: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.stg_coffee_shop__products"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`stg_coffee_shop__products`
    
    
    OPTIONS()
    as (
      

select * from `analytics-engineers-club.coffee_shop.products`
    );
  
[0m14:25:56.459146 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:0576bce0-0d74-408d-80e9-eea4d2cabd3b&page=queryresults
[0m14:25:56.476929 [debug] [Thread-1 (]: Timing info for model.coffee_shop.my_first_dbt_model (execute): 2023-03-10 14:25:53.436148 => 2023-03-10 14:25:56.476861
[0m14:25:56.477817 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b71ef2f2-71ea-4705-b310-6314099f6f79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5768a32f50>]}
[0m14:25:56.478430 [info ] [Thread-1 (]: 1 of 9 OK created sql table model dbt_milan.my_first_dbt_model ................. [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 3.11s]
[0m14:25:56.480652 [debug] [Thread-1 (]: Finished running node model.coffee_shop.my_first_dbt_model
[0m14:25:56.481401 [debug] [Thread-8 (]: Began running node model.coffee_shop.my_second_dbt_model
[0m14:25:56.481813 [info ] [Thread-8 (]: 8 of 9 START sql view model dbt_milan.my_second_dbt_model ...................... [RUN]
[0m14:25:56.482672 [debug] [Thread-8 (]: Acquiring new bigquery connection 'model.coffee_shop.my_second_dbt_model'
[0m14:25:56.482958 [debug] [Thread-8 (]: Began compiling node model.coffee_shop.my_second_dbt_model
[0m14:25:56.486011 [debug] [Thread-8 (]: Writing injected SQL for node "model.coffee_shop.my_second_dbt_model"
[0m14:25:56.486491 [debug] [Thread-8 (]: Timing info for model.coffee_shop.my_second_dbt_model (compile): 2023-03-10 14:25:56.483152 => 2023-03-10 14:25:56.486420
[0m14:25:56.486793 [debug] [Thread-8 (]: Began executing node model.coffee_shop.my_second_dbt_model
[0m14:25:56.505784 [debug] [Thread-8 (]: Writing runtime sql for node "model.coffee_shop.my_second_dbt_model"
[0m14:25:56.506607 [debug] [Thread-8 (]: Opening a new connection, currently in state init
[0m14:25:56.507057 [debug] [Thread-8 (]: On model.coffee_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.my_second_dbt_model"} */


  create or replace view `aec-students`.`dbt_milan`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `aec-students`.`dbt_milan`.`my_first_dbt_model`
where id = 1;


[0m14:25:56.509837 [debug] [Thread-5 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:7ea47520-6d08-481e-a64e-b931cf75ed8b&page=queryresults
[0m14:25:56.511624 [debug] [Thread-5 (]: Timing info for model.coffee_shop.stg_coffee_shop__product_prices (execute): 2023-03-10 14:25:53.424930 => 2023-03-10 14:25:56.511575
[0m14:25:56.512336 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b71ef2f2-71ea-4705-b310-6314099f6f79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f576873c7f0>]}
[0m14:25:56.513256 [info ] [Thread-5 (]: 5 of 9 OK created sql table model dbt_milan.stg_coffee_shop__product_prices .... [[32mCREATE TABLE (15.0 rows, 600.0 Bytes processed)[0m in 3.14s]
[0m14:25:56.514104 [debug] [Thread-5 (]: Finished running node model.coffee_shop.stg_coffee_shop__product_prices
[0m14:25:56.557349 [debug] [Thread-6 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:c7cee465-2aa2-49e8-84b0-313fc6034de8&page=queryresults
[0m14:25:56.560440 [debug] [Thread-6 (]: Timing info for model.coffee_shop.stg_coffee_shop__products (execute): 2023-03-10 14:25:53.422621 => 2023-03-10 14:25:56.560366
[0m14:25:56.561688 [debug] [Thread-6 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b71ef2f2-71ea-4705-b310-6314099f6f79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f576884d780>]}
[0m14:25:56.562405 [info ] [Thread-6 (]: 6 of 9 OK created sql table model dbt_milan.stg_coffee_shop__products .......... [[32mCREATE TABLE (7.0 rows, 278.0 Bytes processed)[0m in 3.20s]
[0m14:25:56.564107 [debug] [Thread-6 (]: Finished running node model.coffee_shop.stg_coffee_shop__products
[0m14:25:57.325682 [debug] [Thread-8 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:e8b1f8b0-2c12-4efd-9296-e8b55b511b01&page=queryresults
[0m14:25:57.328135 [debug] [Thread-8 (]: Timing info for model.coffee_shop.my_second_dbt_model (execute): 2023-03-10 14:25:56.486991 => 2023-03-10 14:25:57.328069
[0m14:25:57.329044 [debug] [Thread-8 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b71ef2f2-71ea-4705-b310-6314099f6f79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57686aace0>]}
[0m14:25:57.329627 [info ] [Thread-8 (]: 8 of 9 OK created sql view model dbt_milan.my_second_dbt_model ................. [[32mCREATE VIEW (0 processed)[0m in 0.85s]
[0m14:25:57.330262 [debug] [Thread-8 (]: Finished running node model.coffee_shop.my_second_dbt_model
[0m14:25:57.363763 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:774faa66-20c1-49e9-af69-3ea71af044a4&page=queryresults
[0m14:25:57.365743 [debug] [Thread-2 (]: Timing info for model.coffee_shop.stg_coffee_shop__customers (execute): 2023-03-10 14:25:53.417255 => 2023-03-10 14:25:57.365690
[0m14:25:57.366494 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b71ef2f2-71ea-4705-b310-6314099f6f79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5768744070>]}
[0m14:25:57.367010 [info ] [Thread-2 (]: 2 of 9 OK created sql table model dbt_milan.stg_coffee_shop__customers ......... [[32mCREATE TABLE (174.4k rows, 12.8 MB processed)[0m in 4.01s]
[0m14:25:57.367763 [debug] [Thread-2 (]: Finished running node model.coffee_shop.stg_coffee_shop__customers
[0m14:25:58.829783 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:2bc3753b-9f3d-4e9d-bc37-b76833730c7a&page=queryresults
[0m14:25:58.832453 [debug] [Thread-4 (]: Timing info for model.coffee_shop.stg_coffee_shop__orders (execute): 2023-03-10 14:25:53.396778 => 2023-03-10 14:25:58.832376
[0m14:25:58.833501 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b71ef2f2-71ea-4705-b310-6314099f6f79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5768745060>]}
[0m14:25:58.834087 [info ] [Thread-4 (]: 4 of 9 OK created sql table model dbt_milan.stg_coffee_shop__orders ............ [[32mCREATE TABLE (192.0k rows, 24.7 MB processed)[0m in 5.46s]
[0m14:25:58.834691 [debug] [Thread-4 (]: Finished running node model.coffee_shop.stg_coffee_shop__orders
[0m14:25:59.042898 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:e6d931c5-e558-489e-958b-e2fd12352101&page=queryresults
[0m14:25:59.045699 [debug] [Thread-3 (]: Timing info for model.coffee_shop.stg_coffee_shop__order_items (execute): 2023-03-10 14:25:53.413243 => 2023-03-10 14:25:59.045609
[0m14:25:59.046804 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b71ef2f2-71ea-4705-b310-6314099f6f79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f576884dbd0>]}
[0m14:25:59.047481 [info ] [Thread-3 (]: 3 of 9 OK created sql table model dbt_milan.stg_coffee_shop__order_items ....... [[32mCREATE TABLE (383.8k rows, 30.7 MB processed)[0m in 5.68s]
[0m14:25:59.048077 [debug] [Thread-3 (]: Finished running node model.coffee_shop.stg_coffee_shop__order_items
[0m14:26:04.527224 [debug] [Thread-7 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:9bbaf3e6-cf5d-42b8-93c8-527e1db0a488&page=queryresults
[0m14:26:04.529801 [debug] [Thread-7 (]: Timing info for model.coffee_shop.stg_web_tracking__pageviews (execute): 2023-03-10 14:25:53.411074 => 2023-03-10 14:26:04.529727
[0m14:26:04.530742 [debug] [Thread-7 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b71ef2f2-71ea-4705-b310-6314099f6f79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f576884efb0>]}
[0m14:26:04.531377 [info ] [Thread-7 (]: 7 of 9 OK created sql table model dbt_milan.stg_web_tracking__pageviews ........ [[32mCREATE TABLE (5.8m rows, 606.0 MB processed)[0m in 11.16s]
[0m14:26:04.531953 [debug] [Thread-7 (]: Finished running node model.coffee_shop.stg_web_tracking__pageviews
[0m14:26:04.533010 [debug] [Thread-1 (]: Began running node model.coffee_shop.pageviews
[0m14:26:04.533455 [info ] [Thread-1 (]: 9 of 9 START sql table model dbt_milan.pageviews ............................... [RUN]
[0m14:26:04.534251 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop.pageviews'
[0m14:26:04.534516 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.pageviews
[0m14:26:04.541296 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.pageviews"
[0m14:26:04.541823 [debug] [Thread-1 (]: Timing info for model.coffee_shop.pageviews (compile): 2023-03-10 14:26:04.534674 => 2023-03-10 14:26:04.541748
[0m14:26:04.542207 [debug] [Thread-1 (]: Began executing node model.coffee_shop.pageviews
[0m14:26:04.546346 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop.pageviews"
[0m14:26:04.546871 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:26:04.547253 [debug] [Thread-1 (]: On model.coffee_shop.pageviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.pageviews"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`pageviews`
    
    
    OPTIONS()
    as (
      

WITH
  pageview_with_stiched_user_id AS 
(
SELECT
    *,
    COALESCE (FIRST_VALUE(customer_id IGNORE NULLS) OVER (PARTITION BY visitor_id ORDER BY visitor_id ASC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING),visitor_id) AS user_id
FROM
  `aec-students`.`dbt_milan`.`stg_web_tracking__pageviews` as pageviews
),

  session_calculator as
(
SELECT
  *,
  if (TIMESTAMP_DIFF (timestamp,LAG(timestamp) OVER (PARTITION BY user_id ORDER BY timestamp ASC), SECOND)>1800, 1, 0) AS session_number_increment
FROM
  pageview_with_stiched_user_id
)

SELECT *,
  ABD(FARM_FINGERPRINT(USER_ID || SUM(session_number_increment) OVER (PARTITION BY user_id ORDER BY TIMESTAMP ASC))) as session_id
FROM session_calculator
order by visitor_id, timestamp
    );
  
[0m14:26:05.703022 [debug] [Thread-1 (]: BigQuery adapter: Retry attempt 1 of 1 after error: BadRequest('Function not found: ABD; Did you mean abs? at [33:3]')
[0m14:26:07.149961 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:b1c1192e-8cbf-4784-b027-bd55666445f4&page=queryresults
[0m14:26:07.150939 [debug] [Thread-1 (]: Timing info for model.coffee_shop.pageviews (execute): 2023-03-10 14:26:04.542534 => 2023-03-10 14:26:07.150811
[0m14:26:07.205048 [debug] [Thread-1 (]: Database Error in model pageviews (models/marts/web_tracking/pageviews.sql)
  Function not found: ABD; Did you mean abs? at [33:3]
  compiled Code at target/run/coffee_shop/models/marts/web_tracking/pageviews.sql
[0m14:26:07.205706 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b71ef2f2-71ea-4705-b310-6314099f6f79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57680713c0>]}
[0m14:26:07.206352 [error] [Thread-1 (]: 9 of 9 ERROR creating sql table model dbt_milan.pageviews ...................... [[31mERROR[0m in 2.67s]
[0m14:26:07.207029 [debug] [Thread-1 (]: Finished running node model.coffee_shop.pageviews
[0m14:26:07.209321 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:26:07.209937 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:26:07.210177 [debug] [MainThread]: Connection 'model.coffee_shop.pageviews' was properly closed.
[0m14:26:07.210410 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop__customers' was properly closed.
[0m14:26:07.210634 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop__order_items' was properly closed.
[0m14:26:07.210856 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop__products' was properly closed.
[0m14:26:07.211074 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop__orders' was properly closed.
[0m14:26:07.211292 [debug] [MainThread]: Connection 'model.coffee_shop.stg_web_tracking__pageviews' was properly closed.
[0m14:26:07.211510 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop__product_prices' was properly closed.
[0m14:26:07.211727 [debug] [MainThread]: Connection 'model.coffee_shop.my_second_dbt_model' was properly closed.
[0m14:26:07.212104 [info ] [MainThread]: 
[0m14:26:07.212499 [info ] [MainThread]: Finished running 8 table models, 1 view model in 0 hours 0 minutes and 15.44 seconds (15.44s).
[0m14:26:07.213857 [debug] [MainThread]: Command end result
[0m14:26:07.221859 [info ] [MainThread]: 
[0m14:26:07.222415 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:26:07.222895 [info ] [MainThread]: 
[0m14:26:07.223389 [error] [MainThread]: [33mDatabase Error in model pageviews (models/marts/web_tracking/pageviews.sql)[0m
[0m14:26:07.223975 [error] [MainThread]:   Function not found: ABD; Did you mean abs? at [33:3]
[0m14:26:07.224509 [error] [MainThread]:   compiled Code at target/run/coffee_shop/models/marts/web_tracking/pageviews.sql
[0m14:26:07.225017 [info ] [MainThread]: 
[0m14:26:07.225508 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=0 TOTAL=9
[0m14:26:07.226221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5768b81b40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f576c04c4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5768a030d0>]}
[0m14:26:07.226767 [debug] [MainThread]: Flushing usage events


============================== 2023-03-10 14:27:00.101901 | fcf0f5cf-a952-4c74-9ca3-c55c3b33130b ==============================
[0m14:27:00.101901 [info ] [MainThread]: Running with dbt=1.4.1
[0m14:27:00.105278 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/vscode/.dbt', 'send_anonymous_usage_stats': True, 'quiet': False, 'no_print': False, 'cache_selected_only': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m14:27:00.105867 [debug] [MainThread]: Tracking: tracking
[0m14:27:00.108036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b411dcdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b3d850550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b3d8536d0>]}
[0m14:27:00.182086 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:27:00.183439 [debug] [MainThread]: Partial parsing: updated file: coffee_shop://models/marts/web_tracking/pageviews.sql
[0m14:27:00.206529 [debug] [MainThread]: 1699: static parser successfully parsed marts/web_tracking/pageviews.sql
[0m14:27:00.224277 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.coffe_shop_milan.example
[0m14:27:00.229614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fcf0f5cf-a952-4c74-9ca3-c55c3b33130b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b3d6a5c30>]}
[0m14:27:00.238115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fcf0f5cf-a952-4c74-9ca3-c55c3b33130b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b3d668430>]}
[0m14:27:00.238510 [info ] [MainThread]: Found 9 models, 10 tests, 0 snapshots, 0 analyses, 334 macros, 0 operations, 0 seed files, 2 sources, 0 exposures, 0 metrics
[0m14:27:00.238964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fcf0f5cf-a952-4c74-9ca3-c55c3b33130b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b411dcdc0>]}
[0m14:27:00.240911 [info ] [MainThread]: 
[0m14:27:00.292801 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:27:00.294407 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students'
[0m14:27:00.294942 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:27:01.416509 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_aec-students_dbt_milan'
[0m14:27:01.417260 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:27:01.710915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fcf0f5cf-a952-4c74-9ca3-c55c3b33130b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b3dc64280>]}
[0m14:27:01.712113 [info ] [MainThread]: Concurrency: 8 threads (target='dev')
[0m14:27:01.712826 [info ] [MainThread]: 
[0m14:27:01.718001 [debug] [Thread-1 (]: Began running node model.coffee_shop.my_first_dbt_model
[0m14:27:01.718429 [info ] [Thread-1 (]: 1 of 9 START sql table model dbt_milan.my_first_dbt_model ...................... [RUN]
[0m14:27:01.719273 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop.my_first_dbt_model'
[0m14:27:01.719563 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.my_first_dbt_model
[0m14:27:01.722777 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.my_first_dbt_model"
[0m14:27:01.723141 [debug] [Thread-2 (]: Began running node model.coffee_shop.stg_coffee_shop__customers
[0m14:27:01.723544 [debug] [Thread-3 (]: Began running node model.coffee_shop.stg_coffee_shop__order_items
[0m14:27:01.723811 [debug] [Thread-4 (]: Began running node model.coffee_shop.stg_coffee_shop__orders
[0m14:27:01.724134 [debug] [Thread-5 (]: Began running node model.coffee_shop.stg_coffee_shop__product_prices
[0m14:27:01.724460 [debug] [Thread-6 (]: Began running node model.coffee_shop.stg_coffee_shop__products
[0m14:27:01.724816 [debug] [Thread-7 (]: Began running node model.coffee_shop.stg_web_tracking__pageviews
[0m14:27:01.729517 [info ] [Thread-6 (]: 6 of 9 START sql table model dbt_milan.stg_coffee_shop__products ............... [RUN]
[0m14:27:01.731297 [debug] [Thread-6 (]: Acquiring new bigquery connection 'model.coffee_shop.stg_coffee_shop__products'
[0m14:27:01.727616 [debug] [Thread-1 (]: Timing info for model.coffee_shop.my_first_dbt_model (compile): 2023-03-10 14:27:01.719757 => 2023-03-10 14:27:01.727504
[0m14:27:01.726184 [info ] [Thread-4 (]: 4 of 9 START sql table model dbt_milan.stg_coffee_shop__orders ................. [RUN]
[0m14:27:01.727158 [info ] [Thread-5 (]: 5 of 9 START sql table model dbt_milan.stg_coffee_shop__product_prices ......... [RUN]
[0m14:27:01.730211 [info ] [Thread-7 (]: 7 of 9 START sql table model dbt_milan.stg_web_tracking__pageviews ............. [RUN]
[0m14:27:01.725247 [info ] [Thread-2 (]: 2 of 9 START sql table model dbt_milan.stg_coffee_shop__customers .............. [RUN]
[0m14:27:01.731586 [debug] [Thread-6 (]: Began compiling node model.coffee_shop.stg_coffee_shop__products
[0m14:27:01.738013 [debug] [Thread-6 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop__products"
[0m14:27:01.732135 [debug] [Thread-1 (]: Began executing node model.coffee_shop.my_first_dbt_model
[0m14:27:01.733052 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.coffee_shop.stg_coffee_shop__orders'
[0m14:27:01.733747 [debug] [Thread-5 (]: Acquiring new bigquery connection 'model.coffee_shop.stg_coffee_shop__product_prices'
[0m14:27:01.734647 [debug] [Thread-7 (]: Acquiring new bigquery connection 'model.coffee_shop.stg_web_tracking__pageviews'
[0m14:27:01.735373 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.coffee_shop.stg_coffee_shop__customers'
[0m14:27:01.725747 [info ] [Thread-3 (]: 3 of 9 START sql table model dbt_milan.stg_coffee_shop__order_items ............ [RUN]
[0m14:27:01.738938 [debug] [Thread-6 (]: Timing info for model.coffee_shop.stg_coffee_shop__products (compile): 2023-03-10 14:27:01.735621 => 2023-03-10 14:27:01.738849
[0m14:27:01.753647 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:27:01.753960 [debug] [Thread-4 (]: Began compiling node model.coffee_shop.stg_coffee_shop__orders
[0m14:27:01.754319 [debug] [Thread-5 (]: Began compiling node model.coffee_shop.stg_coffee_shop__product_prices
[0m14:27:01.754614 [debug] [Thread-7 (]: Began compiling node model.coffee_shop.stg_web_tracking__pageviews
[0m14:27:01.754952 [debug] [Thread-2 (]: Began compiling node model.coffee_shop.stg_coffee_shop__customers
[0m14:27:01.755549 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.coffee_shop.stg_coffee_shop__order_items'
[0m14:27:01.769146 [debug] [Thread-3 (]: Began compiling node model.coffee_shop.stg_coffee_shop__order_items
[0m14:27:01.760506 [debug] [Thread-4 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop__orders"
[0m14:27:01.766086 [debug] [Thread-7 (]: Writing injected SQL for node "model.coffee_shop.stg_web_tracking__pageviews"
[0m14:27:01.768405 [debug] [Thread-2 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop__customers"
[0m14:27:01.755929 [debug] [Thread-6 (]: Began executing node model.coffee_shop.stg_coffee_shop__products
[0m14:27:01.771705 [debug] [Thread-5 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop__product_prices"
[0m14:27:01.785091 [debug] [Thread-5 (]: Timing info for model.coffee_shop.stg_coffee_shop__product_prices (compile): 2023-03-10 14:27:01.760866 => 2023-03-10 14:27:01.785005
[0m14:27:01.780388 [debug] [Thread-3 (]: Writing injected SQL for node "model.coffee_shop.stg_coffee_shop__order_items"
[0m14:27:01.784439 [debug] [Thread-6 (]: Opening a new connection, currently in state init
[0m14:27:01.785494 [debug] [Thread-5 (]: Began executing node model.coffee_shop.stg_coffee_shop__product_prices
[0m14:27:01.781085 [debug] [Thread-4 (]: Timing info for model.coffee_shop.stg_coffee_shop__orders (compile): 2023-03-10 14:27:01.757928 => 2023-03-10 14:27:01.780990
[0m14:27:01.791655 [debug] [Thread-4 (]: Began executing node model.coffee_shop.stg_coffee_shop__orders
[0m14:27:01.795695 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:27:01.790110 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m14:27:01.785845 [debug] [Thread-2 (]: Timing info for model.coffee_shop.stg_coffee_shop__customers (compile): 2023-03-10 14:27:01.766388 => 2023-03-10 14:27:01.785766
[0m14:27:01.799746 [debug] [Thread-2 (]: Began executing node model.coffee_shop.stg_coffee_shop__customers
[0m14:27:01.802649 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:27:01.786476 [debug] [Thread-7 (]: Timing info for model.coffee_shop.stg_web_tracking__pageviews (compile): 2023-03-10 14:27:01.763074 => 2023-03-10 14:27:01.786400
[0m14:27:01.807798 [debug] [Thread-7 (]: Began executing node model.coffee_shop.stg_web_tracking__pageviews
[0m14:27:01.810729 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m14:27:01.807306 [debug] [Thread-3 (]: Timing info for model.coffee_shop.stg_coffee_shop__order_items (compile): 2023-03-10 14:27:01.772828 => 2023-03-10 14:27:01.807207
[0m14:27:01.812684 [debug] [Thread-3 (]: Began executing node model.coffee_shop.stg_coffee_shop__order_items
[0m14:27:01.815620 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:27:02.489053 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop.my_first_dbt_model"
[0m14:27:02.491834 [debug] [Thread-4 (]: Writing runtime sql for node "model.coffee_shop.stg_coffee_shop__orders"
[0m14:27:02.493834 [debug] [Thread-2 (]: Writing runtime sql for node "model.coffee_shop.stg_coffee_shop__customers"
[0m14:27:02.495169 [debug] [Thread-5 (]: Writing runtime sql for node "model.coffee_shop.stg_coffee_shop__product_prices"
[0m14:27:02.497405 [debug] [Thread-5 (]: On model.coffee_shop.stg_coffee_shop__product_prices: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.stg_coffee_shop__product_prices"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`stg_coffee_shop__product_prices`
    
    
    OPTIONS()
    as (
      

select * from `analytics-engineers-club.coffee_shop.product_prices`
    );
  
[0m14:27:02.496773 [debug] [Thread-4 (]: On model.coffee_shop.stg_coffee_shop__orders: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.stg_coffee_shop__orders"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`stg_coffee_shop__orders`
    
    
    OPTIONS()
    as (
      

select * from `analytics-engineers-club.coffee_shop.orders`
    );
  
[0m14:27:02.496428 [debug] [Thread-2 (]: On model.coffee_shop.stg_coffee_shop__customers: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.stg_coffee_shop__customers"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`stg_coffee_shop__customers`
    
    
    OPTIONS()
    as (
      

select * from `analytics-engineers-club.coffee_shop.customers`
    );
  
[0m14:27:02.497859 [debug] [Thread-1 (]: On model.coffee_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.my_first_dbt_model"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`my_first_dbt_model`
    
    
    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
[0m14:27:02.583980 [debug] [Thread-3 (]: Writing runtime sql for node "model.coffee_shop.stg_coffee_shop__order_items"
[0m14:27:02.584836 [debug] [Thread-3 (]: On model.coffee_shop.stg_coffee_shop__order_items: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.stg_coffee_shop__order_items"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`stg_coffee_shop__order_items`
    
    
    OPTIONS()
    as (
      

select * from `analytics-engineers-club.coffee_shop.order_items`
    );
  
[0m14:27:02.592440 [debug] [Thread-7 (]: Writing runtime sql for node "model.coffee_shop.stg_web_tracking__pageviews"
[0m14:27:02.593059 [debug] [Thread-7 (]: On model.coffee_shop.stg_web_tracking__pageviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.stg_web_tracking__pageviews"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`stg_web_tracking__pageviews`
    
    
    OPTIONS()
    as (
      

select * from `analytics-engineers-club`.`web_tracking`.`pageviews`
    );
  
[0m14:27:02.858759 [debug] [Thread-6 (]: Writing runtime sql for node "model.coffee_shop.stg_coffee_shop__products"
[0m14:27:02.859672 [debug] [Thread-6 (]: On model.coffee_shop.stg_coffee_shop__products: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.stg_coffee_shop__products"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`stg_coffee_shop__products`
    
    
    OPTIONS()
    as (
      

select * from `analytics-engineers-club.coffee_shop.products`
    );
  
[0m14:27:04.699452 [debug] [Thread-5 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:2a1d2f0b-f20f-47e5-80a6-d51f7a5007c2&page=queryresults
[0m14:27:04.717034 [debug] [Thread-5 (]: Timing info for model.coffee_shop.stg_coffee_shop__product_prices (execute): 2023-03-10 14:27:01.787935 => 2023-03-10 14:27:04.716957
[0m14:27:04.717907 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcf0f5cf-a952-4c74-9ca3-c55c3b33130b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b3d83ceb0>]}
[0m14:27:04.718477 [info ] [Thread-5 (]: 5 of 9 OK created sql table model dbt_milan.stg_coffee_shop__product_prices .... [[32mCREATE TABLE (15.0 rows, 600.0 Bytes processed)[0m in 2.98s]
[0m14:27:04.720539 [debug] [Thread-5 (]: Finished running node model.coffee_shop.stg_coffee_shop__product_prices
[0m14:27:04.770871 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:99e16b95-a28f-4253-a7a7-ed73d71f9ec4&page=queryresults
[0m14:27:04.773417 [debug] [Thread-1 (]: Timing info for model.coffee_shop.my_first_dbt_model (execute): 2023-03-10 14:27:01.739116 => 2023-03-10 14:27:04.773343
[0m14:27:04.774223 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcf0f5cf-a952-4c74-9ca3-c55c3b33130b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b3d857a90>]}
[0m14:27:04.774735 [info ] [Thread-1 (]: 1 of 9 OK created sql table model dbt_milan.my_first_dbt_model ................. [[32mCREATE TABLE (2.0 rows, 0 processed)[0m in 3.06s]
[0m14:27:04.775376 [debug] [Thread-1 (]: Finished running node model.coffee_shop.my_first_dbt_model
[0m14:27:04.776349 [debug] [Thread-8 (]: Began running node model.coffee_shop.my_second_dbt_model
[0m14:27:04.776766 [info ] [Thread-8 (]: 8 of 9 START sql view model dbt_milan.my_second_dbt_model ...................... [RUN]
[0m14:27:04.778063 [debug] [Thread-8 (]: Acquiring new bigquery connection 'model.coffee_shop.my_second_dbt_model'
[0m14:27:04.778440 [debug] [Thread-8 (]: Began compiling node model.coffee_shop.my_second_dbt_model
[0m14:27:04.781320 [debug] [Thread-8 (]: Writing injected SQL for node "model.coffee_shop.my_second_dbt_model"
[0m14:27:04.782207 [debug] [Thread-8 (]: Timing info for model.coffee_shop.my_second_dbt_model (compile): 2023-03-10 14:27:04.778635 => 2023-03-10 14:27:04.782131
[0m14:27:04.782585 [debug] [Thread-8 (]: Began executing node model.coffee_shop.my_second_dbt_model
[0m14:27:04.802316 [debug] [Thread-8 (]: Writing runtime sql for node "model.coffee_shop.my_second_dbt_model"
[0m14:27:04.803143 [debug] [Thread-8 (]: Opening a new connection, currently in state init
[0m14:27:04.803586 [debug] [Thread-8 (]: On model.coffee_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.my_second_dbt_model"} */


  create or replace view `aec-students`.`dbt_milan`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `aec-students`.`dbt_milan`.`my_first_dbt_model`
where id = 1;


[0m14:27:05.284537 [debug] [Thread-6 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:a94a8e50-0cea-43f1-8078-6f537c0fd9bb&page=queryresults
[0m14:27:05.287008 [debug] [Thread-6 (]: Timing info for model.coffee_shop.stg_coffee_shop__products (execute): 2023-03-10 14:27:01.781819 => 2023-03-10 14:27:05.286931
[0m14:27:05.288046 [debug] [Thread-6 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcf0f5cf-a952-4c74-9ca3-c55c3b33130b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b3d83dde0>]}
[0m14:27:05.288749 [info ] [Thread-6 (]: 6 of 9 OK created sql table model dbt_milan.stg_coffee_shop__products .......... [[32mCREATE TABLE (7.0 rows, 278.0 Bytes processed)[0m in 3.56s]
[0m14:27:05.289455 [debug] [Thread-6 (]: Finished running node model.coffee_shop.stg_coffee_shop__products
[0m14:27:05.525237 [debug] [Thread-8 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:db6c9fbc-babc-427e-931a-9f2a0652abda&page=queryresults
[0m14:27:05.527937 [debug] [Thread-8 (]: Timing info for model.coffee_shop.my_second_dbt_model (execute): 2023-03-10 14:27:04.782873 => 2023-03-10 14:27:05.527861
[0m14:27:05.528826 [debug] [Thread-8 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcf0f5cf-a952-4c74-9ca3-c55c3b33130b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b3d856110>]}
[0m14:27:05.529352 [info ] [Thread-8 (]: 8 of 9 OK created sql view model dbt_milan.my_second_dbt_model ................. [[32mCREATE VIEW (0 processed)[0m in 0.75s]
[0m14:27:05.530080 [debug] [Thread-8 (]: Finished running node model.coffee_shop.my_second_dbt_model
[0m14:27:06.320555 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:94f99bc9-c6da-4d48-a536-6f462b83ee1c&page=queryresults
[0m14:27:06.323823 [debug] [Thread-2 (]: Timing info for model.coffee_shop.stg_coffee_shop__customers (execute): 2023-03-10 14:27:01.800054 => 2023-03-10 14:27:06.323731
[0m14:27:06.325504 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcf0f5cf-a952-4c74-9ca3-c55c3b33130b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b3d83e050>]}
[0m14:27:06.326444 [info ] [Thread-2 (]: 2 of 9 OK created sql table model dbt_milan.stg_coffee_shop__customers ......... [[32mCREATE TABLE (174.4k rows, 12.8 MB processed)[0m in 4.59s]
[0m14:27:06.328683 [debug] [Thread-2 (]: Finished running node model.coffee_shop.stg_coffee_shop__customers
[0m14:27:07.813117 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:ce974cc3-857c-4a77-aebe-b44e31c9a394&page=queryresults
[0m14:27:07.815834 [debug] [Thread-4 (]: Timing info for model.coffee_shop.stg_coffee_shop__orders (execute): 2023-03-10 14:27:01.792504 => 2023-03-10 14:27:07.815756
[0m14:27:07.816906 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcf0f5cf-a952-4c74-9ca3-c55c3b33130b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b3d166e00>]}
[0m14:27:07.817620 [info ] [Thread-4 (]: 4 of 9 OK created sql table model dbt_milan.stg_coffee_shop__orders ............ [[32mCREATE TABLE (192.0k rows, 24.7 MB processed)[0m in 6.08s]
[0m14:27:07.818421 [debug] [Thread-4 (]: Finished running node model.coffee_shop.stg_coffee_shop__orders
[0m14:27:07.940251 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:511cfabe-40f6-4e69-b5a2-f27fafee5fa2&page=queryresults
[0m14:27:07.942476 [debug] [Thread-3 (]: Timing info for model.coffee_shop.stg_coffee_shop__order_items (execute): 2023-03-10 14:27:01.813071 => 2023-03-10 14:27:07.942406
[0m14:27:07.943422 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcf0f5cf-a952-4c74-9ca3-c55c3b33130b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b3d14afb0>]}
[0m14:27:07.944187 [info ] [Thread-3 (]: 3 of 9 OK created sql table model dbt_milan.stg_coffee_shop__order_items ....... [[32mCREATE TABLE (383.8k rows, 30.7 MB processed)[0m in 6.19s]
[0m14:27:07.944808 [debug] [Thread-3 (]: Finished running node model.coffee_shop.stg_coffee_shop__order_items
[0m14:27:11.624513 [debug] [Thread-7 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:c83fe788-da33-4b46-8995-d583249d90c9&page=queryresults
[0m14:27:11.626850 [debug] [Thread-7 (]: Timing info for model.coffee_shop.stg_web_tracking__pageviews (execute): 2023-03-10 14:27:01.808128 => 2023-03-10 14:27:11.626782
[0m14:27:11.627686 [debug] [Thread-7 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcf0f5cf-a952-4c74-9ca3-c55c3b33130b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b3d83c700>]}
[0m14:27:11.628227 [info ] [Thread-7 (]: 7 of 9 OK created sql table model dbt_milan.stg_web_tracking__pageviews ........ [[32mCREATE TABLE (5.8m rows, 606.0 MB processed)[0m in 9.89s]
[0m14:27:11.628962 [debug] [Thread-7 (]: Finished running node model.coffee_shop.stg_web_tracking__pageviews
[0m14:27:11.630142 [debug] [Thread-1 (]: Began running node model.coffee_shop.pageviews
[0m14:27:11.630580 [info ] [Thread-1 (]: 9 of 9 START sql table model dbt_milan.pageviews ............................... [RUN]
[0m14:27:11.631732 [debug] [Thread-1 (]: Acquiring new bigquery connection 'model.coffee_shop.pageviews'
[0m14:27:11.632016 [debug] [Thread-1 (]: Began compiling node model.coffee_shop.pageviews
[0m14:27:11.636874 [debug] [Thread-1 (]: Writing injected SQL for node "model.coffee_shop.pageviews"
[0m14:27:11.637834 [debug] [Thread-1 (]: Timing info for model.coffee_shop.pageviews (compile): 2023-03-10 14:27:11.632351 => 2023-03-10 14:27:11.637745
[0m14:27:11.638296 [debug] [Thread-1 (]: Began executing node model.coffee_shop.pageviews
[0m14:27:11.646065 [debug] [Thread-1 (]: Writing runtime sql for node "model.coffee_shop.pageviews"
[0m14:27:11.646759 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:27:11.647303 [debug] [Thread-1 (]: On model.coffee_shop.pageviews: /* {"app": "dbt", "dbt_version": "1.4.1", "profile_name": "coffe_shop_milan", "target_name": "dev", "node_id": "model.coffee_shop.pageviews"} */

  
    

    create or replace table `aec-students`.`dbt_milan`.`pageviews`
    
    
    OPTIONS()
    as (
      

WITH
  pageview_with_stiched_user_id AS 
(
SELECT
    *,
    COALESCE (FIRST_VALUE(customer_id IGNORE NULLS) OVER (PARTITION BY visitor_id ORDER BY visitor_id ASC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING),visitor_id) AS user_id
FROM
  `aec-students`.`dbt_milan`.`stg_web_tracking__pageviews` as pageviews
),

  session_calculator as
(
SELECT
  *,
  if (TIMESTAMP_DIFF (timestamp,LAG(timestamp) OVER (PARTITION BY user_id ORDER BY timestamp ASC), SECOND)>1800, 1, 0) AS session_number_increment
FROM
  pageview_with_stiched_user_id
)

SELECT *,
  ABS(FARM_FINGERPRINT(USER_ID || SUM(session_number_increment) OVER (PARTITION BY user_id ORDER BY TIMESTAMP ASC))) as session_id
FROM session_calculator
order by visitor_id, timestamp
    );
  
[0m14:27:25.701950 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=aec-students&j=bq:US:4742226a-a43f-490a-9498-efcb449e5d4b&page=queryresults
[0m14:27:25.704286 [debug] [Thread-1 (]: Timing info for model.coffee_shop.pageviews (execute): 2023-03-10 14:27:11.638626 => 2023-03-10 14:27:25.704206
[0m14:27:25.705298 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcf0f5cf-a952-4c74-9ca3-c55c3b33130b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b3d82d540>]}
[0m14:27:25.705901 [info ] [Thread-1 (]: 9 of 9 OK created sql table model dbt_milan.pageviews .......................... [[32mCREATE TABLE (5.8m rows, 606.0 MB processed)[0m in 14.07s]
[0m14:27:25.706513 [debug] [Thread-1 (]: Finished running node model.coffee_shop.pageviews
[0m14:27:25.708768 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:27:25.709367 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:27:25.709608 [debug] [MainThread]: Connection 'model.coffee_shop.pageviews' was properly closed.
[0m14:27:25.709844 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop__products' was properly closed.
[0m14:27:25.710076 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop__orders' was properly closed.
[0m14:27:25.710302 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop__product_prices' was properly closed.
[0m14:27:25.710523 [debug] [MainThread]: Connection 'model.coffee_shop.stg_web_tracking__pageviews' was properly closed.
[0m14:27:25.710741 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop__customers' was properly closed.
[0m14:27:25.710963 [debug] [MainThread]: Connection 'model.coffee_shop.stg_coffee_shop__order_items' was properly closed.
[0m14:27:25.711180 [debug] [MainThread]: Connection 'model.coffee_shop.my_second_dbt_model' was properly closed.
[0m14:27:25.711525 [info ] [MainThread]: 
[0m14:27:25.712101 [info ] [MainThread]: Finished running 8 table models, 1 view model in 0 hours 0 minutes and 25.47 seconds (25.47s).
[0m14:27:25.713158 [debug] [MainThread]: Command end result
[0m14:27:25.724828 [info ] [MainThread]: 
[0m14:27:25.725323 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:27:25.725815 [info ] [MainThread]: 
[0m14:27:25.726238 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m14:27:25.726914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b3d807880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b3dc739a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b3d9fd060>]}
[0m14:27:25.727402 [debug] [MainThread]: Flushing usage events
